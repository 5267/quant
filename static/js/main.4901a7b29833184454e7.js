define("business/js/main",["lodash","achy/biz/yauth","backbone","underscore","achy/biz/globalFooter","jquery","mathjax","achy/widget/ui/modal","achy/widget/ui/message","achy/utils/digit","highcharts","achy/utils/head","jqueryui","achy/biz/globalBar2"],function(__WEBPACK_EXTERNAL_MODULE_45__,__WEBPACK_EXTERNAL_MODULE_46__,__WEBPACK_EXTERNAL_MODULE_48__,__WEBPACK_EXTERNAL_MODULE_50__,__WEBPACK_EXTERNAL_MODULE_67__,__WEBPACK_EXTERNAL_MODULE_77__,__WEBPACK_EXTERNAL_MODULE_91__,__WEBPACK_EXTERNAL_MODULE_115__,__WEBPACK_EXTERNAL_MODULE_156__,__WEBPACK_EXTERNAL_MODULE_182__,__WEBPACK_EXTERNAL_MODULE_183__,__WEBPACK_EXTERNAL_MODULE_378__,__WEBPACK_EXTERNAL_MODULE_409__,__WEBPACK_EXTERNAL_MODULE_613__){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(41)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i,r;n(42),i=[n(45),n(46),n(47),n(53),n(612),n(72),n(266),n(233),n(611),n(214),n(116),n(556),n(616)],r=function(e,t,n){$.ajaxPrefilter(function(e,n,i){i.then(function(e){e&&-403===e.code&&t.forceLoginWithRedirect({loginUrl:window.getAppRoot()+"/login.html?RelayState="})})}),t.logined().always(function(){n.start()})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){},,,function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_45__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_46__},function(e,t,n){var i,r;i=[n(48),n(49)],r=function(e,t){var n=new t.Application;return n.body=$(document.body),n.name="优矿",n.version="Beta",n.on("layout:inited",function(){e.history.start({pushState:!0,root:requirejs.toUrl("business").replace(location.origin,"")})}),window.App=n,n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_48__},function(e,t,n){var i,r;!function(o,a){i=[n(48),n(50),n(51),n(52)],r=function(e,t){return o.Marionette=o.Mn=a(o,e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t,n){"use strict";var i=e.Marionette,r=e.Mn,o=t.Marionette={};o.VERSION="2.4.4",o.noConflict=function(){return e.Marionette=i,e.Mn=r,this},o.Deferred=t.$.Deferred,o.FEATURES={},o.isEnabled=function(e){return!!o.FEATURES[e]},o.extend=t.Model.extend,o.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},o.mergeOptions=function(e,t){e&&n.extend(this,n.pick(e,t))},o.getOption=function(e,t){return e&&t?e.options&&void 0!==e.options[t]?e.options[t]:e[t]:void 0},o.proxyGetOption=function(e){return o.getOption(this,e)},o._getValue=function(e,t,i){return n.isFunction(e)&&(e=i?e.apply(t,i):e.call(t)),e},o.normalizeMethods=function(e){return n.reduce(e,function(e,t,i){return n.isFunction(t)||(t=this[t]),t&&(e[i]=t),e},{},this)},o.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(e){return t[e.slice(4)]})},o.normalizeUIKeys=function(e,t){return n.reduce(e,function(e,n,i){var r=o.normalizeUIString(i,t);return e[r]=n,e},{})},o.normalizeUIValues=function(e,t,i){return n.each(e,function(r,a){n.isString(r)?e[a]=o.normalizeUIString(r,t):n.isObject(r)&&n.isArray(i)&&(n.extend(r,o.normalizeUIValues(n.pick(r,i),t)),n.each(i,function(e){var i=r[e];n.isString(i)&&(r[e]=o.normalizeUIString(i,t))}))}),e},o.actAsCollection=function(e,t){var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(i,function(i){e[i]=function(){var e=n.values(n.result(this,t)),r=[e].concat(n.toArray(arguments));return n[i].apply(n,r)}})};var a=o.deprecate=function(e,t){n.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),void 0!==t&&t||a._cache[e]||(a._warn("Deprecation warning: "+e),a._cache[e]=!0)};a._warn="undefined"!=typeof console&&(console.warn||console.log)||function(){},a._cache={},o._triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi;return function(i,r,o){var a=arguments.length<3;a&&(o=r,r=o[0]);var s,l="on"+r.replace(t,e),c=i[l];return n.isFunction(c)&&(s=c.apply(i,a?n.rest(o):o)),n.isFunction(i.trigger)&&(a+o.length>1?i.trigger.apply(i,a?o:[r].concat(n.drop(o,0))):i.trigger(r)),s}}(),o.triggerMethod=function(e){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(e){var t=n.isFunction(e.triggerMethod)?e.triggerMethod:o.triggerMethod;return t.apply(e,n.rest(arguments))},o.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,i()}function n(){e._isRendered=!0,i()}function i(){e._isShown&&e._isRendered&&o.isNodeAttached(e.el)&&o.triggerMethodOn(e,"dom:refresh",e)}e._isDomRefreshMonitored||(e._isDomRefreshMonitored=!0,e.on({show:t,render:n}))},function(e){function t(t,i,r,o){var a=o.split(/\s+/);n.each(a,function(n){var o=t[n];if(!o)throw new e.Error('Method "'+n+'" was configured as an event handler, but does not exist.');t.listenTo(i,r,o)})}function i(e,t,n,i){e.listenTo(t,n,i)}function r(e,t,i,r){var o=r.split(/\s+/);n.each(o,function(n){var r=e[n];e.stopListening(t,i,r)})}function o(e,t,n,i){e.stopListening(t,n,i)}function a(t,i,r,o,a){if(i&&r){if(!n.isObject(r))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=e._getValue(r,t),n.each(r,function(e,r){n.isFunction(e)?o(t,i,r,e):a(t,i,r,e)})}}e.bindEntityEvents=function(e,n,r){a(e,n,r,i,t)},e.unbindEntityEvents=function(e,t,n){a(e,t,n,o,r)},e.proxyBindEntityEvents=function(t,n){return e.bindEntityEvents(this,t,n)},e.proxyUnbindEntityEvents=function(t,n){return e.unbindEntityEvents(this,t,n)}}(o);var s=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(e,t){n.isObject(e)?(t=e,e=t.message):t||(t={});var i=Error.call(this,e);n.extend(this,n.pick(i,s),n.pick(t,s)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(e,t){var i=n.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),i.then(function(n){t&&(n.context=t),e.call(n.context,n.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),o.Controller=function(e){this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,t.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(e){this.options=n.extend({},n.result(this,"options"),e),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,n.extend(o.Object.prototype,t.Events,{initialize:function(){},destroy:function(e){return e=e||{},this.triggerMethod("before:destroy",e),this.triggerMethod("destroy",e),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,e)},show:function(e,t){if(this._ensureElement()){this._ensureViewIsIntact(e),o.MonitorDOMRefresh(e);var i=t||{},r=e!==this.currentView,a=!!i.preventDestroy,s=!!i.forceShow,l=!!this.currentView,c=r&&!a,u=r||s;if(l&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&delete this.currentView._parent,c?this.empty():l&&u&&this.currentView.off("destroy",this.empty,this),u){e.once("destroy",this.empty,this),e._parent=this,this._renderView(e),l&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),o.triggerMethodOn(e,"before:show",e,this,t),l&&this.triggerMethod("swapOut",this.currentView,this,t);var d=o.isNodeAttached(this.el),h=[],p=n.extend({triggerBeforeAttach:this.triggerBeforeAttach,triggerAttach:this.triggerAttach},i);return d&&p.triggerBeforeAttach&&(h=this._displayedViews(e),this._triggerAttach(h,"before:")),this.attachHtml(e),this.currentView=e,d&&p.triggerAttach&&(h=this._displayedViews(e),this._triggerAttach(h)),l&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),o.triggerMethodOn(e,"show",e,this,t),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var i=(t||"")+"attach";n.each(e,function(e){o.triggerMethodOn(e,i,e,this)},this)},_displayedViews:function(e){return n.union([e],n.result(e,"_getNestedViews")||[])},_renderView:function(e){e.supportsRenderLifecycle||o.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||o.triggerMethodOn(e,"render",e)},_ensureElement:function(){if(n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,o._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,n=e||{},i=!!n.preventDestroy;return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),i||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,i&&this.$el.contents().detach(),this):this},_destroyView:function(){var e=this.currentView;e.isDestroyed||(e.supportsDestroyLifecycle||o.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():(e.remove(),e.isDestroyed=!0),e.supportsDestroyLifecycle||o.triggerMethodOn(e,"destroy",e))},attachView:function(e){return this.currentView&&delete this.currentView._parent,e._parent=this,this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(n.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(n.isFunction(e))return this._buildRegionFromRegionClass(e);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var i=e.regionClass||t,r=n.omit(e,"selector","regionClass");return e.selector&&!r.el&&(r.el=e.selector),new i(r)},_buildRegionFromRegionClass:function(e){return new e}}),o.RegionManager=o.Controller.extend({constructor:function(e){this._regions={},this.length=0,o.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=o._getValue(e,this,arguments),n.reduce(e,function(e,i,r){return n.isString(i)&&(i={selector:i}),i.selector&&(i=n.defaults({},i,t)),e[r]=this.addRegion(r,i),e},{},this)},addRegion:function(e,t){var n;return n=t instanceof o.Region?t:o.Region.buildRegion(t,o.Region),this.triggerMethod("before:add:region",e,n),n._parent=this,this._store(e,n),this.triggerMethod("add:region",e,n),n},get:function(e){return this._regions[e]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return n.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return n.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(e){this.templateId=e},n.extend(o.TemplateCache,{templateCaches:{},get:function(e,t){var n=this.templateCaches[e];return n||(n=new o.TemplateCache(e),this.templateCaches[e]=n),n.load(t)},clear:function(){var e,t=n.toArray(arguments),i=t.length;if(i>0)for(e=0;i>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e,n){var i=t.$(e);if(!i.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return i.html()},compileTemplate:function(e,t){return n.template(e,t)}}),o.Renderer={render:function(e,t){if(!e)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var i=n.isFunction(e)?e:o.TemplateCache.get(e);return i(t)}},o.View=t.View.extend({isDestroyed:!1,supportsRenderLifecycle:!0,supportsDestroyLifecycle:!0,constructor:function(e){this.render=n.bind(this.render,this),e=o._getValue(e,this),this.options=n.extend({},n.result(this,"options"),e),this._behaviors=o.Behaviors(this),t.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,n.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=o._getValue(t,this),n.extend(e,t)},normalizeUIKeys:function(e){var t=n.result(this,"_uiBindings");return o.normalizeUIKeys(e,t||n.result(this,"ui"))},normalizeUIValues:function(e,t){var i=n.result(this,"ui"),r=n.result(this,"_uiBindings");return o.normalizeUIValues(e,r||i,t)},configureTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(e,function(e,t,n){return e[n]=this._buildViewTrigger(t),e},{},this)}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var i=o._getValue(e||this.events,this);i=this.normalizeUIKeys(i),n.isUndefined(e)&&(this.events=i);var r={},a=n.result(this,"behaviorEvents")||{},s=this.configureTriggers(),l=n.result(this,"behaviorTriggers")||{};n.extend(r,a,i,s,l),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),n.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(e,function(e,t){this.ui[t]=this.$(e)},this)}},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=n.defaults({},e,{preventDefault:!0,stopPropagation:!0}),i=n.isObject(e)?t.event:e;return function(e){e&&(e.preventDefault&&t.preventDefault&&e.preventDefault(),e.stopPropagation&&t.stopPropagation&&e.stopPropagation());var n={view:this,model:this.model,collection:this.collection};this.triggerMethod(i,n)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],n.rest(arguments)),e},_triggerEventOnBehaviors:function(e){for(var t=o._triggerMethod,n=this._behaviors,i=0,r=n&&n.length;r>i;i++)t(n[i],e)},_triggerEventOnParentLayout:function(e,t){var i=this._parentLayoutView();if(i){var r=o.getOption(i,"childViewEventPrefix"),a=r+":"+e,s=[this].concat(t);o._triggerMethod(i,a,s);var l=o.getOption(i,"childEvents");l=o._getValue(l,i);var c=i.normalizeMethods(l);c&&n.isFunction(c[e])&&c[e].apply(i,s)}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?n.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_parentLayoutView:function(){for(var e=this._parent;e;){if(e instanceof o.LayoutView)return e;e=e._parent}},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){if(!e)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),n=o.Renderer.render(e,t,this);return this.attachElContent(n),this}},attachElContent:function(e){return this.$el.html(e),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(e){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on({"before:show":this._onBeforeShowCalled,show:this._onShowCalled,"before:attach":this._onBeforeAttachCalled,attach:this._onAttachCalled}),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){var e,t=this._isShown&&o.isNodeAttached(this.el);this.isBuffering=!1,this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"before:show"),t&&this._triggerBeforeAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"before:attach")),this.attachBuffer(this,this._createBuffer()),t&&this._triggerAttach&&(e=this._getNestedViews(),this._triggerMethodMany(e,this,"attach")),this._isShown&&this._triggerMethodMany(this._bufferedChildren,this,"show"),this.initRenderBuffer()},_triggerMethodMany:function(e,t,i){var r=n.drop(arguments,3);n.each(e,function(e){o.triggerMethodOn.apply(e,[e,i,e,t].concat(r))})},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,i){var r=void 0!==i.at&&(i.index||t.indexOf(e));if((this.getOption("filter")||r===!1)&&(r=n.indexOf(this._filteredSortedModels(r),e)),this._shouldAddChild(e,r)){this.destroyEmptyView();var o=this.getChildView(e);this.addChild(e,o,r)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onBeforeShowCalled:function(){this._triggerBeforeAttach=this._triggerAttach=!1,this.children.each(function(e){o.triggerMethodOn(e,"before:show",e)})},_onShowCalled:function(){this.children.each(function(e){o.triggerMethodOn(e,"show",e)})},_onBeforeAttachCalled:function(){this._triggerBeforeAttach=!0},_onAttachCalled:function(){this._triggerAttach=!0},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels(),i=n.some(t,function(t){return!e.findByModel(t)});if(i)this.render();else{var r=n.map(t,function(t,n){var i=e.findByModel(t);return i._index=n,i.el}),o=e.filter(function(e){return!n.contains(r,e.el)});this.triggerMethod("before:reorder"),this._appendReorderedChildren(r),n.each(o,this.removeChildView,this),this.checkEmpty(),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=n.find(e,function(e,t){var n=this.children.findByModel(e);return!n||n._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren({checkEmpty:!1}),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.getOption("filter")&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();n.each(t,function(t,n){e=this.getChildView(t),this.addChild(t,e,n)},this)},_filteredSortedModels:function(e){var t=this.getViewComparator(),i=this.collection.models;if(e=Math.min(Math.max(e,0),i.length-1),t){var r;e&&(r=i[e],i=i.slice(0,e).concat(i.slice(e+1))),i=this._sortModelsBy(i,t),r&&i.splice(e,0,r)}return this.getOption("filter")&&(i=n.filter(i,function(e,t){return this._shouldAddChild(e,t)},this)),i},_sortModelsBy:function(e,t){return"string"==typeof t?n.sortBy(e,function(e){return e.get(t)},this):1===t.length?n.sortBy(e,t,this):e.sort(n.bind(t,this))},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new t.Model;this.addEmptyView(n,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var i,r=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el),a=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(a)&&(a=a.call(this,e,this._emptyViewIndex));var s=this.buildChildView(e,t,a);s._parent=this,this.proxyChildEvents(s),s.once("render",function(){this._isShown&&o.triggerMethodOn(s,"before:show",s),r&&this._triggerBeforeAttach&&(i=this._getViewAndNested(s),this._triggerMethodMany(i,this,"before:attach"))},this),this.children.add(s),this.renderChildView(s,this._emptyViewIndex),r&&this._triggerAttach&&(i=this._getViewAndNested(s),this._triggerMethodMany(i,this,"attach")),this._isShown&&o.triggerMethodOn(s,"show",s)},getChildView:function(e){var t=this.getOption("childView");if(!t)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return t},addChild:function(e,t,n){var i=this.getOption("childViewOptions");i=o._getValue(i,this,[e,n]);var r=this.buildChildView(e,t,i);return this._updateIndices(r,!0,n),this.triggerMethod("before:add:child",r),this._addChildView(r,n),this.triggerMethod("add:child",r),r._parent=this,r},_updateIndices:function(e,t,n){this.getOption("sort")&&(t&&(e._index=n),this.children.each(function(n){n._index>=e._index&&(n._index+=t?1:-1)}))},_addChildView:function(e,t){var n,i=this._isShown&&!this.isBuffering&&o.isNodeAttached(this.el);this.proxyChildEvents(e),e.once("render",function(){this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"before:show",e),i&&this._triggerBeforeAttach&&(n=this._getViewAndNested(e),this._triggerMethodMany(n,this,"before:attach"))},this),this.children.add(e),this.renderChildView(e,t),i&&this._triggerAttach&&(n=this._getViewAndNested(e),this._triggerMethodMany(n,this,"attach")),this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"show",e)},renderChildView:function(e,t){return e.supportsRenderLifecycle||o.triggerMethodOn(e,"before:render",e),e.render(),e.supportsRenderLifecycle||o.triggerMethodOn(e,"render",e),this.attachHtml(this,e,t),e},buildChildView:function(e,t,i){var r=n.extend({model:e},i),a=new t(r);return o.MonitorDOMRefresh(a),a},removeChildView:function(e){return e?(this.triggerMethod("before:remove:child",e),e.supportsDestroyLifecycle||o.triggerMethodOn(e,"before:destroy",e),e.destroy?e.destroy():e.remove(),e.supportsDestroyLifecycle||o.triggerMethodOn(e,"destroy",e),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1),e):e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e,t){e.$el.append(t)},_createBuffer:function(){var e=document.createDocumentFragment();return n.each(this._bufferedChildren,function(t){e.appendChild(t.el)}),e},attachHtml:function(e,t,n){e.isBuffering?e._bufferedChildren.splice(n,0,t):e._insertBefore(t,n)||e._insertAfter(t)},_insertBefore:function(e,t){var n,i=this.getOption("sort")&&t<this.children.length-1;return i&&(n=this.children.find(function(e){return e._index===t+1})),n?(n.$el.before(e.el),!0):!1},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren({checkEmpty:!1}),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(e){var t=e||{},i=!0,r=this.children.map(n.identity);return n.isUndefined(t.checkEmpty)||(i=t.checkEmpty),this.children.each(this.removeChildView,this),i&&this.checkEmpty(),r},_shouldAddChild:function(e,t){var i=this.getOption("filter");return!n.isFunction(i)||i.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var i=n.toArray(arguments),r=i[0],o=this.normalizeMethods(n.result(this,"childEvents"));i[0]=t+":"+r,i.splice(1,0,e),"undefined"!=typeof o&&n.isFunction(o[r])&&o[r].apply(this,i.slice(1)),this.triggerMethod.apply(this,i)})},_getImmediateChildren:function(){return n.values(this.children._views)},_getViewAndNested:function(e){return[e].concat(n.result(e,"_getNestedViews")||[])},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(e){var t=this.getOption("childView")||this.constructor;return t},serializeData:function(){var e={};return this.model&&(e=n.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),n=o.Renderer.render(t,e,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e,t){var n=this.getChildViewContainer(e);n.append(t)},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e,t){if(e.$childViewContainer)return e.$childViewContainer;var n,i=o.getOption(e,"childViewContainer");if(i){var r=o._getValue(i,e);if(n="@"===r.charAt(0)&&e.ui?e.ui[r.substr(4)]:e.$(r),n.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else n=e.$el;return e.$childViewContainer=n,n},resetChildViewContainer:function(){this.$childViewContainer&&(this.$childViewContainer=void 0)}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),o.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t,i){var r=this.getRegion(e);return r.show.apply(r,n.rest(arguments))},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"el")};return this.regionManager.addRegions(e,t);
},_initializeRegions:function(e){var t;this._initRegionManager(),t=o._getValue(this.regions,this,[e])||{};var i=this.getOption.call(e,"regions");i=o._getValue(i,this,[e]),n.extend(t,i),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(e,t){this.view=t,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,e),this.ui=n.extend({},n.result(t,"ui"),n.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),o.Behaviors=function(e,t){function n(e,i){return t.isObject(e.behaviors)?(i=n.parseBehaviors(e,i||t.result(e,"behaviors")),n.wrap(e,i,t.keys(a)),i):{}}function i(e,t){this._view=e,this._behaviors=t,this._triggers={}}function r(e){return e._uiBindings||e.ui}var o=/^(\S+)\s*(.*)$/,a={behaviorTriggers:function(e,t){var n=new i(this,t);return n.buildBehaviorTriggers()},behaviorEvents:function(n,i){var a={};return t.each(i,function(n,i){var s={},l=t.clone(t.result(n,"events"))||{};l=e.normalizeUIKeys(l,r(n));var c=0;t.each(l,function(e,r){var a=r.match(o),l=a[1]+"."+[this.cid,i,c++," "].join(""),u=a[2],d=l+u,h=t.isFunction(e)?e:n[e];s[d]=t.bind(h,n)},this),a=t.extend(a,s)},this),a}};return t.extend(n,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,i){return t.behaviorClass?t.behaviorClass:e._getValue(n.behaviorsLookup,this,[t,i])[i]},parseBehaviors:function(e,i){return t.chain(i).map(function(i,r){var o=n.getBehaviorClass(i,r),a=new o(i,e),s=n.parseBehaviors(e,t.result(a,"behaviors"));return[a].concat(s)}).flatten().value()},wrap:function(e,n,i){t.each(i,function(i){e[i]=t.partial(a[i],e[i],n)})}}),t.extend(i.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,i){var o=t.clone(t.result(n,"triggers"))||{};o=e.normalizeUIKeys(o,r(n)),t.each(o,t.bind(this._setHandlerForBehavior,this,n,i))},_setHandlerForBehavior:function(e,t,n,i){var r=i.replace(/^\S+/,function(e){return e+".behaviortriggers"+t});this._triggers[r]=this._view._buildViewTrigger(n)}}),n}(o,n),o.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var n=this.getOption("appRoutes"),i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},_processOnRoute:function(e,t){if(n.isFunction(this.onRoute)){var i=n.invert(this.getOption("appRoutes"))[e];this.onRoute(e,i,t)}},processAppRoutes:function(e,t){if(t){var i=n.keys(t).reverse();n.each(i,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,i){var r=e[i];if(!r)throw new o.Error('Method "'+i+'" was not found on the controller');this.route(t,i,n.bind(r,e))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new o.Callbacks,this.submodules={},n.extend(this,e),this._initChannel(),o.Object.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var i=o.Module.getClass(t),r=n.toArray(arguments);return r.unshift(this),i.create.apply(i,r)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(e){var t=n.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var i=o.getOption(e,"regions");return n.isFunction(i)&&(i=i.call(this,e)),n.extend(t,i),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),o.Module=function(e,t,i){this.moduleName=e,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,n.isFunction(this.initialize)&&this.initialize(e,t,this.options)},o.Module.extend=o.extend,n.extend(o.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var r=n.flatten([this,this.app,t,o,t.$,n,i]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),n.extend(o.Module,{create:function(e,t,i){var r=e,o=n.drop(arguments,3);t=t.split(".");var a=t.length,s=[];return s[a-1]=i,n.each(t,function(t,n){var a=r;r=this._getModule(a,t,e,i),this._addModuleDefinition(a,r,s[n],o)},this),r},_getModule:function(e,t,i,r,o){var a=n.extend({},r),s=this.getClass(r),l=e[t];return l||(l=new s(t,i,a),e[t]=l,e.submodules[t]=l),l},getClass:function(e){var t=o.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,n,i){var r=this._getDefine(n),o=this._getStartWithParent(n,t);r&&t.addDefinition(r,i),this._addStartWithParent(e,t,o)},_getStartWithParent:function(e,t){var i;return n.isFunction(e)&&e.prototype instanceof o.Module?(i=t.constructor.prototype.startWithParent,n.isUndefined(i)?!0:i):n.isObject(e)?(i=e.startWithParent,n.isUndefined(i)?!0:i):!0},_getDefine:function(e){return!n.isFunction(e)||e.prototype instanceof o.Module?n.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,n){t.startWithParent=t.startWithParent&&n,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),o})},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_50__},function(e,t,n){var i,r;!function(o,a){i=[n(48),n(50)],r=function(e,t){return a(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){"use strict";var n=e.Wreqr,i=e.Wreqr={};return e.Wreqr.VERSION="1.3.5",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){return t.callback.apply(t.context,arguments)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),i.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),i.Commands=function(e,t){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this),e.Handlers.prototype.constructor.apply(this,arguments)},execute:function(e){e=arguments[0];var n=t.rest(arguments);this.hasHandler(e)?this.getHandler(e).apply(this,n):this.storage.addCommand(e,n)},_executeCommands:function(e,n,i){var r=this.storage.getCommands(e);t.each(r.instances,function(e){n.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,i=e.storageType||this.storageType;n=t.isFunction(i)?new i:i,this.storage=n}})}(i,t),i.RequestResponse=function(e,t){return e.Handlers.extend({request:function(e){return this.hasHandler(e)?this.getHandler(e).apply(this,t.rest(arguments)):void 0}})}(i,t),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),i.Channel=function(n){var i=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(i.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,i){if(n){i=i||this;var r="vent"===e?"on":"setHandler";t.each(n,function(n,o){this[e][r](o,t.bind(n,i))},this)}}}),i}(i),i.radio=function(e,t){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(i[e],function(t){this[e][t]=r(this,e,t)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,n,i){return function(r){var o=e._getChannel(r)[n];return o[i].apply(o,t.rest(arguments))}};return new n}(i,t),e.Wreqr})},function(e,t,n){var i,r;!function(o,a){i=[n(48),n(50)],r=function(e,t){return a(e,t)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){"use strict";var n=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(e,t),e.ChildViewContainer.VERSION="0.1.10",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=n,this},e.ChildViewContainer})},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(46),n(47),n(55),n(59),n(54),n(60),n(61),n(62),n(65),n(69)],r=function(t,i,r,o,a,s,l,c,u,d,h,p){var f=t.map(["/labs*","/trade*","/contest/group/edit","/community/share/create"],function(e){return new RegExp(e,"img")}),m=function(e){var t;for(e.match("^/")||(e="/"+e),t=0;t<f.length;t++)if(e.match(f[t]))return!0;return!1},g=!1,v=r.AppRouter.extend({routes:{"":"index","*notFound":"notFound"},index:function(){this.navigate("/community/",{trigger:!0})},execute:function(){if(!window.MAINTAIN)return void r.AppRouter.prototype.execute.apply(this,arguments);var e=i.history.fragment,n=!1;t.each(window.MAINTAIN,function(t,i){n||e.split("/")[0]!==i||(n=!0,a.vent.trigger("nav:focus",i),a.Layout.main.show(new h({text:t})))}),n||r.AppRouter.prototype.execute.apply(this,arguments)},notFound:function(){a.Layout.main.show(new p)},onRoute:function(){var e;g?g=!1:(e=location.pathname,m(e)&&o.loginWithRedirect({loginUrl:window.getAppRoot()+"/login.html?RelayState="}))}});return a.addInitializer(function(){a.Route=new v;var r=[s,l,c,u,d];t.each(r,function(i){t.each(i.controller,function(r,o){i.controller[o]=t.wrap(r,function(r){var o=t.rest(arguments);!function(){(function(e){var t=[n(71)("./"+i.name)];(function(e){o=[e].concat(o),r.apply(window,o)}).apply(null,t)}).call(this,n(70)(e))}()})})}),t.each(r,function(e){a.Route.processAppRoutes(e.controller,e.route)}),a.body.on("click","a[data-href]",function(e){var t=$(e.currentTarget).attr("data-href"),n=function(){t===i.history.fragment?i.history.loadUrl(i.history.fragment):a.Route.navigate(t,{trigger:!0})},r=function(){a.Route.blockRoute?a.Route.blockRoute(function(){n()}):n()};g=!0,m(t)?o.loginWithModal({appRoot:window.getAppRoot()}).done(function(){r()}):r(),e.preventDefault()})}),v}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47)],r=function(e){return{name:"trade",route:{"trade(/)":"tradeIndex","trade/strategies(/)":"tradeStrategyList","trade/strategy/:id(/:tab)":"tradeStrategyDetail","trade/fundstrategy/:id(/:tab)":"tradeFundStrategyDetail"},controller:{tradeIndex:function(){e.Route.navigate("trade/strategies/",{trigger:!0})},tradeStrategyList:function(t){var n=e.Layout.ensureLayout("trade",t.Layout);n.main.show(new t.HomeView),e.vent.trigger("nav:focus","trade")},tradeStrategyDetail:function(t,n,i){var r=e.Layout.ensureLayout("trade",t.Layout);r.main.show(new t.DetailView({id:n,tab:i})),e.vent.trigger("nav:focus","trade")},tradeFundStrategyDetail:function(t,n,i){var r=e.Layout.ensureLayout("trade",t.Layout);r.main.show(new t.FundDetailView({id:n,tab:i})),e.vent.trigger("nav:focus","trade")}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(56),n(57),n(58)],r=function(e,t,n,i,r,o){return{name:"labs",route:e.extend({"labs(/)":"labsIndex","labs/library/:name":"libraryDetail"},i.route,r.route,o.route),controller:e.extend({labsIndex:function(e){var t=n.Layout.ensureLayout("labs",e.Layout);t.main.show(new e.Welcome),n.vent.trigger("mainNav:reset"),n.vent.trigger("menu:hide"),n.vent.trigger("toolbar:reset",{}),n.vent.trigger("title:reset",{title:"",edit:!1}),n.vent.trigger("title:hide"),n.vent.trigger("nav:focus","labs")}},i.controller,r.controller,o.controller)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47)],r=function(e,t,n){return{route:{"labs/notebooks/:name":"loadNotebook"},controller:{loadNotebook:function(e,t){var i=n.Layout.ensureLayout("labs",e.Layout);n.vent.trigger("menu:show"),i.checkFinish?i.main.show(new e.NotebookDetailView({name:t})):i.on("checkFinish",function(){i.main.show(new e.NotebookDetailView({name:t}))}),n.vent.trigger("mainNav:focus","notebook"),n.vent.trigger("nav:focus","labs")}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47)],r=function(e,t,n){return{route:{"labs/datas/:name":"loadData"},controller:{loadData:function(t,n){var i=e.Layout.ensureLayout("labs",t.Layout);e.vent.trigger("menu:hide"),e.vent.trigger("toolbar:reset",{}),i.checkFinish?i.main.show(new t.DataDetailView({name:n})):i.on("checkFinish",function(){i.main.show(new t.DataDetailView({name:n}))}),e.vent.trigger("mainNav:focus","data"),e.vent.trigger("nav:focus","labs")}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47)],r=function(e){return{route:{"labs/library/:name":"libraryDetail"},controller:{libraryDetail:function(t,n){var i=e.Layout.ensureLayout("labs",t.Layout);e.vent.trigger("menu:hide"),e.vent.trigger("toolbar:reset",{}),i.checkFinish?i.main.show(new t.LibraryDetailView({name:n})):i.on("checkFinish",function(){i.main.show(new t.LibraryDetailView({name:n}))}),e.vent.trigger("mainNav:focus","library"),e.vent.trigger("nav:focus","labs")}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47)],r=function(e){return{name:"community",route:{"community(/)":"communityIndex","community/search/:keyword":"communitySearch","community/share/create":"communityShareCreate","community/share/:id":"communityShareDetail","community/user/:id/shares":"communityUserDetail","community/mall":"communityMall","community/exchange":"communityMallExchange","community/exchangeDetail/:id":"communityExchangeDetail","community/share/edit/:id":"communityShareEdit","community/email/:id":"communityEmailView"},controller:{communityIndex:function(t){var n=e.Layout.ensureLayout("community",t.Layout);n.main.show(new t.HomeView),e.vent.trigger("nav:focus","community")},communitySearch:function(t,n){var i=e.Layout.ensureLayout("community",t.Layout);i.main.show(new t.SearchView({keyword:n})),e.vent.trigger("nav:focus","community")},communityShareDetail:function(t,n){var i=e.Layout.ensureLayout("community",t.Layout);i.main.show(new t.ShareDetailView({id:n})),e.vent.trigger("nav:focus","community")},communityShareCreate:function(t){var n=e.Layout.ensureLayout("community",t.Layout);n.main.show(new t.ShareCreateView),e.vent.trigger("nav:focus","community")},communityUserDetail:function(t,n){var i=e.Layout.ensureLayout("community",t.Layout);i.main.show(new t.UserDetailView({id:n})),e.vent.trigger("nav:focus","community")},communityMall:function(t){var n=e.Layout.ensureLayout("community",t.Layout);n.main.show(new t.MallView({tab:"mall"})),e.vent.trigger("nav:focus","community")},communityMallExchange:function(t){var n=e.Layout.ensureLayout("community",t.Layout);n.main.show(new t.MallView({tab:"exchange"})),e.vent.trigger("nav:focus","community")},communityExchangeDetail:function(t,n){var i=e.Layout.ensureLayout("community",t.Layout);i.main.show(new t.ExchangeDetailView({id:n})),e.vent.trigger("nav:focus","community")},communityShareEdit:function(t,n){var i=e.Layout.ensureLayout("community",t.Layout);i.main.show(new t.ShareEditView({id:n})),e.vent.trigger("nav:focus","community")},communityEmailView:function(t,n,i){var r=e.Layout.ensureLayout("community",t.Layout),o={};o.id=n,o.type=i.op_type,o.subscribe=i.subscribe_type,o.thread_id=i.thread_id||void 0,o.title=i.title||void 0,o.followee_id=i.followee_id||void 0,o.nickname=i.nickname||void 0,r.main.show(new t.EmailView(o)),e.vent.trigger("nav:focus","community")}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47)],r=function(e){return{name:"help",route:{"help(/)":"helpIndex","help/faq(/)":"faqIndex","help/changelog(/)":"changelogIndex","help/api":"apiIndexRedirect","help/api/*more":"apiMoreRedirect","data(/)":"apiIndex","data/browse(/)":"apiBrowseIndex","data/browse/:category/:sub(/)":"apiBrowse","data/search/:keyword":"apiSearch"},controller:{helpIndex:function(){e.Route.navigate("help/faq/",{trigger:!0})},faqIndex:function(t){var n=e.Layout.ensureLayout("help",t.Layout);n.main.show(new t.FaqView),e.vent.trigger("nav:focus","help")},changelogIndex:function(t){var n=e.Layout.ensureLayout("help",t.Layout);n.main.show(new t.ChangelogView),e.vent.trigger("nav:focus","help")},apiIndex:function(){e.Route.navigate("data/browse/",{trigger:!0})},apiBrowseIndex:function(){e.Route.navigate("data/browse/datayes/master/",{trigger:!0})},apiBrowse:function(t,n,i,r){var o=e.Layout.ensureLayout("help",t.Layout),a=new t.APILayout,s={};s.category=n||void 0,s.sub=i||void 0,s.page=r?r.page:1,o.main.show(a),a.main.show(new t.BrowseView(s)),e.vent.trigger("nav:focus","data")},apiSearch:function(t,n,i){var r=e.Layout.ensureLayout("help",t.Layout),o=new t.APILayout({keyword:n}),a={keyword:n};i&&(a.category=i.category||void 0,a.sub=i.sub||void 0,a.page=i.page||void 0),r.main.show(o),o.main.show(new t.SearchView(a)),e.vent.trigger("nav:focus","data")},apiIndexRedirect:function(){e.Route.navigate("data/",{trigger:!0})},apiMoreRedirect:function(t,n){e.Route.navigate("data/"+n,{trigger:!0})}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47)],r=function(e,t){return{name:"contest",route:{"contest(/)":"contestIndex","contest/home(/)":"contestHome","contest/rank(/)":"contestRank","contest/history(/)":"contestHistory","contest/guide(/)":"contestGuide","contest/rankPK(/)":"contestRankPK","contest/newbie(/)":"contestRankPK"},controller:{contestIndex:function(t){e.Route.navigate("contest/home/",{trigger:!0,replace:!0})},contestHome:function(t){var n=e.Layout.ensureLayout("contest",t.Layout);n.main.show(new t.HomeView),n.focusTab("home"),e.vent.trigger("nav:focus","contest")},contestRank:function(t){var n=e.Layout.ensureLayout("contest",t.Layout);n.main.show(new t.RankView),n.focusTab("rank"),e.vent.trigger("nav:focus","contest")},contestHistory:function(t){var n=e.Layout.ensureLayout("contest",t.Layout);n.main.show(new t.HistoryView),n.focusTab("history"),e.vent.trigger("nav:focus","contest")},contestGuide:function(t){var n=e.Layout.ensureLayout("contest",t.Layout);n.main.show(new t.GuideView),e.vent.trigger("nav:focus","contest")},contestRankPK:function(t){var n=e.Layout.ensureLayout("contest",t.Layout);n.main.show(new t.RankPKView),n.focusTab("rankPK"),e.vent.trigger("nav:focus","contest")}}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=i(r),a=n(64),s=i(a);t["default"]=o["default"].ItemView.extend({className:"maintain",template:s["default"],initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{text:"维护中"}:arguments[0];this.model=new Backbone.Model({text:e.text})}}),e.exports=t["default"]},function(e,t){"use strict";t["default"]=function(e){return e&&e.__esModule?e:{"default":e}},t.__esModule=!0},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="maintain-text">'+(null==(__t=text)?"":__t)+"</div>\n";return __p}},function(e,t,n){var i,r;i=[n(49),n(66),n(68)],r=function(e,t,n){return e.ItemView.extend({className:"page-404",template:n,onRender:function(){t(this.el)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(67),n(47)],r=function(e,t){return function(n){new e({appendTo:n,appName:t.name,appVersion:t.version,links:!1})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_67__},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="page-404-inner">\n    <h4>抱歉，您要查看的页面不存在或已被删除。</h4>\n    <h5>您可能对如下内容感兴趣：</h5>\n    <ul>\n        <li>返回通联量化实验室<a href="/home">首页</a>；</li>\n        <li>参加量化投资策略<a href="contest/" data-href="contest/">大赛</a>；</li>\n        <li>浏览<a href="community/" data-href="community/">社区</a>，发现高质量开源策略；</li>\n        <li>进入<a href="labs/" data-href="labs/">开始研究</a>，用海量金融大数据进行量化投资研究；</li>\n        <li>查看<a href="help/" data-href="help/">帮助</a>。</li>\n    </ul>\n\n    如果您认为该信息错误，请尝试清除浏览器缓存或联系我们 <a href="mailto:mercury@datayes.com">mercury@datayes.com</a>\n</div>\n';return __p}},function(e,t,n){var i,r;!function(o,a){i=[n(50),n(48)],r=function(e,t){return a(e||o._,t||o.Backbone)}.apply(t,i),!(void 0!==r&&(e.exports=r))}(this,function(e,t){function n(i,r){function o(e){return String(e).replace(a,encodeURIComponent(a))}var a=t.Router.arrayValueSplit;if(!i)return"";r=r||"";var s=[];return e.each(i,function(t,i){if(i=r+i,e.isString(t)||e.isNumber(t)||e.isBoolean(t)||e.isDate(t))null!=t&&s.push(i+"="+o(encodeURIComponent(t)));else if(e.isArray(t)){for(var l="",c=0;c<t.length;c++){var u=t[c];null!=u&&(l+=a+o(u))}l&&s.push(i+"="+l)}else{var d=n(t,i+".");d&&s.push(d)}}),s.join("&")}function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}function r(t,n){var i=t.split("&");e.each(i,function(e){var t=e.split("=");n(t.shift(),t.join("="))})}var o=/^\?(.*)/,a=/\((.*?)\)/g,s=/(\(\?)?:\w+/g,l=/\*\w+/g,c=/[\-{}\[\]+?.,\\\^$|#\s]/g,u=/^([^\?]*)/,d=/[\:\*]([^\:\?\/]+)/g,h=/^[#\/]|\s+$/g,p=/\/$/;t.Router.arrayValueSplit="|",e.extend(t.History.prototype,{getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(p,""),i=this.location.search;e.indexOf(n)||(e=e.substr(n.length)),i&&this._hasPushState&&(e+=i)}else e=this.getHash();return e.replace(h,"")},getQueryParameters:function(t,n){t=this.getFragment(t,n);var a=t.replace(u,""),s=a.match(o);if(s){a=s[1];var l={};return r(a,function(t,n){n=i(n),l[t]?e.isString(l[t])?l[t]=[l[t],n]:l[t].push(n):l[t]=n}),l}return{}}}),e.extend(t.Router.prototype,{initialize:function(e){this.encodedSplatParts=e&&e.encodedSplatParts},_routeToRegExp:function(t){var n=l.exec(t)||{index:-1},i=s.exec(t)||{index:-1},r=t.match(d)||[];t=t.replace(c,"\\$&").replace(a,"(?:$1)?").replace(s,function(e,t){return t?e:"([^\\/\\?]+)"}).replace(l,"([^??]*?)"),t+="(\\?.*)?";var o=new RegExp("^"+t+"$");return n.index>=0&&(i>=0?o.splatMatch=n.index-i.index:o.splatMatch=-1),o.paramNames=e.map(r,function(e){return e.replace(/\)$/,"").substring(1)}),o.namedParameters=this.namedParameters,o},_extractParameters:function(n,a){var s=n.exec(a).slice(1),l={};s.length>0&&!s[s.length-1]&&s.splice(s.length-1,1);var c=s.length&&s[s.length-1]&&s[s.length-1].match(o);if(c){var u=c[1],d={};if(u){var h=this;r(u,function(e,t){h._setParamValue(e,t,d)})}s[s.length-1]=d,e.extend(l,d)}var p=s.length;if(n.splatMatch&&this.encodedSplatParts){if(n.splatMatch<0)return s;p-=1}for(var f=0;p>f;f++)e.isString(s[f])&&(s[f]=i(s[f]),n.paramNames&&n.paramNames.length>=f-1&&(l[n.paramNames[f]]=s[f]));return t.Router.namedParameters||n.namedParameters?[l]:s},_setParamValue:function(e,t,n){e=e.replace("[]",""),e=e.replace("%5B%5D","");for(var i=e.split("."),r=n,o=0;o<i.length;o++){var a=i[o];o===i.length-1?r[a]=this._decodeParamValue(t,r[a]):r=r[a]=r[a]||{}}},_decodeParamValue:function(n,r){var o=t.Router.arrayValueSplit;if(o&&n.indexOf(o)>=0){for(var a=n.split(o),s=a.length-1;s>=0;s--)a[s]?a[s]=i(a[s]):a.splice(s,1);return a}return n=i(n),r?e.isArray(r)?(r.push(n),r):[r,n]:n},toFragment:function(t,i){return i&&(e.isString(i)||(i=n(i)),i&&(t+="?"+i)),t}})})},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t,n){function i(e){return n(r(e))}function r(e){return o[e]||function(){throw new Error("Cannot find module '"+e+"'.")}()}var o={"./community":72,"./community.js":72,"./contest":214,"./contest.js":214,"./help":233,"./help.js":233,"./labs":266,"./labs.js":266,"./module/community/adv/adv":141,"./module/community/adv/adv.js":141,"./module/community/adv/advs":140,"./module/community/adv/advs.js":140,"./module/community/adv/itemView":143,"./module/community/adv/itemView.js":143,"./module/community/adv/itemView.tpl":144,"./module/community/adv/listView":142,"./module/community/adv/listView.js":142,"./module/community/cell/itemView":185,"./module/community/cell/itemView.js":185,"./module/community/cell/itemView.tpl":186,"./module/community/cell/listView":159,"./module/community/cell/listView.js":159,"./module/community/comment/comment":196,"./module/community/comment/comment.js":196,"./module/community/comment/comments":195,"./module/community/comment/comments.js":195,"./module/community/comment/itemView":198,"./module/community/comment/itemView.js":198,"./module/community/comment/itemView.tpl":199,"./module/community/comment/listView":197,"./module/community/comment/listView.js":197,"./module/community/emailView":207,"./module/community/emailView.js":207,"./module/community/emailView.tpl":208,"./module/community/filterView":138,"./module/community/filterView.js":138,"./module/community/filterView.tpl":139,"./module/community/follow/follow":111,"./module/community/follow/follow.js":111,"./module/community/follow/follows":110,"./module/community/follow/follows.js":110,"./module/community/follow/itemView":113,"./module/community/follow/itemView.js":113,"./module/community/follow/itemView.tpl":114,"./module/community/follow/listView":112,"./module/community/follow/listView.js":112,"./module/community/home":124,"./module/community/home.js":124,"./module/community/home.tpl":125,"./module/community/honors/honor":118,"./module/community/honors/honor.js":118,"./module/community/honors/honors":117,"./module/community/honors/honors.js":117,"./module/community/honors/itemView":120,"./module/community/honors/itemView.js":120,"./module/community/honors/itemView.tpl":121,"./module/community/honors/listView":119,"./module/community/honors/listView.js":119,"./module/community/layout":122,"./module/community/layout.js":122,
"./module/community/layout.tpl":150,"./module/community/mall/detailView":210,"./module/community/mall/detailView.js":210,"./module/community/mall/detailView.tpl":211,"./module/community/mall/exchangeDetailView":203,"./module/community/mall/exchangeDetailView.js":203,"./module/community/mall/exchangeDetailView.tpl":204,"./module/community/mall/mallView":209,"./module/community/mall/mallView.js":209,"./module/community/mall/productView.tpl":212,"./module/community/mall/recordView.tpl":213,"./module/community/profile/editView":129,"./module/community/profile/editView.js":129,"./module/community/profile/editView.tpl":130,"./module/community/profile/editViewForm.tpl":131,"./module/community/profile/profile":567,"./module/community/profile/profile.js":567,"./module/community/route":59,"./module/community/route.js":59,"./module/community/search":151,"./module/community/search.js":151,"./module/community/search.tpl":152,"./module/community/searchInput":126,"./module/community/searchInput.js":126,"./module/community/share/createView":201,"./module/community/share/createView.js":201,"./module/community/share/createView.tpl":202,"./module/community/share/createViewMini":552,"./module/community/share/createViewMini.js":552,"./module/community/share/createViewMini.tpl":553,"./module/community/share/detailView":153,"./module/community/share/detailView.js":153,"./module/community/share/detailView.tpl":200,"./module/community/share/editView":205,"./module/community/share/editView.js":205,"./module/community/share/editView.tpl":206,"./module/community/share/emptyView":105,"./module/community/share/emptyView.js":105,"./module/community/share/itemView":135,"./module/community/share/itemView.js":135,"./module/community/share/itemView.tpl":136,"./module/community/share/listView":134,"./module/community/share/listView.js":134,"./module/community/share/listView.tpl":137,"./module/community/share/share":133,"./module/community/share/share.js":133,"./module/community/share/shares":132,"./module/community/share/shares.js":132,"./module/community/thread/itemView":108,"./module/community/thread/itemView.js":108,"./module/community/thread/itemView.tpl":109,"./module/community/thread/listView":107,"./module/community/thread/listView.js":107,"./module/community/thread/thread":75,"./module/community/thread/thread.js":75,"./module/community/thread/threads":74,"./module/community/thread/threads.js":74,"./module/community/user/detailView":73,"./module/community/user/detailView.js":73,"./module/community/user/detailView.tpl":106,"./module/community/user/info":80,"./module/community/user/info.js":80,"./module/community/user/infos":79,"./module/community/user/infos.js":79,"./module/community/user/user":103,"./module/community/user/user.js":103,"./module/community/user/userItemView":83,"./module/community/user/userItemView.js":83,"./module/community/user/userItemView.tpl":104,"./module/community/user/userListView":81,"./module/community/user/userListView.js":81,"./module/contest/guideView":229,"./module/contest/guideView.js":229,"./module/contest/guideView.tpl":230,"./module/contest/historyView":223,"./module/contest/historyView.js":223,"./module/contest/historyView.tpl":228,"./module/contest/homeView":217,"./module/contest/homeView.js":217,"./module/contest/homeView.tpl":218,"./module/contest/layout":215,"./module/contest/layout.js":215,"./module/contest/layout.tpl":216,"./module/contest/rankPKView":231,"./module/contest/rankPKView.js":231,"./module/contest/rankPKView.tpl":232,"./module/contest/rankTableAll.tpl":222,"./module/contest/rankTableMine.tpl":221,"./module/contest/rankView":219,"./module/contest/rankView.js":219,"./module/contest/rankView.tpl":220,"./module/contest/route":61,"./module/contest/route.js":61,"./module/contest/season":225,"./module/contest/season.js":225,"./module/contest/seasonItem":226,"./module/contest/seasonItem.js":226,"./module/contest/seasonItem.tpl":227,"./module/contest/seasons":224,"./module/contest/seasons.js":224,"./module/help/api/api":248,"./module/help/api/api.js":248,"./module/help/api/apis":247,"./module/help/api/apis.js":247,"./module/help/api/browseView":246,"./module/help/api/browseView.js":246,"./module/help/api/browseView.tpl":262,"./module/help/api/category/categories":254,"./module/help/api/category/categories.js":254,"./module/help/api/category/category":255,"./module/help/api/category/category.js":255,"./module/help/api/category/itemView":256,"./module/help/api/category/itemView.js":256,"./module/help/api/category/itemView.tpl":261,"./module/help/api/category/listView":253,"./module/help/api/category/listView.js":253,"./module/help/api/category/subCategories":259,"./module/help/api/category/subCategories.js":259,"./module/help/api/category/subCategory":260,"./module/help/api/category/subCategory.js":260,"./module/help/api/category/subItemView":257,"./module/help/api/category/subItemView.js":257,"./module/help/api/category/subItemView.tpl":258,"./module/help/api/itemView":250,"./module/help/api/itemView.js":250,"./module/help/api/itemView.tpl":251,"./module/help/api/layout":242,"./module/help/api/layout.js":242,"./module/help/api/layout.tpl":244,"./module/help/api/listView":249,"./module/help/api/listView.js":249,"./module/help/api/listView.tpl":252,"./module/help/api/provider.tpl":263,"./module/help/api/searchInput":243,"./module/help/api/searchInput.js":243,"./module/help/api/searchView":264,"./module/help/api/searchView.js":264,"./module/help/api/searchView.tpl":265,"./module/help/changelog.md":241,"./module/help/changelog.tpl":240,"./module/help/changelogView":239,"./module/help/changelogView.js":239,"./module/help/faq.md":238,"./module/help/faqView":236,"./module/help/faqView.js":236,"./module/help/faqView.tpl":237,"./module/help/guide/boot":271,"./module/help/guide/boot.js":271,"./module/help/guide/guide":272,"./module/help/guide/guide.js":272,"./module/help/guide/guideV1":276,"./module/help/guide/guideV1.js":276,"./module/help/guide/layer":273,"./module/help/guide/layer.js":273,"./module/help/guide/popover":274,"./module/help/guide/popover.js":274,"./module/help/guide/popover.tpl":275,"./module/help/layout":234,"./module/help/layout.js":234,"./module/help/layout.tpl":235,"./module/help/route":60,"./module/help/route.js":60,"./module/labs/belt/boot":385,"./module/labs/belt/boot.js":385,"./module/labs/belt/flexo":389,"./module/labs/belt/flexo.js":389,"./module/labs/belt/flexo.tpl":397,"./module/labs/belt/flexo/log":390,"./module/labs/belt/flexo/log.js":390,"./module/labs/belt/flexo/log.tpl":391,"./module/labs/belt/flexo/manual":392,"./module/labs/belt/flexo/manual.js":392,"./module/labs/belt/flexo/manual.tpl":393,"./module/labs/belt/flexo/monitor":394,"./module/labs/belt/flexo/monitor.js":394,"./module/labs/belt/flexo/monitor.tpl":396,"./module/labs/belt/layout":386,"./module/labs/belt/layout.js":386,"./module/labs/belt/layout.tpl":398,"./module/labs/belt/status":387,"./module/labs/belt/status.js":387,"./module/labs/belt/status.tpl":388,"./module/labs/data/boot":380,"./module/labs/data/boot.js":380,"./module/labs/data/data":287,"./module/labs/data/data.js":287,"./module/labs/data/datas":381,"./module/labs/data/datas.js":381,"./module/labs/data/detailView":565,"./module/labs/data/detailView.js":565,"./module/labs/data/itemView.tpl":288,"./module/labs/data/listView":278,"./module/labs/data/listView.js":278,"./module/labs/data/route":57,"./module/labs/data/route.js":57,"./module/labs/layout":267,"./module/labs/layout.js":267,"./module/labs/layout.tpl":399,"./module/labs/library/boot":383,"./module/labs/library/boot.js":383,"./module/labs/library/detailView":566,"./module/labs/library/detailView.js":566,"./module/labs/library/itemView.tpl":293,"./module/labs/library/libraries":384,"./module/labs/library/libraries.js":384,"./module/labs/library/library":292,"./module/labs/library/library.js":292,"./module/labs/library/listView":291,"./module/labs/library/listView.js":291,"./module/labs/library/route":58,"./module/labs/library/route.js":58,"./module/labs/menu/boot":382,"./module/labs/menu/boot.js":382,"./module/labs/menu/dropdown.tpl":376,"./module/labs/menu/layout":373,"./module/labs/menu/layout.js":373,"./module/labs/menu/layout.tpl":374,"./module/labs/menu/menu":375,"./module/labs/menu/menu.js":375,"./module/labs/notebook/boot":268,"./module/labs/notebook/boot.js":268,"./module/labs/notebook/cell/addCellBtn.tpl":549,"./module/labs/notebook/cell/cell":424,"./module/labs/notebook/cell/cell.js":424,"./module/labs/notebook/cell/cells":431,"./module/labs/notebook/cell/cells.js":431,"./module/labs/notebook/cell/codeController":436,"./module/labs/notebook/cell/codeController.js":436,"./module/labs/notebook/cell/controllers":434,"./module/labs/notebook/cell/controllers.js":434,"./module/labs/notebook/cell/handle":544,"./module/labs/notebook/cell/handle.js":544,"./module/labs/notebook/cell/handle.tpl":547,"./module/labs/notebook/cell/itemView":433,"./module/labs/notebook/cell/itemView.js":433,"./module/labs/notebook/cell/itemView.tpl":548,"./module/labs/notebook/cell/listView":432,"./module/labs/notebook/cell/listView.js":432,"./module/labs/notebook/cell/mdController":435,"./module/labs/notebook/cell/mdController.js":435,"./module/labs/notebook/cell/showhint":439,"./module/labs/notebook/cell/showhint.js":439,"./module/labs/notebook/cell/startContest":448,"./module/labs/notebook/cell/startContest.js":448,"./module/labs/notebook/cell/startContest.tpl":449,"./module/labs/notebook/cell/startContestBtn.tpl":447,"./module/labs/notebook/cell/startTradeView":441,"./module/labs/notebook/cell/startTradeView.js":441,"./module/labs/notebook/cell/startTradeView.tpl":445,"./module/labs/notebook/cell/strategyCodeTpl.txt":446,"./module/labs/notebook/cell/strategyController":440,"./module/labs/notebook/cell/strategyController.js":440,"./module/labs/notebook/cell/typeSwitcher":545,"./module/labs/notebook/cell/typeSwitcher.js":545,"./module/labs/notebook/cell/typeSwitcher.tpl":546,"./module/labs/notebook/detailView":426,"./module/labs/notebook/detailView.js":426,"./module/labs/notebook/detailViewTpl.tpl":564,"./module/labs/notebook/itemView.tpl":290,"./module/labs/notebook/kernel/kernel":430,"./module/labs/notebook/kernel/kernel.js":430,"./module/labs/notebook/keyConfig":563,"./module/labs/notebook/keyConfig.js":563,"./module/labs/notebook/listView":289,"./module/labs/notebook/listView.js":289,"./module/labs/notebook/menuConfig":557,"./module/labs/notebook/menuConfig.js":557,"./module/labs/notebook/menuController":555,"./module/labs/notebook/menuController.js":555,"./module/labs/notebook/notebook":157,"./module/labs/notebook/notebook.js":157,"./module/labs/notebook/notebooks":269,"./module/labs/notebook/notebooks.js":269,"./module/labs/notebook/publishLibrary":558,"./module/labs/notebook/publishLibrary.js":558,"./module/labs/notebook/publishLibrary.tpl":560,"./module/labs/notebook/publishLibraryNamingError.tpl":561,"./module/labs/notebook/route":56,"./module/labs/notebook/route.js":56,"./module/labs/notebook/sBuilder/builders/builders":402,"./module/labs/notebook/sBuilder/builders/builders.js":402,"./module/labs/notebook/sBuilder/builders/topic/completeCode.tpl":421,"./module/labs/notebook/sBuilder/builders/topic/config":403,"./module/labs/notebook/sBuilder/builders/topic/config.js":403,"./module/labs/notebook/sBuilder/builders/topic/preview":404,"./module/labs/notebook/sBuilder/builders/topic/preview.js":404,"./module/labs/notebook/sBuilder/builders/topic/preview.tpl":405,"./module/labs/notebook/sBuilder/builders/topic/step1":406,"./module/labs/notebook/sBuilder/builders/topic/step1.js":406,"./module/labs/notebook/sBuilder/builders/topic/step1.tpl":407,"./module/labs/notebook/sBuilder/builders/topic/step1Code.tpl":408,"./module/labs/notebook/sBuilder/builders/topic/step2":411,"./module/labs/notebook/sBuilder/builders/topic/step2.js":411,"./module/labs/notebook/sBuilder/builders/topic/step2.tpl":419,"./module/labs/notebook/sBuilder/builders/topic/step2Code.tpl":420,"./module/labs/notebook/sBuilder/builders/topic/stock":418,"./module/labs/notebook/sBuilder/builders/topic/stock.js":418,"./module/labs/notebook/sBuilder/builders/topic/stockItem":413,"./module/labs/notebook/sBuilder/builders/topic/stockItem.js":413,"./module/labs/notebook/sBuilder/builders/topic/stockItem.tpl":414,"./module/labs/notebook/sBuilder/builders/topic/stockList":412,"./module/labs/notebook/sBuilder/builders/topic/stockList.js":412,"./module/labs/notebook/sBuilder/builders/topic/stocks":417,"./module/labs/notebook/sBuilder/builders/topic/stocks.js":417,"./module/labs/notebook/sBuilder/builders/topic/topicSelectItem.tpl":422,"./module/labs/notebook/sBuilder/wizard":401,"./module/labs/notebook/sBuilder/wizard.js":401,"./module/labs/notebook/sBuilder/wizard.tpl":423,"./module/labs/notebook/share":550,"./module/labs/notebook/share.js":550,"./module/labs/notebook/share.tpl":554,"./module/labs/notebook/strategyDetail/cellDetail":451,"./module/labs/notebook/strategyDetail/cellDetail.js":451,"./module/labs/notebook/strategyDetail/detailView":450,"./module/labs/notebook/strategyDetail/detailView.js":450,"./module/labs/notebook/strategyDetail/detailView.tpl":452,"./module/labs/notebook/strategyDetail/details/filters/base":472,"./module/labs/notebook/strategyDetail/details/filters/base.js":472,"./module/labs/notebook/strategyDetail/details/filters/checkbox":473,"./module/labs/notebook/strategyDetail/details/filters/checkbox.js":473,"./module/labs/notebook/strategyDetail/details/filters/dateRange":513,"./module/labs/notebook/strategyDetail/details/filters/dateRange.js":513,"./module/labs/notebook/strategyDetail/details/filters/index":467,"./module/labs/notebook/strategyDetail/details/filters/index.js":467,"./module/labs/notebook/strategyDetail/details/filters/range":474,"./module/labs/notebook/strategyDetail/details/filters/range.js":474,"./module/labs/notebook/strategyDetail/details/filters/select":468,"./module/labs/notebook/strategyDetail/details/filters/select.js":468,"./module/labs/notebook/strategyDetail/details/gridDownloadBehavior":529,"./module/labs/notebook/strategyDetail/details/gridDownloadBehavior.js":529,"./module/labs/notebook/strategyDetail/details/gridFilter.tpl":568,"./module/labs/notebook/strategyDetail/details/gridFilterBehavior":466,"./module/labs/notebook/strategyDetail/details/gridFilterBehavior.js":466,"./module/labs/notebook/strategyDetail/details/gridSortBehavior":528,"./module/labs/notebook/strategyDetail/details/gridSortBehavior.js":528,"./module/labs/notebook/strategyDetail/details/index":453,"./module/labs/notebook/strategyDetail/details/index.js":453,"./module/labs/notebook/strategyDetail/details/indicatorBase":542,"./module/labs/notebook/strategyDetail/details/indicatorBase.js":542,"./module/labs/notebook/strategyDetail/details/indicatorTable.tpl":543,"./module/labs/notebook/strategyDetail/details/log":455,"./module/labs/notebook/strategyDetail/details/log.js":455,"./module/labs/notebook/strategyDetail/details/log.tpl":456,"./module/labs/notebook/strategyDetail/details/order":533,"./module/labs/notebook/strategyDetail/details/order.js":533,"./module/labs/notebook/strategyDetail/details/order.tpl":534,"./module/labs/notebook/strategyDetail/details/orderColumn":536,"./module/labs/notebook/strategyDetail/details/orderColumn.js":536,"./module/labs/notebook/strategyDetail/details/orderColumnPlain":538,"./module/labs/notebook/strategyDetail/details/orderColumnPlain.js":538,"./module/labs/notebook/strategyDetail/details/orderGroupTitle.tpl":535,"./module/labs/notebook/strategyDetail/details/orderState":537,"./module/labs/notebook/strategyDetail/details/orderState.js":537,"./module/labs/notebook/strategyDetail/details/overview":454,"./module/labs/notebook/strategyDetail/details/overview.js":454,"./module/labs/notebook/strategyDetail/details/popoverBugFix":527,"./module/labs/notebook/strategyDetail/details/popoverBugFix.js":527,"./module/labs/notebook/strategyDetail/details/position":457,"./module/labs/notebook/strategyDetail/details/position.js":457,"./module/labs/notebook/strategyDetail/details/position.tpl":532,"./module/labs/notebook/strategyDetail/details/positionColumn":530,"./module/labs/notebook/strategyDetail/details/positionColumn.js":530,"./module/labs/notebook/strategyDetail/details/positionColumnPlain":531,"./module/labs/notebook/strategyDetail/details/positionColumnPlain.js":531,"./module/labs/notebook/strategyDetail/details/returnsTable.tpl":541,"./module/labs/notebook/strategyDetail/details/settings":539,"./module/labs/notebook/strategyDetail/details/settings.js":539,"./module/labs/notebook/strategyDetail/details/settings.tpl":540,"./module/labs/notebook/toolbarConfig":562,"./module/labs/notebook/toolbarConfig.js":562,"./module/labs/route":55,"./module/labs/route.js":55,"./module/labs/sidebar/mainNav":294,"./module/labs/sidebar/mainNav.js":294,"./module/labs/sidebar/mainNavItem.tpl":295,"./module/labs/sidebar/sidebar":277,"./module/labs/sidebar/sidebar.js":277,"./module/labs/sidebar/sidebar.tpl":372,"./module/labs/sidebar/toolbar":296,"./module/labs/sidebar/toolbar.js":296,"./module/labs/sidebar/toolbar.tpl":371,"./module/labs/sidebar/toolbarItem/button":301,"./module/labs/sidebar/toolbarItem/button.js":301,"./module/labs/sidebar/toolbarItem/buttonGroup":300,"./module/labs/sidebar/toolbarItem/buttonGroup.js":300,"./module/labs/sidebar/toolbarItem/items":297,"./module/labs/sidebar/toolbarItem/items.js":297,"./module/labs/sidebar/toolbarItem/navItem.tpl":299,"./module/labs/sidebar/toolbarItem/navs":298,"./module/labs/sidebar/toolbarItem/navs.js":298,"./module/labs/title/layout":377,"./module/labs/title/layout.js":377,"./module/labs/title/layout.tpl":379,"./module/labs/welcome":400,"./module/labs/welcome.js":400,"./module/labs/welcome.tpl":425,"./module/trade/fundstrategy/detailView":569,"./module/trade/fundstrategy/detailView.js":569,"./module/trade/fundstrategy/details":590,"./module/trade/fundstrategy/details.js":590,"./module/trade/fundstrategy/details/settings":591,"./module/trade/fundstrategy/details/settings.js":591,"./module/trade/fundstrategy/details/settings.tpl":592,"./module/trade/fundstrategy/fundstrategies":593,"./module/trade/fundstrategy/fundstrategies.js":593,"./module/trade/fundstrategy/fundstrategy":589,"./module/trade/fundstrategy/fundstrategy.js":589,"./module/trade/fundstrategy/itemView":594,"./module/trade/fundstrategy/itemView.js":594,"./module/trade/fundstrategy/itemView.tpl":598,"./module/trade/fundstrategy/listView":599,"./module/trade/fundstrategy/listView.js":599,"./module/trade/fundstrategy/listView.tpl":603,"./module/trade/home":604,"./module/trade/home.js":604,"./module/trade/home.tpl":607,"./module/trade/layout":608,"./module/trade/layout.js":608,"./module/trade/layout.tpl":609,"./module/trade/monitorDropdown":605,"./module/trade/monitorDropdown.js":605,"./module/trade/monitorDropdown.tpl":606,"./module/trade/route":54,"./module/trade/route.js":54,"./module/trade/strategy/detailActions.tpl":588,"./module/trade/strategy/detailSummary.tpl":587,"./module/trade/strategy/detailView":570,"./module/trade/strategy/detailView.js":570,"./module/trade/strategy/detailView.tpl":586,"./module/trade/strategy/details":571,"./module/trade/strategy/details.js":571,"./module/trade/strategy/details/code":583,"./module/trade/strategy/details/code.js":583,"./module/trade/strategy/details/empty.tpl":580,"./module/trade/strategy/details/log":581,"./module/trade/strategy/details/log.js":581,"./module/trade/strategy/details/logItem.tpl":582,"./module/trade/strategy/details/overview":572,"./module/trade/strategy/details/overview.js":572,"./module/trade/strategy/details/overview.tpl":573,"./module/trade/strategy/details/risk":577,"./module/trade/strategy/details/risk.js":577,"./module/trade/strategy/details/risk.tpl":578,"./module/trade/strategy/details/riskBrief.tpl":579,"./module/trade/strategy/details/settings":584,"./module/trade/strategy/details/settings.js":584,"./module/trade/strategy/details/settings.tpl":585,"./module/trade/strategy/emptyView":601,"./module/trade/strategy/emptyView.js":601,"./module/trade/strategy/goFund.tpl":597,"./module/trade/strategy/itemView":595,"./module/trade/strategy/itemView.js":595,"./module/trade/strategy/itemView.tpl":596,"./module/trade/strategy/listView":600,"./module/trade/strategy/listView.js":600,"./module/trade/strategy/listView.tpl":602,"./module/trade/strategy/statusMap":444,"./module/trade/strategy/statusMap.js":444,"./module/trade/strategy/strategies":442,"./module/trade/strategy/strategies.js":442,"./module/trade/strategy/strategy":443,"./module/trade/strategy/strategy.js":443,"./partial/contestGrade.tpl":610,"./trade":611,"./trade.js":611};i.keys=function(){return Object.keys(o)},i.resolve=r,e.exports=i,i.id=71},function(e,t,n){var i,r;i=[n(122),n(124),n(151),n(153),n(201),n(73),n(203),n(205),n(207),n(209)],r=function(e,t,n,i,r,o,a,s,l,c){return{Layout:e,HomeView:t,SearchView:n,ShareDetailView:i,UserDetailView:o,ShareCreateView:r,ExchangeDetailView:a,ShareEditView:s,EmailView:l,MallView:c}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(47),n(78),n(79),n(81),n(103),n(106),n(46),n(74),n(107),n(110),n(112),n(117),n(119),n(116)],r=function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f){return n.extend({className:"user-detail clearfix",template:a,navItemTpl:e.template('<li><a class="tab-<%= id %>" href="#<%= href %>"><%= name %><span class="count"></span></a></li>'),events:{"click .nav a":"clickNav","click .actions .follow-action":"clickFollow","click .actions .followed-action":"clickFollow","click .actions .unEdited":"clickEdit","click .goto-follow":"clickGotoFollow","click .goto-follower":"clickGotoFollower","click .follow-tabs a":"clickFollowAction","click .actions .cancel":"clickCancel","click .actions .submit":"clickSubmit"},ui:{paginator:".paginator",form:".profile-form"},initialize:function(e){n.prototype.initialize.apply(this,arguments),this.model=new o({id:e.id})},serializeData:function(){var e=f.get("profile"),t=this.model.toJSON();return t.isEdited=e.get("id")===t.id,t.mallUrl=this.model.mallUrl(),t},render:function(){var e=this;this.model.fetch().done(function(){n.prototype.render.apply(e)}).fail(function(e){404===e.status&&t.Route.notFound()})},onRender:function(){var e=this,n=i.extend({url:this.model.threadsUrl()+this.model.get("id")+"/timeline"}),o=i.extend({url:this.model.threadsUrl()+this.model.get("id")+"/threads"}),a=i.extend({url:this.model.threadsUrl()+this.model.get("id")+"/comments"}),s=i.extend({url:this.model.threadsUrl()+this.model.get("id")+"/collects"});e.$el.find(".actions .not-user").show(),e.$el.find(".actions .is-user").hide(),this.nav=this.$el.find(".nav"),this.addGroup(r.extend({emptyViewOptions:{text:"当前没有动态"}}),{id:"active",name:"动态",href:"tab-active"}),this.addGroup(r.extend({emptyViewOptions:{text:"当前没有分享"}}),{id:"share",name:"分享",href:"tab-share"}),this.addGroup(r.extend({emptyViewOptions:{text:"当前没有评论"}}),{id:"comment",name:"评论",href:"tab-comment"}),this.addGroup(r.extend({emptyViewOptions:{text:"当前没有收藏"}}),{id:"collect",name:"收藏",href:"tab-collect"}),this.listCollection={active:new n([],{}),share:new o([],{}),comment:new a([],{}),collect:new s([],{})},this.on("tab:show",function(){e.loading=!0,e.ui.paginator.pagination("destroy"),e.getCurrentGroup().collection.state.currentPage=0,e.getCurrentGroup().collection.fetchNext().done(function(){e.loading=!1,e.paginate()})}),this.showGroup("active",{collection:this.listCollection.active}),t.vent.trigger("title",this.model.get("profile.nickname")),this.hotThreads=new l({userID:this.model.get("id")}),this.follows=new u({val:"follows",userID:this.model.get("id")}),this.followers=new u({val:"followers",userID:this.model.get("id")}),this.honors=new h({userID:this.model.get("id")}),this.$el.find(".follows").hide(),this.$el.find(".edited").hide(),this.$el.find(".user-mall").hide(),this.$el.find(".user-meta").addClass("user-meta-bottom"),this.followsList=new d({collection:this.follows}),this.followersList=new d({collection:this.followers}),this.listenTo(this.model,{"change:profile.nickname":function(){e.$el.find(".profile-nickname").text(e.model.get("profile.nickname"))},"change:profile.introduction":function(){e.$el.find(".profile-introduction").text(e.model.get("profile.introduction"))}}),this.on("follow_able",function(t){t?(e.$el.find(".actions .followed-action").hide(),e.$el.find(".actions .follow-action").show()):(e.$el.find(".actions .followed-action").show(),e.$el.find(".actions .follow-action").hide())}),t.vent.on("user_follow",function(t){if(e.model.get("id")===f.get("profile").get("id")){var n=e.$el.find(".user-follow .follow").text();n=t+Number(n),e.$el.find(".user-follow .follow").text(n),e.$el.find(".tab-follow .count").text(n)}}),this.renderReputations(),this.renderStatic(),this.renderFollows(),this.renderHotThreads(),this.renderHonors(),f.get("profile").deferred.done(function(){f.get("profile").get("id")===e.model.get("id")&&(e.$el.find(".actions .not-user").hide(),e.$el.find(".actions .is-user").show(),e.$el.find(".user-mall").show(),e.$el.find(".user-meta").removeClass("user-meta-bottom"),e.fetchPoints())})},fetchPoints:function(){var e=this,t=0;$.ajax({url:window.getapi("mercury_community","/user/"+this.model.get("id")+"/points"),type:"GET"}).done(function(n){200===n.code&&n.data&&(e.$el.find(".points").text(n.data.available_points),n.data.available_points<300?(t=300-n.data.available_points,e.$el.find(".mem-txt").text("还差"+t+"积分,即可兑换内存")):e.$el.find(".mem-txt").text("积分可兑换内存啦"))})},renderHonors:function(){var e=this;this.honorsList=new p({collection:this.honors}),$.when(this.honors.fetch()).done(function(){e.honorsList.isEmpty()?e.$el.find(".honors").remove():e.$el.find(".honors").append(e.honorsList.render().el)})},renderReputations:function(){var e=this;this.model.userReputations().done(function(t){200===t.code&&t.data&&(e.$el.find(".achieve .thread-up").text(t.data.received_thread_up_count),e.$el.find(".achieve .comment-up").text(t.data.received_comment_up_count),e.$el.find(".achieve .collect").text(t.data.received_collect_count),e.$el.find(".achieve .fork").text(t.data.received_fork_count))})},renderStatic:function(){var e=this;this.model.userStatic().done(function(t){200===t.code&&t.data&&(e.$el.find(".nav .tab-share .count").text("("+t.data.thread_count+")"),e.$el.find(".nav .tab-comment .count").text("("+t.data.comment_count+")"),e.$el.find(".nav .tab-collect .count").text("("+t.data.collect_count+")"))})},renderFollows:function(){var e=this;this.model.userFollowers().done(function(t){200===t.code&&t.data&&(e.model.get("isEdited")&&e.model.set({myFollowCount:t.data.follow_count}),e.$el.find(".user-follow .follow").text(t.data.follow_count),e.$el.find(".user-follow .follower").text(t.data.follower_count),e.trigger("follow_able",t.data.follow_able),e.$el.find(".tab-follow .count").text(t.data.follow_count),e.$el.find(".tab-follower .count").text(t.data.follower_count))})},renderHotThreads:function(){var e=this;this.hotThreadList=new c({collection:this.hotThreads}),$.when(this.hotThreads.fetchNext()).done(function(){e.$el.find(".hotThreads").append(e.hotThreadList.render().el)})},renderFollowView:function(){var e=this;$.when(this.follows.fetchNext()).done(function(){e.$el.find(".follow-content").children().remove(),e.$el.find(".follow-content").append(e.followsList.render().el),e.$el.find(".tab-follow .count").text(e.followsList.collection.state.totalCount)})},renderFollowerView:function(){var e=this;$.when(this.followers.fetchNext()).done(function(){e.$el.find(".follow-content").children().remove(),e.$el.find(".follow-content").append(e.followersList.render().el),e.$el.find(".tab-follower .count").text(e.followersList.collection.state.totalCount)})},clickNav:function(e){var t=$(e.currentTarget),n=t.attr("href").replace("#tab-","");t.parent().addClass("active").siblings().removeClass("active"),this.showGroup(n,{collection:this.listCollection[n]}),e.preventDefault()},setNavCount:function(e){},paginate:function(){var e=this;return this.getCurrentGroup().collection.isEmpty()||1===this.getCurrentGroup().collection.state.totalPage?void this.ui.paginator.pagination("destroy"):void this.ui.paginator.pagination({items:e.getCurrentGroup().collection.state.totalCount,itemsOnPage:e.getCurrentGroup().collection.state.pageSize,currentPage:e.getCurrentGroup().collection.state.currentPage,cssStyle:"pagination",prevText:"上一页",nextText:"下一页",onPageClick:function(t,n){e.getCurrentGroup().collection.state.currentPage=t-1,e.getCurrentGroup().collection.fetchNext(!0).done(function(){$(".main").scrollTop(0)}),n.preventDefault()}})},clickFollow:function(e){var t=($(e.currentTarget),this);return s.anonymous?(s.loginWithModal({appRoot:window.getApp("cloud-portal","")}),void e.preventDefault()):(this.model.follow().done(function(e){t.trigger("follow_able",e.data.follow_able)}),void e.preventDefault())},clickEdit:function(e){this.$el.find(".edited").show(),this.$el.find(".unEdited").hide(),e.preventDefault()},clickGotoFollow:function(e){this.$el.find(".tabs").hide(),this.$el.find(".follows").show(),this.$el.find(".tab-follow").parent().addClass("active").siblings().removeClass("active"),this.renderFollowView(),e.preventDefault()},clickGotoFollower:function(e){this.$el.find(".tabs").hide(),this.$el.find(".follows").show(),this.$el.find(".tab-follower").parent().addClass("active").siblings().removeClass("active"),this.renderFollowerView(),e.preventDefault()},clickFollowAction:function(e){var t=$(e.currentTarget),n=t.attr("href").replace("#tab-","");t.parent().addClass("active").siblings().removeClass("active"),"back"===n?(this.$el.find(".follows").hide(),this.$el.find(".tabs").show()):"follow"===n?this.renderFollowView():"follower"===n&&this.renderFollowerView(),e.preventDefault()},clickCancel:function(e){var t=this.ui.form.find('input[name="nickname"]'),n=this.ui.form.find('input[name="title"]');this.$el.find(".edited").hide(),this.$el.find(".unEdited").show(),t.val(this.model.get("profile.nickname")),n.val(this.model.get("profile.introduction")),this.resetField(t),this.resetField(n),e.preventDefault()},errorField:function(e,t){e.parents(".form-div").addClass("has-error"),e.next(".error-block").text(t||"")},resetField:function(e){e.parents(".form-div").removeClass("has-error"),e.next(".error-block").text("")},clickSubmit:function(e){var t=this,n=this.ui.form.find('input[name="nickname"]'),i=this.ui.form.find('input[name="title"]'),r=this.model.get("profile"),o=r.nickname,a=function(e,t,n){return e.length<t||e.length>n?!1:!0};return e.preventDefault(),this.resetField(n),this.resetField(i),n.val()?/[@\s\\<>]/gi.test(n.val())?void this.errorField(n,"昵称不得包含@,\\,/,<,>,空格"):/[@\\<>]/gi.test(i.val())?void this.errorField(i,"简介不得包含特殊字符"):a(n.val(),2,30)?a(i.val(),0,30)?r.nickname===n.val()&&r.introduction===i.val()?void t.clickCancel(e):void this.model.save({profile:{nickname:n.val(),introduction:i.val(),job:""}},{url:this.model.profileUrl(),wait:!0}).done(function(i){return 506===i.code?(t.model.set({"profile.nickname":o}),void t.errorField(n,"此昵称已被使用.")):void t.clickCancel(e)}):void this.errorField(i,"简介不得超过30个字符"):void this.errorField(n,"昵称应为2-30个字符"):void this.errorField(n)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(75)],r=function(e,t,n){return t.Collection.extend({model:n,initialize:function(t,n){n=n||{},e.defaults(n,{sortBy:"hot",currentPage:0,pageSize:5,totalPage:1,type:"all"}),this.userID=t.userID,this.state=n},url:function(){return this.userID?window.getapi("mercury_community","/w/user/"+this.userID+"/threads"):window.getapi("mercury_community","/w/threads")},parse:function(e){return 200===e.code?e.data.list:[]},fetch:function(){return this.trigger("sync:before"),t.Collection.prototype.fetch.apply(this,arguments)},fetchNext:function(){if(this.state.currentPage>=this.state.totalPage){var e=$.Deferred();return e.reject(),e}return this.fetch({data:{page:this.state.currentPage+1,page_size:this.state.pageSize,sort:this.state.sortBy,
type:this.state.type},remove:!0}).done(function(e){})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(76)],r=function(e,t){return t.NestedModel.extend({urlRoot:window.getapi("mercury_community","/thread/"),appUrl:function(){return"community/share/"+(this.get("thread_id")?this.get("thread_id"):this.id)},parse:function(e){return 200===e.code?e.data:e||{}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){!function(t,i){e.exports=i(n(77),n(50),n(48))}(this,function(e,t,n){"use strict";return n.NestedModel=n.Model.extend({get:function(e){return n.NestedModel.walkThenGet(this.attributes,e)},previous:function(e){return n.NestedModel.walkThenGet(this._previousAttributes,e)},has:function(e){var n=this.get(e);return!(null===n||t.isUndefined(n))},set:function(e,i,r){var o,a,s,l=n.NestedModel.deepClone(this.attributes);if(t.isString(e)?o=n.NestedModel.attrPath(e):t.isArray(e)&&(o=e),o)r=r||{},this._setAttr(l,o,i,r);else{r=i||{};var c=e;for(var u in c)c.hasOwnProperty(u)&&this._setAttr(l,n.NestedModel.attrPath(u),r.unset?void 0:c[u],r)}return this._nestedChanges=n.NestedModel.__super__.changedAttributes.call(this),r.unset&&o&&1===o.length?(a={},a[e]=void 0,this._nestedChanges=t.omit(this._nestedChanges,t.keys(a)),s=n.NestedModel.__super__.set.call(this,a,r)):(a=l,r.unset&&o?(r=t.extend({},r),delete r.unset):r.unset&&t.isObject(e)&&(a=e),this._nestedChanges=t.omit(this._nestedChanges,t.keys(a)),s=n.NestedModel.__super__.set.call(this,a,r)),s?(this._runDelayedTriggers(),this):(this.changed={},this._nestedChanges={},!1)},unset:function(e,n){return this.set(e,void 0,t.extend({},n,{unset:!0}))},clear:function(e){this._nestedChanges={},e=e||{};var n=t.clone(this.attributes);if(!e.silent&&this.validate&&!this.validate(n,e))return!1;var i=this.changed={},r=this,o=function(e,n,a){t.each(e,function(s,l){var c=n;t.isArray(e)?c+="["+l+"]":n?c+="."+l:c=l,s=e[l],t.isObject(s)&&o(s,c,a),a.silent||r._delayedChange(c,null,a),i[c]=null})};return o(this.attributes,"",e),this.attributes={},e.silent||this._delayedTrigger("change"),this._runDelayedTriggers(),this},add:function(e,n,i){var r=this.get(e);if(!t.isArray(r))throw new Error("current value is not an array");return this.set(e+"["+r.length+"]",n,i)},remove:function(e,i){i=i||{};var r=n.NestedModel.attrPath(e),o=t.initial(r),a=this.get(o),s=t.last(r);if(!t.isArray(a))throw new Error("remove() must be called on a nested array");var l=!i.silent&&a.length>=s+1,c=a[s];if(a.splice(s,1),i.silent=!0,this.set(o,a,i),l){e=n.NestedModel.createAttrStr(o),this.trigger("remove:"+e,this,c);for(var u=o.length;u>=1;u--)e=n.NestedModel.createAttrStr(t.first(o,u)),this.trigger("change:"+e,this,c);this.trigger("change",this,c)}return this},changedAttributes:function(e){var i=n.NestedModel.__super__.changedAttributes.call(this,e);return t.isObject(i)?t.extend({},this._nestedChanges,i):!1},toJSON:function(){return n.NestedModel.deepClone(this.attributes)},_getDelayedTriggers:function(){return"undefined"==typeof this._delayedTriggers&&(this._delayedTriggers=[]),this._delayedTriggers},_delayedTrigger:function(){this._getDelayedTriggers().push(arguments)},_delayedChange:function(e,t,n){this._delayedTrigger("change:"+e,this,t,n),this.changed||(this.changed={}),this.changed[e]=t},_runDelayedTriggers:function(){for(;this._getDelayedTriggers().length>0;)this.trigger.apply(this,this._getDelayedTriggers().shift())},_setAttr:function(e,i,r,o){o=o||{};var a=i.length,s=this;n.NestedModel.walkPath(e,i,function(e,l,c){var u=t.last(l),d=n.NestedModel.createAttrStr(l),h=!t.isEqual(e[u],r);if(l.length===a){if(o.unset){if(delete e[u],t.isArray(e)){var p=n.NestedModel.createAttrStr(t.initial(i));s._delayedTrigger("remove:"+p,s,e[u])}}else e[u]=r;if(!o.silent&&t.isObject(r)&&h){var f=[],m=function(e,n){if(!(t.indexOf(f,e)>-1)){f.push(e);var i,r;for(var a in e)e.hasOwnProperty(a)&&(i=n+"."+a,r=e[a],t.isEqual(s.get(i),r)||s._delayedChange(i,r,o),t.isObject(r)&&m(r,i))}};m(r,d)}}else e[u]||(t.isNumber(c)?e[u]=[]:e[u]={});o.silent||(l.length>1&&h&&s._delayedChange(d,e[u],o),t.isArray(e[u])&&s._delayedTrigger("add:"+d,s,e[u]))})}},{attrPath:function(e){var n;return t.isString(e)?(n=""===e?[""]:e.match(/[^\.\[\]]+/g),n=t.map(n,function(e){return e.match(/^\d+$/)?parseInt(e,10):e})):n=e,n},createAttrStr:function(e){var n=e[0];return t.each(t.rest(e),function(e){n+=t.isNumber(e)?"["+e+"]":"."+e}),n},deepClone:function(t){return e.extend(!0,{},t)},walkPath:function(e,t,n,i){for(var r,o=e,a=0;a<t.length&&(n.call(i||this,o,t.slice(0,a+1),t[a+1]),r=t[a],o=o[r],o);a++);},walkThenGet:function(e,i){var r,o=n.NestedModel.attrPath(i);return n.NestedModel.walkPath(e,o,function(e,n){var i=t.last(n);n.length===o.length&&(r=e[i])}),r}}),n})},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_77__},function(e,t,n){var i,r;i=[n(45),n(49)],r=function(e,t){return t.LayoutView.extend({regions:{main:".tab-content"},navItemTpl:e.template('<li><a class="tab-<%= id %>" href="#<%= href %>"><%= name %></a></li>'),initialize:function(e){t.LayoutView.prototype.initialize.apply(this,arguments),this._groupClass={}},addGroup:function(e,t){var n=$(this.navItemTpl(t));this.nav.append(n),this._groupClass[t.id]=e},showGroup:function(e,t){this._groupClass[e]&&(this._currentGroup=new this._groupClass[e](t),this.main.show(this._currentGroup),this.nav.find("li").removeClass("active").end().find("a.tab-"+e).parent().addClass("active"),this.trigger("tab:show",e),this._currentGroup.trigger("tab:show"))},existsGroup:function(e){return this._groupClass[e]?!0:!1},getCurrentGroup:function(){return this._currentGroup}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(80)],r=function(e,t,n){return t.Collection.extend({model:n,parse:function(e){return 200===e.code?e.data.list:[]},initialize:function(t,n){n=n||{},e.defaults(n,{currentPage:0,pageSize:10,totalPage:1}),this.state=n},fetch:function(){return this.trigger("sync:before"),t.Collection.prototype.fetch.apply(this,arguments)},fetchNext:function(){var e=this;if(this.state.currentPage>=this.state.totalPage){var t=$.Deferred();return t.reject(),t}return this.fetch({data:{page:this.state.currentPage+1,page_size:this.state.pageSize},remove:!0}).done(function(t){e.state.currentPage=t.data.current_page,e.state.totalPage=t.data.total_page,e.state.totalCount=t.data.total_count})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(76)],r=function(e,t){return t.NestedModel.extend({parse:function(e){return 200===e.code?e.data:e||{}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(82),n(83),n(105)],r=function(e,t,n,i){return e.CollectionView.extend({className:"share-list",childView:n,emptyView:i,initialize:function(){this.listenTo(this.collection,{sync:this.removeLoading,"sync:before":this.appendLoading})},onDestroy:function(){},appendLoading:function(){this.$el.find(".empty-share-list").hide(),this.loading=new t,this.$el.append(this.loading.render().$el)},removeLoading:function(){this.loading&&this.loading.destroy(),this.$el.find(".empty-share-list").show()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49)],r=function(e,t){return t.ItemView.extend({className:"loading",template:e.template('<span class="spinner primary"></span>')})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(84),n(87),n(88),n(89),n(103),n(104)],r=function(e,t,n,i,r,o,a,s){return t.ItemView.extend({className:"user-item clearfix",template:s,serializeData:function(){var t={thread:"发表了",thread_retrieve:"删除了",thread_discuss:"发表了",thread_discuss_retrieve:"删除了",comment:"评论了",comment_retrieve:"删除了",comment_discuss:"评论了",comment_discuss_retrieve:"删除了",thread_up:"点赞了",thread_up_delete:"取消点赞了",comment_up:"感谢了",comment_up_delete:"取消感谢了",thread_collect:"收藏了",thread_collect_delete:"取消收藏了",comment_collect:"收藏了",comment_collect_delete:"取消收藏了",user_follow:"关注了",user_follow_delete:"取消关注了",thread_discuss_follow:"关注了",thread_discuss_follow_delete:"取消关注了",thread_fork:"克隆了",honor:"获得了"},i=e.extend(this.model.toJSON(),i),r=this.model.get("resource_name");return i.time=n.fromNow(this.model.get("create")),i.followeeUrl=null,i.url="community/share/"+this.model.get("thread_id"),"timeline"===r?(i.followeeUrl="community/user/"+this.model.get("followee.id")+"/shares","comment"===this.model.get("event_type")&&"discuss"===this.model.get("meta.type")&&(t.comment="回复了")):"comments"===r&&(i.time=n.fromNow(this.model.get("comments[0].create"))),i.msg=t[this.model.get("event_type")],i},initialize:function(){this.md=new o({breaks:!0})},onRender:function(){var e=this,t=this.model.get("resource_name"),n=!1,r=this.model.get("event_type");"timeline"===t?("comment"===r||"comment_up"===r||"comment_collect"===r||"comment_discuss"===r)&&(n=!0):("comments"===t||"collects"===t&&"comment"===this.model.get("type"))&&(n=!0),n&&(this.md.Init({preview:this.$el.find(".content")[0],buffer:this.$el.find(".buffer")[0],getText:function(){return e.model.get("comments[0].content")},getAtArray:e.model.get("comments[0].at"),emptyText:"",preMarked:function(e,t){return i(e,t)}}),this.md.Update())},onShow:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(85),n(86)],r=function(e){return e.locale("zh-cn"),{format:function(t,n){return n=n||"YYYY-MM-DD HH:mm",e(t).format(n)},formatDate:function(t,n){return n=n||"YYYY-MM-DD",e(t).format(n)},calendar:function(t){return e(t).calendar()},from:function(t,n){return t=e(t),n=e(n),t.diff(n,"years")<=-1?this.format(t,"YYYY-MM-DD"):t.from(n)},fromNow:function(t){return this.from(t,e())},addDay:function(t,n){return this.formatDate(e(t).add(n,"days"))},formatTime:function(t,n){return n=n||"YYYY-MM-DD HH:mm:ss",e(t).format(n)}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){(function(e){!function(t,n){e.exports=n()}(this,function(){"use strict";function t(){return Yn.apply(null,arguments)}function n(e){Yn=e}function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function o(e,t){var n,i=[];for(n=0;n<e.length;++n)i.push(t(e[n],n));return i}function a(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function s(e,t){for(var n in t)a(t,n)&&(e[n]=t[n]);return a(t,"toString")&&(e.toString=t.toString),a(t,"valueOf")&&(e.valueOf=t.valueOf),e}function l(e,t,n,i){return Le(e,t,n,i,!0).utc()}function c(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function u(e){return null==e._pf&&(e._pf=c()),e._pf}function d(e){if(null==e._isValid){var t=u(e);e._isValid=!(isNaN(e._d.getTime())||!(t.overflow<0)||t.empty||t.invalidMonth||t.invalidWeekday||t.nullInput||t.invalidFormat||t.userInvalidated),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function h(e){var t=l(NaN);return null!=e?s(u(t),e):u(t).userInvalidated=!0,t}function p(e){return void 0===e}function f(e,t){var n,i,r;if(p(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),p(t._i)||(e._i=t._i),p(t._f)||(e._f=t._f),p(t._l)||(e._l=t._l),p(t._strict)||(e._strict=t._strict),p(t._tzm)||(e._tzm=t._tzm),p(t._isUTC)||(e._isUTC=t._isUTC),p(t._offset)||(e._offset=t._offset),p(t._pf)||(e._pf=u(t)),p(t._locale)||(e._locale=t._locale),Kn.length>0)for(n in Kn)i=Kn[n],r=t[i],p(r)||(e[i]=r);return e}function m(e){f(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),Jn===!1&&(Jn=!0,t.updateOffset(this),Jn=!1)}function g(e){return e instanceof m||null!=e&&null!=e._isAMomentObject}function v(e){return 0>e?Math.ceil(e):Math.floor(e)}function y(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=v(t)),n}function b(e,t,n){var i,r=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(i=0;r>i;i++)(n&&e[i]!==t[i]||!n&&y(e[i])!==y(t[i]))&&a++;return a+o}function _(){}function w(e){return e?e.toLowerCase().replace("_","-"):e}function x(e){for(var t,n,i,r,o=0;o<e.length;){for(r=w(e[o]).split("-"),t=r.length,n=w(e[o+1]),n=n?n.split("-"):null;t>0;){if(i=C(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&b(r,n,!0)>=t-1)break;t--}o++}return null}function C(t){var n=null;if(!Zn[t]&&"undefined"!=typeof e&&e&&e.exports)try{n=Xn._abbr,!function(){var e=new Error('Cannot find module "./locale"');throw e.code="MODULE_NOT_FOUND",e}(),k(n)}catch(i){}return Zn[t]}function k(e,t){var n;return e&&(n=p(t)?T(e):S(e,t),n&&(Xn=n)),Xn._abbr}function S(e,t){return null!==t?(t.abbr=e,Zn[e]=Zn[e]||new _,Zn[e].set(t),k(e),Zn[e]):(delete Zn[e],null)}function T(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Xn;if(!i(e)){if(t=C(e))return t;e=[e]}return x(e)}function D(e,t){var n=e.toLowerCase();Qn[n]=Qn[n+"s"]=Qn[t]=e}function M(e){return"string"==typeof e?Qn[e]||Qn[e.toLowerCase()]:void 0}function $(e){var t,n,i={};for(n in e)a(e,n)&&(t=M(n),t&&(i[t]=e[n]));return i}function L(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function A(e,n){return function(i){return null!=i?(I(this,e,i),t.updateOffset(this,n),this):R(this,e)}}function R(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function I(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function j(e,t){var n;if("object"==typeof e)for(n in e)this.set(n,e[n]);else if(e=M(e),L(this[e]))return this[e](t);return this}function E(e,t,n){var i=""+Math.abs(e),r=t-i.length,o=e>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function N(e,t,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),e&&(ii[e]=r),t&&(ii[t[0]]=function(){return E(r.apply(this,arguments),t[1],t[2])}),n&&(ii[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function P(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function O(e){var t,n,i=e.match(ei);for(t=0,n=i.length;n>t;t++)ii[i[t]]?i[t]=ii[i[t]]:i[t]=P(i[t]);return function(r){var o="";for(t=0;n>t;t++)o+=i[t]instanceof Function?i[t].call(r,e):i[t];return o}}function V(e,t){return e.isValid()?(t=F(t,e.localeData()),ni[t]=ni[t]||O(t),ni[t](e)):e.localeData().invalidDate()}function F(e,t){function n(e){return t.longDateFormat(e)||e}var i=5;for(ti.lastIndex=0;i>=0&&ti.test(e);)e=e.replace(ti,n),ti.lastIndex=0,i-=1;return e}function H(e,t,n){wi[e]=L(t)?t:function(e,i){return e&&n?n:t}}function z(e,t){return a(wi,e)?wi[e](t._strict,t._locale):new RegExp(B(e))}function B(e){return W(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,i,r){return t||n||i||r}))}function W(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function U(e,t){var n,i=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(i=function(e,n){n[t]=y(e)}),n=0;n<e.length;n++)xi[e[n]]=i}function q(e,t){U(e,function(e,n,i,r){i._w=i._w||{},t(e,i._w,i,r)})}function G(e,t,n){null!=t&&a(xi,e)&&xi[e](t,n._a,n,e)}function Y(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function X(e,t){return i(this._months)?this._months[e.month()]:this._months[Ri.test(t)?"format":"standalone"][e.month()]}function K(e,t){return i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Ri.test(t)?"format":"standalone"][e.month()]}function J(e,t,n){var i,r,o;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(r=l([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function Z(e,t){var n;return e.isValid()?"string"==typeof t&&(t=e.localeData().monthsParse(t),"number"!=typeof t)?e:(n=Math.min(e.date(),Y(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e):e}function Q(e){return null!=e?(Z(this,e),t.updateOffset(this,!0),this):R(this,"Month")}function ee(){return Y(this.year(),this.month())}function te(e){return this._monthsParseExact?(a(this,"_monthsRegex")||ie.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}function ne(e){return this._monthsParseExact?(a(this,"_monthsRegex")||ie.call(this),e?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}function ie(){function e(e,t){return t.length-e.length}var t,n,i=[],r=[],o=[];for(t=0;12>t;t++)n=l([2e3,t]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(i.sort(e),r.sort(e),o.sort(e),t=0;12>t;t++)i[t]=W(i[t]),r[t]=W(r[t]),o[t]=W(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")$","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")$","i")}function re(e){var t,n=e._a;return n&&-2===u(e).overflow&&(t=n[ki]<0||n[ki]>11?ki:n[Si]<1||n[Si]>Y(n[Ci],n[ki])?Si:n[Ti]<0||n[Ti]>24||24===n[Ti]&&(0!==n[Di]||0!==n[Mi]||0!==n[$i])?Ti:n[Di]<0||n[Di]>59?Di:n[Mi]<0||n[Mi]>59?Mi:n[$i]<0||n[$i]>999?$i:-1,u(e)._overflowDayOfYear&&(Ci>t||t>Si)&&(t=Si),u(e)._overflowWeeks&&-1===t&&(t=Li),u(e)._overflowWeekday&&-1===t&&(t=Ai),u(e).overflow=t),e}function oe(e){t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function ae(e,t){var n=!0;return s(function(){return n&&(oe(e+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),n=!1),t.apply(this,arguments)},t)}function se(e,t){Pi[e]||(oe(t),Pi[e]=!0)}function le(e){var t,n,i,r,o,a,s=e._i,l=Oi.exec(s)||Vi.exec(s);if(l){for(u(e).iso=!0,t=0,n=Hi.length;n>t;t++)if(Hi[t][1].exec(l[1])){r=Hi[t][0],i=Hi[t][2]!==!1;break}if(null==r)return void(e._isValid=!1);if(l[3]){for(t=0,n=zi.length;n>t;t++)if(zi[t][1].exec(l[3])){o=(l[2]||" ")+zi[t][0];break}if(null==o)return void(e._isValid=!1)}if(!i&&null!=o)return void(e._isValid=!1);if(l[4]){if(!Fi.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=r+(o||"")+(a||""),Ce(e)}else e._isValid=!1}function ce(e){var n=Bi.exec(e._i);return null!==n?void(e._d=new Date(+n[1])):(le(e),void(e._isValid===!1&&(delete e._isValid,t.createFromInputFallback(e))))}function ue(e,t,n,i,r,o,a){var s=new Date(e,t,n,i,r,o,a);return 100>e&&e>=0&&isFinite(s.getFullYear())&&s.setFullYear(e),s}function de(e){var t=new Date(Date.UTC.apply(null,arguments));return 100>e&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function he(e){return pe(e)?366:365}function pe(e){return e%4===0&&e%100!==0||e%400===0}function fe(){return pe(this.year())}function me(e,t,n){var i=7+t-n,r=(7+de(e,0,i).getUTCDay()-t)%7;return-r+i-1}function ge(e,t,n,i,r){var o,a,s=(7+n-i)%7,l=me(e,i,r),c=1+7*(t-1)+s+l;return 0>=c?(o=e-1,a=he(o)+c):c>he(e)?(o=e+1,a=c-he(e)):(o=e,a=c),{year:o,dayOfYear:a}}function ve(e,t,n){var i,r,o=me(e.year(),t,n),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return 1>a?(r=e.year()-1,i=a+ye(r,t,n)):a>ye(e.year(),t,n)?(i=a-ye(e.year(),t,n),r=e.year()+1):(r=e.year(),i=a),{week:i,year:r}}function ye(e,t,n){var i=me(e,t,n),r=me(e+1,t,n);return(he(e)-i+r)/7}function be(e,t,n){return null!=e?e:null!=t?t:n}function _e(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function we(e){var t,n,i,r,o=[];if(!e._d){for(i=_e(e),e._w&&null==e._a[Si]&&null==e._a[ki]&&xe(e),e._dayOfYear&&(r=be(e._a[Ci],i[Ci]),e._dayOfYear>he(r)&&(u(e)._overflowDayOfYear=!0),n=de(r,0,e._dayOfYear),e._a[ki]=n.getUTCMonth(),e._a[Si]=n.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ti]&&0===e._a[Di]&&0===e._a[Mi]&&0===e._a[$i]&&(e._nextDay=!0,e._a[Ti]=0),e._d=(e._useUTC?de:ue).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ti]=24)}}function xe(e){var t,n,i,r,o,a,s,l;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(o=1,a=4,n=be(t.GG,e._a[Ci],ve(Ae(),1,4).year),i=be(t.W,1),r=be(t.E,1),(1>r||r>7)&&(l=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,n=be(t.gg,e._a[Ci],ve(Ae(),o,a).year),i=be(t.w,1),null!=t.d?(r=t.d,(0>r||r>6)&&(l=!0)):null!=t.e?(r=t.e+o,(t.e<0||t.e>6)&&(l=!0)):r=o),1>i||i>ye(n,o,a)?u(e)._overflowWeeks=!0:null!=l?u(e)._overflowWeekday=!0:(s=ge(n,i,r,o,a),e._a[Ci]=s.year,e._dayOfYear=s.dayOfYear)}function Ce(e){if(e._f===t.ISO_8601)return void le(e);e._a=[],u(e).empty=!0;var n,i,r,o,a,s=""+e._i,l=s.length,c=0;for(r=F(e._f,e._locale).match(ei)||[],n=0;n<r.length;n++)o=r[n],i=(s.match(z(o,e))||[])[0],i&&(a=s.substr(0,s.indexOf(i)),a.length>0&&u(e).unusedInput.push(a),s=s.slice(s.indexOf(i)+i.length),c+=i.length),ii[o]?(i?u(e).empty=!1:u(e).unusedTokens.push(o),G(o,i,e)):e._strict&&!i&&u(e).unusedTokens.push(o);u(e).charsLeftOver=l-c,s.length>0&&u(e).unusedInput.push(s),u(e).bigHour===!0&&e._a[Ti]<=12&&e._a[Ti]>0&&(u(e).bigHour=void 0),e._a[Ti]=ke(e._locale,e._a[Ti],e._meridiem),we(e),re(e)}function ke(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(i=e.isPM(n),i&&12>t&&(t+=12),i||12!==t||(t=0),t):t}function Se(e){var t,n,i,r,o;if(0===e._f.length)return u(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)o=0,t=f({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],Ce(t),d(t)&&(o+=u(t).charsLeftOver,o+=10*u(t).unusedTokens.length,u(t).score=o,(null==i||i>o)&&(i=o,n=t));s(e,n||t)}function Te(e){if(!e._d){var t=$(e._i);e._a=o([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),we(e)}}function De(e){var t=new m(re(Me(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Me(e){var t=e._i,n=e._f;return e._locale=e._locale||T(e._l),null===t||void 0===n&&""===t?h({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),g(t)?new m(re(t)):(i(n)?Se(e):n?Ce(e):r(t)?e._d=t:$e(e),d(e)||(e._d=null),e))}function $e(e){var n=e._i;void 0===n?e._d=new Date(t.now()):r(n)?e._d=new Date(+n):"string"==typeof n?ce(e):i(n)?(e._a=o(n.slice(0),function(e){return parseInt(e,10)}),we(e)):"object"==typeof n?Te(e):"number"==typeof n?e._d=new Date(n):t.createFromInputFallback(e)}function Le(e,t,n,i,r){var o={};return"boolean"==typeof n&&(i=n,n=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=e,o._f=t,o._strict=i,De(o)}function Ae(e,t,n,i){return Le(e,t,n,i,!1)}function Re(e,t){var n,r;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Ae();for(n=t[0],r=1;r<t.length;++r)(!t[r].isValid()||t[r][e](n))&&(n=t[r]);return n}function Ie(){var e=[].slice.call(arguments,0);return Re("isBefore",e)}function je(){var e=[].slice.call(arguments,0);return Re("isAfter",e)}function Ee(e){var t=$(e),n=t.year||0,i=t.quarter||0,r=t.month||0,o=t.week||0,a=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._milliseconds=+u+1e3*c+6e4*l+36e5*s,this._days=+a+7*o,this._months=+r+3*i+12*n,this._data={},this._locale=T(),this._bubble()}function Ne(e){return e instanceof Ee}function Pe(e,t){N(e,0,0,function(){var e=this.utcOffset(),n="+";return 0>e&&(e=-e,n="-"),n+E(~~(e/60),2)+t+E(~~e%60,2)})}function Oe(e,t){var n=(t||"").match(e)||[],i=n[n.length-1]||[],r=(i+"").match(Yi)||["-",0,0],o=+(60*r[1])+y(r[2]);return"+"===r[0]?o:-o}function Ve(e,n){var i,o;return n._isUTC?(i=n.clone(),o=(g(e)||r(e)?+e:+Ae(e))-+i,i._d.setTime(+i._d+o),t.updateOffset(i,!1),i):Ae(e).local()}function Fe(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function He(e,n){var i,r=this._offset||0;return this.isValid()?null!=e?("string"==typeof e?e=Oe(yi,e):Math.abs(e)<16&&(e=60*e),!this._isUTC&&n&&(i=Fe(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!n||this._changeInProgress?it(this,Ze(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:Fe(this):null!=e?this:NaN}function ze(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Be(e){return this.utcOffset(0,e)}function We(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Fe(this),"m")),this}function Ue(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Oe(vi,this._i)),this}function qe(e){return this.isValid()?(e=e?Ae(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Ge(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ye(){if(!p(this._isDSTShifted))return this._isDSTShifted;var e={};if(f(e,this),e=Me(e),e._a){var t=e._isUTC?l(e._a):Ae(e._a);this._isDSTShifted=this.isValid()&&b(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Xe(){return this.isValid()?!this._isUTC:!1}function Ke(){return this.isValid()?this._isUTC:!1}function Je(){return this.isValid()?this._isUTC&&0===this._offset:!1}function Ze(e,t){var n,i,r,o=e,s=null;return Ne(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(s=Xi.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:y(s[Si])*n,h:y(s[Ti])*n,m:y(s[Di])*n,s:y(s[Mi])*n,ms:y(s[$i])*n}):(s=Ki.exec(e))?(n="-"===s[1]?-1:1,o={y:Qe(s[2],n),M:Qe(s[3],n),d:Qe(s[4],n),h:Qe(s[5],n),m:Qe(s[6],n),s:Qe(s[7],n),w:Qe(s[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(r=tt(Ae(o.from),Ae(o.to)),o={},o.ms=r.milliseconds,o.M=r.months),i=new Ee(o),Ne(e)&&a(e,"_locale")&&(i._locale=e._locale),i}function Qe(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function et(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function tt(e,t){var n;return e.isValid()&&t.isValid()?(t=Ve(t,e),e.isBefore(t)?n=et(e,t):(n=et(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function nt(e,t){return function(n,i){var r,o;return null===i||isNaN(+i)||(se(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),o=n,n=i,i=o),n="string"==typeof n?+n:n,r=Ze(n,i),it(this,r,e),this}}function it(e,n,i,r){var o=n._milliseconds,a=n._days,s=n._months;e.isValid()&&(r=null==r?!0:r,o&&e._d.setTime(+e._d+o*i),a&&I(e,"Date",R(e,"Date")+a*i),s&&Z(e,R(e,"Month")+s*i),r&&t.updateOffset(e,a||s))}function rt(e,t){var n=e||Ae(),i=Ve(n,this).startOf("day"),r=this.diff(i,"days",!0),o=-6>r?"sameElse":-1>r?"lastWeek":0>r?"lastDay":1>r?"sameDay":2>r?"nextDay":7>r?"nextWeek":"sameElse",a=t&&(L(t[o])?t[o]():t[o]);return this.format(a||this.localeData().calendar(o,this,Ae(n)))}function ot(){return new m(this)}function at(e,t){var n=g(e)?e:Ae(e);return this.isValid()&&n.isValid()?(t=M(p(t)?"millisecond":t),"millisecond"===t?+this>+n:+n<+this.clone().startOf(t)):!1}function st(e,t){var n=g(e)?e:Ae(e);return this.isValid()&&n.isValid()?(t=M(p(t)?"millisecond":t),"millisecond"===t?+n>+this:+this.clone().endOf(t)<+n):!1}function lt(e,t,n){return this.isAfter(e,n)&&this.isBefore(t,n)}function ct(e,t){var n,i=g(e)?e:Ae(e);return this.isValid()&&i.isValid()?(t=M(t||"millisecond"),"millisecond"===t?+this===+i:(n=+i,+this.clone().startOf(t)<=n&&n<=+this.clone().endOf(t))):!1}function ut(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function dt(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function ht(e,t,n){var i,r,o,a;return this.isValid()?(i=Ve(e,this),i.isValid()?(r=6e4*(i.utcOffset()-this.utcOffset()),t=M(t),"year"===t||"month"===t||"quarter"===t?(a=pt(this,i),"quarter"===t?a/=3:"year"===t&&(a/=12)):(o=this-i,a="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-r)/864e5:"week"===t?(o-r)/6048e5:o),n?a:v(a)):NaN):NaN}function pt(e,t){var n,i,r=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(r,"months");return 0>t-o?(n=e.clone().add(r-1,"months"),i=(t-o)/(o-n)):(n=e.clone().add(r+1,"months"),i=(t-o)/(n-o)),-(r+i)}function ft(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function mt(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?L(Date.prototype.toISOString)?this.toDate().toISOString():V(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):V(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function gt(e){var n=V(this,e||t.defaultFormat);return this.localeData().postformat(n)}function vt(e,t){return this.isValid()&&(g(e)&&e.isValid()||Ae(e).isValid())?Ze({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function yt(e){return this.from(Ae(),e)}function bt(e,t){return this.isValid()&&(g(e)&&e.isValid()||Ae(e).isValid())?Ze({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function _t(e){return this.to(Ae(),e)}function wt(e){var t;return void 0===e?this._locale._abbr:(t=T(e),null!=t&&(this._locale=t),this)}function xt(){return this._locale}function Ct(e){switch(e=M(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function kt(e){return e=M(e),void 0===e||"millisecond"===e?this:this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms")}function St(){return+this._d-6e4*(this._offset||0)}function Tt(){return Math.floor(+this/1e3)}function Dt(){return this._offset?new Date(+this):this._d}function Mt(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function $t(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Lt(){return this.isValid()?this.toISOString():"null"}function At(){return d(this)}function Rt(){return s({},u(this))}function It(){return u(this).overflow}function jt(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Et(e,t){N(0,[e,e.length],0,t)}function Nt(e){return Ft.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Pt(e){return Ft.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ot(){return ye(this.year(),1,4)}function Vt(){var e=this.localeData()._week;return ye(this.year(),e.dow,e.doy)}function Ft(e,t,n,i,r){var o;return null==e?ve(this,i,r).year:(o=ye(e,i,r),t>o&&(t=o),Ht.call(this,e,t,n,i,r))}function Ht(e,t,n,i,r){var o=ge(e,t,n,i,r),a=de(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function zt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Bt(e){return ve(e,this._week.dow,this._week.doy).week}function Wt(){return this._week.dow}function Ut(){return this._week.doy}function qt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Gt(e){var t=ve(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Yt(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function Xt(e,t){return i(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}function Kt(e){return this._weekdaysShort[e.day()]}function Jt(e){return this._weekdaysMin[e.day()]}function Zt(e,t,n){var i,r,o;for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],
this._fullWeekdaysParse=[]),i=0;7>i;i++){if(r=Ae([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".",".?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}}function Qt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Yt(e,this.localeData()),this.add(e-t,"d")):t}function en(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function tn(e){return this.isValid()?null==e?this.day()||7:this.day(this.day()%7?e:e-7):null!=e?this:NaN}function nn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function rn(){return this.hours()%12||12}function on(e,t){N(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function an(e,t){return t._meridiemParse}function sn(e){return"p"===(e+"").toLowerCase().charAt(0)}function ln(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function cn(e,t){t[$i]=y(1e3*("0."+e))}function un(){return this._isUTC?"UTC":""}function dn(){return this._isUTC?"Coordinated Universal Time":""}function hn(e){return Ae(1e3*e)}function pn(){return Ae.apply(null,arguments).parseZone()}function fn(e,t,n){var i=this._calendar[e];return L(i)?i.call(t,n):i}function mn(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function gn(){return this._invalidDate}function vn(e){return this._ordinal.replace("%d",e)}function yn(e){return e}function bn(e,t,n,i){var r=this._relativeTime[n];return L(r)?r(e,t,n,i):r.replace(/%d/i,e)}function _n(e,t){var n=this._relativeTime[e>0?"future":"past"];return L(n)?n(t):n.replace(/%s/i,t)}function wn(e){var t,n;for(n in e)t=e[n],L(t)?this[n]=t:this["_"+n]=t;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function xn(e,t,n,i){var r=T(),o=l().set(i,t);return r[n](o,e)}function Cn(e,t,n,i,r){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return xn(e,t,n,r);var o,a=[];for(o=0;i>o;o++)a[o]=xn(e,o,n,r);return a}function kn(e,t){return Cn(e,t,"months",12,"month")}function Sn(e,t){return Cn(e,t,"monthsShort",12,"month")}function Tn(e,t){return Cn(e,t,"weekdays",7,"day")}function Dn(e,t){return Cn(e,t,"weekdaysShort",7,"day")}function Mn(e,t){return Cn(e,t,"weekdaysMin",7,"day")}function $n(){var e=this._data;return this._milliseconds=_r(this._milliseconds),this._days=_r(this._days),this._months=_r(this._months),e.milliseconds=_r(e.milliseconds),e.seconds=_r(e.seconds),e.minutes=_r(e.minutes),e.hours=_r(e.hours),e.months=_r(e.months),e.years=_r(e.years),this}function Ln(e,t,n,i){var r=Ze(t,n);return e._milliseconds+=i*r._milliseconds,e._days+=i*r._days,e._months+=i*r._months,e._bubble()}function An(e,t){return Ln(this,e,t,1)}function Rn(e,t){return Ln(this,e,t,-1)}function In(e){return 0>e?Math.floor(e):Math.ceil(e)}function jn(){var e,t,n,i,r,o=this._milliseconds,a=this._days,s=this._months,l=this._data;return o>=0&&a>=0&&s>=0||0>=o&&0>=a&&0>=s||(o+=864e5*In(Nn(s)+a),a=0,s=0),l.milliseconds=o%1e3,e=v(o/1e3),l.seconds=e%60,t=v(e/60),l.minutes=t%60,n=v(t/60),l.hours=n%24,a+=v(n/24),r=v(En(a)),s+=r,a-=In(Nn(r)),i=v(s/12),s%=12,l.days=a,l.months=s,l.years=i,this}function En(e){return 4800*e/146097}function Nn(e){return 146097*e/4800}function Pn(e){var t,n,i=this._milliseconds;if(e=M(e),"month"===e||"year"===e)return t=this._days+i/864e5,n=this._months+En(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Nn(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function On(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*y(this._months/12)}function Vn(e){return function(){return this.as(e)}}function Fn(e){return e=M(e),this[e+"s"]()}function Hn(e){return function(){return this._data[e]}}function zn(){return v(this.days()/7)}function Bn(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function Wn(e,t,n){var i=Ze(e).abs(),r=Nr(i.as("s")),o=Nr(i.as("m")),a=Nr(i.as("h")),s=Nr(i.as("d")),l=Nr(i.as("M")),c=Nr(i.as("y")),u=r<Pr.s&&["s",r]||1>=o&&["m"]||o<Pr.m&&["mm",o]||1>=a&&["h"]||a<Pr.h&&["hh",a]||1>=s&&["d"]||s<Pr.d&&["dd",s]||1>=l&&["M"]||l<Pr.M&&["MM",l]||1>=c&&["y"]||["yy",c];return u[2]=t,u[3]=+e>0,u[4]=n,Bn.apply(null,u)}function Un(e,t){return void 0===Pr[e]?!1:void 0===t?Pr[e]:(Pr[e]=t,!0)}function qn(e){var t=this.localeData(),n=Wn(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function Gn(){var e,t,n,i=Or(this._milliseconds)/1e3,r=Or(this._days),o=Or(this._months);e=v(i/60),t=v(e/60),i%=60,e%=60,n=v(o/12),o%=12;var a=n,s=o,l=r,c=t,u=e,d=i,h=this.asSeconds();return h?(0>h?"-":"")+"P"+(a?a+"Y":"")+(s?s+"M":"")+(l?l+"D":"")+(c||u||d?"T":"")+(c?c+"H":"")+(u?u+"M":"")+(d?d+"S":""):"P0D"}var Yn,Xn,Kn=t.momentProperties=[],Jn=!1,Zn={},Qn={},ei=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ti=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ni={},ii={},ri=/\d/,oi=/\d\d/,ai=/\d{3}/,si=/\d{4}/,li=/[+-]?\d{6}/,ci=/\d\d?/,ui=/\d\d\d\d?/,di=/\d\d\d\d\d\d?/,hi=/\d{1,3}/,pi=/\d{1,4}/,fi=/[+-]?\d{1,6}/,mi=/\d+/,gi=/[+-]?\d+/,vi=/Z|[+-]\d\d:?\d\d/gi,yi=/Z|[+-]\d\d(?::?\d\d)?/gi,bi=/[+-]?\d+(\.\d{1,3})?/,_i=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,wi={},xi={},Ci=0,ki=1,Si=2,Ti=3,Di=4,Mi=5,$i=6,Li=7,Ai=8;N("M",["MM",2],"Mo",function(){return this.month()+1}),N("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),N("MMMM",0,0,function(e){return this.localeData().months(this,e)}),D("month","M"),H("M",ci),H("MM",ci,oi),H("MMM",function(e,t){return t.monthsShortRegex(e)}),H("MMMM",function(e,t){return t.monthsRegex(e)}),U(["M","MM"],function(e,t){t[ki]=y(e)-1}),U(["MMM","MMMM"],function(e,t,n,i){var r=n._locale.monthsParse(e,i,n._strict);null!=r?t[ki]=r:u(n).invalidMonth=e});var Ri=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Ii="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ji="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ei=_i,Ni=_i,Pi={};t.suppressDeprecationWarnings=!1;var Oi=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Vi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Fi=/Z|[+-]\d\d(?::?\d\d)?/,Hi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],zi=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Bi=/^\/?Date\((\-?\d+)/i;t.createFromInputFallback=ae("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),N("Y",0,0,function(){var e=this.year();return 9999>=e?""+e:"+"+e}),N(0,["YY",2],0,function(){return this.year()%100}),N(0,["YYYY",4],0,"year"),N(0,["YYYYY",5],0,"year"),N(0,["YYYYYY",6,!0],0,"year"),D("year","y"),H("Y",gi),H("YY",ci,oi),H("YYYY",pi,si),H("YYYYY",fi,li),H("YYYYYY",fi,li),U(["YYYYY","YYYYYY"],Ci),U("YYYY",function(e,n){n[Ci]=2===e.length?t.parseTwoDigitYear(e):y(e)}),U("YY",function(e,n){n[Ci]=t.parseTwoDigitYear(e)}),U("Y",function(e,t){t[Ci]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return y(e)+(y(e)>68?1900:2e3)};var Wi=A("FullYear",!1);t.ISO_8601=function(){};var Ui=ae("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Ae.apply(null,arguments);return this.isValid()&&e.isValid()?this>e?this:e:h()}),qi=ae("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Ae.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:h()}),Gi=function(){return Date.now?Date.now():+new Date};Pe("Z",":"),Pe("ZZ",""),H("Z",yi),H("ZZ",yi),U(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Oe(yi,e)});var Yi=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Xi=/(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ki=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Ze.fn=Ee.prototype;var Ji=nt(1,"add"),Zi=nt(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Qi=ae("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});N(0,["gg",2],0,function(){return this.weekYear()%100}),N(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Et("gggg","weekYear"),Et("ggggg","weekYear"),Et("GGGG","isoWeekYear"),Et("GGGGG","isoWeekYear"),D("weekYear","gg"),D("isoWeekYear","GG"),H("G",gi),H("g",gi),H("GG",ci,oi),H("gg",ci,oi),H("GGGG",pi,si),H("gggg",pi,si),H("GGGGG",fi,li),H("ggggg",fi,li),q(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,i){t[i.substr(0,2)]=y(e)}),q(["gg","GG"],function(e,n,i,r){n[r]=t.parseTwoDigitYear(e)}),N("Q",0,"Qo","quarter"),D("quarter","Q"),H("Q",ri),U("Q",function(e,t){t[ki]=3*(y(e)-1)}),N("w",["ww",2],"wo","week"),N("W",["WW",2],"Wo","isoWeek"),D("week","w"),D("isoWeek","W"),H("w",ci),H("ww",ci,oi),H("W",ci),H("WW",ci,oi),q(["w","ww","W","WW"],function(e,t,n,i){t[i.substr(0,1)]=y(e)});var er={dow:0,doy:6};N("D",["DD",2],"Do","date"),D("date","D"),H("D",ci),H("DD",ci,oi),H("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),U(["D","DD"],Si),U("Do",function(e,t){t[Si]=y(e.match(ci)[0],10)});var tr=A("Date",!0);N("d",0,"do","day"),N("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),N("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),N("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),N("e",0,0,"weekday"),N("E",0,0,"isoWeekday"),D("day","d"),D("weekday","e"),D("isoWeekday","E"),H("d",ci),H("e",ci),H("E",ci),H("dd",_i),H("ddd",_i),H("dddd",_i),q(["dd","ddd","dddd"],function(e,t,n,i){var r=n._locale.weekdaysParse(e,i,n._strict);null!=r?t.d=r:u(n).invalidWeekday=e}),q(["d","e","E"],function(e,t,n,i){t[i]=y(e)});var nr="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),ir="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),rr="Su_Mo_Tu_We_Th_Fr_Sa".split("_");N("DDD",["DDDD",3],"DDDo","dayOfYear"),D("dayOfYear","DDD"),H("DDD",hi),H("DDDD",ai),U(["DDD","DDDD"],function(e,t,n){n._dayOfYear=y(e)}),N("H",["HH",2],0,"hour"),N("h",["hh",2],0,rn),N("hmm",0,0,function(){return""+rn.apply(this)+E(this.minutes(),2)}),N("hmmss",0,0,function(){return""+rn.apply(this)+E(this.minutes(),2)+E(this.seconds(),2)}),N("Hmm",0,0,function(){return""+this.hours()+E(this.minutes(),2)}),N("Hmmss",0,0,function(){return""+this.hours()+E(this.minutes(),2)+E(this.seconds(),2)}),on("a",!0),on("A",!1),D("hour","h"),H("a",an),H("A",an),H("H",ci),H("h",ci),H("HH",ci,oi),H("hh",ci,oi),H("hmm",ui),H("hmmss",di),H("Hmm",ui),H("Hmmss",di),U(["H","HH"],Ti),U(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),U(["h","hh"],function(e,t,n){t[Ti]=y(e),u(n).bigHour=!0}),U("hmm",function(e,t,n){var i=e.length-2;t[Ti]=y(e.substr(0,i)),t[Di]=y(e.substr(i)),u(n).bigHour=!0}),U("hmmss",function(e,t,n){var i=e.length-4,r=e.length-2;t[Ti]=y(e.substr(0,i)),t[Di]=y(e.substr(i,2)),t[Mi]=y(e.substr(r)),u(n).bigHour=!0}),U("Hmm",function(e,t,n){var i=e.length-2;t[Ti]=y(e.substr(0,i)),t[Di]=y(e.substr(i))}),U("Hmmss",function(e,t,n){var i=e.length-4,r=e.length-2;t[Ti]=y(e.substr(0,i)),t[Di]=y(e.substr(i,2)),t[Mi]=y(e.substr(r))});var or=/[ap]\.?m?\.?/i,ar=A("Hours",!0);N("m",["mm",2],0,"minute"),D("minute","m"),H("m",ci),H("mm",ci,oi),U(["m","mm"],Di);var sr=A("Minutes",!1);N("s",["ss",2],0,"second"),D("second","s"),H("s",ci),H("ss",ci,oi),U(["s","ss"],Mi);var lr=A("Seconds",!1);N("S",0,0,function(){return~~(this.millisecond()/100)}),N(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),N(0,["SSS",3],0,"millisecond"),N(0,["SSSS",4],0,function(){return 10*this.millisecond()}),N(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),N(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),N(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),N(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),N(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),D("millisecond","ms"),H("S",hi,ri),H("SS",hi,oi),H("SSS",hi,ai);var cr;for(cr="SSSS";cr.length<=9;cr+="S")H(cr,mi);for(cr="S";cr.length<=9;cr+="S")U(cr,cn);var ur=A("Milliseconds",!1);N("z",0,0,"zoneAbbr"),N("zz",0,0,"zoneName");var dr=m.prototype;dr.add=Ji,dr.calendar=rt,dr.clone=ot,dr.diff=ht,dr.endOf=kt,dr.format=gt,dr.from=vt,dr.fromNow=yt,dr.to=bt,dr.toNow=_t,dr.get=j,dr.invalidAt=It,dr.isAfter=at,dr.isBefore=st,dr.isBetween=lt,dr.isSame=ct,dr.isSameOrAfter=ut,dr.isSameOrBefore=dt,dr.isValid=At,dr.lang=Qi,dr.locale=wt,dr.localeData=xt,dr.max=qi,dr.min=Ui,dr.parsingFlags=Rt,dr.set=j,dr.startOf=Ct,dr.subtract=Zi,dr.toArray=Mt,dr.toObject=$t,dr.toDate=Dt,dr.toISOString=mt,dr.toJSON=Lt,dr.toString=ft,dr.unix=Tt,dr.valueOf=St,dr.creationData=jt,dr.year=Wi,dr.isLeapYear=fe,dr.weekYear=Nt,dr.isoWeekYear=Pt,dr.quarter=dr.quarters=zt,dr.month=Q,dr.daysInMonth=ee,dr.week=dr.weeks=qt,dr.isoWeek=dr.isoWeeks=Gt,dr.weeksInYear=Vt,dr.isoWeeksInYear=Ot,dr.date=tr,dr.day=dr.days=Qt,dr.weekday=en,dr.isoWeekday=tn,dr.dayOfYear=nn,dr.hour=dr.hours=ar,dr.minute=dr.minutes=sr,dr.second=dr.seconds=lr,dr.millisecond=dr.milliseconds=ur,dr.utcOffset=He,dr.utc=Be,dr.local=We,dr.parseZone=Ue,dr.hasAlignedHourOffset=qe,dr.isDST=Ge,dr.isDSTShifted=Ye,dr.isLocal=Xe,dr.isUtcOffset=Ke,dr.isUtc=Je,dr.isUTC=Je,dr.zoneAbbr=un,dr.zoneName=dn,dr.dates=ae("dates accessor is deprecated. Use date instead.",tr),dr.months=ae("months accessor is deprecated. Use month instead",Q),dr.years=ae("years accessor is deprecated. Use year instead",Wi),dr.zone=ae("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",ze);var hr=dr,pr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},fr={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},mr="Invalid date",gr="%d",vr=/\d{1,2}/,yr={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},br=_.prototype;br._calendar=pr,br.calendar=fn,br._longDateFormat=fr,br.longDateFormat=mn,br._invalidDate=mr,br.invalidDate=gn,br._ordinal=gr,br.ordinal=vn,br._ordinalParse=vr,br.preparse=yn,br.postformat=yn,br._relativeTime=yr,br.relativeTime=bn,br.pastFuture=_n,br.set=wn,br.months=X,br._months=Ii,br.monthsShort=K,br._monthsShort=ji,br.monthsParse=J,br._monthsRegex=Ni,br.monthsRegex=ne,br._monthsShortRegex=Ei,br.monthsShortRegex=te,br.week=Bt,br._week=er,br.firstDayOfYear=Ut,br.firstDayOfWeek=Wt,br.weekdays=Xt,br._weekdays=nr,br.weekdaysMin=Jt,br._weekdaysMin=rr,br.weekdaysShort=Kt,br._weekdaysShort=ir,br.weekdaysParse=Zt,br.isPM=sn,br._meridiemParse=or,br.meridiem=ln,k("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===y(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),t.lang=ae("moment.lang is deprecated. Use moment.locale instead.",k),t.langData=ae("moment.langData is deprecated. Use moment.localeData instead.",T);var _r=Math.abs,wr=Vn("ms"),xr=Vn("s"),Cr=Vn("m"),kr=Vn("h"),Sr=Vn("d"),Tr=Vn("w"),Dr=Vn("M"),Mr=Vn("y"),$r=Hn("milliseconds"),Lr=Hn("seconds"),Ar=Hn("minutes"),Rr=Hn("hours"),Ir=Hn("days"),jr=Hn("months"),Er=Hn("years"),Nr=Math.round,Pr={s:45,m:45,h:22,d:26,M:11},Or=Math.abs,Vr=Ee.prototype;Vr.abs=$n,Vr.add=An,Vr.subtract=Rn,Vr.as=Pn,Vr.asMilliseconds=wr,Vr.asSeconds=xr,Vr.asMinutes=Cr,Vr.asHours=kr,Vr.asDays=Sr,Vr.asWeeks=Tr,Vr.asMonths=Dr,Vr.asYears=Mr,Vr.valueOf=On,Vr._bubble=jn,Vr.get=Fn,Vr.milliseconds=$r,Vr.seconds=Lr,Vr.minutes=Ar,Vr.hours=Rr,Vr.days=Ir,Vr.weeks=zn,Vr.months=jr,Vr.years=Er,Vr.humanize=qn,Vr.toISOString=Gn,Vr.toString=Gn,Vr.toJSON=Gn,Vr.locale=wt,Vr.localeData=xt,Vr.toIsoString=ae("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gn),Vr.lang=Qi,N("X",0,0,"unix"),N("x",0,0,"valueOf"),H("x",gi),H("X",bi),U("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),U("x",function(e,t,n){n._d=new Date(y(e))}),t.version="2.11.1",n(Ae),t.fn=hr,t.min=Ie,t.max=je,t.now=Gi,t.utc=l,t.unix=hn,t.months=kn,t.isDate=r,t.locale=k,t.invalid=h,t.duration=Ze,t.isMoment=g,t.weekdays=Tn,t.parseZone=pn,t.localeData=T,t.isDuration=Ne,t.monthsShort=Sn,t.weekdaysMin=Mn,t.defineLocale=S,t.weekdaysShort=Dn,t.normalizeUnits=M,t.relativeTimeThreshold=Un,t.prototype=hr;var Fr=t;return Fr})}).call(t,n(70)(e))},function(e,t,n){var i,r,o;!function(a){r=[n(85)],i=a,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(function(e){return e.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",LTS:"Ah点m分s秒",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY-MM-DD",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(e,t,n){var i=100*e+t;return 600>i?"凌晨":900>i?"早上":1130>i?"上午":1230>i?"中午":1800>i?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var t,n;return t=e().startOf("week"),n=this.unix()-t.unix()>=604800?"[下]":"[本]",0===this.minutes()?n+"dddAh点整":n+"dddAh点mm"},lastWeek:function(){var t,n;return t=e().startOf("week"),n=this.unix()<t.unix()?"[上]":"[本]",0===this.minutes()?n+"dddAh点整":n+"dddAh点mm"},sameElse:"LL"},ordinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}})})},function(e,t,n){var i;i=function(){var e=/@([^@\s]{1,30})(\s|$)/gi;return function(t,n){return t.replace(e,function(e,t,i){if(n[t]){var r=document.createElement("a");return r.href="community/user/"+t+"/shares",'<a href="'+r.href+'" data-href="community/user/'+t+'/shares" class="atted-user">@'+n[t]+"</a>"+i}return e})}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){return function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(45),n(90),n(91),n(92)],r=function(e,t,n,i){n.Hub.Config({showProcessingMessages:!1,tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},TeX:{equationNumbers:{autoNumber:"AMS"}}}),n.Hub.Startup.onload(),t.setOptions({renderer:new t.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(e){return e+" "}});var r=function o(i){i=e.defaults(i||{},{breaks:!1});var r={delay:50,preview:null,buffer:null,timeout:null,mjRunning:!1,oldText:null,Init:function(e){this.preview=e.preview,this.getText=e.getText,this.buffer=e.buffer,this.emptyText=e.emptyText,this.buffer.style.display="none",this.buffer.style.position="absolute",this.preMarked=e.preMarked,this.atArray=e.getAtArray},SwapBuffers:function(){var e=this.preview,t=this.buffer;this.buffer=e,this.preview=t,e.style.display="none",e.style.position="absolute",t.style.position="",t.style.display=""},Update:function(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(this.callback,this.delay)},CreatePreview:function(){if(o.timeout=null,!this.mjRunning){var e=this.getText();e!==this.oldtext&&(e=this.Escape(e),this.buffer.innerHTML=this.oldtext=e,this.mjRunning=!0,n.Hub.Queue(["Typeset",n.Hub,this.buffer],["PreviewDone",this],["resetEquationNumbers",n.InputJax.TeX]))}},PreviewDone:function(){var e;this.mjRunning=!1,e=this.buffer.innerHTML,e=e.replace(/^&gt;/gm,">"),this.preMarked&&(e=this.preMarked(e,this.atArray)),this.buffer.innerHTML=t(e||this.emptyText,i),$(this.buffer).addClass("markdown-buffer"),this.SwapBuffers()},Escape:function(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}};return r.callback=n.Callback(["CreatePreview",r]),r.callback.autoReset=!0,r};return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){(function(t){(function(){function t(e){this.tokens=[],this.tokens.links={},this.options=e||u.defaults,this.rules=d.normal,this.options.gfm&&(this.options.tables?this.rules=d.tables:this.rules=d.gfm)}function n(e,t){if(this.options=t||u.defaults,this.links=e,this.rules=h.normal,this.renderer=this.options.renderer||new i,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=h.breaks:this.rules=h.gfm:this.options.pedantic&&(this.rules=h.pedantic)}function i(e){this.options=e||{}}function r(e){this.tokens=[],this.token=null,this.options=e||u.defaults,this.options.renderer=this.options.renderer||new i,this.renderer=this.options.renderer,this.renderer.options=this.options}function o(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function a(e){return e.replace(/&([#\w]+);/g,function(e,t){return t=t.toLowerCase(),"colon"===t?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function s(e,t){return e=e.source,t=t||"",function n(i,r){return i?(r=r.source||r,r=r.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(i,r),n):new RegExp(e,t)}}function l(){}function c(e){for(var t,n,i=1;i<arguments.length;i++){t=arguments[i];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function u(e,n,i){if(i||"function"==typeof n){i||(i=n,n=null),n=c({},u.defaults,n||{});var a,s,l=n.highlight,d=0;try{a=t.lex(e,n)}catch(h){return i(h)}s=a.length;var p=function(e){if(e)return n.highlight=l,i(e);var t;try{t=r.parse(a,n)}catch(o){e=o}return n.highlight=l,e?i(e):i(null,t)};if(!l||l.length<3)return p();if(delete n.highlight,!s)return p();for(;d<a.length;d++)!function(e){return"code"!==e.type?--s||p():l(e.text,e.lang,function(t,n){return t?p(t):null==n||n===e.text?--s||p():(e.text=n,e.escaped=!0,void(--s||p()))})}(a[d])}else try{return n&&(n=c({},u.defaults,n)),r.parse(t.lex(e,n),n)}catch(h){if(h.message+="\nPlease report this to https://github.com/chjj/marked.",(n||u.defaults).silent)return"<p>An error occured:</p><pre>"+o(h.message+"",!0)+"</pre>";throw h}}var d={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};d.bullet=/(?:[*+-]|\d+\.)/,d.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,d.item=s(d.item,"gm")(/bull/g,d.bullet)(),d.list=s(d.list)(/bull/g,d.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+d.def.source+")")(),d.blockquote=s(d.blockquote)("def",d.def)(),d._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",d.html=s(d.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,d._tag)(),d.paragraph=s(d.paragraph)("hr",d.hr)("heading",d.heading)("lheading",d.lheading)("blockquote",d.blockquote)("tag","<"+d._tag)("def",d.def)(),d.normal=c({},d),d.gfm=c({},d.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),d.gfm.paragraph=s(d.paragraph)("(?!","(?!"+d.gfm.fences.source.replace("\\1","\\2")+"|"+d.list.source.replace("\\1","\\3")+"|")(),d.tables=c({},d.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=d,t.lex=function(e,n){var i=new t(n);return i.lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(e,t,n){for(var i,r,o,a,s,l,c,u,h,e=e.replace(/^ +$/gm,"");e;)if((o=this.rules.newline.exec(e))&&(e=e.substring(o[0].length),o[0].length>1&&this.tokens.push({type:"space"})),o=this.rules.code.exec(e))e=e.substring(o[0].length),o=o[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?o:o.replace(/\n+$/,"")});else if(o=this.rules.fences.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"code",lang:o[2],text:o[3]||""});else if(o=this.rules.heading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:o[1].length,text:o[2]});else if(t&&(o=this.rules.nptable.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/\n$/,"").split("\n")},u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=l.cells[u].split(/ *\| */);this.tokens.push(l)}else if(o=this.rules.lheading.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"heading",depth:"="===o[2]?1:2,text:o[1]});else if(o=this.rules.hr.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"hr"});else if(o=this.rules.blockquote.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"blockquote_start"}),o=o[0].replace(/^ *> ?/gm,""),this.token(o,t,!0),this.tokens.push({type:"blockquote_end"});else if(o=this.rules.list.exec(e)){for(e=e.substring(o[0].length),a=o[2],this.tokens.push({type:"list_start",ordered:a.length>1}),o=o[0].match(this.rules.item),i=!1,h=o.length,u=0;h>u;u++)l=o[u],c=l.length,l=l.replace(/^ *([*+-]|\d+\.) +/,""),~l.indexOf("\n ")&&(c-=l.length,l=this.options.pedantic?l.replace(/^ {1,4}/gm,""):l.replace(new RegExp("^ {1,"+c+"}","gm"),"")),this.options.smartLists&&u!==h-1&&(s=d.bullet.exec(o[u+1])[0],a===s||a.length>1&&s.length>1||(e=o.slice(u+1).join("\n")+e,u=h-1)),r=i||/\n\n(?!\s*$)/.test(l),u!==h-1&&(i="\n"===l.charAt(l.length-1),r||(r=i)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(o=this.rules.html.exec(e))e=e.substring(o[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===o[1]||"script"===o[1]||"style"===o[1]),text:o[0]});else if(!n&&t&&(o=this.rules.def.exec(e)))e=e.substring(o[0].length),this.tokens.links[o[1].toLowerCase()]={href:o[2],title:o[3]};else if(t&&(o=this.rules.table.exec(e))){for(e=e.substring(o[0].length),l={type:"table",header:o[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:o[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:o[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<l.align.length;u++)/^ *-+: *$/.test(l.align[u])?l.align[u]="right":/^ *:-+: *$/.test(l.align[u])?l.align[u]="center":/^ *:-+ *$/.test(l.align[u])?l.align[u]="left":l.align[u]=null;for(u=0;u<l.cells.length;u++)l.cells[u]=l.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(t&&(o=this.rules.paragraph.exec(e)))e=e.substring(o[0].length),this.tokens.push({type:"paragraph",text:"\n"===o[1].charAt(o[1].length-1)?o[1].slice(0,-1):o[1]});else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),this.tokens.push({type:"text",text:o[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var h={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};h._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,h._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,h.link=s(h.link)("inside",h._inside)("href",h._href)(),h.reflink=s(h.reflink)("inside",h._inside)(),h.normal=c({},h),h.pedantic=c({},h.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),h.gfm=c({},h.normal,{escape:s(h.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:s(h.text)("]|","~]|")("|","|https?://|")()}),h.breaks=c({},h.gfm,{br:s(h.br)("{2,}","*")(),text:s(h.gfm.text)("{2,}","*")()}),n.rules=h,n.output=function(e,t,i){var r=new n(t,i);return r.output(e)},n.prototype.output=function(e){for(var t,n,i,r,a="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),a+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),"@"===r[2]?(n=":"===r[1].charAt(6)?this.mangle(r[1].substring(7)):this.mangle(r[1]),i=this.mangle("mailto:")+n):(n=o(r[1]),i=n),a+=this.renderer.link(i,null,n);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),e=e.substring(r[0].length),a+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):o(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),
this.inLink=!0,a+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),t=this.links[t.toLowerCase()],!t||!t.href){a+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,a+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),a+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),a+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),a+=this.renderer.codespan(o(r[2],!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),a+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),a+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),a+=this.renderer.text(o(this.smartypants(r[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(r[0].length),n=o(r[1]),i=n,a+=this.renderer.link(i,null,n);return a},n.prototype.outputLink=function(e,t){var n=o(t.href),i=t.title?o(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,i,this.output(e[1])):this.renderer.image(n,i,o(e[1]))},n.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},n.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",i=e.length,r=0;i>r;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},i.prototype.code=function(e,t,n){if(this.options.highlight){var i=this.options.highlight(e,t);null!=i&&i!==e&&(n=!0,e=i)}return t?'<pre><code class="'+this.options.langPrefix+o(t,!0)+'">'+(n?e:o(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:o(e,!0))+"\n</code></pre>"},i.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},i.prototype.html=function(e){return e},i.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},i.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},i.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},i.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},i.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},i.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},i.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},i.prototype.tablecell=function(e,t){var n=t.header?"th":"td",i=t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">";return i+e+"</"+n+">\n"},i.prototype.strong=function(e){return"<strong>"+e+"</strong>"},i.prototype.em=function(e){return"<em>"+e+"</em>"},i.prototype.codespan=function(e){return"<code>"+e+"</code>"},i.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},i.prototype.del=function(e){return"<del>"+e+"</del>"},i.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(a(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(r){return""}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},i.prototype.image=function(e,t,n){var i='<img src="'+e+'" alt="'+n+'"';return t&&(i+=' title="'+t+'"'),i+=this.options.xhtml?"/>":">"},i.prototype.text=function(e){return e},r.parse=function(e,t,n){var i=new r(t,n);return i.parse(e)},r.prototype.parse=function(e){this.inline=new n(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},r.prototype.next=function(){return this.token=this.tokens.pop()},r.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},r.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},r.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,i,r,o="",a="";for(n="",e=0;e<this.token.header.length;e++)i={header:!0,align:this.token.align[e]},n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});a+=this.renderer.tablerow(n)}return this.renderer.table(o,a);case"blockquote_start":for(var a="";"blockquote_end"!==this.next().type;)a+=this.tok();return this.renderer.blockquote(a);case"list_start":for(var a="",s=this.token.ordered;"list_end"!==this.next().type;)a+=this.tok();return this.renderer.list(a,s);case"list_item_start":for(var a="";"list_item_end"!==this.next().type;)a+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(a);case"loose_item_start":for(var a="";"list_item_end"!==this.next().type;)a+=this.tok();return this.renderer.listitem(a);case"html":var l=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(l);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.exec=l,u.options=u.setOptions=function(e){return c(u.defaults,e),u},u.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new i,xhtml:!1},u.Parser=r,u.parser=r.parse,u.Renderer=i,u.Lexer=t,u.lexer=t.lex,u.InlineLexer=n,u.inlineLexer=n.output,u.parse=u,e.exports=u}).call(function(){return this||("undefined"!=typeof window?window:t)}())}).call(t,function(){return this}())},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_91__},function(e,t,n){var i,r;i=[n(45),n(93)],r=function(e,t){var n,i=e.clone(t.whiteList);return i.th.push("rowspan"),i.a.push("data-href"),n=new t.FilterXSS({whiteList:i}),window.xss=t,function(e){return n.process(e||"")}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){function i(e,t){var n=new s(t);return n.process(e)}var r,o=n(94),a=n(101),s=n(102);t=e.exports=i,t.FilterXSS=s;for(var l in o)t[l]=o[l];for(var l in a)t[l]=a[l];r=function(){return e.exports}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)),"undefined"!=typeof window&&(window.filterXSS=e.exports)},function(e,t,n){function i(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","colspan","align","valign"],tfoot:["align","valign"],th:["width","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}function r(e,t,n){}function o(e,t,n){}function a(e,t,n){}function s(e,t,n){}function l(e){return e.replace(k,"&lt;").replace(S,"&gt;")}function c(e,t,n,i){if(i=i||C,n=m(n),"href"===t||"src"===t){if(n=x.trim(n),"#"===n)return"#";if("http://"!==n.substr(0,7)&&"https://"!==n.substr(0,8)&&"mailto:"!==n.substr(0,7)&&"#"!==n[0]&&"/"!==n[0])return""}else if("background"===t){if(A.lastIndex=0,A.test(n))return""}else if("style"===t){if(R.lastIndex=0,R.test(n))return"";if(I.lastIndex=0,I.test(n)&&(A.lastIndex=0,A.test(n)))return"";n=i.process(n)}return n=g(n)}function u(e){return e.replace(T,"&quot;")}function d(e){return e.replace(D,'"')}function h(e){return e.replace(M,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function p(e){return e.replace($,":").replace(L," ")}function f(e){for(var t="",n=0,i=e.length;i>n;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return x.trim(t)}function m(e){return e=d(e),e=h(e),e=p(e),e=f(e)}function g(e){return e=u(e),e=l(e)}function v(){return""}function y(e,t){function n(t){return i?!0:-1!==x.indexOf(e,t)}"function"!=typeof t&&(t=function(){});var i=!Array.isArray(e),r=[],o=!1;return{onIgnoreTag:function(e,i,a){if(n(e)){if(a.isClosing){var s="[/removed]",l=a.position+s.length;return r.push([o!==!1?o:a.position,l]),o=!1,s}return o||(o=a.position),"[removed]"}return t(e,i,a)},remove:function(e){var t="",n=0;return x.forEach(r,function(i){t+=e.slice(n,i[0]),n=i[1]}),t+=e.slice(n)}}}function b(e){return e.replace(j,"")}function _(e){var t=e.split("");return t=t.filter(function(e){var t=e.charCodeAt(0);return 127===t?!1:31>=t?10===t||13===t?!0:!1:!0}),t.join("")}var w=n(95).FilterCSS,x=n(100),C=new w,k=/</g,S=/>/g,T=/"/g,D=/&quot;/g,M=/&#([a-zA-Z0-9]*);?/gim,$=/&colon;?/gim,L=/&newline;?/gim,A=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,R=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,I=/u\s*r\s*l\s*\(.*/gi,j=/<!--[\s\S]*?-->/g;t.whiteList=i(),t.getDefaultWhiteList=i,t.onTag=r,t.onIgnoreTag=o,t.onTagAttr=a,t.onIgnoreTagAttr=s,t.safeAttrValue=c,t.escapeHtml=l,t.escapeQuote=u,t.unescapeQuote=d,t.escapeHtmlEntities=h,t.escapeDangerHtml5Entities=p,t.clearNonPrintableCharacter=f,t.friendlyAttrValue=m,t.escapeAttrValue=g,t.onIgnoreTagStripAll=v,t.StripTagBody=y,t.stripCommentTag=b,t.stripBlankChar=_,t.cssFilter=C},function(e,t,n){function i(e,t){var n=new a(t);return n.process(e)}var r,o=n(96),a=n(97);t=e.exports=i,t.FilterCSS=a;for(var s in o)t[s]=o[s];r=function(){return e.exports}.call(t,n,t,e),!(void 0!==r&&(e.exports=r)),"undefined"!=typeof window&&(window.filterCSS=e.exports)},function(e,t){function n(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e["float"]=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function i(e,t,n){}function r(e,t,n){}t.whiteList=n(),t.getDefaultWhiteList=n,t.onAttr=i,t.onIgnoreAttr=r},function(e,t,n){function i(e){return void 0===e||null===e}function r(e){e=e||{},e.whiteList=e.whiteList||o.whiteList,e.onAttr=e.onAttr||o.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||o.onIgnoreAttr,this.options=e}var o=n(96),a=n(98);n(99);r.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,n=t.options,r=n.whiteList,o=n.onAttr,s=n.onIgnoreAttr,l=a(e,function(e,t,n,a,l){var c=r[n],u=!1;c===!0?u=c:"function"==typeof c?u=c(a):c instanceof RegExp&&(u=c.test(a)),u!==!0&&(u=!1);var d={position:t,sourcePosition:e,source:l,isWhite:u};if(u){var h=o(n,a,d);return i(h)?n+":"+a:h}var h=s(n,a,d);return i(h)?void 0:h});return l},e.exports=r},function(e,t,n){function i(e,t){function n(){if(!o){var n=r.trim(e.slice(a,s)),i=n.indexOf(":");if(-1!==i){var c=r.trim(n.slice(0,i)),u=r.trim(n.slice(i+1));if(c){var d=t(a,l.length,c,u,n);d&&(l+=d+"; ")}}}a=s+1}e=r.trimRight(e),";"!==e[e.length-1]&&(e+=";");for(var i=e.length,o=!1,a=0,s=0,l="";i>s;s++){var c=e[s];if("/"===c&&"*"===e[s+1]){var u=e.indexOf("*/",s+2);if(-1===u)break;s=u+1,a=s+1,o=!1}else"("===c?o=!0:")"===c?o=!1:";"===c?o||n():"\n"===c&&n()}return r.trim(l)}var r=n(99);e.exports=i},function(e,t){e.exports={indexOf:function(e,t){var n,i;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var i,r;if(Array.prototype.forEach)return e.forEach(t,n);for(i=0,r=e.length;r>i;i++)t.call(n,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}}},function(e,t){e.exports={indexOf:function(e,t){var n,i;if(Array.prototype.indexOf)return e.indexOf(t);for(n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},forEach:function(e,t,n){var i,r;if(Array.prototype.forEach)return e.forEach(t,n);for(i=0,r=e.length;r>i;i++)t.call(n,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")}}},function(e,t,n){function i(e){var t=e.indexOf(" ");if(-1===t)var n=e.slice(1,-1);else var n=e.slice(1,t+1);return n=d.trim(n).toLowerCase(),"/"===n.slice(0,1)&&(n=n.slice(1)),"/"===n.slice(-1)&&(n=n.slice(0,-1)),n}function r(e){return"</"===e.slice(0,2)}function o(e,t,n){"user strict";var o="",a=0,s=!1,l=!1,c=0,u=e.length,d="",h="";for(c=0;u>c;c++){var p=e.charAt(c);if(s===!1){if("<"===p){s=c;continue}}else if(l===!1){if("<"===p){o+=n(e.slice(a,c)),s=c,a=c;continue}if(">"===p){o+=n(e.slice(a,s)),d=e.slice(s,c+1),h=i(d),o+=t(s,o.length,h,d,r(d)),a=c+1,s=!1;continue}if(('"'===p||"'"===p)&&"="===e.charAt(c-1)){l=p;continue}}else if(p===l){l=!1;continue}}return a<e.length&&(o+=n(e.substr(a))),o}function a(e,t){"user strict";function n(e,n){if(e=d.trim(e),e=e.replace(h,"").toLowerCase(),!(e.length<1)){var i=t(e,n||"");i&&r.push(i)}}for(var i=0,r=[],o=!1,a=e.length,c=0;a>c;c++){var p,f,m=e.charAt(c);if(o!==!1||"="!==m)if(o===!1||c!==i||'"'!==m&&"'"!==m||"="!==e.charAt(c-1))if(" "!==m);else{if(o===!1){if(f=s(e,c),-1===f){p=d.trim(e.slice(i,c)),n(p),o=!1,i=c+1;continue}c=f-1;continue}if(f=l(e,c-1),-1===f){p=d.trim(e.slice(i,c)),p=u(p),n(o,p),o=!1,i=c+1;continue}}else{if(f=e.indexOf(m,c+1),-1===f)break;p=d.trim(e.slice(i+1,f)),n(o,p),o=!1,c=f,i=c+1}else o=e.slice(i,c),i=c+1}return i<e.length&&(o===!1?n(e.slice(i)):n(o,u(d.trim(e.slice(i))))),d.trim(r.join(" "))}function s(e,t){for(;t<e.length;t++){var n=e[t];if(" "!==n)return"="===n?t:-1}}function l(e,t){for(;t>0;t--){var n=e[t];if(" "!==n)return"="===n?t:-1}}function c(e){return'"'===e[0]&&'"'===e[e.length-1]||"'"===e[0]&&"'"===e[e.length-1]?!0:!1}function u(e){return c(e)?e.substr(1,e.length-2):e}var d=n(100),h=/[^a-zA-Z0-9_:\.\-]/gim;t.parseTag=o,t.parseAttr=a},function(e,t,n){function i(e){return void 0===e||null===e}function r(e){var t=e.indexOf(" ");if(-1===t)return{html:"",closing:"/"===e[e.length-2]};e=d.trim(e.slice(t+1,-1));var n="/"===e[e.length-1];return n&&(e=d.trim(e.slice(0,-1))),{html:e,closing:n}}function o(e){e=e||{},e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=s.onIgnoreTagStripAll),e.whiteList=e.whiteList||s.whiteList,e.onTag=e.onTag||s.onTag,e.onTagAttr=e.onTagAttr||s.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||s.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||s.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||s.safeAttrValue,e.escapeHtml=e.escapeHtml||s.escapeHtml,e.css=e.css||{},this.options=e,this.cssFilter=new a(e.css)}var a=n(95).FilterCSS,s=n(94),l=n(101),c=l.parseTag,u=l.parseAttr,d=n(100);o.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,n=t.options,o=n.whiteList,a=n.onTag,l=n.onIgnoreTag,h=n.onTagAttr,p=n.onIgnoreTagAttr,f=n.safeAttrValue,m=n.escapeHtml,g=t.cssFilter;n.stripBlankChar&&(e=s.stripBlankChar(e)),n.allowCommentTag||(e=s.stripCommentTag(e));var v=!1;if(n.stripIgnoreTagBody){var v=s.StripTagBody(n.stripIgnoreTagBody,l);l=v.onIgnoreTag}var y=c(e,function(e,t,n,s,c){var v={sourcePosition:e,position:t,isClosing:c,isWhite:n in o},y=a(n,s,v);if(!i(y))return y;if(v.isWhite){if(v.isClosing)return"</"+n+">";var b=r(s),_=o[n],w=u(b.html,function(e,t){var r=-1!==d.indexOf(_,e),o=h(n,e,t,r);if(!i(o))return o;if(r)return t=f(n,e,t,g),t?e+'="'+t+'"':e;var o=p(n,e,t,r);return i(o)?void 0:o}),s="<"+n;return w&&(s+=" "+w),b.closing&&(s+=" /"),s+=">"}var y=l(n,s,v);return i(y)?m(s):y},m);return v&&(y=v.remove(y)),y},e.exports=o},function(e,t,n){var i,r;i=[n(76)],r=function(e){return e.NestedModel.extend({urlRoot:window.getapi("mercury_community","/w/user"),appUrl:function(){return"community/user/"+this.id+"/shares"},parse:function(e){return 200===e.code?e.data:e||{}},threadsUrl:function(){return window.getapi("mercury_community","/w/user/")},profileUrl:function(){return window.getapi("mercury_community","/user/")+this.id},mallUrl:function(){return"community/mall"},follow:function(){return $.ajax({url:this.profileUrl()+"/follow",type:"PUT"}).done(function(e){e.data&&200===e.code})},userReputations:function(){return $.ajax({url:window.getapi("mercury_community","/w/user/"+this.id+"/reputations"),type:"GET"})},userFollowers:function(){return $.ajax({url:window.getapi("mercury_community","/w/user/"+this.id+"/follow"),type:"GET"})},userStatic:function(){return $.ajax({url:window.getapi("mercury_community","/w/user/"+this.id+"/statistics"),type:"GET"})},orderPoints:function(e,t){return $.ajax({url:window.getapi("mercury_community","/user/"+this.id+"/orders"),type:t,contentType:"application/json",data:JSON.stringify(e)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)"timeline"===resource_name&&(__p+="\n<div>\n    ",("user_follow"===event_type||"user_follow_delete"===event_type)&&(__p+="    \n        <span>"+(null==(__t=msg)?"":__t)+'</span>\n        <a href="'+(null==(__t=followeeUrl)?"":__t)+'" data-href="'+(null==(__t=followeeUrl)?"":__t)+'" title="'+(null==(__t=followee.profile.nickname)?"":__t)+'" class="titlename">'+(null==(__t=followee.profile.nickname)?"":__t)+'</a>\n        <span class="time">&nbsp;&nbsp;&nbsp;&nbsp;'+(null==(__t=time)?"":__t)+"</span>\n    "),__p+="\n\n    ","honor"===event_type&&(__p+="    \n        <span>"+(null==(__t=msg)?"":__t)+'</span>\n        <span class="time">&nbsp;&nbsp;&nbsp;&nbsp;'+(null==(__t=time)?"":__t)+"</span>\n    "),__p+="\n    \n    ",("thread"===event_type||"thread_retrieve"===event_type||"thread_discuss"===event_type||"thread_discuss_retrieve"===event_type||"thread_up"===event_type||"thread_up_delete"===event_type||"thread_collect"===event_type||"thread_collect_delete"===event_type||"comment"===event_type||"comment_retrieve"===event_type||"comment_discuss"===event_type||"comment_discuss_retrieve"===event_type||"comment_up"===event_type||"comment_up_delete"===event_type||"comment_collect"===event_type||"comment_collect_delete"===event_type||"thread_discuss_follow"===event_type||"thread_discuss_follow_delete"===event_type||"thread_fork"===event_type)&&(__p+="    \n        <div>\n            <span>"+(null==(__t=msg)?"":__t)+"</span>\n\n            ","strategy"===meta.type&&(__p+='\n            <span class="label green">策略</span>\n            '),__p+="\n            ","discuss"!==meta.type||"comment"!==event_type&&"comment_retrieve"!==event_type&&"comment_discuss"!==event_type&&"comment_discuss_retrieve"!==event_type&&"comment_up"!==event_type&&"comment_up_delete"!==event_type&&"comment_collect"!==event_type&&"comment_collect_delete"!==event_type?"discuss"===meta.type&&(__p+='\n            <span class="label purple">问答</span>\n            '):__p+='\n            <span class="label purple">评论</span>\n            ',__p+="\n            ","research"===meta.type&&(__p+='    \n            <span class="label gray">研究</span>\n            '),__p+='\n\n            <span class="time">&nbsp;&nbsp;&nbsp;&nbsp;'+(null==(__t=time)?"":__t)+'</span>\n        </div>\n        <a href="'+(null==(__t=url)?"":__t)+'" data-href="'+(null==(__t=url)?"":__t)+'" title="'+__e(title)+'" class="titlename">'+__e(title)+"</a>\n    "),__p+="\n\n    ",("thread"===event_type||"thread_retrieve"===event_type||"thread_discuss"===event_type||"thread_up"===event_type||"thread_up_delete"===event_type||"thread_collect"===event_type||"thread_collect_delete"===event_type||"thread_discuss_follow"===event_type||"thread_discuss_follow_delete"===event_type||"thread_fork"===event_type)&&(__p+=' \n        <a class="desc" style="display: -webkit-box;">'+__e(summary)+"</a>\n     "),__p+="\n    ",("thread_discuss_retrieve"===event_type||"comment_discuss_retrieve"===event_type)&&(__p+='\n        <a class="desc">[很抱歉，该帖已被原作者删除]</a>\n    '),__p+="\n    ",("comment"===event_type||"comment_retrieve"===event_type||"comment_discuss"===event_type||"comment_up"===event_type||"comment_up_delete"===event_type||"comment_collect"===event_type||"comment_collect_delete"===event_type)&&(__p+='\n        \n        <a class="desc content" style="display: -webkit-box;">'+__e(comments[0].content)+'</a>\n        <div class="buffer"></div>\n    '),__p+=" \n</div>\n"),__p+="\n\n","timeline"!==resource_name&&(__p+="\n<div>\n    <div>\n        ","threads"===resource_name&&"strategy"===meta.type&&(__p+='\n        <span>分享了</span>\n        <span class="label green">策略</span>\n        '),__p+=" \n        ","threads"===resource_name&&"discuss"===meta.type&&(__p+='\n        <span>发布了</span>\n        <span class="label purple">讨论</span>\n        '),__p+="  \n        ","threads"===resource_name&&"research"===meta.type&&(__p+='\n        <span>分享了</span>\n        <span class="label gray">研究</span>\n        '),__p+="  \n\n        ","comments"===resource_name&&(__p+="\n\n            ","strategy"===meta.type&&(__p+='\n                <span>评论了</span>\n                <span class="label green">策略</span>\n                '),__p+="\n                ","discuss"===meta.type&&(__p+='\n                <span>回复了</span>\n                <span class="label purple">问答</span>\n                '),__p+="\n                ","research"===meta.type&&(__p+='    \n                <span>评论了</span>\n                <span class="label gray">研究</span>\n            '),__p+="\n\n        "),__p+=" \n\n        ","collects"===resource_name&&(__p+="\n                <span>收藏了</span>\n            ","comment"===type?__p+='\n                <span class="label purple">评论</span>\n            ':(__p+=" \n                ","strategy"===meta.type&&(__p+='\n                    <span class="label green">策略</span>\n                    '),__p+="\n                    ","discuss"===meta.type&&(__p+='\n                    <span class="label purple">问答</span>\n                    '),__p+="\n                    ","research"===meta.type&&(__p+='    \n                    <span class="label gray">研究</span>\n                '),__p+="\n            "),__p+=" \n\n        "),__p+=' \n\n        <span class="time">&nbsp;&nbsp;&nbsp;&nbsp;'+(null==(__t=time)?"":__t)+'</span>\n    </div>\n    \n    <a href="'+(null==(__t=url)?"":__t)+'" data-href="'+(null==(__t=url)?"":__t)+'" title="'+__e(title)+'" class="titlename">'+__e(title)+"</a>\n\n    ",("threads"===resource_name||"collects"===resource_name&&"comment"!==type)&&(__p+='\n    <a class="desc" style="display: -webkit-box;">'+__e(summary)+"</a>\n    "),__p+=" \n\n    ",("comments"===resource_name||"collects"===resource_name&&"comment"===type)&&(__p+='\n    <a class="desc content" style="display: -webkit-box;">'+__e(comments[0].content)+'</a>\n    <div class="buffer"></div>\n    '),__p+=" \n\n    ",("collects"!==resource_name||"comment"!==type)&&(__p+='\n    \n        <div class="meta">\n            <span class="meta-item">\n                <i class="fa fa-star-o"></i>\n                '+(null==(__t=meta.collect_count)?"":__t)+"条收藏\n            </span>\n            ",__p+="discuss"!==meta.type?'\n            <span class="meta-item">\n                <i class="fa fa-clone"></i>\n                '+(null==(__t=meta.fork_count)?"":__t)+"次克隆\n            </span>\n            ":'\n            <span class="meta-item">\n                <i class="fa fa-comment-o"></i>\n                '+(null==(__t=comment_count)?"":__t)+"条评论\n            </span>\n            ",__p+='\n            <span class="meta-item">\n                <i class="fa fa-thumbs-o-up"></i>\n                '+(null==(__t=meta.up_count)?"":__t)+"条赞\n            </span>\n        </div>\n    "),__p+="        \n\n</div>\n"),__p+="        ";return __p}},function(e,t,n){var i,r;i=[n(49)],r=function(e){return e.ItemView.extend({className:"empty-share-list",template:!1,initialize:function(e){this.emptyText=e.text||"没有分享"},render:function(){return e.ItemView.prototype.render.apply(this,arguments),this.$el.html(this.emptyText),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="cm_main ul-style">\n    <div class="user-header">\n        <img src="'+(null==(__t=profile.avatar)?"":__t)+'" alt="">\n        <ul>\n            <li>\n                <div class="actions">\n                    <div class="not-user">\n                        <a href="" class="follow-action">关注</a>\n                        <a href="" class="followed-action"></i>取消关注</a>\n                    </div>\n                    <div class="is-user">\n                        <a href="" class="unEdited"><i class="fa fa-pencil"></i>编辑</a>\n                        <div class="edited">\n                            <a href="" class="cancel">取消</a>\n                            <a href="" class="submit">保存</a>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            <li class="title">\n                <div class="unEdited">\n                    <span>昵称：</span>\n                    <span>\n                        ',
__p+=profile.verified?'\n                        <span class="profile-nickname">\n                            '+__e(profile.nickname)+'\n                        </span>\n                        <i class="fa fa-check-circle verified"></i>\n                        <small>通联量化实验室认证用户</small>\n                        ':'\n                        <span class="profile-nickname">\n                        '+__e(profile.nickname)+"\n                        </span>\n                        ",__p+='\n                    </span>\n                </div>\n\n                <div class="unEdited">\n                    <span>简介：</span>\n                    <span class="profile-introduction">\n                        '+__e(profile.introduction)+'\n                    </span>\n                </div>\n                <form class="profile-form edited">\n                    <div class="form-div">\n                        <span>昵称：</span>\n                            <input class="form-control detail-control" type="text" name="nickname" id="profile-edit-nickname" value="'+(null==(__t=profile.nickname)?"":__t)+'">\n                            <span class="error-block"></span>\n                    </div>\n\n                    <div class="form-div">\n                        <span>简介：</span>\n                            <input class="form-control detail-control" type="text" name="title" id="profile-edit-title" value="'+(null==(__t=profile.introduction)?"":__t)+'">\n                        <span class="error-block"></span>\n                    </div>\n                </form>\n            </li>\n        </ul>\n    </div>\n    <div class="user-achievement">\n        <!-- <div>\n            <i class="fa fa-trophy"></i>\n            获得成就展示\n        </div> -->\n        <div class="bd honors">\n        </div>\n        <div class="achieve clearfix">\n            <a>共获得</a>\n            <a><i class="fa fa-thumbs-o-up"></i><span class="thread-up"></span>赞</a>\n            <a><i class="fa fa-heart-o"></i><span class="comment-up"></span>感谢</a>\n            <a><i class="fa fa-star-o"></i><span class="collect"></span>收藏</a>\n            <a><i class="fa fa-clone"></i><span class="fork"></span>克隆</a>\n        </div>\n\n    </div>\n\n    <div class="user-content">\n        <div class="tabs">\n            <ul class="nav nav-tabs active-tabs"></ul>\n            <div class="commList">\n                <div class="tab-content"></div>\n                <div class="commPage">\n                    <ul class="paginator"></ul>\n                </div>\n            </div>\n        </div>\n        <div class="follows">\n            <ul class="follow-tabs clearfix">\n                <li><a class="tab-follow" href="#tab-follow">关注人(<span class="count"></span>)</a></li>\n                <li><a class="tab-follower"  href="#tab-follower">关注者(<span class="count"></span>)</a></li>\n                <li class="back"><a class="tab-back" href="#tab-back">返回个人主页 </a></li>\n            </ul>\n            <div class="follow-content"></div>\n        </div>\n    </div>\n\n</div>\n<div class="sideBar ul-style">\n    <div class="user-meta user-follow">\n        <ul class="meta-left">\n            <li>\n                关注了\n            </li>\n            <li>\n                <a class="goto-follow"><span class="follow"></span>人</a>\n            </li>\n        </ul>\n        <a class="gap"></a>\n        <ul class="meta-right">\n            <li>\n                关注者\n            </li>\n            <li>\n                <a class="goto-follower"><span class="follower"></span>人</a>\n            </li>\n        </ul>\n    </div>\n    <div class="user-mall" >\n        <p>当前积分 <a data-href="'+(null==(__t=mallUrl)?"":__t)+'" href="'+(null==(__t=mallUrl)?"":__t)+'"><span class="points"></span></a>\n        <a class="mall" data-href="'+(null==(__t=mallUrl)?"":__t)+'" href="'+(null==(__t=mallUrl)?"":__t)+'"><span class="mem-txt"></span> &gt;</a>\n        </p>\n        <a href="help/faq/#积分FAQ" data-href="help/faq/#积分FAQ">积分怎么用？</a>\n    </div>\n    <div class="cmBlock mTop">\n        <div class="top">\n            <h3>TA的热门分享</h3>\n        </div>\n\n        <div class="bd hotThreads">\n        </div>\n    </div>\n\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(108)],r=function(e,t){return e.CollectionView.extend({className:"comment-list",tagName:"ul",childView:t,onRender:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(109)],r=function(e,t,n){return t.ItemView.extend({tagName:"li",template:n,initialize:function(){},serializeData:function(){var t=e.extend(this.model.toJSON(),t);return t.url=this.model.appUrl(),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<a href="'+(null==(__t=url)?"":__t)+'" title="'+__e(title)+'" target="_blank">'+__e(title)+"</a>";return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(111)],r=function(e,t,n){return t.Collection.extend({model:n,parse:function(e){return 200===e.code?e.data.list:[]},initialize:function(t,n){n=n||{},e.defaults(n,{currentPage:0,pageSize:10,totalPage:1}),this.val=t.val,this.userID=t.userID,this.state=n},url:function(){return window.getapi("mercury_community","/w/user/"+this.userID+"/"+this.val)},fetch:function(){return this.trigger("sync:before"),t.Collection.prototype.fetch.apply(this,arguments)},fetchNext:function(){var e=this;return this.fetch({data:{page:this.state.currentPage+1,page_size:this.state.pageSize},remove:!0}).done(function(t){e.state.currentPage=t.data.current_page,e.state.totalPage=t.data.total_page,e.state.totalCount=t.data.total_count})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(76)],r=function(e,t){return t.NestedModel.extend({parse:function(e){return 200===e.code?e.data:e||{}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(113)],r=function(e,t){return e.CollectionView.extend({className:"follow-list",tagName:"ul",childView:t,onRender:function(){},onDestroy:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(114),n(46),n(115),n(103),n(116)],r=function(e,t,n,i,r,o,a){return t.ItemView.extend({tagName:"li",template:n,events:{"click .follow-item":"clickFollowUserBtn"},initialize:function(){},serializeData:function(){var t=e.extend(this.model.toJSON(),t);return t.appUrl=new o({id:this.model.get("id")}).appUrl(),t},onRender:function(){return a.get("profile").get("id")===this.model.get("id")?(this.$el.find(".followed-action").hide(),void this.$el.find(".follow-action").hide()):void(this.model.get("follow_able")?(this.$el.find(".followed-action").hide(),this.$el.find(".follow-action").show()):(this.$el.find(".followed-action").show(),this.$el.find(".follow-action").hide()))},clickFollowUserBtn:function(e){var t=this;return i.anonymous?(i.loginWithModal({appRoot:window.getApp("cloud-portal","")}),void e.preventDefault()):($.ajax({url:window.getapi("mercury_community","/user/"+this.model.get("id"))+"/follow",type:"PUT"}).done(function(e){200===e.code&&e.data&&(e.data.follow_able?(t.$el.find(".followed-action").hide(),t.$el.find(".follow-action").show(),App.vent.trigger("user_follow",-1)):(t.$el.find(".followed-action").show(),t.$el.find(".follow-action").hide(),App.vent.trigger("user_follow",1)))}),void e.preventDefault())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="clearfix">\n    <img src="'+(null==(__t=profile.avatar)?"":__t)+'" alt="">\n    <div class="desc">\n        <span>\n            <a class="name'+(null==(__t=profile.verified?" verified-user":"")?"":__t)+'" href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'">\n                ',__p+=profile.verified?"\n                "+__e(profile.nickname)+'<i class="fa fa-check-circle" title="认证用户"></i>\n                ':"\n                "+__e(profile.nickname)+"\n                ",__p+='\n            </a>\n            <a class="follow-item follow-action" href="#"><span class="text">关注</span></a>\n            <a href="" class="follow-item followed-action">取消关注</a>\n        </span>\n        <p>'+__e(profile.introduction)+"</p>\n    </div>\n\n</div>";return __p}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_115__},function(e,t,n){var i,r;i=[n(47)],r=function(e){return e.module("Cache",function(e){var t={};e.set=function(e,n){t[e]=n},e.get=function(e){return t[e]},e.destroy=function(e){t[e].destroy?t[e].destroy():delete t[e]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(118)],r=function(e,t){return e.Collection.extend({model:t,initialize:function(e){this.userID=e.userID},url:function(){return window.getapi("mercury_community","/w/user/"+this.userID+"/honors")},parse:function(e){return 200===e.code?e.data.list:[]},fetch:function(){return this.trigger("sync:before"),e.Collection.prototype.fetch.apply(this,arguments)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48)],r=function(e){return e.Model.extend({})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(120)],r=function(e,t){return e.CollectionView.extend({className:"div",childView:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(121)],r=function(e,t){return e.ItemView.extend({className:"item",template:t,serializeData:function(){var e=this.model.toJSON();return e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<!-- <i class="num_i num03"></i> -->\n<span>'+(null==(__t=description)?"":__t)+'</span> <i class="icon-num icon-num0'+(null==(__t=rank)?"":__t)+'"></i>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(67),n(47),n(123),n(124),n(150)],r=function(e,t,n,i,r,o){return e.LayoutView.extend({className:"community_wrap",template:o,name:"community",regions:{main:".region-community-main"},onRender:function(){$(".main").addClass("main-community-color"),new t({appendTo:this.el,appName:n.name,appVersion:n.version,links:!1}),n.vent.trigger("title:module","社区")},onDestroy:function(){$(".main").removeClass("main-community-color"),this.goTop&&this.goTop.destroy()},onShow:function(){this.goTop=new i({target:this.$el,scroll:$(".main"),offset:332}),this.$el.find(".copyright").css("background","white")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49)],r=function(e){return e.ItemView.extend({tagName:"span",className:"go-top",events:{click:"goTop"},template:!1,initialize:function(e){var t=this;this.window=$(window),this.scroll=e.scroll,this.target=e.target,this.offset=e.offset,this.scroll.on("scroll.goTop",function(){t.showOrHide()}),this.window.on("resize.goTop",function(){t.repos()}),this.repos(),this.render()},repos:function(){this.pos={left:(this.window.width()-this.target.width())/2+this.target.width()-(this.offset||0)},this.$el.css(this.pos)},onRender:function(){this.$el.html('<i class="fa fa-chevron-up"></i>'),this.$el.css(this.pos),this.$el.attr("title","回到顶部"),$(document.body).append(this.$el)},onDestroy:function(){this.scroll.off("scroll.goTop"),this.window.off("resize.goTop")},goTop:function(){this.scroll.scrollTop(0)},showOrHide:function(){this.scroll.scrollTop()>=80?this.$el.show():this.$el.hide()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47),n(116),n(78),n(126),n(129),n(132),n(134),n(138),n(125),n(140),n(142),n(46),n(145),n(147),n(149)],r=function(e,t,n,i,r,o,a,s,l,c,u,d,h,p){return n.extend({className:"community-home clearfix",template:l,events:{"click .nav a":"clickNav","click .search input":"extendSearchInput","focusout .search input":"reduceSearchInput","click .un-logined":"clickLogin"},ui:{paginator:".paginator"},onRender:function(){var n=this;this.searchInput=new i,this.$el.find(".search").prepend(this.searchInput.render().el),this.nav=this.$el.find(".nav"),this.isSearchExtend=!1,this.filterView=new s,this.$el.find(".sort-view").prepend(this.filterView.render().el),this.addGroup(a,{id:"new",name:"动态",href:"tab-new"}),this.addGroup(a,{id:"tutorial",name:"新手专栏",href:"tab-tutorial"}),this.defaultSearch={sortBy:"update",type:"all"},this.listCollection={"new":new o([],{sortBy:"update",type:"all"}),tutorial:new(o.extend({url:window.getapi("mercury_community","/w/threads/tutorial")}))},this.on("tab:show",function(){n.loading=!0,n.ui.paginator.pagination("destroy"),n.getCurrentGroup().collection.state.currentPage=0,n.getCurrentGroup().collection.fetchNext(!0).done(function(){n.loading=!1,n.paginate()})}),this.showGroup("new",{collection:this.listCollection["new"]}),this.currentTab="new",t.get("profile").deferred.done(function(){n.$el.find(".un-logined").remove(),n.$el.find(".profile").append((new r).render().el),n.getAnnounceMents()}),this.listenTo(e.vent,"sortType:sortType",function(e){n.clickSortType(e)}),this.listenTo(e.vent,"sortBy:sortBy",function(e){n.clickSortBy(e)}),this.listenTo(e.vent,"remove:announce",function(){n.showAnnounce()}),this.advs=new c({}),this.renderAdvs(),e.vent.trigger("title","首页")},getAnnounceMents:function(){var e=this,n=t.get("profile");this.announceItem={},this.announceItem.index=-1,this.announceItem.userId=n.get("id"),this.announces=new h({}),$.when(this.announces.fetch()).done(function(t){e.showAnnounce()})},showAnnounce:function(){this.announceItem.index=this.announceItem.index+1,this.$el.find(".notice").remove(),this.announceItem.index<this.announces.length&&this.$el.prepend(new p({model:this.announces.at(this.announceItem.index),userId:this.announceItem.userId}).render().el)},renderAdvs:function(){var e=this;this.advsListView=new u({collection:this.advs}),$.when(this.advs.fetch()).done(function(){e.$el.find(".adv").append(e.advsListView.render().el)})},onDestroy:function(){this.ui.paginator.pagination("destroy")},clickNav:function(e){var t=$(e.currentTarget),n=t.attr("href").replace("#tab-","");this.currentTab=n,t.parent().addClass("active").siblings().removeClass("active"),this.showGroup(n,{collection:this.listCollection[n]}),"tutorial"===n?(this.$(".sort-view").hide(),this.$(".searchArea").addClass("searchAreaTop")):(this.$(".searchArea").removeClass("searchAreaTop"),this.$(".sort-view").show()),e.preventDefault()},extendSearchInput:function(){var e=this;if(!e.isSearchExtend){e.isSearchExtend=!0;var t=e.$(".searchArea").width();e.$(".searchArea").css("left",0),e.$(".searchArea").css("width",t+200),e.nav.find("li").addClass("hideStyle")}},reduceSearchInput:function(){var e=this;if(e.isSearchExtend){var t=e.$(".searchArea").width();e.$(".searchArea").css("left",200),e.$(".searchArea").css("width",t-200),e.isSearchExtend=!1,e.nav.find("li").removeClass("hideStyle")}},clickSortType:function(e){"new"===this.currentTab&&(this.defaultSearch.type=e,this.listCollection[this.currentTab]=new o([],{type:e,sortBy:this.defaultSearch.sortBy}),this.showGroup(this.currentTab,{collection:this.listCollection[this.currentTab]}))},clickSortBy:function(e){"new"===this.currentTab&&(this.defaultSearch.sortBy=e,this.listCollection[this.currentTab]=new o([],{sortBy:e,type:this.defaultSearch.type}),this.showGroup(this.currentTab,{collection:this.listCollection[this.currentTab]}))},paginate:function(){var e=this;return this.getCurrentGroup().collection.isEmpty()||1===this.getCurrentGroup().collection.state.totalPage?void this.ui.paginator.pagination("destroy"):void this.ui.paginator.pagination({items:e.getCurrentGroup().collection.state.totalCount,itemsOnPage:e.getCurrentGroup().collection.state.pageSize,currentPage:e.getCurrentGroup().collection.state.currentPage,cssStyle:"pagination",prevText:"上一页",nextText:"下一页",onPageClick:function(t,n){e.getCurrentGroup().collection.state.currentPage=t-1,e.getCurrentGroup().collection.fetchNext(!0).done(function(){$(".main").scrollTop(0)}),n.preventDefault()}})},clickLogin:function(e){return d.anonymous?(d.loginWithModal({appRoot:window.getApp("cloud-portal","")}),void e.preventDefault()):void 0}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="left">\n    <div class="comTitBar">\n\n        <a href="community/share/create" data-href="community/share/create" class="qa"><i class="fa fa-plus"></i>&nbsp;我要提问</a>\n        <ul class="nav nav-tabs">\n        </ul>\n    </div>\n    <div class="commBd">\n        <div class="search searchArea" style="">\n        </div>\n        <div class="sort-view">\n        </div>\n    </div>\n    <div class="commList">\n        <div class="tab-content"></div>\n        <div class="commPage">\n            <ul class="paginator"></ul>\n        </div>\n    </div>\n</div>\n\n<div class="right">\n	<div class="profile">\n         <div class="profile-edit cmBlock un-logined">\n            <div class="top">\n                <img src="img/header.jpg" alt="">\n                <a>我的主页<i class="fa fa-chevron-right"></i></a>\n                <p>介绍一下自己</p>\n            </div>\n        </div>   \n    </div>\n    <div class="adv"></div>\n</div>';return __p}},function(e,t,n){var i,r;i=[n(47),n(127)],r=function(e,t){return t.extend({placeholderText:"标题 / 摘要 / 用户名",suggestionAPI:window.getapi("mercury_community","/suggestion"),onSearch:function(){var t,n=this.ui.input.val();n&&(t="/community/search/"+encodeURIComponent(n),e.Route.navigate(t,{trigger:!0}))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(47),n(128)],r=function(e,t,n,i,r){return n.ItemView.extend({className:"input-group search-input",template:r,events:{"click .fa-search":"onSearch","click .fa-times":"onClickClear","keyup input":"onKeyup"},ui:{input:"input",clear:".fa-times"},initialize:function(e){this.model=new t.Model({placeholder:this.placeholderText||"请输入关键字",button:this.buttonText||"搜索"}),this.keyword=e?e.keyword:null},onRender:function(){var e=this;this.suggestionAPI&&this.ui.input.autocomplete({source:function(t,n){$.ajax({url:e.suggestionAPI,type:"GET",data:{key:t.term}}).done(function(e){200===e.code&&e.data&&n(e.data)})},select:function(){setTimeout(function(){e.onSearch()},0)}}),this.keyword&&this.ui.input.val(this.keyword)},onKeyup:function(e){13===e.keyCode&&this.onSearch(),this.ui.input.val()?this.ui.clear.show():this.ui.clear.hide()},onClickClear:function(){this.ui.input.val(""),this.ui.clear.hide()},focus:function(){this.ui.input.focus()},val:function(e){this.ui.input.val(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<input class="form-control" type="text" placeholder="'+(null==(__t=placeholder)?"":__t)+'">\n<i class="fa fa-times"></i>\n<i class="fa fa-search"></i>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(116),n(103),n(130),n(131)],r=function(e,t,n,i,r,o){return t.ItemView.extend({template:r,events:{"click .dropdown-menu":"click","click .cancel":"clickCancel","click .submit":"clickSubmit","submit form":"submitForm","show.bs.dropdown .dropdown":"showDropdown"},ui:{dropdown:".dropdown-toggle",form:".form-horizontal"},initialize:function(){this.model=n.get("profile")},serializeData:function(){var e=this.model.toJSON();return e.userUrl=new i({id:this.model.get("id")}).appUrl(),e},onRender:function(){this.getStatic(),this.fetchPoints()},fetchPoints:function(){var e=this;$.ajax({url:window.getapi("mercury_community","/user/"+this.model.get("id")+"/points"),type:"GET"}).done(function(t){200===t.code&&t.data&&e.$el.find(".points").text(t.data.available_points)})},getStatic:function(){var e=this;$.ajax({url:window.getapi("mercury_community","/w/user/"+this.model.get("id")+"/statistics"),type:"GET"}).done(function(t){200===t.code&&t.data&&(e.$el.find(".bd-static .share").text(t.data.thread_count),e.$el.find(".bd-static .comment").text(t.data.comment_count),e.$el.find(".bd-static .collect").text(t.data.collect_count))})},renderForm:function(){this.ui.form.empty(),this.ui.form.append(o(e.extend(this.model.toJSON(),{userUrl:new i({id:this.model.get("id")}).appUrl()})))},errorField:function(e,t){e.parents(".form-group").addClass("has-error"),e.next(".help-block").text(t||"")},resetField:function(e){e.parents(".form-group").removeClass("has-error"),e.next(".help-block").text("")},toggleDropdown:function(){this.ui.dropdown.dropdown("toggle")},click:function(e){$(e.target).is(".go-my-profile")||e.stopPropagation()},clickCancel:function(e){this.toggleDropdown()},clickSubmit:function(){var e=this,t=this.ui.form.find('input[name="nickname"]'),n=(this.ui.form.find('input[name="job"]'),this.ui.form.find('textarea[name="title"]')),i=this.model.get("profile"),r=function(e,t,n){return e.length<t||e.length>n?!1:!0};return t.val()?/[@\s\\]/gi.test(t.val())?void this.errorField(t,"昵称不得包含@,\\,/,空格"):r(t.val(),2,30)?r(n.val(),0,30)?i.nickname===t.val()&&i.introduction===n.val()?void e.toggleDropdown():void this.model.save({profile:{nickname:t.val(),introduction:n.val(),job:""}},{success:function(){e.toggleDropdown()},error:function(n,i){409===i.status&&e.errorField(t,"此昵称已被使用."),400===i.status&&e.errorField(t,"昵称不得包含@,\\,/,空格")},wait:!0}):void this.errorField(n,"简介不得超过30个字符"):void this.errorField(t,"昵称应为2-30个字符"):void this.errorField(t)},showDropdown:function(){this.renderForm()},submitForm:function(e){this.clickSubmit(),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<!-- <div class="profile-edit">\n    <div class="dropdown dropdown-box">\n        <button class="btn btn-link dropdown-toggle" data-toggle="dropdown">\n            <i class="fa fa-cog"></i> 个人设置\n        </button>\n        <div class="dropdown-menu">\n            <div class="dropdown-box-body">\n                <form class="form-horizontal"></form>\n            </div>\n            <div class="btns">\n                <button class="cancel btn btn-link">取消</button>\n                <button class="submit btn btn-primary">确定</button>\n            </div>\n        </div>\n    </div>\n</div> -->\n<div class="profile-edit cmBlock">\n    <div class="top">\n        <img src="'+(null==(__t=profile.avatar)?"":__t)+'" alt="">\n        <a href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'">'+(null==(__t=profile.nickname)?"":__t)+'<i class="fa fa-chevron-right"></i></a>\n        <p>'+(null==(__t=profile.introduction)?"":__t)+'</p>\n    </div>\n    <div class="bd-static">\n        <ul>\n            <li>\n                <a href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'"><i class="fa fa-share-alt"></i>分享<span class="share"></span>文章</a>\n            </li>\n            <li>\n                <a href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'"><i class="fa fa-comment-o"></i>评论<span class="comment"></span>次</a>\n            </li>\n            <li>\n                <a href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'"><i class="fa fa-star"></i>收藏<span class="collect"></span>文章</a>\n            </li>\n        </ul>\n    </div>\n        <div class="point">当前积分 <a data-href="community/mall" href="community/mall"><span class="points"></span></a></div>\n\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="form-group">\n    <label class="col-md-4 control-label" for="profile-edit-nickname">昵称</label>\n    <div class="col-md-8">\n        <input class="form-control" type="text" name="nickname" id="profile-edit-nickname" value="'+(null==(__t=profile.nickname)?"":__t)+'">\n        <span class="help-block"></span>\n    </div>\n</div>\n<div class="form-group">\n    <label class="col-md-4 control-label" for="profile-edit-title">个人简介</label>\n    <div class="col-md-8">\n        <textarea class="form-control" name="title" id="profile-edit-title">'+(null==(__t=profile.introduction)?"":__t)+'</textarea>\n        <span class="help-block"></span>\n    </div>\n</div>\n<a class="col-md-offset-4 go-my-profile" href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'">我的个人主页</a>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(133)],r=function(e,t,n){return t.Collection.extend({model:n,url:window.getapi("mercury_community","/w/threads"),parse:function(e){return 200===e.code?e.data.list:[]},initialize:function(t,n){n=n||{},e.defaults(n,{sortBy:"update",currentPage:0,pageSize:15,totalPage:1,type:"all"}),this.state=n},fetch:function(){return this.trigger("sync:before"),t.Collection.prototype.fetch.apply(this,arguments)},fetchNext:function(e){var t=this;if(this.state.currentPage>=this.state.totalPage){var n=$.Deferred();return n.reject(),n}return this.fetch({data:{page:this.state.currentPage+1,page_size:this.state.pageSize,sort:this.state.sortBy,type:this.state.type},remove:e?!0:!1}).done(function(e){t.state.currentPage=e.data.current_page,t.state.totalPage=e.data.total_page,t.state.totalCount=e.data.total_count})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(76)],r=function(e,t){return t.NestedModel.extend({urlRoot:window.getapi("mercury_community","/w/thread"),appUrl:function(){return"community/share/"+this.id},operationUrl:function(){return window.getapi("mercury_community","/thread/"+this.id)},deleteUrl:function(){return window.getapi("mercury_community","/thread/"+this.id)},parse:function(e){return 200===e.code?e.data:e||{}},up:function(){var t=this;return $.ajax({url:this.operationUrl()+"/up",type:"PUT"}).done(function(n){n.data&&e.isNumber(n.data.up_count)&&t.set("meta.up_count",n.data.up_count)})},fork:function(){var t=this;return $.ajax({url:this.operationUrl()+"/fork",type:"PUT"}).done(function(n){n.data&&e.isNumber(n.data.fork_count)&&t.set("meta.fork_count",n.data.fork_count)})},follow:function(){var t=this;return $.ajax({url:this.operationUrl()+"/follow",type:"PUT"}).done(function(n){n.data&&e.isNumber(n.data.follow_count)&&t.set("meta.follow_count",n.data.follow_count)})},collect:function(){var t=this;return $.ajax({url:this.operationUrl()+"/collect",type:"PUT"}).done(function(n){n.data&&e.isNumber(n.data.collect_count)&&t.set("meta.collect_count",n.data.collect_count)})},deleteModel:function(){return $.ajax({url:this.deleteUrl(),type:"DELETE"}).done(function(e){})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(82),n(135),n(105),n(137)],r=function(e,t,n,i,r){return e.CollectionView.extend({className:"share-list",template:r,childView:n,emptyView:i,initialize:function(){this.listenTo(this.collection,{sync:this.removeLoading,"sync:before":this.appendLoading})},onDestroy:function(){},appendLoading:function(){this.$el.find(".empty-share-list").hide(),this.loading=new t,this.$el.append(this.loading.render().$el)},removeLoading:function(){this.loading&&this.loading.destroy(),this.$el.find(".empty-share-list").show()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(84),n(103),n(136)],r=function(e,t,n,i,r){return t.ItemView.extend({className:"item clearfix",template:r,serializeData:function(){var t={url:this.model.appUrl(),time:null,isComment:!1};return this.model.get("comment_latest_update")?(t.time=n.fromNow(this.model.get("comment_latest_update")),t.isComment=!0):t.time=n.fromNow(this.model.get("update")),t=e.extend(this.model.toJSON(),t),t.author.appUrl=new i({id:this.model.get("author.id")}).appUrl(),t},renderImage:function(e){e&&""!==e?(this.$el.find(".thread-img img").attr({src:e}),this.$el.find(".thread-content .thread-desc").css("height",40)):(this.$el.find(".thread-img").hide(),this.$el.find(".thread-content").css("width","100%"),this.$el.find(".thread-content .thread-desc").css("max-height",40))},onShow:function(){var e=this;$.ajax({url:window.getapi("mercury_community","/w/thread/"+this.model.get("id")+"/thumbnail")}).done(function(t){200===t.code&&e.renderImage(t.data.thumbnail)})},onRender:function(){"discuss"!==this.model.get("meta.type")&&this.$el.find(".thread-content").css("width",620)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<p>\n	<a href="'+(null==(__t=url)?"":__t)+'" title="'+__e(title)+'" target="_blank" class="titlename">'+__e(title)+"</a>\n</p>\n","discuss"!==meta.type&&(__p+='   \n<div class="thread-img">\n	<img  alt="">\n</div>\n'),__p+='\n<div class="thread-content">\n	<div class="thread-desc">\n		<a class="desc" style="display: -webkit-box;">'+__e(summary)+'</a>\n		\n	</div>\n	<div>\n		<a class="like"><i class="fa fa-thumbs-o-up"></i><font>'+(null==(__t=meta.up_count)?"":__t)+'</font></a>\n		<a class="comment"><i class="fa fa-comment-o"></i><font>'+(null==(__t=comment_count)?"":__t)+"</font></a>\n		","discuss"!==meta.type&&(__p+='   \n		<a class="clone"><i class="fa fa-clone"></i><font>'+(null==(__t=meta.fork_count)?"":__t)+"</font></a>\n		"),__p+='\n		<a class="n">'+(null==(__t=_T.partial("simpleUser",author))?"":__t)+"</a><span>分享了</span>\n		","strategy"===meta.type&&(__p+='        \n		<span class="label green">策略</span>\n		'),__p+="\n		","research"===meta.type&&(__p+='    \n		<span class="label gray">研究</span>\n		'),__p+="\n		","discuss"===meta.type&&(__p+='    \n		<span class="label purple">问答</span>\n		'),__p+='\n		\n		<span class="mr">&nbsp;&nbsp;&nbsp;&nbsp;'+(null==(__t=time)?"":__t)+"</span>\n		",isComment||(__p+='   \n		<span class="ml">发表</span>\n		'),__p+="\n		",isComment&&(__p+='   \n		<span class="ml">有了新评论</span>\n		'),__p+="\n	</div>\n</div>";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+="";return __p}},function(e,t,n){var i,r;i=[n(49),n(139)],r=function(e,t){return e.ItemView.extend({className:"filter",tagName:"div",template:t,events:{"click .sortType":"clickSortType","click .sortBy":"clickSortBy"},onRender:function(){this.sortType=this.$el.find(".sortType"),this.sortBy=this.$el.find(".sortBy")},clickSortType:function(e){var t=$(e.currentTarget),n=t.attr("attr");this.sortType.removeClass("cur"),t.addClass("cur"),App.vent.trigger("sortType:sortType",n),e.preventDefault()},clickSortBy:function(e){var t=$(e.currentTarget),n=t.attr("attr");this.sortBy.removeClass("act"),t.addClass("act"),App.vent.trigger("sortBy:sortBy",n),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='    <span>\n        <a class="sortBy" attr="hot">热门排序</a>\n        |\n        <a class="sortBy act" attr="update">时间排序</a>\n    </span>\n    <a class="sortType cur" attr="all">全部</a>\n    <a class="sortType" attr="strategy">策略</a>\n    <a class="sortType" attr="research">研究</a>\n    <a class="sortType" attr="discuss">问答</a>';return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(141)],r=function(e,t,n){return t.Collection.extend({model:n,initialize:function(t,n){n=n||{},e.defaults(n,{locations:"front_page"}),this.state=n},url:function(){return window.getapi("mercury_community","/w/ads/"+this.state.locations)},parse:function(e){return 200===e.code?e.data.list:[]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(76)],r=function(e,t){return t.NestedModel.extend({appUrl:function(){return window.getapi("mercury_community","/w/ad/image/"+this.get("image.id"))},parse:function(e){return 200===e.code?e.data:e||{}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(143)],r=function(e,t){return e.CollectionView.extend({className:"adv-list",tagName:"div",childView:t,onRender:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(144)],r=function(e,t,n){
return t.ItemView.extend({tagName:"div",template:n,serializeData:function(){var t=e.extend(this.model.toJSON(),t);return t.url=this.model.appUrl(),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<a href="'+(null==(__t=href)?"":__t)+'" target="_blank">\n<img src="'+(null==(__t=url)?"":__t)+'" alt="">\n</a>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(146)],r=function(e,t,n){return t.Collection.extend({model:n,initialize:function(t,n){n=n||{},e.defaults(n,{})},url:function(){return window.getapi("mercury_community","/announcements")},parse:function(e){return 200===e.code?e.data.list:[]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(76)],r=function(e){return e.NestedModel.extend({urlRoot:window.getapi("mercury_community","/announcement"),parse:function(e){return 200===e.code?e.data:e||{}},"delete":function(e){return $.ajax({url:this.urlRoot+"/"+this.id,type:"PUT",contentType:"application/json",data:JSON.stringify(e)}).done(function(e){e.data&&200===e.code})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(148),n(47)],r=function(e,t,n,i){return t.ItemView.extend({className:"notice",template:n,events:{"click .close-message":"clickClose"},initialize:function(e){t.ItemView.prototype.initialize.apply(this,arguments),this.model=e.model,this.userId=e.userId},clickClose:function(e){e.preventDefault(),this.model["delete"]({who_read:this.userId}).done(function(){i.vent.trigger("remove:announce")})},onRender:function(){},onDestroy:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="noticeContent">\n',__p+=href_url?'\n<a href="'+(null==(__t=href_url)?"":__t)+'" target="_blank" class="message messagelink">'+(null==(__t=message)?"":__t)+"</a>\n":'\n<a class="message">'+(null==(__t=message)?"":__t)+"</a>\n",__p+='\n<a href="" class="close-message"><i class="fa fa-times-circle"></i></a>\n</div>';return __p}},function(e,t){"use strict";!function(e){var t={init:function(n){var i=e.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:0,hrefTextPrefix:"#page-",hrefTextSuffix:"",prevText:"Prev",nextText:"Next",ellipseText:"&hellip;",cssStyle:"light-theme",listStyle:"",labelMap:[],selectOnClick:!0,nextAtFront:!1,invertPageOrder:!1,useStartEdge:!0,useEndEdge:!0,onPageClick:function(e,t){},onInit:function(){}},n||{}),r=this;return i.pages=i.pages?i.pages:Math.ceil(i.items/i.itemsOnPage)?Math.ceil(i.items/i.itemsOnPage):1,i.currentPage?i.currentPage=i.currentPage-1:i.currentPage=i.invertPageOrder?i.pages-1:0,i.halfDisplayed=i.displayedPages/2,this.each(function(){r.addClass(i.cssStyle+" simple-pagination").data("pagination",i),t._draw.call(r)}),i.onInit(),this},selectPage:function(e){return t._selectPage.call(this,e-1),this},prevPage:function(){var e=this.data("pagination");return e.invertPageOrder?e.currentPage<e.pages-1&&t._selectPage.call(this,e.currentPage+1):e.currentPage>0&&t._selectPage.call(this,e.currentPage-1),this},nextPage:function(){var e=this.data("pagination");return e.invertPageOrder?e.currentPage>0&&t._selectPage.call(this,e.currentPage-1):e.currentPage<e.pages-1&&t._selectPage.call(this,e.currentPage+1),this},getPagesCount:function(){return this.data("pagination").pages},setPagesCount:function(e){this.data("pagination").pages=e},getCurrentPage:function(){return this.data("pagination").currentPage+1},destroy:function(){return this.empty(),this},drawPage:function(e){var n=this.data("pagination");return n.currentPage=e-1,this.data("pagination",n),t._draw.call(this),this},redraw:function(){return t._draw.call(this),this},disable:function(){var e=this.data("pagination");return e.disabled=!0,this.data("pagination",e),t._draw.call(this),this},enable:function(){var e=this.data("pagination");return e.disabled=!1,this.data("pagination",e),t._draw.call(this),this},updateItems:function(e){var n=this.data("pagination");n.items=e,n.pages=t._getPages(n),this.data("pagination",n),t._draw.call(this)},updateItemsOnPage:function(e){var n=this.data("pagination");return n.itemsOnPage=e,n.pages=t._getPages(n),this.data("pagination",n),t._selectPage.call(this,0),this},getItemsOnPage:function(){return this.data("pagination").itemsOnPage},_draw:function(){var n,i,r=this.data("pagination"),o=t._getInterval(r);t.destroy.call(this),i="function"==typeof this.prop?this.prop("tagName"):this.attr("tagName");var a="UL"===i?this:e("<ul"+(r.listStyle?' class="'+r.listStyle+'"':"")+"></ul>").appendTo(this);if(r.prevText&&t._appendItem.call(this,r.invertPageOrder?r.currentPage+1:r.currentPage-1,{text:r.prevText,classes:"prev"}),r.nextText&&r.nextAtFront&&t._appendItem.call(this,r.invertPageOrder?r.currentPage-1:r.currentPage+1,{text:r.nextText,classes:"next"}),r.invertPageOrder){if(o.end<r.pages&&r.edges>0){if(r.useStartEdge){var s=Math.max(r.pages-r.edges,o.end);for(n=r.pages-1;n>=s;n--)t._appendItem.call(this,n)}r.pages-r.edges>o.end&&r.pages-r.edges-o.end!=1?a.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):r.pages-r.edges-o.end==1&&t._appendItem.call(this,o.end)}}else if(o.start>0&&r.edges>0){if(r.useStartEdge){var l=Math.min(r.edges,o.start);for(n=0;l>n;n++)t._appendItem.call(this,n)}r.edges<o.start&&o.start-r.edges!=1?a.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):o.start-r.edges==1&&t._appendItem.call(this,r.edges)}if(r.invertPageOrder)for(n=o.end-1;n>=o.start;n--)t._appendItem.call(this,n);else for(n=o.start;n<o.end;n++)t._appendItem.call(this,n);if(r.invertPageOrder){if(o.start>0&&r.edges>0&&(r.edges<o.start&&o.start-r.edges!=1?a.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):o.start-r.edges==1&&t._appendItem.call(this,r.edges),r.useEndEdge)){var l=Math.min(r.edges,o.start);for(n=l-1;n>=0;n--)t._appendItem.call(this,n)}}else if(o.end<r.pages&&r.edges>0&&(r.pages-r.edges>o.end&&r.pages-r.edges-o.end!=1?a.append('<li class="disabled"><span class="ellipse">'+r.ellipseText+"</span></li>"):r.pages-r.edges-o.end==1&&t._appendItem.call(this,o.end),r.useEndEdge)){var s=Math.max(r.pages-r.edges,o.end);for(n=s;n<r.pages;n++)t._appendItem.call(this,n)}r.nextText&&!r.nextAtFront&&t._appendItem.call(this,r.invertPageOrder?r.currentPage-1:r.currentPage+1,{text:r.nextText,classes:"next"})},_getPages:function(e){var t=Math.ceil(e.items/e.itemsOnPage);return t||1},_getInterval:function(e){return{start:Math.ceil(e.currentPage>e.halfDisplayed?Math.max(Math.min(e.currentPage-e.halfDisplayed,e.pages-e.displayedPages),0):0),end:Math.ceil(e.currentPage>e.halfDisplayed?Math.min(e.currentPage+e.halfDisplayed,e.pages):Math.min(e.displayedPages,e.pages))}},_appendItem:function(n,i){var r,o,a=this,s=a.data("pagination"),l=e("<li></li>"),c=a.find("ul");n=0>n?0:n<s.pages?n:s.pages-1,r={text:n+1,classes:""},s.labelMap.length&&s.labelMap[n]&&(r.text=s.labelMap[n]),r=e.extend(r,i||{}),n==s.currentPage||s.disabled?(s.disabled||"prev"===r.classes||"next"===r.classes?l.addClass("disabled"):l.addClass("active"),o=e('<span class="current">'+r.text+"</span>")):(o=e('<a href="'+s.hrefTextPrefix+(n+1)+s.hrefTextSuffix+'" class="page-link">'+r.text+"</a>"),o.click(function(e){return t._selectPage.call(a,n,e)})),r.classes&&o.addClass(r.classes),l.append(o),c.length?c.append(l):a.append(l)},_selectPage:function(e,n){var i=this.data("pagination");return i.currentPage=e,i.selectOnClick&&t._draw.call(this),i.onPageClick(e+1,n)}};e.fn.pagination=function(n){return t[n]&&"_"!=n.charAt(0)?t[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof n&&n?void e.error("Method "+n+" does not exist on jQuery.pagination"):t.init.apply(this,arguments)}}(jQuery)},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="region-community-main"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(48),n(49),n(116),n(132),n(134),n(126),n(152)],r=function(e,t,n,i,r,o,a){return t.LayoutView.extend({className:"community-search",template:a,initialize:function(t){this.keyword=t.keyword,this.model=new e.Model({key:this.keyword,count:""})},regions:{search:".search",searchList:".search-list",profile:".profile"},ui:{paginator:".paginator"},onRender:function(){var e=this,t=new o,n=i.extend({url:window.getapi("mercury_community","/search?key="+this.keyword)});this.search.show(t),t.val(this.keyword),this.searchInput=t,n=new n([],{}),this.shareList=new r({collection:n}),this.searchList.show(this.shareList),this.loading=!0,n.state.currentPage=0,n.fetchNext(!0).done(function(){e.$el.find(".search-meta .count").text(n.state.totalCount),e.loading=!1,e.paginate()})},onDestroy:function(){$(".wrapper .main").off("scroll.communitySearchLoadmore"),this.ui.paginator.pagination("destroy")},onShow:function(){this.searchInput.focus()},paginate:function(){var e=this;return this.shareList.collection.isEmpty()||1===this.shareList.collection.state.totalPage?void this.ui.paginator.pagination("destroy"):void this.ui.paginator.pagination({items:e.shareList.collection.state.totalCount,itemsOnPage:e.shareList.collection.state.pageSize,currentPage:e.shareList.collection.state.currentPage,cssStyle:"pagination",prevText:"上一页",nextText:"下一页",onPageClick:function(t,n){e.shareList.collection.state.currentPage=t-1,e.shareList.collection.fetchNext(!0).done(function(){$(".main").scrollTop(0)}),n.preventDefault()}})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<!-- <div class="search"></div>\n<div class="search-meta">\n    <a href="community/" data-href="community/">\n        <i class="fa fa-chevron-left"></i>\n        返回首页\n    </a>\n    共找到 <span class="count">'+(null==(__t=count)?"":__t)+'</span> 个匹配 "'+__e(key)+'" 的结果\n</div>\n<div class="search-list"></div> -->\n\n\n<div class="left">\n    <div class="comTitBar searchtpl">\n\n        <a href="community/share/create" data-href="community/share/create" class="qa sqa"><i class="fa fa-plus"></i>&nbsp;我要提问</a>\n        \n        <div class="search searchArea"></div>\n        <a href="community/" data-href="community/" class="cancel">取消</a>\n\n    </div>\n\n    <div class="commBd">\n        <div class="search-meta">\n		    <a href="community/" data-href="community/">\n		        <i class="fa fa-chevron-left"></i>\n		        返回\n		    </a>\n		    共找到 <span class="count">'+(null==(__t=count)?"":__t)+'</span> 个匹配 "'+__e(key)+'" 的结果\n		</div>\n        <!-- <a href="" class="return">&lt;&nbsp;返回</a>\n        <span>共找到 23 个匹配 "量化" 的结果</span> -->\n\n    </div><!-- end commBd -->\n\n    <div class="commList">\n		<div class="search-list"></div>\n		<div class="commPage">\n            <ul class="paginator"></ul>\n        </div>\n    </div>\n</div>\n\n<div class="right">\n	<div class="profile"></div>\n    <!-- <div>\n        12\n    </div> -->\n</div>\n<div class="clearfix"></div>';return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(46),n(115),n(156),n(47),n(116),n(84),n(157),n(159),n(187),n(154),n(89),n(190),n(133),n(195),n(197),n(103),n(74),n(107),n(117),n(119),n(200)],r=function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v,y,b,_,w,x,C){return n.ItemView.extend({className:"share-detail clearfix",events:{"click .actionLike":"clickLikeBtn","click .actionFork":"clickForkBtn","click .actionCollect":"clickCollectBtn","click .actionFollow":"clickFollowBtn","click .cm_main .delete":"clickDelete","click .goto-reply":"clickGotoReply","click .reply .submit":"clickReplySubmit","click .follow-user":"clickFollowUserBtn","click .close-code":"clickCloseCode","click .overlay":"clickCloseCode",keydown:"keypressClose"},template:C,serializeData:function(){var t={url:this.model.appUrl(),profile:this.profile?this.profile.toJSON():{},time:l.formatTime(this.model.get("thread_latest_edit")),anonymous:i.anonymous};return t=e.extend(this.model.toJSON(),t),t.author.appUrl=new y({id:this.model.get("author.id")}).appUrl(),t.profile.appUrl=new y({id:this.profile.get("id")}).appUrl(),t},initialize:function(e){n.ItemView.prototype.initialize.apply(this,arguments);var t=this;this.model=new m({id:e.id}),this.comments=new g({shareID:e.id}),this.listenTo(this.model,{"change:meta.up_count":function(){t.$el.find(".like .count").text(t.model.get("meta.up_count"))},"change:meta.fork_count":function(){t.$el.find(".fork .count").text(t.model.get("meta.fork_count"))},"change:meta.collect_count":function(){t.$el.find(".collect .count").text(t.model.get("meta.collect_count"))},"change:meta.follow_count":function(){t.$el.find(".follow .count").text(t.model.get("meta.follow_count"))}}),this.on("meta:up_able",function(e){e?t.$el.find(".actionLike").removeClass("liked"):t.$el.find(".actionLike").addClass("liked")}),this.on("meta:follow_able",function(e){e?t.$el.find(".actionFollow").removeClass("liked"):t.$el.find(".actionFollow").addClass("liked")}),this.on("meta:collect_able",function(e){e.flag?t.$el.find(".actionCollect").removeClass("liked"):(t.$el.find(".actionCollect").addClass("liked"),"discuss"===t.model.get("meta.type")&&t.model.get("meta.follow_able")&&t.popView(e.target,"同时关注，可获新回复邮件提醒哦~",3e3),"discuss"!==t.model.get("meta.type")&&t.popView(e.target,"点击克隆，可复制策略进行编辑哦~",3e3))}),a.vent.on("show-code",function(e){t.$el.find(".overlay").show(),t.$el.find(".pop-up").show(),t.$el.find(".pop-code").append(e);var n=t.$el.find(".overlay").height();t.$el.find(".pop-code").css("max-height",.9*n-40)})},render:function(){var e=this,t=s.get("profile");return i.anonymous?$.when(this.model.fetch()).done(function(t){return t&&702===t.code?void a.Route.notFound():void n.ItemView.prototype.render.apply(e,arguments)}).fail(function(e){404===e.status&&a.Route.notFound()}):$.when(t.deferred,this.model.fetch()).done(function(t,i){return i[0]&&702===i[0].code?void a.Route.notFound():void n.ItemView.prototype.render.apply(e,arguments)}).fail(function(e,t){e&&t&&404!==t.status&&404!==e.status||a.Route.notFound()}),this.profile=t,this},onRender:function(){var e=this;this.scrollEl=$(".wrapper .main"),this.$el.find(".overlay").hide(),this.$el.find(".pop-up").hide(),this.scrollEl.on("scroll.headerActions",function(){e.showOrHide()}),"discuss"===this.model.get("meta.type")||"retrieved"===this.model.get("status")?this.renderDetail():this.renderNotebook(),this.userThreads=new b({userID:this.model.get("author.id")}),this.hotThreads=new b({}),this.honors=new w({userID:this.model.get("author.id")}),this.renderComments(),this.renderCommentInput(),this.renderUserThreads(),this.renderHotThreads(),this.renderHonors(),this.getFollowUserInfo(),this.renderReputations(),a.vent.trigger("title",this.model.get("title"))},onDestory:function(){$(".wrapper .main").off("scroll.headerActions")},renderReputations:function(){var e=this;$.ajax({url:window.getapi("mercury_community","/w/user/"+this.model.get("author.id")+"/reputations"),type:"GET"}).done(function(t){e.$el.find(".achieve .thread-up").text(t.data.received_thread_up_count),e.$el.find(".achieve .comment-up").text(t.data.received_comment_up_count),e.$el.find(".achieve .collect").text(t.data.received_collect_count),e.$el.find(".achieve .fork").text(t.data.received_fork_count)})},renderHonors:function(){var e=this;this.honorsList=new x({collection:this.honors}),$.when(this.honors.fetch()).done(function(){e.honorsList.isEmpty()?e.$el.find(".honors").remove():e.$el.find(".honors").append(e.honorsList.render().el)})},renderUserThreads:function(){var e=this;this.userThreadList=new _({collection:this.userThreads}),$.when(this.userThreads.fetchNext()).done(function(){e.userThreadList.isEmpty()?e.$el.find(".userThreads").remove():e.$el.find(".userThreads").append(e.userThreadList.render().el)})},renderHotThreads:function(){var e=this;this.hotThreadList=new _({collection:this.hotThreads}),$.when(this.hotThreads.fetchNext()).done(function(){e.$el.find(".hotThreads").append(e.hotThreadList.render().el)})},renderDetail:function(){var e=this,t=new p({breaks:!0});"discuss"===this.model.get("meta.type")&&this.$(".actionFork").hide(),this.$el.find(".notebook").after('<div class="topic-buffer"></div>'),t.Init({preview:this.$el.find(".notebook")[0],buffer:this.$el.find(".topic-buffer")[0],getText:function(){return e.model.get("content")},emptyText:""}),t.Update(),this.md=t},renderNotebook:function(){var e=new c({content:this.model.get("content")}),t=new d(e.cells()),n=new u({collection:t});this.$el.find(".notebook").append(n.render().el)},renderComments:function(){var e=this;this.commentList=new v({collection:this.comments}),$.when(this.comments.fetch()).done(function(){e.$el.find(".comments .list").append(e.commentList.render().el)}),this.listenTo(this.comments,{"add remove":function(){e.$el.find(".comments-count").html(e.comments.size())}}),this.listenTo(this.commentList,{"childview:at":function(t,n){e.addAt(n)}})},renderCommentInput:function(){var t=this,n=new f,i=e.debounce(function(){var e=t.replyEditor.getValue();e&&e.length>=8&&e.length<=1e4&&t.replyEditor.$el.removeClass("has-error").parent().parent().removeClass("has-error")},100);this.$el.find(".comment-input").append(n.render().el),n.triggerMethod("show"),n.editor.on("change",function(){i()}),this.replyEditor=n},clickGotoReply:function(e){$(".wrapper > .main").scrollTop(99999999),this.replyEditor.focus(),e.preventDefault()},addAt:function(e){var t=this.replyEditor.getValue(),n=/.*\s/.test(t)||!t,i=new RegExp("@"+e+"\\s","igm");return i.test(t)?void this.replyEditor.focus():(this.replyEditor.setValue(t+(n?"":" ")+"@"+e+" "),void this.replyEditor.focus())},clickDelete:function(e){var n=this,i=r.Confirm({title:"操作确认",content:"确定删除此分享?",yes:function(){$.when(n.model.deleteModel()).done(function(){t.history.navigate("community",{trigger:!0})})}});i.$el.on("hidden.bs.modal",function(){i.destroy()}),e.preventDefault()},clickReplySubmit:function(e){var t=this,n=this.replyEditor.getValue();return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):(this.replyEditor.$el.removeClass("has-error"),!n||n.trim().length<8||n.trim().length>1e4?(this.replyEditor.$el.addClass("has-error"),void this.replyEditor.$el.parent().next().text("评论内容长度应多于8个字符少于10000个字符").parent().addClass("has-error")):(this.comments.create({content:n},{wait:!0,success:function(){t.replyEditor.setValue("")}}),void e.preventDefault()))},clickLikeBtn:function(e){var t=this,n=$(e.currentTarget);return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):void this.model.up().done(function(e){200===e.code?t.trigger("meta:up_able",e.data.up_able):503===e.code?t.popView(n,"自己发的贴，让别人点赞吧",5e3):t.popView(n,"没有权限",5e3)})},clickCollectBtn:function(e){var t=this,n=$(e.currentTarget);return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):void this.model.collect().done(function(e){t.trigger("meta:collect_able",{flag:e.data.collect_able,target:n})})},clickFollowBtn:function(e){var t=this;$(e.currentTarget);return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):void this.model.follow().done(function(e){t.trigger("meta:follow_able",e.data.follow_able)})},clickForkBtn:function(e){var t=this,n=$(e.currentTarget);return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):this.model.get("isForking")?void new o({type:"warn",msg:"请不要频繁进行克隆操作",timeout:3e3}):(this.$el.find(".actionFork").addClass("liked"),this.model.set({isForking:!0}),void this.model.fork().done(function(e){if(t.model.set({isForking:!1}),e&&-403===e.code)return void t.popView(n,"没有权限",5e3);var i=e.data.title;n.popover({content:'克隆成功！<a href="labs/notebooks/'+encodeURIComponent(i)+'" data-href="labs/notebooks/'+encodeURIComponent(i)+'">点此开始研究克隆内容</a>',placement:"bottom",trigger:"manual",html:!0}),n.popover("toggle");var r=setTimeout(function(){n.popover("hide"),clearTimeout(r)},1e4)}).error(function(){t.model.set({isForking:!1})}))},showOrHide:function(){this.scrollEl.scrollTop()>=90?this.$(".header-overlay").addClass("show-header-actions"):this.$(".header-overlay").removeClass("show-header-actions")},clickFollowUserBtn:function(e){var t=this;return i.anonymous?(i.loginWithModal({appRoot:window.getApp("cloud-portal","")}),void e.preventDefault()):($.ajax({url:window.getapi("mercury_community","/user/"+this.model.get("author.id"))+"/follow",type:"PUT"}).done(function(e){200===e.code&&e.data&&(e.data.follow_able?(t.$el.find(".followed-action").hide(),t.$el.find(".follow-action").show()):(t.$el.find(".followed-action").show(),t.$el.find(".follow-action").hide()))}),void e.preventDefault())},getFollowUserInfo:function(){var e=this,t=s.get("profile");return e.model.get("author.id")===t.get("id")?(e.$el.find(".follow-action").remove(),void e.$el.find(".followed-action").remove()):void $.ajax({url:window.getapi("mercury_community","/w/user/"+this.model.get("author.id"))+"/follow",type:"GET"}).done(function(t){200===t.code&&t.data&&(t.data.follow_able?(e.$el.find(".followed-action").hide(),e.$el.find(".follow-action").show()):(e.$el.find(".followed-action").show(),e.$el.find(".follow-action").hide()))})},popView:function(e,t,n){e.popover({content:t,placement:"bottom",trigger:"manual",html:!0}),e.popover("toggle");var i=setTimeout(function(){e.popover("hide"),clearTimeout(i)},n)},clickCloseCode:function(e){$(e.currentTarget);this.hideCode(),e.preventDefault()},hideCode:function(){this.$el.find(".pop-code").empty(),this.$el.find(".overlay").hide(),this.$el.find(".pop-up").hide()},keypressClose:function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0;27==t&&this.$el.find(".overlay").show()&&this.hideCode()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(155)],r=function(e,t,n){return t.ItemView.extend({className:"alert-wrapper",template:n,events:{"click .close":"clickClose"},ui:{alert:".alert"},initialize:function(e){this.content=e.content,this.status=e.status||"success"},onRender:function(){this.ui.alert.append(this.content).addClass("alert-"+this.status)},clickClose:function(e){this.destroy()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="alert alert-dismissable">\n  <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>\n</div>\n';return __p}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_156__},function(e,t,n){var i,r;i=[n(48),n(158)],r=function(e,t){return e.Model.extend({idAttribute:"name",defaults:function(){return{session_id:null,type:"notebook",content:{metadata:{},nbformat:3,nbformat_minor:0,worksheets:[{metadata:{},cells:[{cell_type:"code",collapsed:!1,input:"",language:"python",metadata:{},outputs:[],trusted:!0}]}]}}},urlRoot:window.getapi("mercury","/api/notebooks"),downloadUrl:window.getapi("mercury","/files"),appUrl:function(){return"labs/notebooks/"+encodeURIComponent(t.toNB(this.get("name")))},initialize:function(){e.Model.prototype.initialize.apply(this,arguments);var t=this;this.on("sync",function(){t.cellsHash=JSON.stringify(t.cells())}),this.on("change:name",function(){t.set("search_name",t.get("name").replace(/\.ipynb/,""))}),this.get("name")&&this.set("search_name",this.get("name").replace(/\.ipynb/,""))},parse:function(e){return e.name&&e.type?e:{}},destroy:function(){var t=this,n=e.Model.prototype.destroy.apply(this,arguments);return n&&n.fail(function(e){403===e.status?t.trigger("delete:forbid"):404===e.status&&t.trigger("delete:notFound")}),n},validateTitle:function(e){var t=/\//gi;return t.test(e)?'Notebook名称中不可以有字符 "/".':e.length>100?"Notebook名称长度最多100个字符":null},cellsChanged:function(e){return!(this.cellsHash===JSON.stringify(e))},cells:function(){var e=this.get("content").worksheets;return e[0]?e[0].cells:[]},setCells:function(e){var t=this.get("content").worksheets,n=t[0];n?n.cells=e:t.push({cells:e})},displayName:function(){return this.get("name").replace(/.ipynb$/,"")},copy:function(e){var t=this,n=this.get("name");return $.ajax({url:this.urlRoot,type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify({copy_from:n}),success:function(n){t.collection.add(n),e&&e(n)}})},startSession:function(){var e=this;return $.ajax({url:window.getapi("mercury","/api/sessions"),type:"POST",dataType:"json",data:JSON.stringify({notebook:{name:this.get("name"),path:""}})}).done(function(t){e.set("session_id",t.id)}).fail(function(t){404===t.status&&e.trigger("notFound")})},renameSession:function(){var e=this;return this.get("session_id")?$.ajax({type:"PUT",url:window.getapi("mercury","/api/sessions/"+this.get("session_id")),data:JSON.stringify({notebook:{name:e.get("name"),path:""}})}).fail(function(t){404===t.status&&e.trigger("notFound")}):$.Deferred().resolve()},closeSession:function(){var e=this;return this.get("session_id")?$.ajax({type:"DELETE",url:window.getapi("mercury","/api/sessions/"+this.get("session_id"))}).done(function(){e.set("session_id",null)}).fail(function(){}):$.Deferred().resolve()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return{toNB:function(e){return e.replace(/\.ipynb/i,".nb")},toIPYNB:function(e){return e.replace(/\.nb/i,".ipynb")}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(49),n(160),n(185)],r=function(e,t,n){return t.extend({childView:n})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(161)],r=function(e,t){return e.CollectionView.extend({className:"cell-list",events:{"mousedown .cell":"mousedownCell"},childEvents:{destroy:function(e){e==this.focusedChild&&(this.focusedChild=null)}},childView:t,initialize:function(){e.CollectionView.prototype.initialize.apply(this,arguments)},render:function(){return e.CollectionView.prototype.render.apply(this,arguments),this},focusChild:function(e,t){e.focused||(this.focusedChild&&this.focusedChild.trigger("blur"),e.trigger("focus"),this.focusedChild=e,t&&this.$el.parent().scrollTop(e.$el.offset().top))},mousedownCell:function(e){var t=this;this.children.each(function(n){n.el===e.currentTarget&&t.focusChild(n)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(92),n(162),n(176),n(184)],r=function(e,t,n,i,r,o,a){return t.ItemView.extend({className:"cell",template:a,events:{"mousedown .result-toggler":"clickResultToggler",keyup:"keypressShow"},ui:{handle:".handle",code:".code",result:".result",resultWrapper:".result-wrapper"},controllers:o,initialize:function(){t.ItemView.prototype.initialize.apply(this,arguments);var e=this;this.focused=!1,this.on("focus",function(){e.onFocus()}),this.on("blur",function(){e.onBlur()}),this.on("render",this.refresh),this.initController()},render:function(){var n=this,i=this.model.get("outputs");return t.ItemView.prototype.render.apply(this,arguments),this.initEditor(),i&&!e.isEmpty(i)&&e.each(i,function(e){n.controller.savedOut(e)}),this},onRender:function(){this.model.get("collapsed")&&this.ui.result.hide()},onDestroy:function(){this.controller.destroy(),this.$el.next().remove()},refresh:function(){var e=this;setTimeout(function(){e.editor.refresh(),e.trigger("editorInited")},1)},onFocus:function(){var e=this;this.focused=!0,this.$el.addClass("focused"),this.controller.noHandle?e.trigger("focused"):$.Velocity.animate(this.ui.handle,"slideDown",{duration:200,easing:"easeOut",complete:function(){e.trigger("focused")}})},onBlur:function(){var e=this;this.focused=!1,this.$el.removeClass("focused"),this.controller.noHandle?e.trigger("blured"):$.Velocity.animate(this.ui.handle,"slideUp",{duration:200,easing:"easeOut",complete:function(){e.trigger("blured")}}),this.editor.hasFocus()&&this.editor.getInputField().blur()},toggleResult:function(e){this.model.get("collapsed")?this.showResult():this.hideResult()},showResult:function(){var e=this;this.ui.result.velocity("slideDown",{duration:200,easing:"easeOut",complete:function(){e.trigger("result:show")}}),this.$el.find(".result-toggler").removeClass("folded"),this.editor.refresh(),this.model.set("collapsed",!1)},hideResult:function(){var e=this;this.ui.result.velocity("slideUp",{duration:200,easing:"easeOut",complete:function(){e.trigger("result:hide")}}),this.$el.find(".result-toggler").addClass("folded"),this.model.set("collapsed",!0)},clickResultToggler:function(e){this.toggleResult()},initEditor:function(){var t=this,n=this.controller.value(this.model),i=e.result(this.controller,"cmOptions")||{},o=e.throttle(function(){t.controller.setValue(t.editor.getValue())},600),a=this.model.get("folded");e.isArray(n)&&(n=n.join("\n")),this.editor=r(this.$el.find(".input")[0],e.extend({value:n,mode:this.model.getCMMode()},i)),a&&this.$el.find(".CodeMirror-scroll").height(20),this.editor.on("run",function(){t.controller.run()}),this.editor.on("runAndNext",function(){t.controller.run()}),this.editor.on("change",function(){t.model.get("folded")||o()}),this.editor.on("focus",function(){t.trigger("focusme"),t.model.get("folded")&&(t.foldCode(),t.$el.trigger("click"))})},initController:function(){this.controller&&this.controller.destroy(),this.controller=new(this.controllers[this.model.get("cell_type")])({view:this})},keypressShow:function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0;App.vent.trigger("codehint",{controller:this.controller,key:t})},appendResult:function(t,n){var r=$('<div class="out"></div>');return e.isString(t)&&!n&&(t=i(t)),r.append(t),this.ui.resultWrapper.show(),this.ui.result.append(r),r},clearResult:function(){this.model.clearOutputs(),this.ui.result.empty(),this.ui.resultWrapper.hide()},onShow:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(163),n(164),n(166),n(167),n(168),n(169),n(170),n(175)],r=function(e,t){return function(n,i){return i=e.defaults(i,{indentUnit:4,tabSize:4,lineWrapping:!0,lineNumbers:!0,dragDrop:!1,keyMap:"sublime",highlightSelectionMatches:!0,matchBrackets:!0,autoCloseBrackets:!0,viewportMargin:1/0,extraKeys:e.defaults(i.extraKeys||{},{"Ctrl-Enter":function(){},"Ctrl-.":function(e){var n=e.getCursor(),i=e.getTokenAt(n),r=e.getTokenAt(t.Pos(n.line,i.start));console.log("current token",i),console.log("prev token",r)}})}),t(n,i)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){!function(t){e.exports=t()}(function(){"use strict";function e(n,i){if(!(this instanceof e))return new e(n,i);this.options=i=i?Pr(i):{},Pr(Qo,i,!1),p(i);var r=i.value;"string"==typeof r&&(r=new Ca(r,i.mode,null,i.lineSeparator)),this.doc=r;var o=new e.inputStyles[i.inputStyle](this),a=this.display=new t(n,r,o);a.wrapper.CodeMirror=this,c(this),s(this),i.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),i.autofocus&&!$o&&a.input.focus(),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Lr,keySeq:null,specialChars:null};var l=this;bo&&11>_o&&setTimeout(function(){l.display.input.reset(!0)},20),zt(this),Xr(),_t(this),this.curOp.forceUpdate=!0,Ki(this,r),i.autofocus&&!$o||l.hasFocus()?setTimeout(Or(vn,this),20):yn(this);for(var u in ea)ea.hasOwnProperty(u)&&ea[u](this,i[u],ta);x(this),i.finishInit&&i.finishInit(this);for(var d=0;d<oa.length;++d)oa[d](this);xt(this),wo&&i.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}function t(e,t,n){var i=this;this.input=n,i.scrollbarFiller=zr("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=zr("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=zr("div",null,"CodeMirror-code"),i.selectionDiv=zr("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=zr("div",null,"CodeMirror-cursors"),
i.measure=zr("div",null,"CodeMirror-measure"),i.lineMeasure=zr("div",null,"CodeMirror-measure"),i.lineSpace=zr("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),i.mover=zr("div",[zr("div",[i.lineSpace],"CodeMirror-lines")],null,"position: relative"),i.sizer=zr("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=zr("div",null,null,"position: absolute; height: "+ja+"px; width: 1px;"),i.gutters=zr("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=zr("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=zr("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),bo&&8>_o&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),wo||go&&$o||(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,n.init(i)}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),i(t)}function i(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,Ve(e,100),e.state.modeGen++,e.curOp&&Et(e)}function r(e){e.options.lineWrapping?(Ja(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Ka(e.display.wrapper,"CodeMirror-wrap"),h(e)),a(e),Et(e),st(e),setTimeout(function(){y(e)},100)}function o(e){var t=yt(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/bt(e.display)-3);return function(r){if(xi(e.doc,r))return 0;var o=0;if(r.widgets)for(var a=0;a<r.widgets.length;a++)r.widgets[a].height&&(o+=r.widgets[a].height);return n?o+(Math.ceil(r.text.length/i)||1)*t:o+t}}function a(e){var t=e.doc,n=o(e);t.iter(function(e){var t=n(e);t!=e.height&&er(e,t)})}function s(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),st(e)}function l(e){c(e),Et(e),setTimeout(function(){w(e)},20)}function c(e){var t=e.display.gutters,n=e.options.gutters;Br(t);for(var i=0;i<n.length;++i){var r=n[i],o=t.appendChild(zr("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=o,o.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=i?"":"none",u(e)}function u(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function d(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=mi(i);){var r=t.find(0,!0);i=r.from.line,n+=r.from.ch-r.to.ch}for(i=e;t=gi(i);){var r=t.find(0,!0);n-=i.text.length-r.from.ch,i=r.to.line,n+=i.text.length-r.to.ch}return n}function h(e){var t=e.display,n=e.doc;t.maxLine=Ji(n,n.first),t.maxLineLength=d(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=d(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function p(e){var t=Ir(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function f(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+We(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+qe(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function m(e,t,n){this.cm=n;var i=this.vert=zr("div",[zr("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=zr("div",[zr("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(i),e(r),$a(i,"scroll",function(){i.clientHeight&&t(i.scrollTop,"vertical")}),$a(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,bo&&8>_o&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function g(){}function v(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&Ka(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),$a(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,n){"horizontal"==n?on(t,e):rn(t,e)},t),t.display.scrollbars.addClass&&Ja(t.display.wrapper,t.display.scrollbars.addClass)}function y(e,t){t||(t=f(e));var n=e.display.barWidth,i=e.display.barHeight;b(e,t);for(var r=0;4>r&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&A(e),b(e,f(e)),n=e.display.barWidth,i=e.display.barHeight}function b(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function _(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-Be(e));var r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=nr(t,i),a=nr(t,r);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;o>s?(o=s,a=nr(t,ir(Ji(t,s))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=a&&(o=nr(t,ir(Ji(t,l))-e.wrapper.clientHeight),a=l)}return{from:o,to:Math.max(a,o+1)}}function w(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=k(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&n[a].gutter&&(n[a].gutter.style.left=o);var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function x(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=C(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(zr("div",[zr("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=r.firstChild.offsetWidth,a=r.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-a)+1,i.lineNumWidth=i.lineNumInnerWidth+a,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",u(e),!0}return!1}function C(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function k(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function S(e,t,n){var i=e.display;this.viewport=t,this.visible=_(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=Ge(e),this.force=n,this.dims=I(e),this.events=[]}function T(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=qe(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=qe(e)+"px",t.scrollbarsClipped=!0)}function D(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return Pt(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==Ht(e))return!1;x(e)&&(Pt(e),t.dims=I(e));var r=i.first+i.size,o=Math.max(t.visible.from-e.options.viewportMargin,i.first),a=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(i.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(r,n.viewTo)),No&&(o=_i(e.doc,o),a=wi(e.doc,a));var s=o!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;Ft(e,o,a),n.viewOffset=ir(Ji(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=Ht(e);if(!s&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=Ur();return l>4&&(n.lineDiv.style.display="none"),j(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,c&&Ur()!=c&&c.offsetHeight&&c.focus(),Br(n.cursorDiv),Br(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,Ve(e,400)),n.updateLineNumbers=null,!0}function M(e,t){for(var n=t.viewport,i=!0;(i&&e.options.lineWrapping&&t.oldDisplayWidth!=Ge(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+We(e.display)-Ye(e),n.top)}),t.visible=_(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&D(e,t);i=!1){A(e);var r=f(e);je(e),L(e,r),y(e,r)}t.signal(e,"update",e),(e.display.viewFrom!=e.display.reportedViewFrom||e.display.viewTo!=e.display.reportedViewTo)&&(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function $(e,t){var n=new S(e,t);if(D(e,n)){A(e),M(e,n);var i=f(e);je(e),L(e,i),y(e,i),n.finish()}}function L(e,t){e.display.sizer.style.minHeight=t.docHeight+"px";var n=t.docHeight+e.display.barHeight;e.display.heightForcer.style.top=n+"px",e.display.gutters.style.height=Math.max(n+qe(e),t.clientHeight)+"px"}function A(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var r,o=t.view[i];if(!o.hidden){if(bo&&8>_o){var a=o.node.offsetTop+o.node.offsetHeight;r=a-n,n=a}else{var s=o.node.getBoundingClientRect();r=s.bottom-s.top}var l=o.line.height-r;if(2>r&&(r=yt(t)),(l>.001||-.001>l)&&(er(o.line,r),R(o.line),o.rest))for(var c=0;c<o.rest.length;c++)R(o.rest[c])}}}function R(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function I(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,a=0;o;o=o.nextSibling,++a)n[e.options.gutters[a]]=o.offsetLeft+o.clientLeft+r,i[e.options.gutters[a]]=o.clientWidth;return{fixedPos:k(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function j(e,t,n){function i(t){var n=t.nextSibling;return wo&&Lo&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var r=e.display,o=e.options.lineNumbers,a=r.lineDiv,s=a.firstChild,l=r.view,c=r.viewFrom,u=0;u<l.length;u++){var d=l[u];if(d.hidden);else if(d.node&&d.node.parentNode==a){for(;s!=d.node;)s=i(s);var h=o&&null!=t&&c>=t&&d.lineNumber;d.changes&&(Ir(d.changes,"gutter")>-1&&(h=!1),E(e,d,c,n)),h&&(Br(d.lineNumber),d.lineNumber.appendChild(document.createTextNode(C(e.options,c)))),s=d.node.nextSibling}else{var p=B(e,d,c,n);a.insertBefore(p,s)}c+=d.size}for(;s;)s=i(s)}function E(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?V(e,t):"gutter"==o?H(e,t,n,i):"class"==o?F(t):"widget"==o&&z(e,t,i)}t.changes=null}function N(e){return e.node==e.text&&(e.node=zr("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),bo&&8>_o&&(e.node.style.zIndex=2)),e.node}function P(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=N(e);e.background=n.insertBefore(zr("div",null,t),n.firstChild)}}function O(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):Oi(e,t)}function V(e,t){var n=t.text.className,i=O(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,F(t)):n&&(t.text.className=n)}function F(e){P(e),e.line.wrapClass?N(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function H(e,t,n,i){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=N(t);t.gutterBackground=zr("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),r.insertBefore(t.gutterBackground,t.text)}var o=t.line.gutterMarkers;if(e.options.lineNumbers||o){var r=N(t),a=t.gutter=zr("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(e.display.input.setUneditable(a),r.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(zr("div",C(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o)for(var s=0;s<e.options.gutters.length;++s){var l=e.options.gutters[s],c=o.hasOwnProperty(l)&&o[l];c&&a.appendChild(zr("div",[c],"CodeMirror-gutter-elt","left: "+i.gutterLeft[l]+"px; width: "+i.gutterWidth[l]+"px"))}}}function z(e,t,n){t.alignable&&(t.alignable=null);for(var i,r=t.node.firstChild;r;r=i){var i=r.nextSibling;"CodeMirror-linewidget"==r.className&&t.node.removeChild(r)}W(e,t,n)}function B(e,t,n,i){var r=O(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),F(t),H(e,t,n,i),W(e,t,i),t.node}function W(e,t,n){if(U(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)U(e,t.rest[i],t,n,!1)}function U(e,t,n,i,r){if(t.widgets)for(var o=N(n),a=0,s=t.widgets;a<s.length;++a){var l=s[a],c=zr("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),q(l,c,n,i),e.display.input.setUneditable(c),r&&l.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),kr(l,"redraw")}}function q(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var r=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(r-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function G(e){return Po(e.line,e.ch)}function Y(e,t){return Oo(e,t)<0?t:e}function X(e,t){return Oo(e,t)<0?e:t}function K(e){e.state.focused||(e.display.input.focus(),vn(e))}function J(e,t,n,i,r){var o=e.doc;e.display.shift=!1,i||(i=o.sel);var a=e.state.pasteIncoming||"paste"==r,s=o.splitLines(t),l=null;if(a&&i.ranges.length>1)if(Vo&&Vo.join("\n")==t){if(i.ranges.length%Vo.length==0){l=[];for(var c=0;c<Vo.length;c++)l.push(o.splitLines(Vo[c]))}}else s.length==i.ranges.length&&(l=jr(s,function(e){return[e]}));for(var c=i.ranges.length-1;c>=0;c--){var u=i.ranges[c],d=u.from(),h=u.to();u.empty()&&(n&&n>0?d=Po(d.line,d.ch-n):e.state.overwrite&&!a&&(h=Po(h.line,Math.min(Ji(o,h.line).text.length,h.ch+Rr(s).length))));var p=e.curOp.updateInput,f={from:d,to:h,text:l?l[c%l.length]:s,origin:r||(a?"paste":e.state.cutIncoming?"cut":"+input")};Tn(e.doc,f),kr(e,"inputRead",e,f)}t&&!a&&Q(e,t),On(e),e.curOp.updateInput=p,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function Z(e,t){var n=e.clipboardData&&e.clipboardData.getData("text/plain");return n?(e.preventDefault(),t.isReadOnly()||t.options.disableInput||$t(t,function(){J(t,n,0,null,"paste")}),!0):void 0}function Q(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;i>=0;i--){var r=n.ranges[i];if(!(r.head.ch>100||i&&n.ranges[i-1].head.line==r.head.line)){var o=e.getModeAt(r.head),a=!1;if(o.electricChars){for(var s=0;s<o.electricChars.length;s++)if(t.indexOf(o.electricChars.charAt(s))>-1){a=Fn(e,r.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Ji(e.doc,r.head.line).text.slice(0,r.head.ch))&&(a=Fn(e,r.head.line,"smart"));a&&kr(e,"electricInput",e,r.head.line)}}}function ee(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,o={anchor:Po(r,0),head:Po(r+1,0)};n.push(o),t.push(e.getRange(o.anchor,o.head))}return{text:t,ranges:n}}function te(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function ne(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Lr,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function ie(){var e=zr("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=zr("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return wo?e.style.width="1000px":e.setAttribute("wrap","off"),Mo&&(e.style.border="1px solid black"),te(e),t}function re(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Lr,this.gracePeriod=!1}function oe(e,t){var n=Qe(e,t.line);if(!n||n.hidden)return null;var i=Ji(e.doc,t.line),r=Ke(n,i,t.line),o=rr(i),a="left";if(o){var s=co(o,t.ch);a=s%2?"right":"left"}var l=nt(r.map,t.ch,a);return l.offset="right"==l.collapse?l.end:l.start,l}function ae(e,t){return t&&(e.bad=!0),e}function se(e,t,n){var i;if(t==e.display.lineDiv){if(i=e.display.lineDiv.childNodes[n],!i)return ae(e.clipPos(Po(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==i)return le(o,t,n)}}function le(e,t,n){function i(t,n,i){for(var r=-1;r<(u?u.length:0);r++)for(var o=0>r?c.map:u[r],a=0;a<o.length;a+=3){var s=o[a+2];if(s==t||s==n){var l=tr(0>r?e.line:e.rest[r]),d=o[a]+i;return(0>i||s!=t)&&(d=o[a+(i?1:0)]),Po(l,d)}}}var r=e.text.firstChild,o=!1;if(!t||!Ga(r,t))return ae(Po(tr(e.line),0),!0);if(t==r&&(o=!0,t=r.childNodes[n],n=0,!t)){var a=e.rest?Rr(e.rest):e.line;return ae(Po(tr(a),a.text.length),o)}var s=3==t.nodeType?t:null,l=t;for(s||1!=t.childNodes.length||3!=t.firstChild.nodeType||(s=t.firstChild,n&&(n=s.nodeValue.length));l.parentNode!=r;)l=l.parentNode;var c=e.measure,u=c.maps,d=i(s,l,n);if(d)return ae(d,o);for(var h=l.nextSibling,p=s?s.nodeValue.length-n:0;h;h=h.nextSibling){if(d=i(h,h.firstChild,0))return ae(Po(d.line,d.ch-p),o);p+=h.textContent.length}for(var f=l.previousSibling,p=n;f;f=f.previousSibling){if(d=i(f,f.firstChild,-1))return ae(Po(d.line,d.ch+p),o);p+=h.textContent.length}}function ce(e,t,n,i,r){function o(e){return function(t){return t.id==e}}function a(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(null!=n)return""==n&&(n=t.textContent.replace(/\u200b/g,"")),void(s+=n);var u,d=t.getAttribute("cm-marker");if(d){var h=e.findMarks(Po(i,0),Po(r+1,0),o(+d));return void(h.length&&(u=h[0].find())&&(s+=Zi(e.doc,u.from,u.to).join(c)))}if("false"==t.getAttribute("contenteditable"))return;for(var p=0;p<t.childNodes.length;p++)a(t.childNodes[p]);/^(pre|div|p)$/i.test(t.nodeName)&&(l=!0)}else if(3==t.nodeType){var f=t.nodeValue;if(!f)return;l&&(s+=c,l=!1),s+=f}}for(var s="",l=!1,c=e.doc.lineSeparator();a(t),t!=n;)t=t.nextSibling;return s}function ue(e,t){this.ranges=e,this.primIndex=t}function de(e,t){this.anchor=e,this.head=t}function he(e,t){var n=e[t];e.sort(function(e,t){return Oo(e.from(),t.from())}),t=Ir(e,n);for(var i=1;i<e.length;i++){var r=e[i],o=e[i-1];if(Oo(o.to(),r.from())>=0){var a=X(o.from(),r.from()),s=Y(o.to(),r.to()),l=o.empty()?r.from()==r.head:o.from()==o.head;t>=i&&--t,e.splice(--i,2,new de(l?s:a,l?a:s))}}return new ue(e,t)}function pe(e,t){return new ue([new de(e,t||e)],0)}function fe(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function me(e,t){if(t.line<e.first)return Po(e.first,0);var n=e.first+e.size-1;return t.line>n?Po(n,Ji(e,n).text.length):ge(t,Ji(e,t.line).text.length)}function ge(e,t){var n=e.ch;return null==n||n>t?Po(e.line,t):0>n?Po(e.line,0):e}function ve(e,t){return t>=e.first&&t<e.first+e.size}function ye(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=me(e,t[i]);return n}function be(e,t,n,i){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(i){var o=Oo(n,r)<0;o!=Oo(i,r)<0?(r=n,n=i):o!=Oo(n,i)<0&&(n=i)}return new de(r,n)}return new de(i||n,n)}function _e(e,t,n,i){Te(e,new ue([be(e,e.sel.primary(),t,n)],0),i)}function we(e,t,n){for(var i=[],r=0;r<e.sel.ranges.length;r++)i[r]=be(e,e.sel.ranges[r],t[r],null);var o=he(i,e.sel.primIndex);Te(e,o,n)}function xe(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,Te(e,he(r,e.sel.primIndex),i)}function Ce(e,t,n,i){Te(e,pe(t,n),i)}function ke(e,t,n){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new de(me(e,t[n].anchor),me(e,t[n].head))},origin:n&&n.origin};return Ra(e,"beforeSelectionChange",e,i),e.cm&&Ra(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?he(i.ranges,i.ranges.length-1):t}function Se(e,t,n){var i=e.history.done,r=Rr(i);r&&r.ranges?(i[i.length-1]=t,De(e,t,n)):Te(e,t,n)}function Te(e,t,n){De(e,t,n),dr(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function De(e,t,n){(Mr(e,"beforeSelectionChange")||e.cm&&Mr(e.cm,"beforeSelectionChange"))&&(t=ke(e,t,n));var i=n&&n.bias||(Oo(t.primary().head,e.sel.primary().head)<0?-1:1);Me(e,Le(e,t,i,!0)),n&&n.scroll===!1||!e.cm||On(e.cm)}function Me(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Dr(e.cm)),kr(e,"cursorActivity",e))}function $e(e){Me(e,Le(e,e.sel,null,!1),Na)}function Le(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var a=t.ranges[o],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Re(e,a.anchor,s&&s.anchor,n,i),c=Re(e,a.head,s&&s.head,n,i);(r||l!=a.anchor||c!=a.head)&&(r||(r=t.ranges.slice(0,o)),r[o]=new de(l,c))}return r?he(r,t.primIndex):t}function Ae(e,t,n,i,r){var o=Ji(e,t.line);if(o.markedSpans)for(var a=0;a<o.markedSpans.length;++a){var s=o.markedSpans[a],l=s.marker;if((null==s.from||(l.inclusiveLeft?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(l.inclusiveRight?s.to>=t.ch:s.to>t.ch))){if(r&&(Ra(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var c,u=l.find(0>i?1:-1);if((0>i?l.inclusiveRight:l.inclusiveLeft)&&(u=Ie(e,u,-i,o)),u&&u.line==t.line&&(c=Oo(u,n))&&(0>i?0>c:c>0))return Ae(e,u,t,i,r)}var d=l.find(0>i?-1:1);return(0>i?l.inclusiveLeft:l.inclusiveRight)&&(d=Ie(e,d,i,o)),d?Ae(e,d,t,i,r):null}}return t}function Re(e,t,n,i,r){var o=i||1,a=Ae(e,t,n,o,r)||!r&&Ae(e,t,n,o,!0)||Ae(e,t,n,-o,r)||!r&&Ae(e,t,n,-o,!0);return a?a:(e.cantEdit=!0,Po(e.first,0))}function Ie(e,t,n,i){return 0>n&&0==t.ch?t.line>e.first?me(e,Po(t.line-1)):null:n>0&&t.ch==(i||Ji(e,t.line)).text.length?t.line<e.first+e.size-1?Po(t.line+1,0):null:new Po(t.line,t.ch+n)}function je(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Ee(e,t){for(var n=e.doc,i={},r=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(t!==!1||a!=n.sel.primIndex){var s=n.sel.ranges[a],l=s.empty();(l||e.options.showCursorWhenSelecting)&&Ne(e,s.head,r),l||Pe(e,s,o)}return i}function Ne(e,t,n){var i=pt(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=n.appendChild(zr("div"," ","CodeMirror-cursor"));if(r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other){var o=n.appendChild(zr("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=i.other.left+"px",o.style.top=i.other.top+"px",o.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function Pe(e,t,n){function i(e,t,n,i){0>t&&(t=0),t=Math.round(t),i=Math.round(i),s.appendChild(zr("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(i-t)+"px"))}function r(t,n,r){function o(n,i){return ht(e,Po(t,n),"div",d,i)}var s,l,d=Ji(a,t),h=d.text.length;return eo(rr(d),n||0,null==r?h:r,function(e,t,a){var d,p,f,m=o(e,"left");if(e==t)d=m,p=f=m.left;else{if(d=o(t-1,"right"),"rtl"==a){var g=m;m=d,d=g}p=m.left,f=d.right}null==n&&0==e&&(p=c),d.top-m.top>3&&(i(p,m.top,null,m.bottom),p=c,m.bottom<d.top&&i(p,m.bottom,null,d.top)),null==r&&t==h&&(f=u),(!s||m.top<s.top||m.top==s.top&&m.left<s.left)&&(s=m),(!l||d.bottom>l.bottom||d.bottom==l.bottom&&d.right>l.right)&&(l=d),c+1>p&&(p=c),i(p,d.top,f-p,d.bottom)}),{start:s,end:l}}var o=e.display,a=e.doc,s=document.createDocumentFragment(),l=Ue(e.display),c=l.left,u=Math.max(o.sizerWidth,Ge(e)-o.sizer.offsetLeft)-l.right,d=t.from(),h=t.to();if(d.line==h.line)r(d.line,d.ch,h.ch);else{var p=Ji(a,d.line),f=Ji(a,h.line),m=yi(p)==yi(f),g=r(d.line,d.ch,m?p.text.length+1:null).end,v=r(h.line,m?0:null,h.ch).start;m&&(g.top<v.top-2?(i(g.right,g.top,null,g.bottom),i(c,v.top,v.left,v.bottom)):i(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&i(c,g.bottom,null,v.top)}n.appendChild(s)}function Oe(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Ve(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,Or(Fe,e))}function Fe(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=sa(t.mode,ze(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(o){if(t.frontier>=e.display.viewFrom){var a=o.styles,s=o.text.length>e.options.maxHighlightLength,l=ji(e,o,s?sa(t.mode,i):i,!0);o.styles=l.styles;var c=o.styleClasses,u=l.classes;u?o.styleClasses=u:c&&(o.styleClasses=null);for(var d=!a||a.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),h=0;!d&&h<a.length;++h)d=a[h]!=o.styles[h];d&&r.push(t.frontier),o.stateAfter=s?i:sa(t.mode,i)}else o.text.length<=e.options.maxHighlightLength&&Ni(e,o.text,i),o.stateAfter=t.frontier%5==0?sa(t.mode,i):null;return++t.frontier,+new Date>n?(Ve(e,e.options.workDelay),!0):void 0}),r.length&&$t(e,function(){for(var t=0;t<r.length;t++)Nt(e,r[t],"text")})}}function He(e,t,n){for(var i,r,o=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=o.first)return o.first;var l=Ji(o,s-1);if(l.stateAfter&&(!n||s<=o.frontier))return s;var c=Va(l.text,null,e.options.tabSize);(null==r||i>c)&&(r=s-1,i=c)}return r}function ze(e,t,n){var i=e.doc,r=e.display;if(!i.mode.startState)return!0;var o=He(e,t,n),a=o>i.first&&Ji(i,o-1).stateAfter;return a=a?sa(i.mode,a):la(i.mode),i.iter(o,t,function(n){Ni(e,n.text,a);var s=o==t-1||o%5==0||o>=r.viewFrom&&o<r.viewTo;n.stateAfter=s?sa(i.mode,a):null,++o}),n&&(i.frontier=o),a}function Be(e){return e.lineSpace.offsetTop}function We(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Ue(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Wr(e.measure,zr("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function qe(e){return ja-e.display.nativeBarWidth}function Ge(e){return e.display.scroller.clientWidth-qe(e)-e.display.barWidth}function Ye(e){return e.display.scroller.clientHeight-qe(e)-e.display.barHeight}function Xe(e,t,n){var i=e.options.lineWrapping,r=i&&Ge(e);if(!t.measure.heights||i&&t.measure.width!=r){var o=t.measure.heights=[];if(i){t.measure.width=r;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-n.top)}}o.push(n.bottom-n.top)}}function Ke(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var i=0;i<e.rest.length;i++)if(tr(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Je(e,t){t=yi(t);var n=tr(t),i=e.display.externalMeasured=new It(e.doc,t,n);i.lineN=n;var r=i.built=Oi(e,i);return i.text=r.pre,Wr(e.display.lineMeasure,r.pre),i}function Ze(e,t,n,i){return tt(e,et(e,t),n,i)}function Qe(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Ot(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function et(e,t){var n=tr(t),i=Qe(e,n);i&&!i.text?i=null:i&&i.changes&&(E(e,i,n,I(e)),e.curOp.forceUpdate=!0),i||(i=Je(e,t));var r=Ke(i,t,n);return{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function tt(e,t,n,i,r){t.before&&(n=-1);var o,a=n+(i||"");return t.cache.hasOwnProperty(a)?o=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Xe(e,t.view,t.rect),t.hasHeights=!0),o=it(e,t,n,i),o.bogus||(t.cache[a]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}function nt(e,t,n){for(var i,r,o,a,s=0;s<e.length;s+=3){var l=e[s],c=e[s+1];if(l>t?(r=0,o=1,a="left"):c>t?(r=t-l,o=r+1):(s==e.length-3||t==c&&e[s+3]>t)&&(o=c-l,r=o-1,t>=c&&(a="right")),null!=r){if(i=e[s+2],l==c&&n==(i.insertLeft?"left":"right")&&(a=n),"left"==n&&0==r)for(;s&&e[s-2]==e[s-3]&&e[s-1].insertLeft;)i=e[(s-=3)+2],a="left";if("right"==n&&r==c-l)for(;s<e.length-3&&e[s+3]==e[s+4]&&!e[s+5].insertLeft;)i=e[(s+=3)+2],a="right";break}}return{node:i,start:r,end:o,collapse:a,coverStart:l,coverEnd:c}}function it(e,t,n,i){var r,o=nt(t.map,n,i),a=o.node,s=o.start,l=o.end,c=o.collapse;if(3==a.nodeType){for(var u=0;4>u;u++){for(;s&&Hr(t.line.text.charAt(o.coverStart+s));)--s;for(;o.coverStart+l<o.coverEnd&&Hr(t.line.text.charAt(o.coverStart+l));)++l;if(bo&&9>_o&&0==s&&l==o.coverEnd-o.coverStart)r=a.parentNode.getBoundingClientRect();else if(bo&&e.options.lineWrapping){var d=Ba(a,s,l).getClientRects();r=d.length?d["right"==i?d.length-1:0]:Bo}else r=Ba(a,s,l).getBoundingClientRect()||Bo;if(r.left||r.right||0==s)break;l=s,s-=1,c="right"}bo&&11>_o&&(r=rt(e.display.measure,r))}else{s>0&&(c=i="right");var d;r=e.options.lineWrapping&&(d=a.getClientRects()).length>1?d["right"==i?d.length-1:0]:a.getBoundingClientRect()}if(bo&&9>_o&&!s&&(!r||!r.left&&!r.right)){var h=a.parentNode.getClientRects()[0];r=h?{left:h.left,right:h.left+bt(e.display),top:h.top,bottom:h.bottom}:Bo}for(var p=r.top-t.rect.top,f=r.bottom-t.rect.top,m=(p+f)/2,g=t.view.measure.heights,u=0;u<g.length-1&&!(m<g[u]);u++);var v=u?g[u-1]:0,y=g[u],b={left:("right"==c?r.right:r.left)-t.rect.left,right:("left"==c?r.left:r.right)-t.rect.left,top:v,bottom:y};return r.left||r.right||(b.bogus=!0),e.options.singleCursorHeightPerLine||(b.rtop=p,b.rbottom=f),b}function rt(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!Qr(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function ot(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={};
}function at(e){e.display.externalMeasure=null,Br(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)ot(e.display.view[t])}function st(e){at(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function lt(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ct(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function ut(e,t,n,i){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var o=Si(t.widgets[r]);n.top+=o,n.bottom+=o}if("line"==i)return n;i||(i="local");var a=ir(t);if("local"==i?a+=Be(e.display):a-=e.display.viewOffset,"page"==i||"window"==i){var s=e.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==i?0:ct());var l=s.left+("window"==i?0:lt());n.left+=l,n.right+=l}return n.top+=a,n.bottom+=a,n}function dt(e,t,n){if("div"==n)return t;var i=t.left,r=t.top;if("page"==n)i-=lt(),r-=ct();else if("local"==n||!n){var o=e.display.sizer.getBoundingClientRect();i+=o.left,r+=o.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:i-a.left,top:r-a.top}}function ht(e,t,n,i,r){return i||(i=Ji(e.doc,t.line)),ut(e,i,Ze(e,i,t.ch,r),n)}function pt(e,t,n,i,r,o){function a(t,a){var s=tt(e,r,t,a?"right":"left",o);return a?s.left=s.right:s.right=s.left,ut(e,i,s,n)}function s(e,t){var n=l[t],i=n.level%2;return e==to(n)&&t&&n.level<l[t-1].level?(n=l[--t],e=no(n)-(n.level%2?0:1),i=!0):e==no(n)&&t<l.length-1&&n.level<l[t+1].level&&(n=l[++t],e=to(n)-n.level%2,i=!1),i&&e==n.to&&e>n.from?a(e-1):a(e,i)}i=i||Ji(e.doc,t.line),r||(r=et(e,i));var l=rr(i),c=t.ch;if(!l)return a(c);var u=co(l,c),d=s(c,u);return null!=os&&(d.other=s(c,os)),d}function ft(e,t){var n=0,t=me(e.doc,t);e.options.lineWrapping||(n=bt(e.display)*t.ch);var i=Ji(e.doc,t.line),r=ir(i)+Be(e.display);return{left:n,right:n,top:r,bottom:r+i.height}}function mt(e,t,n,i){var r=Po(e,t);return r.xRel=i,n&&(r.outside=!0),r}function gt(e,t,n){var i=e.doc;if(n+=e.display.viewOffset,0>n)return mt(i.first,0,!0,-1);var r=nr(i,n),o=i.first+i.size-1;if(r>o)return mt(i.first+i.size-1,Ji(i,o).text.length,!0,1);0>t&&(t=0);for(var a=Ji(i,r);;){var s=vt(e,a,r,t,n),l=gi(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;r=tr(a=c.to.line)}}function vt(e,t,n,i,r){function o(i){var r=pt(e,Po(n,i),"line",t,c);return s=!0,a>r.bottom?r.left-l:a<r.top?r.left+l:(s=!1,r.left)}var a=r-ir(t),s=!1,l=2*e.display.wrapper.clientWidth,c=et(e,t),u=rr(t),d=t.text.length,h=io(t),p=ro(t),f=o(h),m=s,g=o(p),v=s;if(i>g)return mt(n,p,v,1);for(;;){if(u?p==h||p==ho(t,h,1):1>=p-h){for(var y=f>i||g-i>=i-f?h:p,b=i-(y==h?f:g);Hr(t.text.charAt(y));)++y;var _=mt(n,y,y==h?m:v,-1>b?-1:b>1?1:0);return _}var w=Math.ceil(d/2),x=h+w;if(u){x=h;for(var C=0;w>C;++C)x=ho(t,x,1)}var k=o(x);k>i?(p=x,g=k,(v=s)&&(g+=1e3),d=w):(h=x,f=k,m=s,d-=w)}}function yt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==Fo){Fo=zr("pre");for(var t=0;49>t;++t)Fo.appendChild(document.createTextNode("x")),Fo.appendChild(zr("br"));Fo.appendChild(document.createTextNode("x"))}Wr(e.measure,Fo);var n=Fo.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),Br(e.measure),n||1}function bt(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=zr("span","xxxxxxxxxx"),n=zr("pre",[t]);Wr(e.measure,n);var i=t.getBoundingClientRect(),r=(i.right-i.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function _t(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Uo},Wo?Wo.ops.push(e.curOp):e.curOp.ownsGroup=Wo={ops:[e.curOp],delayedCallbacks:[]}}function wt(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(n<t.length)}function xt(e){var t=e.curOp,n=t.ownsGroup;if(n)try{wt(n)}finally{Wo=null;for(var i=0;i<n.ops.length;i++)n.ops[i].cm.curOp=null;Ct(n)}}function Ct(e){for(var t=e.ops,n=0;n<t.length;n++)kt(t[n]);for(var n=0;n<t.length;n++)St(t[n]);for(var n=0;n<t.length;n++)Tt(t[n]);for(var n=0;n<t.length;n++)Dt(t[n]);for(var n=0;n<t.length;n++)Mt(t[n])}function kt(e){var t=e.cm,n=t.display;T(t),e.updateMaxLine&&h(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new S(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function St(e){e.updatedDisplay=e.mustUpdate&&D(e.cm,e.update)}function Tt(e){var t=e.cm,n=t.display;e.updatedDisplay&&A(t),e.barMeasure=f(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Ze(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+qe(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-Ge(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function Dt(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&on(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),e.updatedDisplay&&L(t,e.barMeasure),(e.updatedDisplay||e.startHeight!=t.doc.height)&&y(t,e.barMeasure),e.selectionChanged&&Oe(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),!e.focus||e.focus!=Ur()||document.hasFocus&&!document.hasFocus()||K(e.cm)}function Mt(e){var t=e.cm,n=t.display,i=t.doc;if(e.updatedDisplay&&M(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==e.scrollTop||n.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(i.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(i.scrollTop),n.scroller.scrollTop=i.scrollTop),null==e.scrollLeft||n.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(i.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-Ge(t),e.scrollLeft)),n.scrollbars.setScrollLeft(i.scrollLeft),n.scroller.scrollLeft=i.scrollLeft,w(t)),e.scrollToPos){var r=jn(t,me(i,e.scrollToPos.from),me(i,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&In(t,r)}var o=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(o)for(var s=0;s<o.length;++s)o[s].lines.length||Ra(o[s],"hide");if(a)for(var s=0;s<a.length;++s)a[s].lines.length&&Ra(a[s],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ra(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function $t(e,t){if(e.curOp)return t();_t(e);try{return t()}finally{xt(e)}}function Lt(e,t){return function(){if(e.curOp)return t.apply(e,arguments);_t(e);try{return t.apply(e,arguments)}finally{xt(e)}}}function At(e){return function(){if(this.curOp)return e.apply(this,arguments);_t(this);try{return e.apply(this,arguments)}finally{xt(this)}}}function Rt(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);_t(t);try{return e.apply(this,arguments)}finally{xt(t)}}}function It(e,t,n){this.line=t,this.rest=bi(t),this.size=this.rest?tr(Rr(this.rest))-n+1:1,this.node=this.text=null,this.hidden=xi(e,t)}function jt(e,t,n){for(var i,r=[],o=t;n>o;o=i){var a=new It(e.doc,Ji(e.doc,o),o);i=o+a.size,r.push(a)}return r}function Et(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var r=e.display;if(i&&n<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)No&&_i(e.doc,t)<r.viewTo&&Pt(e);else if(n<=r.viewFrom)No&&wi(e.doc,n+i)>r.viewFrom?Pt(e):(r.viewFrom+=i,r.viewTo+=i);else if(t<=r.viewFrom&&n>=r.viewTo)Pt(e);else if(t<=r.viewFrom){var o=Vt(e,n,n+i,1);o?(r.view=r.view.slice(o.index),r.viewFrom=o.lineN,r.viewTo+=i):Pt(e)}else if(n>=r.viewTo){var o=Vt(e,t,t,-1);o?(r.view=r.view.slice(0,o.index),r.viewTo=o.lineN):Pt(e)}else{var a=Vt(e,t,t,-1),s=Vt(e,n,n+i,1);a&&s?(r.view=r.view.slice(0,a.index).concat(jt(e,a.lineN,s.lineN)).concat(r.view.slice(s.index)),r.viewTo+=i):Pt(e)}var l=r.externalMeasured;l&&(n<l.lineN?l.lineN+=i:t<l.lineN+l.size&&(r.externalMeasured=null))}function Nt(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var o=i.view[Ot(e,t)];if(null!=o.node){var a=o.changes||(o.changes=[]);-1==Ir(a,n)&&a.push(n)}}}function Pt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Ot(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var n=e.display.view,i=0;i<n.length;i++)if(t-=n[i].size,0>t)return i}function Vt(e,t,n,i){var r,o=Ot(e,t),a=e.display.view;if(!No||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var s=0,l=e.display.viewFrom;o>s;s++)l+=a[s].size;if(l!=t){if(i>0){if(o==a.length-1)return null;r=l+a[o].size-t,o++}else r=l-t;t+=r,n+=r}for(;_i(e.doc,n)!=n;){if(o==(0>i?0:a.length-1))return null;n+=i*a[o-(0>i?1:0)].size,o+=i}return{index:o,lineN:n}}function Ft(e,t,n){var i=e.display,r=i.view;0==r.length||t>=i.viewTo||n<=i.viewFrom?(i.view=jt(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=jt(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(Ot(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(jt(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,Ot(e,n)))),i.viewTo=n}function Ht(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function zt(e){function t(){r.activeTouch&&(o=setTimeout(function(){r.activeTouch=null},1e3),a=r.activeTouch,a.end=+new Date)}function n(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function i(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}var r=e.display;$a(r.scroller,"mousedown",Lt(e,Gt)),bo&&11>_o?$a(r.scroller,"dblclick",Lt(e,function(t){if(!Tr(e,t)){var n=qt(e,t);if(n&&!Zt(e,t)&&!Ut(e.display,t)){Ta(t);var i=e.findWordAt(n);_e(e.doc,i.anchor,i.head)}}})):$a(r.scroller,"dblclick",function(t){Tr(e,t)||Ta(t)}),jo||$a(r.scroller,"contextmenu",function(t){bn(e,t)});var o,a={end:0};$a(r.scroller,"touchstart",function(e){if(!n(e)){clearTimeout(o);var t=+new Date;r.activeTouch={start:t,moved:!1,prev:t-a.end<=300?a:null},1==e.touches.length&&(r.activeTouch.left=e.touches[0].pageX,r.activeTouch.top=e.touches[0].pageY)}}),$a(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),$a(r.scroller,"touchend",function(n){var o=r.activeTouch;if(o&&!Ut(r,n)&&null!=o.left&&!o.moved&&new Date-o.start<300){var a,s=e.coordsChar(r.activeTouch,"page");a=!o.prev||i(o,o.prev)?new de(s,s):!o.prev.prev||i(o,o.prev.prev)?e.findWordAt(s):new de(Po(s.line,0),me(e.doc,Po(s.line+1,0))),e.setSelection(a.anchor,a.head),e.focus(),Ta(n)}t()}),$a(r.scroller,"touchcancel",t),$a(r.scroller,"scroll",function(){r.scroller.clientHeight&&(rn(e,r.scroller.scrollTop),on(e,r.scroller.scrollLeft,!0),Ra(e,"scroll",e))}),$a(r.scroller,"mousewheel",function(t){an(e,t)}),$a(r.scroller,"DOMMouseScroll",function(t){an(e,t)}),$a(r.wrapper,"scroll",function(){r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(t){Tr(e,t)||Ma(t)},over:function(t){Tr(e,t)||(tn(e,t),Ma(t))},start:function(t){en(e,t)},drop:Lt(e,Qt),leave:function(){nn(e)}};var s=r.input.getField();$a(s,"keyup",function(t){fn.call(e,t)}),$a(s,"keydown",Lt(e,hn)),$a(s,"keypress",Lt(e,mn)),$a(s,"focus",Or(vn,e)),$a(s,"blur",Or(yn,e))}function Bt(t,n,i){var r=i&&i!=e.Init;if(!n!=!r){var o=t.display.dragFunctions,a=n?$a:Aa;a(t.display.scroller,"dragstart",o.start),a(t.display.scroller,"dragenter",o.enter),a(t.display.scroller,"dragover",o.over),a(t.display.scroller,"dragleave",o.leave),a(t.display.scroller,"drop",o.drop)}}function Wt(e){var t=e.display;(t.lastWrapHeight!=t.wrapper.clientHeight||t.lastWrapWidth!=t.wrapper.clientWidth)&&(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function Ut(e,t){for(var n=wr(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function qt(e,t,n,i){var r=e.display;if(!n&&"true"==wr(t).getAttribute("cm-not-content"))return null;var o,a,s=r.lineSpace.getBoundingClientRect();try{o=t.clientX-s.left,a=t.clientY-s.top}catch(t){return null}var l,c=gt(e,o,a);if(i&&1==c.xRel&&(l=Ji(e.doc,c.line).text).length==c.ch){var u=Va(l,l.length,e.options.tabSize)-l.length;c=Po(c.line,Math.max(0,Math.round((o-Ue(e.display).left)/bt(e.display))-u))}return c}function Gt(e){var t=this,n=t.display;if(!(n.activeTouch&&n.input.supportsTouch()||Tr(t,e))){if(n.shift=e.shiftKey,Ut(n,e))return void(wo||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)));if(!Zt(t,e)){var i=qt(t,e);switch(window.focus(),xr(e)){case 1:t.state.selectingText?t.state.selectingText(e):i?Yt(t,e,i):wr(e)==n.scroller&&Ta(e);break;case 2:wo&&(t.state.lastMiddleDown=+new Date),i&&_e(t.doc,i),setTimeout(function(){n.input.focus()},20),Ta(e);break;case 3:jo?bn(t,e):gn(t)}}}}function Yt(e,t,n){bo?setTimeout(Or(K,e),0):e.curOp.focus=Ur();var i,r=+new Date;zo&&zo.time>r-400&&0==Oo(zo.pos,n)?i="triple":Ho&&Ho.time>r-400&&0==Oo(Ho.pos,n)?(i="double",zo={time:r,pos:n}):(i="single",Ho={time:r,pos:n});var o,a=e.doc.sel,s=Lo?t.metaKey:t.ctrlKey;e.options.dragDrop&&Qa&&!e.isReadOnly()&&"single"==i&&(o=a.contains(n))>-1&&(Oo((o=a.ranges[o]).from(),n)<0||n.xRel>0)&&(Oo(o.to(),n)>0||n.xRel<0)?Xt(e,t,n,s):Kt(e,t,n,i,s)}function Xt(e,t,n,i){var r=e.display,o=+new Date,a=Lt(e,function(s){wo&&(r.scroller.draggable=!1),e.state.draggingText=!1,Aa(document,"mouseup",a),Aa(r.scroller,"drop",a),Math.abs(t.clientX-s.clientX)+Math.abs(t.clientY-s.clientY)<10&&(Ta(s),!i&&+new Date-200<o&&_e(e.doc,n),wo||bo&&9==_o?setTimeout(function(){document.body.focus(),r.input.focus()},20):r.input.focus())});wo&&(r.scroller.draggable=!0),e.state.draggingText=a,r.scroller.dragDrop&&r.scroller.dragDrop(),$a(document,"mouseup",a),$a(r.scroller,"drop",a)}function Kt(e,t,n,i,r){function o(t){if(0!=Oo(g,t))if(g=t,"rect"==i){for(var r=[],o=e.options.tabSize,a=Va(Ji(c,n.line).text,n.ch,o),s=Va(Ji(c,t.line).text,t.ch,o),l=Math.min(a,s),p=Math.max(a,s),f=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));m>=f;f++){var v=Ji(c,f).text,y=Fa(v,l,o);l==p?r.push(new de(Po(f,y),Po(f,y))):v.length>y&&r.push(new de(Po(f,y),Po(f,Fa(v,p,o))))}r.length||r.push(new de(n,n)),Te(c,he(h.ranges.slice(0,d).concat(r),d),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var b=u,_=b.anchor,w=t;if("single"!=i){if("double"==i)var x=e.findWordAt(t);else var x=new de(Po(t.line,0),me(c,Po(t.line+1,0)));Oo(x.anchor,_)>0?(w=x.head,_=X(b.from(),x.anchor)):(w=x.anchor,_=Y(b.to(),x.head))}var r=h.ranges.slice(0);r[d]=new de(me(c,_),w),Te(c,he(r,d),Pa)}}function a(t){var n=++y,r=qt(e,t,!0,"rect"==i);if(r)if(0!=Oo(r,g)){e.curOp.focus=Ur(),o(r);var s=_(l,c);(r.line>=s.to||r.line<s.from)&&setTimeout(Lt(e,function(){y==n&&a(t)}),150)}else{var u=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;u&&setTimeout(Lt(e,function(){y==n&&(l.scroller.scrollTop+=u,a(t))}),50)}}function s(t){e.state.selectingText=!1,y=1/0,Ta(t),l.input.focus(),Aa(document,"mousemove",b),Aa(document,"mouseup",w),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;Ta(t);var u,d,h=c.sel,p=h.ranges;if(r&&!t.shiftKey?(d=c.sel.contains(n),u=d>-1?p[d]:new de(n,n)):(u=c.sel.primary(),d=c.sel.primIndex),t.altKey)i="rect",r||(u=new de(n,n)),n=qt(e,t,!0,!0),d=-1;else if("double"==i){var f=e.findWordAt(n);u=e.display.shift||c.extend?be(c,u,f.anchor,f.head):f}else if("triple"==i){var m=new de(Po(n.line,0),me(c,Po(n.line+1,0)));u=e.display.shift||c.extend?be(c,u,m.anchor,m.head):m}else u=be(c,u,n);r?-1==d?(d=p.length,Te(c,he(p.concat([u]),d),{scroll:!1,origin:"*mouse"})):p.length>1&&p[d].empty()&&"single"==i&&!t.shiftKey?(Te(c,he(p.slice(0,d).concat(p.slice(d+1)),0),{scroll:!1,origin:"*mouse"}),h=c.sel):xe(c,d,u,Pa):(d=0,Te(c,new ue([u],0),Pa),h=c.sel);var g=n,v=l.wrapper.getBoundingClientRect(),y=0,b=Lt(e,function(e){xr(e)?a(e):s(e)}),w=Lt(e,s);e.state.selectingText=w,$a(document,"mousemove",b),$a(document,"mouseup",w)}function Jt(e,t,n,i){try{var r=t.clientX,o=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Ta(t);var a=e.display,s=a.lineDiv.getBoundingClientRect();if(o>s.bottom||!Mr(e,n))return _r(t);o-=s.top-a.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var c=a.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=r){var u=nr(e.doc,o),d=e.options.gutters[l];return Ra(e,n,e,u,d,t),_r(t)}}}function Zt(e,t){return Jt(e,t,"gutterClick",!0)}function Qt(e){var t=this;if(nn(t),!Tr(t,e)&&!Ut(t.display,e)){Ta(e),bo&&(qo=+new Date);var n=qt(t,e,!0),i=e.dataTransfer.files;if(n&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var r=i.length,o=Array(r),a=0,s=function(e,i){if(!t.options.allowDropFileTypes||-1!=Ir(t.options.allowDropFileTypes,e.type)){var s=new FileReader;s.onload=Lt(t,function(){var e=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),o[i]=e,++a==r){n=me(t.doc,n);var l={from:n,to:n,text:t.doc.splitLines(o.join(t.doc.lineSeparator())),origin:"paste"};Tn(t.doc,l),Se(t.doc,pe(n,Zo(l)))}}),s.readAsText(e)}},l=0;r>l;++l)s(i[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{var o=e.dataTransfer.getData("Text");if(o){if(t.state.draggingText&&!(Lo?e.altKey:e.ctrlKey))var c=t.listSelections();if(De(t.doc,pe(n,n)),c)for(var l=0;l<c.length;++l)Rn(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(o,"around","paste"),t.display.input.focus()}}catch(e){}}}}function en(e,t){if(bo&&(!e.state.draggingText||+new Date-qo<100))return void Ma(t);if(!Tr(e,t)&&!Ut(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.setDragImage&&!So)){var n=zr("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",ko&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),ko&&n.parentNode.removeChild(n)}}function tn(e,t){var n=qt(e,t);if(n){var i=document.createDocumentFragment();Ne(e,n,i),e.display.dragCursor||(e.display.dragCursor=zr("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),Wr(e.display.dragCursor,i)}}function nn(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function rn(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,go||$(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),go&&$(e),Ve(e,100))}function on(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,w(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function an(e,t){var n=Xo(t),i=n.x,r=n.y,o=e.display,a=o.scroller,s=a.scrollWidth>a.clientWidth,l=a.scrollHeight>a.clientHeight;if(i&&s||r&&l){if(r&&Lo&&wo)e:for(var c=t.target,u=o.view;c!=a;c=c.parentNode)for(var d=0;d<u.length;d++)if(u[d].node==c){e.display.currentWheelTarget=c;break e}if(i&&!go&&!ko&&null!=Yo)return r&&l&&rn(e,Math.max(0,Math.min(a.scrollTop+r*Yo,a.scrollHeight-a.clientHeight))),on(e,Math.max(0,Math.min(a.scrollLeft+i*Yo,a.scrollWidth-a.clientWidth))),(!r||r&&l)&&Ta(t),void(o.wheelStartX=null);if(r&&null!=Yo){var h=r*Yo,p=e.doc.scrollTop,f=p+o.wrapper.clientHeight;0>h?p=Math.max(0,p+h-50):f=Math.min(e.doc.height,f+h+50),$(e,{top:p,bottom:f})}20>Go&&(null==o.wheelStartX?(o.wheelStartX=a.scrollLeft,o.wheelStartY=a.scrollTop,o.wheelDX=i,o.wheelDY=r,setTimeout(function(){if(null!=o.wheelStartX){var e=a.scrollLeft-o.wheelStartX,t=a.scrollTop-o.wheelStartY,n=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null,n&&(Yo=(Yo*Go+n)/(Go+1),++Go)}},200)):(o.wheelDX+=i,o.wheelDY+=r))}}function sn(e,t,n){if("string"==typeof t&&(t=ca[t],!t))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=Ea}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}function ln(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=da(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&da(t,e.options.extraKeys,n,e)||da(t,e.options.keyMap,n,e)}function cn(e,t,n,i){var r=e.state.keySeq;if(r){if(ha(t))return"handled";Ko.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var o=ln(e,t,i);return"multi"==o&&(e.state.keySeq=t),"handled"==o&&kr(e,"keyHandled",e,t,n),("handled"==o||"multi"==o)&&(Ta(n),Oe(e)),r&&!o&&/\'$/.test(t)?(Ta(n),!0):!!o}function un(e,t){var n=pa(t,!0);return n?t.shiftKey&&!e.state.keySeq?cn(e,"Shift-"+n,t,function(t){return sn(e,t,!0)})||cn(e,n,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?sn(e,t):void 0}):cn(e,n,t,function(t){return sn(e,t)}):!1}function dn(e,t,n){return cn(e,"'"+n+"'",t,function(t){return sn(e,t,!0)})}function hn(e){var t=this;if(t.curOp.focus=Ur(),!Tr(t,e)){bo&&11>_o&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var i=un(t,e);ko&&(Jo=i?n:null,!i&&88==n&&!ns&&(Lo?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||pn(t)}}function pn(e){function t(e){18!=e.keyCode&&e.altKey||(Ka(n,"CodeMirror-crosshair"),Aa(document,"keyup",t),Aa(document,"mouseover",t))}var n=e.display.lineDiv;Ja(n,"CodeMirror-crosshair"),$a(document,"keyup",t),$a(document,"mouseover",t)}function fn(e){16==e.keyCode&&(this.doc.sel.shift=!1),Tr(this,e)}function mn(e){var t=this;if(!(Ut(t.display,e)||Tr(t,e)||e.ctrlKey&&!e.altKey||Lo&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(ko&&n==Jo)return Jo=null,void Ta(e);if(!ko||e.which&&!(e.which<10)||!un(t,e)){var r=String.fromCharCode(null==i?n:i);dn(t,e,r)||t.display.input.onKeyPress(e)}}}function gn(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,yn(e))},100)}function vn(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Ra(e,"focus",e),e.state.focused=!0,Ja(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),wo&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Oe(e))}function yn(e){e.state.delayingBlurEvent||(e.state.focused&&(Ra(e,"blur",e),e.state.focused=!1,Ka(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function bn(e,t){Ut(e.display,t)||_n(e,t)||Tr(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function _n(e,t){return Mr(e,"gutterContextMenu")?Jt(e,t,"gutterContextMenu",!1):!1}function wn(e,t){if(Oo(e,t.from)<0)return e;if(Oo(e,t.to)<=0)return Zo(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=Zo(t).ch-t.to.ch),Po(n,i)}function xn(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new de(wn(r.anchor,t),wn(r.head,t)))}return he(n,e.sel.primIndex)}function Cn(e,t,n){return e.line==t.line?Po(n.line,e.ch-t.ch+n.ch):Po(n.line+(e.line-t.line),e.ch)}function kn(e,t,n){for(var i=[],r=Po(e.first,0),o=r,a=0;a<t.length;a++){var s=t[a],l=Cn(s.from,r,o),c=Cn(Zo(s),r,o);if(r=s.to,o=c,"around"==n){var u=e.sel.ranges[a],d=Oo(u.head,u.anchor)<0;i[a]=new de(d?c:l,d?l:c)}else i[a]=new de(l,l)}return new ue(i,e.sel.primIndex)}function Sn(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(i.update=function(t,n,i,r){t&&(this.from=me(e,t)),n&&(this.to=me(e,n)),i&&(this.text=i),void 0!==r&&(this.origin=r)}),Ra(e,"beforeChange",e,i),e.cm&&Ra(e.cm,"beforeChange",e.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function Tn(e,t,n){if(e.cm){if(!e.cm.curOp)return Lt(e.cm,Tn)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Mr(e,"beforeChange")||e.cm&&Mr(e.cm,"beforeChange"))||(t=Sn(e,t,!0))){var i=Eo&&!n&&li(e,t.from,t.to);if(i)for(var r=i.length-1;r>=0;--r)Dn(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text});else Dn(e,t)}}function Dn(e,t){if(1!=t.text.length||""!=t.text[0]||0!=Oo(t.from,t.to)){var n=xn(e,t);cr(e,t,n,e.cm?e.cm.curOp.id:NaN),Ln(e,t,n,oi(e,t));var i=[];Xi(e,function(e,n){n||-1!=Ir(i,e.history)||(br(e.history,t),i.push(e.history)),Ln(e,t,null,oi(e,t))})}}function Mn(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var i,r=e.history,o=e.sel,a="undo"==t?r.done:r.undone,s="undo"==t?r.undone:r.done,l=0;l<a.length&&(i=a[l],n?!i.ranges||i.equals(e.sel):i.ranges);l++);if(l!=a.length){for(r.lastOrigin=r.lastSelOrigin=null;i=a.pop(),i.ranges;){if(hr(i,s),n&&!i.equals(e.sel))return void Te(e,i,{clearRedo:!1});o=i}var c=[];hr(o,s),s.push({changes:c,generation:r.generation}),r.generation=i.generation||++r.maxGeneration;for(var u=Mr(e,"beforeChange")||e.cm&&Mr(e.cm,"beforeChange"),l=i.changes.length-1;l>=0;--l){var d=i.changes[l];if(d.origin=t,u&&!Sn(e,d,!1))return void(a.length=0);c.push(ar(e,d));var h=l?xn(e,d):Rr(a);Ln(e,d,h,si(e,d)),!l&&e.cm&&e.cm.scrollIntoView({from:d.from,to:Zo(d)});var p=[];Xi(e,function(e,t){t||-1!=Ir(p,e.history)||(br(e.history,d),p.push(e.history)),Ln(e,d,null,si(e,d))})}}}}function $n(e,t){if(0!=t&&(e.first+=t,e.sel=new ue(jr(e.sel.ranges,function(e){return new de(Po(e.anchor.line+t,e.anchor.ch),Po(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Et(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)Nt(e.cm,i,"gutter")}}function Ln(e,t,n,i){if(e.cm&&!e.cm.curOp)return Lt(e.cm,Ln)(e,t,n,i);if(t.to.line<e.first)return void $n(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);$n(e,r),t={from:Po(e.first,0),to:Po(t.to.line+r,t.to.ch),text:[Rr(t.text)],origin:t.origin}}var o=e.lastLine();t.to.line>o&&(t={from:t.from,to:Po(o,Ji(e,o).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Zi(e,t.from,t.to),n||(n=xn(e,t)),e.cm?An(e.cm,t,i):qi(e,t,i),De(e,n,Na)}}function An(e,t,n){var i=e.doc,r=e.display,a=t.from,s=t.to,l=!1,c=a.line;e.options.lineWrapping||(c=tr(yi(Ji(i,a.line))),i.iter(c,s.line+1,function(e){return e==r.maxLine?(l=!0,!0):void 0})),i.sel.contains(t.from,t.to)>-1&&Dr(e),qi(i,t,n,o(e)),e.options.lineWrapping||(i.iter(c,a.line+t.text.length,function(e){var t=d(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,a.line),Ve(e,400);var u=t.text.length-(s.line-a.line)-1;t.full?Et(e):a.line!=s.line||1!=t.text.length||Ui(e.doc,t)?Et(e,a.line,s.line+1,u):Nt(e,a.line,"text");var h=Mr(e,"changes"),p=Mr(e,"change");if(p||h){var f={from:a,to:s,text:t.text,removed:t.removed,origin:t.origin};p&&kr(e,"change",e,f),h&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(f)}e.display.selForContextMenu=null}function Rn(e,t,n,i,r){if(i||(i=n),Oo(i,n)<0){var o=i;i=n,n=o}"string"==typeof t&&(t=e.splitLines(t)),Tn(e,{from:n,to:i,text:t,origin:r})}function In(e,t){if(!Tr(e,"scrollCursorIntoView")){var n=e.display,i=n.sizer.getBoundingClientRect(),r=null;if(t.top+i.top<0?r=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!Do){var o=zr("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-Be(e.display))+"px; height: "+(t.bottom-t.top+qe(e)+n.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(o),o.scrollIntoView(r),e.display.lineSpace.removeChild(o)}}}function jn(e,t,n,i){null==i&&(i=0);for(var r=0;5>r;r++){var o=!1,a=pt(e,t),s=n&&n!=t?pt(e,n):a,l=Nn(e,Math.min(a.left,s.left),Math.min(a.top,s.top)-i,Math.max(a.left,s.left),Math.max(a.bottom,s.bottom)+i),c=e.doc.scrollTop,u=e.doc.scrollLeft;if(null!=l.scrollTop&&(rn(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(o=!0)),null!=l.scrollLeft&&(on(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(o=!0)),!o)break}return a}function En(e,t,n,i,r){var o=Nn(e,t,n,i,r);null!=o.scrollTop&&rn(e,o.scrollTop),null!=o.scrollLeft&&on(e,o.scrollLeft)}function Nn(e,t,n,i,r){var o=e.display,a=yt(e.display);0>n&&(n=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:o.scroller.scrollTop,l=Ye(e),c={};r-n>l&&(r=n+l);var u=e.doc.height+We(o),d=a>n,h=r>u-a;if(s>n)c.scrollTop=d?0:n;else if(r>s+l){var p=Math.min(n,(h?u:r)-l);p!=s&&(c.scrollTop=p)}var f=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:o.scroller.scrollLeft,m=Ge(e)-(e.options.fixedGutter?o.gutters.offsetWidth:0),g=i-t>m;return g&&(i=t+m),10>t?c.scrollLeft=0:f>t?c.scrollLeft=Math.max(0,t-(g?0:10)):i>m+f-3&&(c.scrollLeft=i+(g?0:10)-m),c}function Pn(e,t,n){(null!=t||null!=n)&&Vn(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function On(e){Vn(e);var t=e.getCursor(),n=t,i=t;e.options.lineWrapping||(n=t.ch?Po(t.line,t.ch-1):t,i=Po(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:i,margin:e.options.cursorScrollMargin,isCursor:!0}}function Vn(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=ft(e,t.from),i=ft(e,t.to),r=Nn(e,Math.min(n.left,i.left),Math.min(n.top,i.top)-t.margin,Math.max(n.right,i.right),Math.max(n.bottom,i.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function Fn(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=ze(e,t):n="prev");var a=e.options.tabSize,s=Ji(o,t),l=Va(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,u=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&(c=o.mode.indent(r,s.text.slice(u.length),s.text),c==Ea||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?Va(Ji(o,t-1).text,null,a):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var d="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(c/a);p;--p)h+=a,d+="	";if(c>h&&(d+=Ar(c-h)),d!=u)return Rn(o,d,Po(t,0),Po(t,u.length),"+input"),s.stateAfter=null,!0;for(var p=0;p<o.sel.ranges.length;p++){var f=o.sel.ranges[p];if(f.head.line==t&&f.head.ch<u.length){var h=Po(t,u.length);xe(o,p,new de(h,h));break}}}function Hn(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=Ji(e,fe(e,t)):r=tr(t),null==r?null:(i(o,r)&&e.cm&&Nt(e.cm,r,n),o)}function zn(e,t){for(var n=e.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=t(n[r]);i.length&&Oo(o.from,Rr(i).to)<=0;){var a=i.pop();if(Oo(a.from,o.from)<0){o.from=a.from;break}}i.push(o)}$t(e,function(){for(var t=i.length-1;t>=0;t--)Rn(e.doc,"",i[t].from,i[t].to,"+delete");On(e)})}function Bn(e,t,n,i,r){function o(){var t=s+n;return t<e.first||t>=e.first+e.size?d=!1:(s=t,u=Ji(e,t))}function a(e){var t=(r?ho:po)(u,l,n,!0);if(null==t){if(e||!o())return d=!1;l=r?(0>n?ro:io)(u):0>n?u.text.length:0}else l=t;return!0}var s=t.line,l=t.ch,c=n,u=Ji(e,s),d=!0;if("char"==i)a();else if("column"==i)a(!0);else if("word"==i||"group"==i)for(var h=null,p="group"==i,f=e.cm&&e.cm.getHelper(t,"wordChars"),m=!0;!(0>n)||a(!m);m=!1){
var g=u.text.charAt(l)||"\n",v=Vr(g,f)?"w":p&&"\n"==g?"n":!p||/\s/.test(g)?null:"p";if(!p||m||v||(v="s"),h&&h!=v){0>n&&(n=1,a());break}if(v&&(h=v),n>0&&!a(!m))break}var y=Re(e,Po(s,l),t,c,!0);return d||(y.hitSide=!0),y}function Wn(e,t,n,i){var r,o=e.doc,a=t.left;if("page"==i){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+n*(s-(0>n?1.5:.5)*yt(e.display))}else"line"==i&&(r=n>0?t.bottom+3:t.top-3);for(;;){var l=gt(e,a,r);if(!l.outside)break;if(0>n?0>=r:r>=o.height){l.hitSide=!0;break}r+=5*n}return l}function Un(t,n,i,r){e.defaults[t]=n,i&&(ea[t]=r?function(e,t,n){n!=ta&&i(e,t,n)}:i)}function qn(e){for(var t,n,i,r,o=e.split(/-(?!$)/),e=o[o.length-1],a=0;a<o.length-1;a++){var s=o[a];if(/^(cmd|meta|m)$/i.test(s))r=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);i=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function Gn(e){return"string"==typeof e?ua[e]:e}function Yn(e,t,n,i,r){if(i&&i.shared)return Xn(e,t,n,i,r);if(e.cm&&!e.cm.curOp)return Lt(e.cm,Yn)(e,t,n,i,r);var o=new ga(e,r),a=Oo(t,n);if(i&&Pr(i,o,!1),a>0||0==a&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=zr("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(vi(e,t.line,t,n,o)||t.line!=n.line&&vi(e,n.line,t,n,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");No=!0}o.addToHistory&&cr(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var s,l=t.line,c=e.cm;if(e.iter(l,n.line+1,function(e){c&&o.collapsed&&!c.options.lineWrapping&&yi(e)==c.display.maxLine&&(s=!0),o.collapsed&&l!=t.line&&er(e,0),ni(e,new Qn(o,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l}),o.collapsed&&e.iter(t.line,n.line+1,function(t){xi(e,t)&&er(t,0)}),o.clearOnEnter&&$a(o,"beforeCursorEnter",function(){o.clear()}),o.readOnly&&(Eo=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),o.collapsed&&(o.id=++ma,o.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),o.collapsed)Et(c,t.line,n.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(var u=t.line;u<=n.line;u++)Nt(c,u,"text");o.atomic&&$e(c.doc),kr(c,"markerAdded",c,o)}return o}function Xn(e,t,n,i,r){i=Pr(i),i.shared=!1;var o=[Yn(e,t,n,i,r)],a=o[0],s=i.widgetNode;return Xi(e,function(e){s&&(i.widgetNode=s.cloneNode(!0)),o.push(Yn(e,me(e,t),me(e,n),i,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=Rr(o)}),new va(o,a)}function Kn(e){return e.findMarks(Po(e.first,0),e.clipPos(Po(e.lastLine())),function(e){return e.parent})}function Jn(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),a=e.clipPos(r.to);if(Oo(o,a)){var s=Yn(e,o,a,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}function Zn(e){for(var t=0;t<e.length;t++){var n=e[t],i=[n.primary.doc];Xi(n.primary.doc,function(e){i.push(e)});for(var r=0;r<n.markers.length;r++){var o=n.markers[r];-1==Ir(i,o.doc)&&(o.parent=null,n.markers.splice(r--,1))}}}function Qn(e,t,n){this.marker=e,this.from=t,this.to=n}function ei(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function ti(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function ni(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function ii(e,t,n){if(e)for(var i,r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);if(s||o.from==t&&"bookmark"==a.type&&(!n||!o.marker.insertLeft)){var l=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);(i||(i=[])).push(new Qn(a,o.from,l?null:o.to))}}return i}function ri(e,t,n){if(e)for(var i,r=0;r<e.length;++r){var o=e[r],a=o.marker,s=null==o.to||(a.inclusiveRight?o.to>=t:o.to>t);if(s||o.from==t&&"bookmark"==a.type&&(!n||o.marker.insertLeft)){var l=null==o.from||(a.inclusiveLeft?o.from<=t:o.from<t);(i||(i=[])).push(new Qn(a,l?null:o.from-t,null==o.to?null:o.to-t))}}return i}function oi(e,t){if(t.full)return null;var n=ve(e,t.from.line)&&Ji(e,t.from.line).markedSpans,i=ve(e,t.to.line)&&Ji(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,a=0==Oo(t.from,t.to),s=ii(n,r,a),l=ri(i,o,a),c=1==t.text.length,u=Rr(t.text).length+(c?r:0);if(s)for(var d=0;d<s.length;++d){var h=s[d];if(null==h.to){var p=ei(l,h.marker);p?c&&(h.to=null==p.to?null:p.to+u):h.to=r}}if(l)for(var d=0;d<l.length;++d){var h=l[d];if(null!=h.to&&(h.to+=u),null==h.from){var p=ei(s,h.marker);p||(h.from=u,c&&(s||(s=[])).push(h))}else h.from+=u,c&&(s||(s=[])).push(h)}s&&(s=ai(s)),l&&l!=s&&(l=ai(l));var f=[s];if(!c){var m,g=t.text.length-2;if(g>0&&s)for(var d=0;d<s.length;++d)null==s[d].to&&(m||(m=[])).push(new Qn(s[d].marker,null,null));for(var d=0;g>d;++d)f.push(m);f.push(l)}return f}function ai(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function si(e,t){var n=mr(e,t),i=oi(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],a=i[r];if(o&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else a&&(n[r]=a)}return n}function li(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=Ir(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var a=i[o],s=a.find(0),l=0;l<r.length;++l){var c=r[l];if(!(Oo(c.to,s.from)<0||Oo(c.from,s.to)>0)){var u=[l,1],d=Oo(c.from,s.from),h=Oo(c.to,s.to);(0>d||!a.inclusiveLeft&&!d)&&u.push({from:c.from,to:s.from}),(h>0||!a.inclusiveRight&&!h)&&u.push({from:s.to,to:c.to}),r.splice.apply(r,u),l+=u.length-1}}return r}function ci(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function ui(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function di(e){return e.inclusiveLeft?-1:0}function hi(e){return e.inclusiveRight?1:0}function pi(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),o=Oo(i.from,r.from)||di(e)-di(t);if(o)return-o;var a=Oo(i.to,r.to)||hi(e)-hi(t);return a?a:t.id-e.id}function fi(e,t){var n,i=No&&e.markedSpans;if(i)for(var r,o=0;o<i.length;++o)r=i[o],r.marker.collapsed&&null==(t?r.from:r.to)&&(!n||pi(n,r.marker)<0)&&(n=r.marker);return n}function mi(e){return fi(e,!0)}function gi(e){return fi(e,!1)}function vi(e,t,n,i,r){var o=Ji(e,t),a=No&&o.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),u=Oo(c.from,n)||di(l.marker)-di(r),d=Oo(c.to,i)||hi(l.marker)-hi(r);if(!(u>=0&&0>=d||0>=u&&d>=0)&&(0>=u&&(Oo(c.to,n)>0||l.marker.inclusiveRight&&r.inclusiveLeft)||u>=0&&(Oo(c.from,i)<0||l.marker.inclusiveLeft&&r.inclusiveRight)))return!0}}}function yi(e){for(var t;t=mi(e);)e=t.find(-1,!0).line;return e}function bi(e){for(var t,n;t=gi(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function _i(e,t){var n=Ji(e,t),i=yi(n);return n==i?t:tr(i)}function wi(e,t){if(t>e.lastLine())return t;var n,i=Ji(e,t);if(!xi(e,i))return t;for(;n=gi(i);)i=n.find(1,!0).line;return tr(i)+1}function xi(e,t){var n=No&&t.markedSpans;if(n)for(var i,r=0;r<n.length;++r)if(i=n[r],i.marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&Ci(e,t,i))return!0}}function Ci(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return Ci(e,i.line,ei(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var r,o=0;o<t.markedSpans.length;++o)if(r=t.markedSpans[o],r.marker.collapsed&&!r.marker.widgetNode&&r.from==n.to&&(null==r.to||r.to!=n.from)&&(r.marker.inclusiveLeft||n.marker.inclusiveRight)&&Ci(e,t,r))return!0}function ki(e,t,n){ir(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Pn(e,null,n)}function Si(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Ga(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),Wr(t.display.measure,zr("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function Ti(e,t,n,i){var r=new ya(e,n,i),o=e.cm;return o&&r.noHScroll&&(o.display.alignWidgets=!0),Hn(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==r.insertAt?n.push(r):n.splice(Math.min(n.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,o&&!xi(e,t)){var i=ir(t)<e.scrollTop;er(t,t.height+Si(r)),i&&Pn(o,null,r.height),o.curOp.forceUpdate=!0}return!0}),r}function Di(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),ci(e),ui(e,n);var r=i?i(e):1;r!=e.height&&er(e,r)}function Mi(e){e.parent=null,ci(e)}function $i(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function Li(t,n){if(t.blankLine)return t.blankLine(n);if(t.innerMode){var i=e.innerMode(t,n);return i.mode.blankLine?i.mode.blankLine(i.state):void 0}}function Ai(t,n,i,r){for(var o=0;10>o;o++){r&&(r[0]=e.innerMode(t,i).mode);var a=t.token(n,i);if(n.pos>n.start)return a}throw new Error("Mode "+t.name+" failed to advance stream.")}function Ri(e,t,n,i){function r(e){return{start:d.start,end:d.pos,string:d.current(),type:o||null,state:e?sa(a.mode,u):u}}var o,a=e.doc,s=a.mode;t=me(a,t);var l,c=Ji(a,t.line),u=ze(e,t.line,n),d=new fa(c.text,e.options.tabSize);for(i&&(l=[]);(i||d.pos<t.ch)&&!d.eol();)d.start=d.pos,o=Ai(s,d,u),i&&l.push(r(!0));return i?l:r()}function Ii(e,t,n,i,r,o,a){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var l,c=0,u=null,d=new fa(t,e.options.tabSize),h=e.options.addModeClass&&[null];for(""==t&&$i(Li(n,i),o);!d.eol();){if(d.pos>e.options.maxHighlightLength?(s=!1,a&&Ni(e,t,i,d.pos),d.pos=t.length,l=null):l=$i(Ai(n,d,i,h),o),h){var p=h[0].name;p&&(l="m-"+(l?p+" "+l:p))}if(!s||u!=l){for(;c<d.start;)c=Math.min(d.start,c+5e4),r(c,u);u=l}d.start=d.pos}for(;c<d.pos;){var f=Math.min(d.pos,c+5e4);r(f,u),c=f}}function ji(e,t,n,i){var r=[e.state.modeGen],o={};Ii(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)},o,i);for(var a=0;a<e.state.overlays.length;++a){var s=e.state.overlays[a],l=1,c=0;Ii(e,t.text,s.mode,!0,function(e,t){for(var n=l;e>c;){var i=r[l];i>e&&r.splice(l,1,e,r[l+1],i),l+=2,c=Math.min(e,i)}if(t)if(s.opaque)r.splice(n,l-n,e,"cm-overlay "+t),l=n+2;else for(;l>n;n+=2){var o=r[n+1];r[n+1]=(o?o+" ":"")+"cm-overlay "+t}},o)}return{styles:r,classes:o.bgClass||o.textClass?o:null}}function Ei(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=ze(e,tr(t)),r=ji(e,t,t.text.length>e.options.maxHighlightLength?sa(e.doc.mode,i):i);t.stateAfter=i,t.styles=r.styles,r.classes?t.styleClasses=r.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function Ni(e,t,n,i){var r=e.doc.mode,o=new fa(t,e.options.tabSize);for(o.start=o.pos=i||0,""==t&&Li(r,n);!o.eol();)Ai(r,o,n),o.start=o.pos}function Pi(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?wa:_a;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function Oi(e,t){var n=zr("span",null,null,wo?"padding-right: .1px":null),i={pre:zr("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,splitSpaces:(bo||wo)&&e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var o,a=r?t.rest[r-1]:t.line;i.pos=0,i.addToken=Fi,Zr(e.display.measure)&&(o=rr(a))&&(i.addToken=zi(i.addToken,o)),i.map=[];var s=t!=e.display.externalMeasured&&tr(a);Wi(a,i,Ei(e,a,s)),a.styleClasses&&(a.styleClasses.bgClass&&(i.bgClass=Gr(a.styleClasses.bgClass,i.bgClass||"")),a.styleClasses.textClass&&(i.textClass=Gr(a.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Jr(e.display.measure))),0==r?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return wo&&/\bcm-tab\b/.test(i.content.lastChild.className)&&(i.content.className="cm-tab-wrap-hack"),Ra(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=Gr(i.pre.className,i.textClass||"")),i}function Vi(e){var t=zr("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Fi(e,t,n,i,r,o,a){if(t){var s=e.splitSpaces?t.replace(/ {3,}/g,Hi):t,l=e.cm.state.specialChars,c=!1;if(l.test(t))for(var u=document.createDocumentFragment(),d=0;;){l.lastIndex=d;var h=l.exec(t),p=h?h.index-d:t.length-d;if(p){var f=document.createTextNode(s.slice(d,d+p));bo&&9>_o?u.appendChild(zr("span",[f])):u.appendChild(f),e.map.push(e.pos,e.pos+p,f),e.col+=p,e.pos+=p}if(!h)break;if(d+=p+1,"	"==h[0]){var m=e.cm.options.tabSize,g=m-e.col%m,f=u.appendChild(zr("span",Ar(g),"cm-tab"));f.setAttribute("role","presentation"),f.setAttribute("cm-text","	"),e.col+=g}else if("\r"==h[0]||"\n"==h[0]){var f=u.appendChild(zr("span","\r"==h[0]?"␍":"␤","cm-invalidchar"));f.setAttribute("cm-text",h[0]),e.col+=1}else{var f=e.cm.options.specialCharPlaceholder(h[0]);f.setAttribute("cm-text",h[0]),bo&&9>_o?u.appendChild(zr("span",[f])):u.appendChild(f),e.col+=1}e.map.push(e.pos,e.pos+1,f),e.pos++}else{e.col+=t.length;var u=document.createTextNode(s);e.map.push(e.pos,e.pos+t.length,u),bo&&9>_o&&(c=!0),e.pos+=t.length}if(n||i||r||c||a){var v=n||"";i&&(v+=i),r&&(v+=r);var y=zr("span",[u],v,a);return o&&(y.title=o),e.content.appendChild(y)}e.content.appendChild(u)}}function Hi(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}function zi(e,t){return function(n,i,r,o,a,s,l){r=r?r+" cm-force-border":"cm-force-border";for(var c=n.pos,u=c+i.length;;){for(var d=0;d<t.length;d++){var h=t[d];if(h.to>c&&h.from<=c)break}if(h.to>=u)return e(n,i,r,o,a,s,l);e(n,i.slice(0,h.to-c),r,o,null,s,l),o=null,i=i.slice(h.to-c),c=h.to}}}function Bi(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",n.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t}function Wi(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(i)for(var a,s,l,c,u,d,h,p=r.length,f=0,m=1,g="",v=0;;){if(v==f){l=c=u=d=s="",h=null,v=1/0;for(var y,b=[],_=0;_<i.length;++_){var w=i[_],x=w.marker;"bookmark"==x.type&&w.from==f&&x.widgetNode?b.push(x):w.from<=f&&(null==w.to||w.to>f||x.collapsed&&w.to==f&&w.from==f)?(null!=w.to&&w.to!=f&&v>w.to&&(v=w.to,c=""),x.className&&(l+=" "+x.className),x.css&&(s=(s?s+";":"")+x.css),x.startStyle&&w.from==f&&(u+=" "+x.startStyle),x.endStyle&&w.to==v&&(y||(y=[])).push(x.endStyle,w.to),x.title&&!d&&(d=x.title),x.collapsed&&(!h||pi(h.marker,x)<0)&&(h=w)):w.from>f&&v>w.from&&(v=w.from)}if(y)for(var _=0;_<y.length;_+=2)y[_+1]==v&&(c+=" "+y[_]);if(h&&(h.from||0)==f){if(Bi(t,(null==h.to?p+1:h.to)-f,h.marker,null==h.from),null==h.to)return;h.to==f&&(h=!1)}if(!h&&b.length)for(var _=0;_<b.length;++_)Bi(t,0,b[_])}if(f>=p)break;for(var C=Math.min(p,v);;){if(g){var k=f+g.length;if(!h){var S=k>C?g.slice(0,C-f):g;t.addToken(t,S,a?a+l:l,u,f+S.length==v?c:"",d,s)}if(k>=C){g=g.slice(C-f),f=C;break}f=k,u=""}g=r.slice(o,o=n[m++]),a=Pi(n[m++],t.cm.options)}}else for(var m=1;m<n.length;m+=2)t.addToken(t,r.slice(o,o=n[m]),Pi(n[m+1],t.cm.options))}function Ui(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Rr(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function qi(e,t,n,i){function r(e){return n?n[e]:null}function o(e,n,r){Di(e,n,r,i),kr(e,"change",e,t)}function a(e,t){for(var n=e,o=[];t>n;++n)o.push(new ba(c[n],r(n),i));return o}var s=t.from,l=t.to,c=t.text,u=Ji(e,s.line),d=Ji(e,l.line),h=Rr(c),p=r(c.length-1),f=l.line-s.line;if(t.full)e.insert(0,a(0,c.length)),e.remove(c.length,e.size-c.length);else if(Ui(e,t)){var m=a(0,c.length-1);o(d,d.text,p),f&&e.remove(s.line,f),m.length&&e.insert(s.line,m)}else if(u==d)if(1==c.length)o(u,u.text.slice(0,s.ch)+h+u.text.slice(l.ch),p);else{var m=a(1,c.length-1);m.push(new ba(h+u.text.slice(l.ch),p,i)),o(u,u.text.slice(0,s.ch)+c[0],r(0)),e.insert(s.line+1,m)}else if(1==c.length)o(u,u.text.slice(0,s.ch)+c[0]+d.text.slice(l.ch),r(0)),e.remove(s.line+1,f);else{o(u,u.text.slice(0,s.ch)+c[0],r(0)),o(d,h+d.text.slice(l.ch),p);var m=a(1,c.length-1);f>1&&e.remove(s.line+1,f-1),e.insert(s.line+1,m)}kr(e,"change",e,t)}function Gi(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Yi(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var r=e[i];t+=r.chunkSize(),n+=r.height,r.parent=this}this.size=t,this.height=n,this.parent=null}function Xi(e,t,n){function i(e,r,o){if(e.linked)for(var a=0;a<e.linked.length;++a){var s=e.linked[a];if(s.doc!=r){var l=o&&s.sharedHist;(!n||l)&&(t(s.doc,l),i(s.doc,e,l))}}}i(e,null,!0)}function Ki(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),n(e),e.options.lineWrapping||h(e),e.options.mode=t.modeOption,Et(e)}function Ji(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(o>t){n=r;break}t-=o}return n.lines[t]}function Zi(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){var o=e.text;r==n.line&&(o=o.slice(0,n.ch)),r==t.line&&(o=o.slice(t.ch)),i.push(o),++r}),i}function Qi(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function er(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function tr(e){if(null==e.parent)return null;for(var t=e.parent,n=Ir(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function nr(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(o>t){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(var i=0;i<e.lines.length;++i){var a=e.lines[i],s=a.height;if(s>t)break;t-=s}return n+i}function ir(e){e=yi(e);for(var t=0,n=e.parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;n=o,o=n.parent)for(var i=0;i<o.children.length;++i){var a=o.children[i];if(a==n)break;t+=a.height}return t}function rr(e){var t=e.order;return null==t&&(t=e.order=as(e.text)),t}function or(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function ar(e,t){var n={from:G(t.from),to:Zo(t),text:Zi(e,t.from,t.to)};return pr(e,n,t.from.line,t.to.line+1),Xi(e,function(e){pr(e,n,t.from.line,t.to.line+1)},!0),n}function sr(e){for(;e.length;){var t=Rr(e);if(!t.ranges)break;e.pop()}}function lr(e,t){return t?(sr(e.done),Rr(e.done)):e.done.length&&!Rr(e.done).ranges?Rr(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Rr(e.done)):void 0}function cr(e,t,n,i){var r=e.history;r.undone.length=0;var o,a=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>a-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(o=lr(r,r.lastOp==i))){var s=Rr(o.changes);0==Oo(t.from,t.to)&&0==Oo(t.from,s.to)?s.to=Zo(t):o.changes.push(ar(e,t))}else{var l=Rr(r.done);for(l&&l.ranges||hr(e.sel,r.done),o={changes:[ar(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,s||Ra(e,"historyAdded")}function ur(e,t,n,i){var r=t.charAt(0);return"*"==r||"+"==r&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function dr(e,t,n,i){var r=e.history,o=i&&i.origin;n==r.lastSelOp||o&&r.lastSelOrigin==o&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==o||ur(e,o,Rr(r.done),t))?r.done[r.done.length-1]=t:hr(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=o,r.lastSelOp=n,i&&i.clearRedo!==!1&&sr(r.undone)}function hr(e,t){var n=Rr(t);n&&n.ranges&&n.equals(e)||t.push(e)}function pr(e,t,n,i){var r=t["spans_"+e.id],o=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((r||(r=t["spans_"+e.id]={}))[o]=n.markedSpans),++o})}function fr(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function mr(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=0,r=[];i<t.text.length;++i)r.push(fr(n[i]));return r}function gr(e,t,n){for(var i=0,r=[];i<e.length;++i){var o=e[i];if(o.ranges)r.push(n?ue.prototype.deepCopy.call(o):o);else{var a=o.changes,s=[];r.push({changes:s});for(var l=0;l<a.length;++l){var c,u=a[l];if(s.push({from:u.from,to:u.to,text:u.text}),t)for(var d in u)(c=d.match(/^spans_(\d+)$/))&&Ir(t,Number(c[1]))>-1&&(Rr(s)[d]=u[d],delete u[d])}}}return r}function vr(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function yr(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],a=!0;if(o.ranges){o.copied||(o=e[r]=o.deepCopy(),o.copied=!0);for(var s=0;s<o.ranges.length;s++)vr(o.ranges[s].anchor,t,n,i),vr(o.ranges[s].head,t,n,i)}else{for(var s=0;s<o.changes.length;++s){var l=o.changes[s];if(n<l.from.line)l.from=Po(l.from.line+i,l.from.ch),l.to=Po(l.to.line+i,l.to.ch);else if(t<=l.to.line){a=!1;break}}a||(e.splice(0,r+1),r=0)}}}function br(e,t){var n=t.from.line,i=t.to.line,r=t.text.length-(i-n)-1;yr(e.done,n,i,r),yr(e.undone,n,i,r)}function _r(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function wr(e){return e.target||e.srcElement}function xr(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Lo&&e.ctrlKey&&1==t&&(t=3),t}function Cr(e,t,n){var i=e._handlers&&e._handlers[t];return n?i&&i.length>0?i.slice():La:i||La}function kr(e,t){function n(e){return function(){e.apply(null,o)}}var i=Cr(e,t,!1);if(i.length){var r,o=Array.prototype.slice.call(arguments,2);Wo?r=Wo.delayedCallbacks:Ia?r=Ia:(r=Ia=[],setTimeout(Sr,0));for(var a=0;a<i.length;++a)r.push(n(i[a]))}}function Sr(){var e=Ia;Ia=null;for(var t=0;t<e.length;++t)e[t]()}function Tr(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ra(e,n||t.type,e,t),_r(t)||t.codemirrorIgnore}function Dr(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==Ir(n,t[i])&&n.push(t[i])}function Mr(e,t){return Cr(e,t).length>0}function $r(e){e.prototype.on=function(e,t){$a(this,e,t)},e.prototype.off=function(e,t){Aa(this,e,t)}}function Lr(){this.id=null}function Ar(e){for(;Ha.length<=e;)Ha.push(Rr(Ha)+" ");return Ha[e]}function Rr(e){return e[e.length-1]}function Ir(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function jr(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function Er(){}function Nr(e,t){var n;return Object.create?n=Object.create(e):(Er.prototype=e,n=new Er),t&&Pr(t,n),n}function Pr(e,t,n){t||(t={});for(var i in e)!e.hasOwnProperty(i)||n===!1&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function Or(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Vr(e,t){return t?t.source.indexOf("\\w")>-1&&Ua(e)?!0:t.test(e):Ua(e)}function Fr(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Hr(e){return e.charCodeAt(0)>=768&&qa.test(e)}function zr(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function Br(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function Wr(e,t){return Br(e).appendChild(t)}function Ur(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function qr(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Gr(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!qr(n[i]).test(t)&&(t+=" "+n[i]);return t}function Yr(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&e(i)}}function Xr(){Za||(Kr(),Za=!0)}function Kr(){var e;$a(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Yr(Wt)},100))}),$a(window,"blur",function(){Yr(yn)})}function Jr(e){if(null==Ya){var t=zr("span","​");Wr(e,zr("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ya=t.offsetWidth<=1&&t.offsetHeight>2&&!(bo&&8>_o))}var n=Ya?zr("span","​"):zr("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Zr(e){if(null!=Xa)return Xa;var t=Wr(e,document.createTextNode("AخA")),n=Ba(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var i=Ba(t,1,2).getBoundingClientRect();return Xa=i.right-n.right<3}function Qr(e){if(null!=is)return is;var t=Wr(e,zr("span","x")),n=t.getBoundingClientRect(),i=Ba(t,0,1).getBoundingClientRect();return is=Math.abs(n.left-i.left)>1}function eo(e,t,n,i){if(!e)return i(t,n,"ltr");for(var r=!1,o=0;o<e.length;++o){var a=e[o];(a.from<n&&a.to>t||t==n&&a.to==t)&&(i(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),r=!0)}r||i(t,n,"ltr")}function to(e){return e.level%2?e.to:e.from}function no(e){return e.level%2?e.from:e.to}function io(e){var t=rr(e);return t?to(t[0]):0}function ro(e){var t=rr(e);return t?no(Rr(t)):e.text.length}function oo(e,t){var n=Ji(e.doc,t),i=yi(n);i!=n&&(t=tr(i));var r=rr(i),o=r?r[0].level%2?ro(i):io(i):0;return Po(t,o)}function ao(e,t){for(var n,i=Ji(e.doc,t);n=gi(i);)i=n.find(1,!0).line,t=null;var r=rr(i),o=r?r[0].level%2?io(i):ro(i):i.text.length;return Po(null==t?tr(i):t,o)}function so(e,t){var n=oo(e,t.line),i=Ji(e.doc,n.line),r=rr(i);if(!r||0==r[0].level){var o=Math.max(0,i.text.search(/\S/)),a=t.line==n.line&&t.ch<=o&&t.ch;return Po(n.line,a?0:o)}return n}function lo(e,t,n){var i=e[0].level;return t==i?!0:n==i?!1:n>t}function co(e,t){os=null;for(var n,i=0;i<e.length;++i){var r=e[i];if(r.from<t&&r.to>t)return i;if(r.from==t||r.to==t){if(null!=n)return lo(e,r.level,e[n].level)?(r.from!=r.to&&(os=n),i):(r.from!=r.to&&(os=i),n);n=i}}return n}function uo(e,t,n,i){if(!i)return t+n;do t+=n;while(t>0&&Hr(e.text.charAt(t)));return t}function ho(e,t,n,i){var r=rr(e);if(!r)return po(e,t,n,i);for(var o=co(r,t),a=r[o],s=uo(e,t,a.level%2?-n:n,i);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return co(r,s)==o?s:(a=r[o+=n],n>0==a.level%2?a.to:a.from);if(a=r[o+=n],!a)return null;s=n>0==a.level%2?uo(e,a.to,-1,i):uo(e,a.from,1,i)}}function po(e,t,n,i){var r=t+n;if(i)for(;r>0&&Hr(e.text.charAt(r));)r+=n;return 0>r||r>e.text.length?null:r}var fo=navigator.userAgent,mo=navigator.platform,go=/gecko\/\d/i.test(fo),vo=/MSIE \d/.test(fo),yo=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fo),bo=vo||yo,_o=bo&&(vo?document.documentMode||6:yo[1]),wo=/WebKit\//.test(fo),xo=wo&&/Qt\/\d+\.\d+/.test(fo),Co=/Chrome\//.test(fo),ko=/Opera\//.test(fo),So=/Apple Computer/.test(navigator.vendor),To=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(fo),Do=/PhantomJS/.test(fo),Mo=/AppleWebKit/.test(fo)&&/Mobile\/\w+/.test(fo),$o=Mo||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(fo),Lo=Mo||/Mac/.test(mo),Ao=/win/i.test(mo),Ro=ko&&fo.match(/Version\/(\d*\.\d*)/);Ro&&(Ro=Number(Ro[1])),Ro&&Ro>=15&&(ko=!1,wo=!0);var Io=Lo&&(xo||ko&&(null==Ro||12.11>Ro)),jo=go||bo&&_o>=9,Eo=!1,No=!1;m.prototype=Pr({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var r=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+r)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var o=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+o+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:t?i:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=Lo&&!To?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Lr,this.disableVert=new Lr},enableZeroWidthBar:function(e,t){function n(){var i=e.getBoundingClientRect(),r=document.elementFromPoint(i.left+1,i.bottom-1);r!=e?e.style.pointerEvents="none":t.set(1e3,n)}e.style.pointerEvents="auto",t.set(1e3,n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},m.prototype),g.prototype=Pr({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},g.prototype),e.scrollbarModel={"native":m,"null":g},S.prototype.signal=function(e,t){Mr(e,t)&&this.events.push(arguments)},S.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ra.apply(null,this.events[e])};var Po=e.Pos=function(e,t){return this instanceof Po?(this.line=e,void(this.ch=t)):new Po(e,t)},Oo=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},Vo=null;ne.prototype=Pr({init:function(e){function t(e){if(i.somethingSelected())Vo=i.getSelections(),n.inaccurateSelection&&(n.prevInput="",n.inaccurateSelection=!1,o.value=Vo.join("\n"),za(o));else{if(!i.options.lineWiseCopyCut)return;var t=ee(i);Vo=t.text,"cut"==e.type?i.setSelections(t.ranges,null,Na):(n.prevInput="",o.value=t.text.join("\n"),za(o))}"cut"==e.type&&(i.state.cutIncoming=!0)}var n=this,i=this.cm,r=this.wrapper=ie(),o=this.textarea=r.firstChild;e.wrapper.insertBefore(r,e.wrapper.firstChild),Mo&&(o.style.width="0px"),$a(o,"input",function(){bo&&_o>=9&&n.hasSelection&&(n.hasSelection=null),n.poll()}),$a(o,"paste",function(e){Tr(i,e)||Z(e,i)||(i.state.pasteIncoming=!0,n.fastPoll())}),$a(o,"cut",t),$a(o,"copy",t),$a(e.scroller,"paste",function(t){Ut(e,t)||Tr(i,t)||(i.state.pasteIncoming=!0,n.focus())}),$a(e.lineSpace,"selectstart",function(t){Ut(e,t)||Ta(t)}),$a(o,"compositionstart",function(){var e=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),$a(o,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,n=e.doc,i=Ee(e);if(e.options.moveInputWithCursor){var r=pt(e,n.sel.primary().head,"div"),o=t.wrapper.getBoundingClientRect(),a=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+a.top-o.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+a.left-o.left))}return i},showSelection:function(e){var t=this.cm,n=t.display;Wr(n.cursorDiv,e.cursors),Wr(n.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){
var t,n,i=this.cm,r=i.doc;if(i.somethingSelected()){this.prevInput="";var o=r.sel.primary();t=ns&&(o.to().line-o.from().line>100||(n=i.getSelection()).length>1e3);var a=t?"-":n||i.getSelection();this.textarea.value=a,i.state.focused&&za(this.textarea),bo&&_o>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",bo&&_o>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!$o||Ur()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function e(){var i=n.poll();i||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))}var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,e)},poll:function(){var e=this.cm,t=this.textarea,n=this.prevInput;if(this.contextMenuPending||!e.state.focused||ts(t)&&!n&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var i=t.value;if(i==n&&!e.somethingSelected())return!1;if(bo&&_o>=9&&this.hasSelection===i||Lo&&/[\uf700-\uf7ff]/.test(i))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var r=i.charCodeAt(0);if(8203!=r||n||(n="​"),8666==r)return this.reset(),this.cm.execCommand("undo")}for(var o=0,a=Math.min(n.length,i.length);a>o&&n.charCodeAt(o)==i.charCodeAt(o);)++o;var s=this;return $t(e,function(){J(e,i.slice(o),n.length-o,null,s.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?t.value=s.prevInput="":s.prevInput=i,s.composing&&(s.composing.range.clear(),s.composing.range=e.markText(s.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){bo&&_o>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=a.selectionStart){var e=r.somethingSelected(),t="​"+(e?a.value:"");a.value="⇚",a.value=t,i.prevInput=e?"":"​",a.selectionStart=1,a.selectionEnd=t.length,o.selForContextMenu=r.doc.sel}}function n(){if(i.contextMenuPending=!1,i.wrapper.style.position="relative",a.style.cssText=u,bo&&9>_o&&o.scrollbars.setScrollTop(o.scroller.scrollTop=l),null!=a.selectionStart){(!bo||bo&&9>_o)&&t();var e=0,n=function(){o.selForContextMenu==r.doc.sel&&0==a.selectionStart&&a.selectionEnd>0&&"​"==i.prevInput?Lt(r,ca.selectAll)(r):e++<10?o.detectingSelectAll=setTimeout(n,500):o.input.reset()};o.detectingSelectAll=setTimeout(n,200)}}var i=this,r=i.cm,o=r.display,a=i.textarea,s=qt(r,e),l=o.scroller.scrollTop;if(s&&!ko){var c=r.options.resetSelectionOnContextMenu;c&&-1==r.doc.sel.contains(s)&&Lt(r,Te)(r.doc,pe(s),Na);var u=a.style.cssText;if(i.wrapper.style.position="absolute",a.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(e.clientY-5)+"px; left: "+(e.clientX-5)+"px; z-index: 1000; background: "+(bo?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",wo)var d=window.scrollY;if(o.input.focus(),wo&&window.scrollTo(null,d),o.input.reset(),r.somethingSelected()||(a.value=i.prevInput=" "),i.contextMenuPending=!0,o.selForContextMenu=r.doc.sel,clearTimeout(o.detectingSelectAll),bo&&_o>=9&&t(),jo){Ma(e);var h=function(){Aa(window,"mouseup",h),setTimeout(n,20)};$a(window,"mouseup",h)}else setTimeout(n,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:Er,needsContentAttribute:!1},ne.prototype),re.prototype=Pr({init:function(e){function t(e){if(i.somethingSelected())Vo=i.getSelections(),"cut"==e.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var t=ee(i);Vo=t.text,"cut"==e.type&&i.operation(function(){i.setSelections(t.ranges,0,Na),i.replaceSelection("",null,"cut")})}if(e.clipboardData&&!Mo)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",Vo.join("\n"));else{var n=ie(),r=n.firstChild;i.display.lineSpace.insertBefore(n,i.display.lineSpace.firstChild),r.value=Vo.join("\n");var o=document.activeElement;za(r),setTimeout(function(){i.display.lineSpace.removeChild(n),o.focus()},50)}}var n=this,i=n.cm,r=n.div=e.lineDiv;te(r),$a(r,"paste",function(e){Tr(i,e)||Z(e,i)}),$a(r,"compositionstart",function(e){var t=e.data;if(n.composing={sel:i.doc.sel,data:t,startData:t},t){var r=i.doc.sel.primary(),o=i.getLine(r.head.line),a=o.indexOf(t,Math.max(0,r.head.ch-t.length));a>-1&&a<=r.head.ch&&(n.composing.sel=pe(Po(r.head.line,a),Po(r.head.line,a+t.length)))}}),$a(r,"compositionupdate",function(e){n.composing.data=e.data}),$a(r,"compositionend",function(e){var t=n.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||n.applyComposition(t),n.composing==t&&(n.composing=null)},50))}),$a(r,"touchstart",function(){n.forceCompositionEnd()}),$a(r,"input",function(){n.composing||(i.isReadOnly()||!n.pollContent())&&$t(n.cm,function(){Et(i)})}),$a(r,"copy",t),$a(r,"cut",t)},prepareSelection:function(){var e=Ee(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){e&&this.cm.display.view.length&&(e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),n=se(this.cm,e.anchorNode,e.anchorOffset),i=se(this.cm,e.focusNode,e.focusOffset);if(!n||n.bad||!i||i.bad||0!=Oo(X(n,i),t.from())||0!=Oo(Y(n,i),t.to())){var r=oe(this.cm,t.from()),o=oe(this.cm,t.to());if(r||o){var a=this.cm.display.view,s=e.rangeCount&&e.getRangeAt(0);if(r){if(!o){var l=a[a.length-1].measure,c=l.maps?l.maps[l.maps.length-1]:l.map;o={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else r={node:a[0].measure.map[2],offset:0};try{var u=Ba(r.node,r.offset,o.offset,o.node)}catch(d){}u&&(!go&&this.cm.state.focused?(e.collapse(r.node,r.offset),u.collapsed||e.addRange(u)):(e.removeAllRanges(),e.addRange(u)),s&&null==e.anchorNode?e.addRange(s):go&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){Wr(this.cm.display.cursorDiv,e.cursors),Wr(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Ga(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}var t=this;this.selectionInEditor()?this.pollSelection():$t(this.cm,function(){t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,e)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var n=se(t,e.anchorNode,e.anchorOffset),i=se(t,e.focusNode,e.focusOffset);n&&i&&$t(t,function(){Te(t.doc,pe(n,i),Na),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e=this.cm,t=e.display,n=e.doc.sel.primary(),i=n.from(),r=n.to();if(i.line<t.viewFrom||r.line>t.viewTo-1)return!1;var o;if(i.line==t.viewFrom||0==(o=Ot(e,i.line)))var a=tr(t.view[0].line),s=t.view[0].node;else var a=tr(t.view[o].line),s=t.view[o-1].node.nextSibling;var l=Ot(e,r.line);if(l==t.view.length-1)var c=t.viewTo-1,u=t.lineDiv.lastChild;else var c=tr(t.view[l+1].line)-1,u=t.view[l+1].node.previousSibling;for(var d=e.doc.splitLines(ce(e,s,u,a,c)),h=Zi(e.doc,Po(a,0),Po(c,Ji(e.doc,c).text.length));d.length>1&&h.length>1;)if(Rr(d)==Rr(h))d.pop(),h.pop(),c--;else{if(d[0]!=h[0])break;d.shift(),h.shift(),a++}for(var p=0,f=0,m=d[0],g=h[0],v=Math.min(m.length,g.length);v>p&&m.charCodeAt(p)==g.charCodeAt(p);)++p;for(var y=Rr(d),b=Rr(h),_=Math.min(y.length-(1==d.length?p:0),b.length-(1==h.length?p:0));_>f&&y.charCodeAt(y.length-f-1)==b.charCodeAt(b.length-f-1);)++f;d[d.length-1]=y.slice(0,y.length-f),d[0]=d[0].slice(p);var w=Po(a,p),x=Po(c,h.length?Rr(h).length-f:0);return d.length>1||d[0]||Oo(w,x)?(Rn(e.doc,d,w,x,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){this.cm.isReadOnly()?Lt(this.cm,Et)(this.cm):e.data&&e.data!=e.startData&&Lt(this.cm,J)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||Lt(this.cm,J)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:Er,resetPosition:Er,needsContentAttribute:!0},re.prototype),e.inputStyles={textarea:ne,contenteditable:re},ue.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(0!=Oo(n.anchor,i.anchor)||0!=Oo(n.head,i.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new de(G(this.ranges[t].anchor),G(this.ranges[t].head));return new ue(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if(Oo(t,i.from())>=0&&Oo(e,i.to())<=0)return n}return-1}},de.prototype={from:function(){return X(this.anchor,this.head)},to:function(){return Y(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Fo,Ho,zo,Bo={left:0,right:0,top:0,bottom:0},Wo=null,Uo=0,qo=0,Go=0,Yo=null;bo?Yo=-.53:go?Yo=15:Co?Yo=-.7:So&&(Yo=-1/3);var Xo=function(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}};e.wheelEventPixels=function(e){var t=Xo(e);return t.x*=Yo,t.y*=Yo,t};var Ko=new Lr,Jo=null,Zo=e.changeEnd=function(e){return e.text?Po(e.from.line+e.text.length-1,Rr(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,i=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,ea.hasOwnProperty(e)&&Lt(this,ea[e])(this,t,i))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Gn(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:At(function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:i,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,Et(this)}),removeOverlay:At(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void Et(this)}}),indentLine:At(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),ve(this.doc,e)&&Fn(this,e,t,n)}),indentSelection:At(function(e){for(var t=this.doc.sel.ranges,n=-1,i=0;i<t.length;i++){var r=t[i];if(r.empty())r.head.line>n&&(Fn(this,r.head.line,e,!0),n=r.head.line,i==this.doc.sel.primIndex&&On(this));else{var o=r.from(),a=r.to(),s=Math.max(n,o.line);n=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=s;n>l;++l)Fn(this,l,e);var c=this.doc.sel.ranges;0==o.ch&&t.length==c.length&&c[i].from().ch>0&&xe(this.doc,i,new de(o,c[i].to()),Na)}}}),getTokenAt:function(e,t){return Ri(this,e,t)},getLineTokens:function(e,t){return Ri(this,Po(e),t,!0)},getTokenTypeAt:function(e){e=me(this.doc,e);var t,n=Ei(this,Ji(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var a=i+r>>1;if((a?n[2*a-1]:0)>=o)r=a;else{if(!(n[2*a+1]<o)){t=n[2*a+2];break}i=a+1}}var s=t?t.indexOf("cm-overlay "):-1;return 0>s?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!aa.hasOwnProperty(t))return n;var i=aa[t],r=this.getModeAt(e);if("string"==typeof r[t])i[r[t]]&&n.push(i[r[t]]);else if(r[t])for(var o=0;o<r[t].length;o++){var a=i[r[t][o]];a&&n.push(a)}else r.helperType&&i[r.helperType]?n.push(i[r.helperType]):i[r.name]&&n.push(i[r.name]);for(var o=0;o<i._global.length;o++){var s=i._global[o];s.pred(r,this)&&-1==Ir(n,s.val)&&n.push(s.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=fe(n,null==e?n.first+n.size-1:e),ze(this,e+1,t)},cursorCoords:function(e,t){var n,i=this.doc.sel.primary();return n=null==e?i.head:"object"==typeof e?me(this.doc,e):e?i.from():i.to(),pt(this,n,t||"page")},charCoords:function(e,t){return ht(this,me(this.doc,e),t||"page")},coordsChar:function(e,t){return e=dt(this,e,t||"page"),gt(this,e.left,e.top)},lineAtHeight:function(e,t){return e=dt(this,{top:e,left:0},t||"page").top,nr(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n,i=!1;if("number"==typeof e){var r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,i=!0),n=Ji(this.doc,e)}else n=e;return ut(this,n,{top:0,left:0},t||"page").top+(i?this.doc.height-ir(n):0)},defaultTextHeight:function(){return yt(this.display)},defaultCharWidth:function(){return bt(this.display)},setGutterMarker:At(function(e,t,n){return Hn(this.doc,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&Fr(i)&&(e.gutterMarkers=null),!0})}),clearGutter:At(function(e){var t=this,n=t.doc,i=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,Nt(t,i,"gutter"),Fr(n.gutterMarkers)&&(n.gutterMarkers=null)),++i})}),lineInfo:function(e){if("number"==typeof e){if(!ve(this.doc,e))return null;var t=e;if(e=Ji(this.doc,e),!e)return null}else{var t=tr(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o=this.display;e=pt(this,me(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),o.sizer.appendChild(t),"over"==i)a=e.top;else if("above"==i||"near"==i){var l=Math.max(o.wrapper.clientHeight,this.doc.height),c=Math.max(o.sizer.clientWidth,o.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>c&&(s=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==r?(s=o.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?s=0:"middle"==r&&(s=(o.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&En(this,s,a,s+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:At(hn),triggerOnKeyPress:At(mn),triggerOnKeyUp:fn,execCommand:function(e){return ca.hasOwnProperty(e)?ca[e].call(null,this):void 0},triggerElectric:At(function(e){Q(this,e)}),findPosH:function(e,t,n,i){var r=1;0>t&&(r=-1,t=-t);for(var o=0,a=me(this.doc,e);t>o&&(a=Bn(this.doc,a,r,n,i),!a.hitSide);++o);return a},moveH:At(function(e,t){var n=this;n.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?Bn(n.doc,i.head,e,t,n.options.rtlMoveVisually):0>e?i.from():i.to()},Oa)}),deleteH:At(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):zn(this,function(n){var r=Bn(i,n.head,e,t,!1);return 0>e?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,n,i){var r=1,o=i;0>t&&(r=-1,t=-t);for(var a=0,s=me(this.doc,e);t>a;++a){var l=pt(this,s,"div");if(null==o?o=l.left:l.left=o,s=Wn(this,l,r,n),s.hitSide)break}return s},moveV:At(function(e,t){var n=this,i=this.doc,r=[],o=!n.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(a){if(o)return 0>e?a.from():a.to();var s=pt(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),r.push(s.left);var l=Wn(n,s,e,t);return"page"==t&&a==i.sel.primary()&&Pn(n,null,ht(n,l,"div").top-s.top),l},Oa),r.length)for(var a=0;a<i.sel.ranges.length;a++)i.sel.ranges[a].goalColumn=r[a]}),findWordAt:function(e){var t=this.doc,n=Ji(t,e.line).text,i=e.ch,r=e.ch;if(n){var o=this.getHelper(e,"wordChars");(e.xRel<0||r==n.length)&&i?--i:++r;for(var a=n.charAt(i),s=Vr(a,o)?function(e){return Vr(e,o)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Vr(e)};i>0&&s(n.charAt(i-1));)--i;for(;r<n.length&&s(n.charAt(r));)++r}return new de(Po(e.line,i),Po(e.line,r))},toggleOverwrite:function(e){(null==e||e!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Ja(this.display.cursorDiv,"CodeMirror-overwrite"):Ka(this.display.cursorDiv,"CodeMirror-overwrite"),Ra(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Ur()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:At(function(e,t){(null!=e||null!=t)&&Vn(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-qe(this)-this.display.barHeight,width:e.scrollWidth-qe(this)-this.display.barWidth,clientHeight:Ye(this),clientWidth:Ge(this)}},scrollIntoView:At(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Po(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)Vn(this),this.curOp.scrollToPos=e;else{var n=Nn(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:At(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var i=this;null!=e&&(i.display.wrapper.style.width=n(e)),null!=t&&(i.display.wrapper.style.height=n(t)),i.options.lineWrapping&&at(this);var r=i.display.viewFrom;i.doc.iter(r,i.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Nt(i,r,"widget");break}++r}),i.curOp.forceUpdate=!0,Ra(i,"refresh",this)}),operation:function(e){return $t(this,e)},refresh:At(function(){var e=this.display.cachedTextHeight;Et(this),this.curOp.forceUpdate=!0,st(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),u(this),(null==e||Math.abs(e-yt(this.display))>.5)&&a(this),Ra(this,"refresh",this)}),swapDoc:At(function(e){var t=this.doc;return t.cm=null,Ki(this,e),st(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,kr(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},$r(e);var Qo=e.defaults={},ea=e.optionHandlers={},ta=e.Init={toString:function(){return"CodeMirror.Init"}};Un("value","",function(e,t){e.setValue(t)},!0),Un("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),Un("indentUnit",2,n,!0),Un("indentWithTabs",!1),Un("smartIndent",!0),Un("tabSize",4,function(e){i(e),st(e),Et(e)},!0),Un("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var n=[],i=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var o=e.text.indexOf(t,r);if(-1==o)break;r=o+t.length,n.push(Po(i,o))}i++});for(var r=n.length-1;r>=0;r--)Rn(e.doc,t,n[r],Po(n[r].line,n[r].ch+t.length))}}),Un("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,n,i){t.state.specialChars=new RegExp(n.source+(n.test("	")?"":"|	"),"g"),i!=e.Init&&t.refresh()}),Un("specialCharPlaceholder",Vi,function(e){e.refresh()},!0),Un("electricChars",!0),Un("inputStyle",$o?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Un("rtlMoveVisually",!Ao),Un("wholeLineUpdateBefore",!0),Un("theme","default",function(e){s(e),l(e)},!0),Un("keyMap","default",function(t,n,i){var r=Gn(n),o=i!=e.Init&&Gn(i);o&&o.detach&&o.detach(t,r),r.attach&&r.attach(t,o||null)}),Un("extraKeys",null),Un("lineWrapping",!1,r,!0),Un("gutters",[],function(e){p(e.options),l(e)},!0),Un("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?k(e.display)+"px":"0",e.refresh()},!0),Un("coverGutterNextToScrollbar",!1,function(e){y(e)},!0),Un("scrollbarStyle","native",function(e){v(e),y(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Un("lineNumbers",!1,function(e){p(e.options),l(e)},!0),Un("firstLineNumber",1,l,!0),Un("lineNumberFormatter",function(e){return e},l,!0),Un("showCursorWhenSelecting",!1,je,!0),Un("resetSelectionOnContextMenu",!0),Un("lineWiseCopyCut",!0),Un("readOnly",!1,function(e,t){"nocursor"==t?(yn(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),Un("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Un("dragDrop",!0,Bt),Un("allowDropFileTypes",null),Un("cursorBlinkRate",530),Un("cursorScrollMargin",0),Un("cursorHeight",1,je,!0),Un("singleCursorHeightPerLine",!0,je,!0),Un("workTime",100),Un("workDelay",100),Un("flattenSpans",!0,i,!0),Un("addModeClass",!1,i,!0),Un("pollInterval",100),Un("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),Un("historyEventDelay",1250),Un("viewportMargin",10,function(e){e.refresh()},!0),Un("maxHighlightLength",1e4,i,!0),Un("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Un("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),Un("autofocus",null);var na=e.modes={},ia=e.mimeModes={};e.defineMode=function(t,n){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),na[t]=n},e.defineMIME=function(e,t){ia[e]=t},e.resolveMode=function(t){if("string"==typeof t&&ia.hasOwnProperty(t))t=ia[t];else if(t&&"string"==typeof t.name&&ia.hasOwnProperty(t.name)){var n=ia[t.name];"string"==typeof n&&(n={name:n}),t=Nr(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),i=na[n.name];if(!i)return e.getMode(t,"text/plain");var r=i(t,n);if(ra.hasOwnProperty(n.name)){var o=ra[n.name];for(var a in o)o.hasOwnProperty(a)&&(r.hasOwnProperty(a)&&(r["_"+a]=r[a]),r[a]=o[a])}if(r.name=n.name,n.helperType&&(r.helperType=n.helperType),n.modeProps)for(var a in n.modeProps)r[a]=n.modeProps[a];return r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var ra=e.modeExtensions={};e.extendMode=function(e,t){var n=ra.hasOwnProperty(e)?ra[e]:ra[e]={};Pr(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){Ca.prototype[e]=t},e.defineOption=Un;var oa=[];e.defineInitHook=function(e){oa.push(e)};var aa=e.helpers={};e.registerHelper=function(t,n,i){aa.hasOwnProperty(t)||(aa[t]=e[t]={_global:[]}),aa[t][n]=i},e.registerGlobalHelper=function(t,n,i,r){e.registerHelper(t,n,r),aa[t]._global.push({pred:i,val:r})};var sa=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var r=t[i];r instanceof Array&&(r=r.concat([])),n[i]=r}return n},la=e.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var ca=e.commands={selectAll:function(e){e.setSelection(Po(e.firstLine(),0),Po(e.lastLine()),Na)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Na)},killLine:function(e){zn(e,function(t){if(t.empty()){var n=Ji(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:Po(t.head.line+1,0)}:{from:t.head,to:Po(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){zn(e,function(t){return{from:Po(t.from().line,0),to:me(e.doc,Po(t.to().line+1,0))}})},delLineLeft:function(e){zn(e,function(e){return{from:Po(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){zn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return{from:i,to:t.from()}})},delWrappedLineRight:function(e){zn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Po(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Po(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return oo(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return so(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return ao(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},Oa)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},Oa)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?so(e,t.head):i},Oa)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),a=Va(e.getLine(o.line),o.ch,i);t.push(new Array(i-a%i+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){$t(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r=t[i].head,o=Ji(e.doc,r.line).text;if(o)if(r.ch==o.length&&(r=new Po(r.line,r.ch-1)),r.ch>0)r=new Po(r.line,r.ch+1),e.replaceRange(o.charAt(r.ch-1)+o.charAt(r.ch-2),Po(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var a=Ji(e.doc,r.line-1).text;a&&e.replaceRange(o.charAt(0)+e.doc.lineSeparator()+a.charAt(a.length-1),Po(r.line-1,a.length-1),Po(r.line,1),"+transpose")}n.push(new de(r,r))}e.setSelections(n)})},newlineAndIndent:function(e){$t(e,function(){for(var t=e.listSelections().length,n=0;t>n;n++){var i=e.listSelections()[n];e.replaceRange(e.doc.lineSeparator(),i.anchor,i.head,"+input"),e.indentLine(i.from().line+1,null,!0)}On(e)})},toggleOverwrite:function(e){e.toggleOverwrite()}},ua=e.keyMap={};ua.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ua.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ua.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},ua.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ua["default"]=Lo?ua.macDefault:ua.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var r=jr(n.split(" "),qn),o=0;o<r.length;o++){var a,s;o==r.length-1?(s=r.join(" "),a=i):(s=r.slice(0,o+1).join(" "),
a="...");var l=t[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else t[s]=a}delete e[n]}for(var c in t)e[c]=t[c];return e};var da=e.lookupKey=function(e,t,n,i){t=Gn(t);var r=t.call?t.call(e,i):t[e];if(r===!1)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return da(e,t.fallthrough,n,i);for(var o=0;o<t.fallthrough.length;o++){var a=da(e,t.fallthrough[o],n,i);if(a)return a}}},ha=e.isModifierKey=function(e){var t="string"==typeof e?e:rs[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},pa=e.keyName=function(e,t){if(ko&&34==e.keyCode&&e["char"])return!1;var n=rs[e.keyCode],i=n;return null==i||e.altGraphKey?!1:(e.altKey&&"Alt"!=n&&(i="Alt-"+i),(Io?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(i="Ctrl-"+i),(Io?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(i="Cmd-"+i),!t&&e.shiftKey&&"Shift"!=n&&(i="Shift-"+i),i)};e.fromTextArea=function(t,n){function i(){t.value=c.getValue()}if(n=n?Pr(n):{},n.value=t.value,!n.tabindex&&t.tabIndex&&(n.tabindex=t.tabIndex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var r=Ur();n.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}if(t.form&&($a(t.form,"submit",i),!n.leaveSubmitMethodAlone)){var o=t.form,a=o.submit;try{var s=o.submit=function(){i(),o.submit=a,o.submit(),o.submit=s}}catch(l){}}n.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Aa(t.form,"submit",i),"function"==typeof t.form.submit&&(t.form.submit=a))}},t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return c};var fa=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};fa.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Va(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Va(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Va(this.string,null,this.tabSize)-(this.lineStart?Va(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&t!==!1&&(this.pos+=i[0].length),i)}var r=function(e){return n?e.toLowerCase():e},o=this.string.substr(this.pos,e.length);return r(o)==r(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ma=0,ga=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ma};$r(ga),ga.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&_t(e),Mr(this,"clear")){var n=this.find();n&&kr(this,"clear",n.from,n.to)}for(var i=null,r=null,o=0;o<this.lines.length;++o){var a=this.lines[o],s=ei(a.markedSpans,this);e&&!this.collapsed?Nt(e,tr(a),"text"):e&&(null!=s.to&&(r=tr(a)),null!=s.from&&(i=tr(a))),a.markedSpans=ti(a.markedSpans,s),null==s.from&&this.collapsed&&!xi(this.doc,a)&&e&&er(a,yt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var o=0;o<this.lines.length;++o){var l=yi(this.lines[o]),c=d(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&Et(e,i,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&$e(e.doc)),e&&kr(e,"markerCleared",e,this),t&&xt(e),this.parent&&this.parent.clear()}},ga.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var n,i,r=0;r<this.lines.length;++r){var o=this.lines[r],a=ei(o.markedSpans,this);if(null!=a.from&&(n=Po(t?o:tr(o),a.from),-1==e))return n;if(null!=a.to&&(i=Po(t?o:tr(o),a.to),1==e))return i}return n&&{from:n,to:i}},ga.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&$t(n,function(){var i=e.line,r=tr(e.line),o=Qe(n,r);if(o&&(ot(o),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!xi(t.doc,i)&&null!=t.height){var a=t.height;t.height=null;var s=Si(t)-a;s&&er(i,i.height+s)}})},ga.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Ir(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},ga.prototype.detachLine=function(e){if(this.lines.splice(Ir(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var ma=0,va=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};$r(va),va.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();kr(this,"clear")}},va.prototype.find=function(e,t){return this.primary.find(e,t)};var ya=e.LineWidget=function(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=e,this.node=t};$r(ya),ya.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,i=tr(n);if(null!=i&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(n.widgets=null);var o=Si(this);er(n,Math.max(0,n.height-o)),e&&$t(e,function(){ki(e,n,-o),Nt(e,i,"widget")})}},ya.prototype.changed=function(){var e=this.height,t=this.doc.cm,n=this.line;this.height=null;var i=Si(this)-e;i&&(er(n,n.height+i),t&&$t(t,function(){t.curOp.forceUpdate=!0,ki(t,n,i)}))};var ba=e.Line=function(e,t,n){this.text=e,ui(this,t),this.height=n?n(this):1};$r(ba),ba.prototype.lineNo=function(){return tr(this)};var _a={},wa={};Gi.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,i=e+t;i>n;++n){var r=this.lines[n];this.height-=r.height,Mi(r),kr(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;i>e;++e)if(n(this.lines[e]))return!0}},Yi.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var i=this.children[n],r=i.chunkSize();if(r>e){var o=Math.min(t,r-e),a=i.height;if(i.removeInner(e,o),this.height-=a-i.height,r==o&&(this.children.splice(n--,1),i.parent=null),0==(t-=o))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Gi))){var s=[];this.collapse(s),this.children=[new Gi(s)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(o>=e){if(r.insertInner(e,t,n),r.lines&&r.lines.length>50){for(;r.lines.length>50;){var a=r.lines.splice(r.lines.length-25,25),s=new Gi(a);r.height-=s.height,this.children.splice(i+1,0,s),s.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Yi(t);if(e.parent){e.size-=n.size,e.height-=n.height;var i=Ir(e.parent.children,e);e.parent.children.splice(i+1,0,n)}else{var r=new Yi(e.children);r.parent=e,e.children=[r,n],e=r}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(o>e){var a=Math.min(t,o-e);if(r.iterN(e,a,n))return!0;if(0==(t-=a))break;e=0}else e-=o}}};var xa=0,Ca=e.Doc=function(e,t,n,i){if(!(this instanceof Ca))return new Ca(e,t,n,i);null==n&&(n=0),Yi.call(this,[new Gi([new ba("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var r=Po(n,0);this.sel=pe(r),this.history=new or(null),this.id=++xa,this.modeOption=t,this.lineSep=i,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),qi(this,{from:r,to:r,text:e}),Te(this,pe(r),Na)};Ca.prototype=Nr(Yi.prototype,{constructor:Ca,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Qi(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:Rt(function(e){var t=Po(this.first,0),n=this.first+this.size-1;Tn(this,{from:t,to:Po(n,Ji(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),Te(this,pe(t))}),replaceRange:function(e,t,n,i){t=me(this,t),n=n?me(this,n):t,Rn(this,e,t,n,i)},getRange:function(e,t,n){var i=Zi(this,me(this,e),me(this,t));return n===!1?i:i.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return ve(this,e)?Ji(this,e):void 0},getLineNumber:function(e){return tr(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Ji(this,e)),yi(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return me(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||e===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Rt(function(e,t,n){Ce(this,me(this,"number"==typeof e?Po(e,t||0):e),null,n)}),setSelection:Rt(function(e,t,n){Ce(this,me(this,e),me(this,t||e),n)}),extendSelection:Rt(function(e,t,n){_e(this,me(this,e),t&&me(this,t),n)}),extendSelections:Rt(function(e,t){we(this,ye(this,e),t)}),extendSelectionsBy:Rt(function(e,t){var n=jr(this.sel.ranges,e);we(this,ye(this,n),t)}),setSelections:Rt(function(e,t,n){if(e.length){for(var i=0,r=[];i<e.length;i++)r[i]=new de(me(this,e[i].anchor),me(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Te(this,he(r,t),n)}}),addSelection:Rt(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new de(me(this,e),me(this,t||e))),Te(this,he(i,i.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,i=0;i<n.length;i++){var r=Zi(this,n[i].from(),n[i].to());t=t?t.concat(r):r}return e===!1?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var r=Zi(this,n[i].from(),n[i].to());e!==!1&&(r=r.join(e||this.lineSeparator())),t[i]=r}return t},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:Rt(function(e,t,n){for(var i=[],r=this.sel,o=0;o<r.ranges.length;o++){var a=r.ranges[o];i[o]={from:a.from(),to:a.to(),text:this.splitLines(e[o]),origin:n}}for(var s=t&&"end"!=t&&kn(this,i,t),o=i.length-1;o>=0;o--)Tn(this,i[o]);s?Se(this,s):this.cm&&On(this.cm)}),undo:Rt(function(){Mn(this,"undo")}),redo:Rt(function(){Mn(this,"redo")}),undoSelection:Rt(function(){Mn(this,"undo",!0)}),redoSelection:Rt(function(){Mn(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new or(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:gr(this.history.done),undone:gr(this.history.undone)}},setHistory:function(e){var t=this.history=new or(this.history.maxGeneration);t.done=gr(e.done.slice(0),null,!0),t.undone=gr(e.undone.slice(0),null,!0)},addLineClass:Rt(function(e,t,n){return Hn(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(qr(n).test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0})}),removeLineClass:Rt(function(e,t,n){return Hn(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[i];if(!r)return!1;if(null==n)e[i]=null;else{var o=r.match(qr(n));if(!o)return!1;var a=o.index+o[0].length;e[i]=r.slice(0,o.index)+(o.index&&a!=r.length?" ":"")+r.slice(a)||null}return!0})}),addLineWidget:Rt(function(e,t,n){return Ti(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return Yn(this,me(this,e),me(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=me(this,e),Yn(this,e,e,n,"bookmark")},findMarksAt:function(e){e=me(this,e);var t=[],n=Ji(this,e.line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,n){e=me(this,e),t=me(this,t);var i=[],r=e.line;return this.iter(e.line,t.line+1,function(o){var a=o.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];r==e.line&&e.ch>l.to||null==l.from&&r!=e.line||r==t.line&&l.from>t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++r}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(i){var r=i.text.length+1;return r>e?(t=e,!0):(e-=r,void++n)}),me(this,Po(n,t))},indexFromPos:function(e){e=me(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new Ca(Qi(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new Ca(Qi(this,t,n),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Jn(i,Kn(this)),i},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var i=this.linked[n];if(i.doc==t){this.linked.splice(n,1),t.unlinkDoc(this),Zn(Kn(this));break}}if(t.history==this.history){var r=[t.id];Xi(t,function(e){r.push(e.id)},!0),t.history=new or(null),t.history.done=gr(this.history.done,r),t.history.undone=gr(this.history.undone,r)}},iterLinkedDocs:function(e){Xi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):es(e)},lineSeparator:function(){return this.lineSep||"\n"}}),Ca.prototype.eachLine=Ca.prototype.iter;var ka="iter insert remove copy getEditor constructor".split(" ");for(var Sa in Ca.prototype)Ca.prototype.hasOwnProperty(Sa)&&Ir(ka,Sa)<0&&(e.prototype[Sa]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ca.prototype[Sa]));$r(Ca);var Ta=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Da=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Ma=e.e_stop=function(e){Ta(e),Da(e)},$a=e.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={}),r=i[t]||(i[t]=[]);r.push(n)}},La=[],Aa=e.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else for(var i=Cr(e,t,!1),r=0;r<i.length;++r)if(i[r]==n){i.splice(r,1);break}},Ra=e.signal=function(e,t){var n=Cr(e,t,!0);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)},Ia=null,ja=30,Ea=e.Pass={toString:function(){return"CodeMirror.Pass"}},Na={scroll:!1},Pa={origin:"*mouse"},Oa={origin:"+move"};Lr.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Va=e.countColumn=function(e,t,n,i,r){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var o=i||0,a=r||0;;){var s=e.indexOf("	",o);if(0>s||s>=t)return a+(t-o);a+=s-o,a+=n-a%n,o=s+1}},Fa=e.findColumn=function(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("	",i);-1==o&&(o=e.length);var a=o-i;if(o==e.length||r+a>=t)return i+Math.min(a,t-r);if(r+=o-i,r+=n-r%n,i=o+1,r>=t)return i}},Ha=[""],za=function(e){e.select()};Mo?za=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:bo&&(za=function(e){try{e.select()}catch(t){}});var Ba,Wa=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Ua=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||Wa.test(e))},qa=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;Ba=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(r){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var Ga=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do if(11==t.nodeType&&(t=t.host),t==e)return!0;while(t=t.parentNode)};bo&&11>_o&&(Ur=function(){try{return document.activeElement}catch(e){return document.body}});var Ya,Xa,Ka=e.rmClass=function(e,t){var n=e.className,i=qr(t).exec(n);if(i){var r=n.slice(i.index+i[0].length);e.className=n.slice(0,i.index)+(r?i[1]+r:"")}},Ja=e.addClass=function(e,t){var n=e.className;qr(t).test(n)||(e.className+=(n?" ":"")+t)},Za=!1,Qa=function(){if(bo&&9>_o)return!1;var e=zr("div");return"draggable"in e||"dragDrop"in e}(),es=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;i>=t;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),a=o.indexOf("\r");-1!=a?(n.push(o.slice(0,a)),t+=a+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},ts=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},ns=function(){var e=zr("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),is=null,rs=e.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var e=0;10>e;e++)rs[e+48]=rs[e+96]=String(e);for(var e=65;90>=e;e++)rs[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)rs[e+111]=rs[e+63235]="F"+e}();var os,as=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?i.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,o=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,c="L";return function(n){if(!r.test(n))return!1;for(var i,u=n.length,d=[],h=0;u>h;++h)d.push(i=e(n.charCodeAt(h)));for(var h=0,p=c;u>h;++h){var i=d[h];"m"==i?d[h]=p:p=i}for(var h=0,f=c;u>h;++h){var i=d[h];"1"==i&&"r"==f?d[h]="n":a.test(i)&&(f=i,"r"==i&&(d[h]="R"))}for(var h=1,p=d[0];u-1>h;++h){var i=d[h];"+"==i&&"1"==p&&"1"==d[h+1]?d[h]="1":","!=i||p!=d[h+1]||"1"!=p&&"n"!=p||(d[h]=p),p=i}for(var h=0;u>h;++h){var i=d[h];if(","==i)d[h]="N";else if("%"==i){for(var m=h+1;u>m&&"%"==d[m];++m);for(var g=h&&"!"==d[h-1]||u>m&&"1"==d[m]?"1":"N",v=h;m>v;++v)d[v]=g;h=m-1}}for(var h=0,f=c;u>h;++h){var i=d[h];"L"==f&&"1"==i?d[h]="L":a.test(i)&&(f=i)}for(var h=0;u>h;++h)if(o.test(d[h])){for(var m=h+1;u>m&&o.test(d[m]);++m);for(var y="L"==(h?d[h-1]:c),b="L"==(u>m?d[m]:c),g=y||b?"L":"R",v=h;m>v;++v)d[v]=g;h=m-1}for(var _,w=[],h=0;u>h;)if(s.test(d[h])){var x=h;for(++h;u>h&&s.test(d[h]);++h);w.push(new t(0,x,h))}else{var C=h,k=w.length;for(++h;u>h&&"L"!=d[h];++h);for(var v=C;h>v;)if(l.test(d[v])){v>C&&w.splice(k,0,new t(1,C,v));var S=v;for(++v;h>v&&l.test(d[v]);++v);w.splice(k,0,new t(2,S,v)),C=v}else++v;h>C&&w.splice(k,0,new t(1,C,h))}return 1==w[0].level&&(_=n.match(/^\s+/))&&(w[0].from=_[0].length,w.unshift(new t(0,0,_[0].length))),1==Rr(w).level&&(_=n.match(/\s+$/))&&(Rr(w).to-=_[0].length,w.push(new t(0,u-_[0].length,u))),2==w[0].level&&w.unshift(new t(1,w[0].to,w[0].to)),w[0].level!=Rr(w).level&&w.push(new t(w[0].level,u,u)),w}}();return e.version="5.10.0",e})},function(e,t,n){!function(e){e(n(163),n(165),n(166))}(function(e){"use strict";function t(t,n,i){if(0>i&&0==n.ch)return t.clipPos(h(n.line-1));var r=t.getLine(n.line);if(i>0&&n.ch>=r.length)return t.clipPos(h(n.line+1,0));for(var o,a="start",s=n.ch,l=0>i?0:r.length,c=0;s!=l;s+=i,c++){var u=r.charAt(0>i?s-1:s),d="_"!=u&&e.isWordChar(u)?"w":"o";if("w"==d&&u.toUpperCase()==u&&(d="W"),"start"==a)"o"!=d&&(a="in",o=d);else if("in"==a&&o!=d){if("w"==o&&"W"==d&&0>i&&s--,"W"==o&&"w"==d&&i>0){o="w";continue}break}}return h(n.line,s)}function n(e,n){e.extendSelectionsBy(function(i){return e.display.shift||e.doc.extend||i.empty()?t(e.doc,i.head,n):0>n?i.from():i.to()})}function i(t,n){return t.isReadOnly()?e.Pass:void t.operation(function(){for(var e=t.listSelections().length,i=[],r=-1,o=0;e>o;o++){var a=t.listSelections()[o].head;if(!(a.line<=r)){var s=h(a.line+(n?0:1),0);t.replaceRange("\n",s,null,"+insertLine"),t.indentLine(s.line,null,!0),i.push({head:s,anchor:s}),r=a.line+1}}t.setSelections(i)})}function r(t,n){for(var i=n.ch,r=i,o=t.getLine(n.line);i&&e.isWordChar(o.charAt(i-1));)--i;for(;r<o.length&&e.isWordChar(o.charAt(r));)++r;return{from:h(n.line,i),to:h(n.line,r),word:o.slice(i,r)}}function o(e){var t=e.getCursor(),n=e.scanForBracket(t,-1);if(n)for(;;){var i=e.scanForBracket(t,1);if(!i)return;if(i.ch==g.charAt(g.indexOf(n.ch)+1))return e.setSelection(h(n.pos.line,n.pos.ch+1),i.pos,!1),!0;t=h(i.pos.line,i.pos.ch+1)}}function a(t,n){if(t.isReadOnly())return e.Pass;for(var i,r=t.listSelections(),o=[],a=0;a<r.length;a++){var s=r[a];if(!s.empty()){for(var l=s.from().line,c=s.to().line;a<r.length-1&&r[a+1].from().line==c;)c=s[++a].to().line;o.push(l,c)}}o.length?i=!0:o.push(t.firstLine(),t.lastLine()),t.operation(function(){for(var e=[],r=0;r<o.length;r+=2){var a=o[r],s=o[r+1],l=h(a,0),c=h(s),u=t.getRange(l,c,!1);n?u.sort():u.sort(function(e,t){var n=e.toUpperCase(),i=t.toUpperCase();return n!=i&&(e=n,t=i),t>e?-1:e==t?0:1}),t.replaceRange(u,l,c),i&&e.push({anchor:l,head:c})}i&&t.setSelections(e,0)})}function s(t,n){t.operation(function(){for(var i=t.listSelections(),o=[],a=[],s=0;s<i.length;s++){var l=i[s];l.empty()?(o.push(s),a.push("")):a.push(n(t.getRange(l.from(),l.to())))}t.replaceSelections(a,"around","case");for(var c,s=o.length-1;s>=0;s--){var l=i[o[s]];if(!(c&&e.cmpPos(l.head,c)>0)){var u=r(t,l.head);c=u.from,t.replaceRange(n(u.word),u.from,u.to)}}})}function l(t){var n=t.getCursor("from"),i=t.getCursor("to");if(0==e.cmpPos(n,i)){var o=r(t,n);if(!o.word)return;n=o.from,i=o.to}return{from:n,to:i,query:t.getRange(n,i),word:o}}function c(e,t){var n=l(e);if(n){var i=n.query,r=e.getSearchCursor(i,t?n.to:n.from);(t?r.findNext():r.findPrevious())?e.setSelection(r.from(),r.to()):(r=e.getSearchCursor(i,t?h(e.firstLine(),0):e.clipPos(h(e.lastLine()))),(t?r.findNext():r.findPrevious())?e.setSelection(r.from(),r.to()):n.word&&e.setSelection(n.from,n.to))}}var u=e.keyMap.sublime={fallthrough:"default"},d=e.commands,h=e.Pos,p=e.keyMap["default"]==e.keyMap.macDefault,f=p?"Cmd-":"Ctrl-";d[u["Alt-Left"]="goSubwordLeft"]=function(e){n(e,-1)},d[u["Alt-Right"]="goSubwordRight"]=function(e){n(e,1)};var m=p?"Ctrl-Alt-":"Ctrl-";d[u[m+"Up"]="scrollLineUp"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top+t.clientHeight,"local");e.getCursor().line>=n&&e.execCommand("goLineUp")}e.scrollTo(null,t.top-e.defaultTextHeight())},d[u[m+"Down"]="scrollLineDown"]=function(e){var t=e.getScrollInfo();if(!e.somethingSelected()){var n=e.lineAtHeight(t.top,"local")+1;e.getCursor().line<=n&&e.execCommand("goLineDown")}e.scrollTo(null,t.top+e.defaultTextHeight())},d[u["Shift-"+f+"L"]="splitSelectionByLine"]=function(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++)for(var r=t[i].from(),o=t[i].to(),a=r.line;a<=o.line;++a)o.line>r.line&&a==o.line&&0==o.ch||n.push({anchor:a==r.line?r:h(a,0),head:a==o.line?o:h(a)});e.setSelections(n,0)},u["Shift-Tab"]="indentLess",d[u.Esc="singleSelectionTop"]=function(e){var t=e.listSelections()[0];e.setSelection(t.anchor,t.head,{scroll:!1})},d[u[f+"L"]="selectLine"]=function(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r=t[i];n.push({anchor:h(r.from().line,0),head:h(r.to().line+1,0)})}e.setSelections(n)},u["Shift-"+f+"K"]="deleteLine",d[u[f+"Enter"]="insertLineAfter"]=function(e){return i(e,!1)},d[u["Shift-"+f+"Enter"]="insertLineBefore"]=function(e){return i(e,!0)},d[u[f+"D"]="selectNextOccurrence"]=function(t){var n=t.getCursor("from"),i=t.getCursor("to"),o=t.state.sublimeFindFullWord==t.doc.sel;if(0==e.cmpPos(n,i)){var a=r(t,n);if(!a.word)return;t.setSelection(a.from,a.to),o=!0}else{var s=t.getRange(n,i),l=o?new RegExp("\\b"+s+"\\b"):s,c=t.getSearchCursor(l,i);c.findNext()?t.addSelection(c.from(),c.to()):(c=t.getSearchCursor(l,h(t.firstLine(),0)),c.findNext()&&t.addSelection(c.from(),c.to()))}o&&(t.state.sublimeFindFullWord=t.doc.sel)};var g="(){}[]";d[u["Shift-"+f+"Space"]="selectScope"]=function(e){o(e)||e.execCommand("selectAll")},d[u["Shift-"+f+"M"]="selectBetweenBrackets"]=function(t){return o(t)?void 0:e.Pass},d[u[f+"M"]="goToBracket"]=function(t){t.extendSelectionsBy(function(n){var i=t.scanForBracket(n.head,1);if(i&&0!=e.cmpPos(i.pos,n.head))return i.pos;var r=t.scanForBracket(n.head,-1);return r&&h(r.pos.line,r.pos.ch+1)||n.head})};var v=p?"Cmd-Ctrl-":"Shift-Ctrl-";d[u[v+"Up"]="swapLineUp"]=function(t){if(t.isReadOnly())return e.Pass;for(var n=t.listSelections(),i=[],r=t.firstLine()-1,o=[],a=0;a<n.length;a++){var s=n[a],l=s.from().line-1,c=s.to().line;o.push({anchor:h(s.anchor.line-1,s.anchor.ch),head:h(s.head.line-1,s.head.ch)}),0!=s.to().ch||s.empty()||--c,l>r?i.push(l,c):i.length&&(i[i.length-1]=c),r=c}t.operation(function(){for(var e=0;e<i.length;e+=2){var n=i[e],r=i[e+1],a=t.getLine(n);t.replaceRange("",h(n,0),h(n+1,0),"+swapLine"),r>t.lastLine()?t.replaceRange("\n"+a,h(t.lastLine()),null,"+swapLine"):t.replaceRange(a+"\n",h(r,0),null,"+swapLine")}t.setSelections(o),t.scrollIntoView()})},d[u[v+"Down"]="swapLineDown"]=function(t){if(t.isReadOnly())return e.Pass;for(var n=t.listSelections(),i=[],r=t.lastLine()+1,o=n.length-1;o>=0;o--){var a=n[o],s=a.to().line+1,l=a.from().line;0!=a.to().ch||a.empty()||s--,r>s?i.push(s,l):i.length&&(i[i.length-1]=l),r=l}t.operation(function(){for(var e=i.length-2;e>=0;e-=2){var n=i[e],r=i[e+1],o=t.getLine(n);n==t.lastLine()?t.replaceRange("",h(n-1),h(n),"+swapLine"):t.replaceRange("",h(n,0),h(n+1,0),"+swapLine"),t.replaceRange(o+"\n",h(r,0),null,"+swapLine")}t.scrollIntoView()})},d[u[f+"/"]="toggleCommentIndented"]=function(e){e.toggleComment({indent:!0})},d[u[f+"J"]="joinLines"]=function(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){for(var r=t[i],o=r.from(),a=o.line,s=r.to().line;i<t.length-1&&t[i+1].from().line==s;)s=t[++i].to().line;n.push({start:a,end:s,anchor:!r.empty()&&o})}e.operation(function(){for(var t=0,i=[],r=0;r<n.length;r++){for(var o,a=n[r],s=a.anchor&&h(a.anchor.line-t,a.anchor.ch),l=a.start;l<=a.end;l++){
var c=l-t;l==a.end&&(o=h(c,e.getLine(c).length+1)),c<e.lastLine()&&(e.replaceRange(" ",h(c),h(c+1,/^\s*/.exec(e.getLine(c+1))[0].length)),++t)}i.push({anchor:s||o,head:o})}e.setSelections(i,0)})},d[u["Shift-"+f+"D"]="duplicateLine"]=function(e){e.operation(function(){for(var t=e.listSelections().length,n=0;t>n;n++){var i=e.listSelections()[n];i.empty()?e.replaceRange(e.getLine(i.head.line)+"\n",h(i.head.line,0)):e.replaceRange(e.getRange(i.from(),i.to()),i.from())}e.scrollIntoView()})},u[f+"T"]="transposeChars",d[u.F9="sortLines"]=function(e){a(e,!0)},d[u[f+"F9"]="sortLinesInsensitive"]=function(e){a(e,!1)},d[u.F2="nextBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){var n=t.shift(),i=n.find();if(i)return t.push(n),e.setSelection(i.from,i.to)}},d[u["Shift-F2"]="prevBookmark"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){t.unshift(t.pop());var n=t[t.length-1].find();if(n)return e.setSelection(n.from,n.to);t.pop()}},d[u[f+"F2"]="toggleBookmark"]=function(e){for(var t=e.listSelections(),n=e.state.sublimeBookmarks||(e.state.sublimeBookmarks=[]),i=0;i<t.length;i++){for(var r=t[i].from(),o=t[i].to(),a=e.findMarks(r,o),s=0;s<a.length;s++)if(a[s].sublimeBookmark){a[s].clear();for(var l=0;l<n.length;l++)n[l]==a[s]&&n.splice(l--,1);break}s==a.length&&n.push(e.markText(r,o,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},d[u["Shift-"+f+"F2"]="clearBookmarks"]=function(e){var t=e.state.sublimeBookmarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();t.length=0},d[u["Alt-F2"]="selectBookmarks"]=function(e){var t=e.state.sublimeBookmarks,n=[];if(t)for(var i=0;i<t.length;i++){var r=t[i].find();r?n.push({anchor:r.from,head:r.to}):t.splice(i--,0)}n.length&&e.setSelections(n,0)},u["Alt-Q"]="wrapLines";var y=f+"K ";u[y+f+"Backspace"]="delLineLeft",d[u.Backspace="smartBackspace"]=function(t){if(t.somethingSelected())return e.Pass;var n=t.getCursor(),i=t.getRange({line:n.line,ch:0},n),r=e.countColumn(i,null,t.getOption("tabSize")),o=t.getOption("indentUnit");if(i&&!/\S/.test(i)&&r%o==0){var a=new h(n.line,e.findColumn(i,r-o,o));return a.ch==n.ch?e.Pass:t.replaceRange("",a,n,"+delete")}return e.Pass},d[u[y+f+"K"]="delLineRight"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=t.length-1;n>=0;n--)e.replaceRange("",t[n].anchor,h(t[n].to().line),"+delete");e.scrollIntoView()})},d[u[y+f+"U"]="upcaseAtCursor"]=function(e){s(e,function(e){return e.toUpperCase()})},d[u[y+f+"L"]="downcaseAtCursor"]=function(e){s(e,function(e){return e.toLowerCase()})},d[u[y+f+"Space"]="setSublimeMark"]=function(e){e.state.sublimeMark&&e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor())},d[u[y+f+"A"]="selectToSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&e.setSelection(e.getCursor(),t)},d[u[y+f+"W"]="deleteToSublimeMark"]=function(t){var n=t.state.sublimeMark&&t.state.sublimeMark.find();if(n){var i=t.getCursor(),r=n;if(e.cmpPos(i,r)>0){var o=r;r=i,i=o}t.state.sublimeKilled=t.getRange(i,r),t.replaceRange("",i,r)}},d[u[y+f+"X"]="swapWithSublimeMark"]=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&(e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor()),e.setCursor(t))},d[u[y+f+"Y"]="sublimeYank"]=function(e){null!=e.state.sublimeKilled&&e.replaceSelection(e.state.sublimeKilled,null,"paste")},u[y+f+"G"]="clearBookmarks",d[u[y+f+"C"]="showInCenter"]=function(e){var t=e.cursorCoords(null,"local");e.scrollTo(null,(t.top+t.bottom)/2-e.getScrollInfo().clientHeight/2)},d[u["Shift-Alt-Up"]="selectLinesUpward"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=0;n<t.length;n++){var i=t[n];i.head.line>e.firstLine()&&e.addSelection(h(i.head.line-1,i.head.ch))}})},d[u["Shift-Alt-Down"]="selectLinesDownward"]=function(e){e.operation(function(){for(var t=e.listSelections(),n=0;n<t.length;n++){var i=t[n];i.head.line<e.lastLine()&&e.addSelection(h(i.head.line+1,i.head.ch))}})},d[u[f+"F3"]="findUnder"]=function(e){c(e,!0)},d[u["Shift-"+f+"F3"]="findUnderPrevious"]=function(e){c(e,!1)},d[u["Alt-F3"]="findAllUnder"]=function(e){var t=l(e);if(t){for(var n=e.getSearchCursor(t.query),i=[],r=-1;n.findNext();)i.push({anchor:n.from(),head:n.to()}),n.from().line<=t.from.line&&n.from().ch<=t.from.ch&&r++;e.setSelections(i,r)}},u["Shift-"+f+"["]="fold",u["Shift-"+f+"]"]="unfold",u[y+f+"0"]=u[y+f+"j"]="unfoldAll",u[f+"I"]="findIncremental",u["Shift-"+f+"I"]="findIncrementalReverse",u[f+"H"]="replace",u.F3="findNext",u["Shift-F3"]="findPrev",e.normalizeKeyMap(u)})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";function t(e,t,r,o){if(this.atOccurrence=!1,this.doc=e,null==o&&"string"==typeof t&&(o=!1),r=r?e.clipPos(r):i(0,0),this.pos={from:r,to:r},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(n,r){if(n){t.lastIndex=0;for(var o,a,s=e.getLine(r.line).slice(0,r.ch),l=0;;){t.lastIndex=l;var c=t.exec(s);if(!c)break;if(o=c,a=o.index,l=o.index+(o[0].length||1),l==s.length)break}var u=o&&o[0].length||0;u||(0==a&&0==s.length?o=void 0:a!=e.getLine(r.line).length&&u++)}else{t.lastIndex=r.ch;var s=e.getLine(r.line),o=t.exec(s),u=o&&o[0].length||0,a=o&&o.index;a+u==s.length||u||(u=1)}return o&&u?{from:i(r.line,a),to:i(r.line,a+u),match:o}:void 0};else{var a=t;o&&(t=t.toLowerCase());var s=o?function(e){return e.toLowerCase()}:function(e){return e},l=t.split("\n");if(1==l.length)t.length?this.matches=function(r,o){if(r){var l=e.getLine(o.line).slice(0,o.ch),c=s(l),u=c.lastIndexOf(t);if(u>-1)return u=n(l,c,u),{from:i(o.line,u),to:i(o.line,u+a.length)}}else{var l=e.getLine(o.line).slice(o.ch),c=s(l),u=c.indexOf(t);if(u>-1)return u=n(l,c,u)+o.ch,{from:i(o.line,u),to:i(o.line,u+a.length)}}}:this.matches=function(){};else{var c=a.split("\n");this.matches=function(t,n){var r=l.length-1;if(t){if(n.line-(l.length-1)<e.firstLine())return;if(s(e.getLine(n.line).slice(0,c[r].length))!=l[l.length-1])return;for(var o=i(n.line,c[r].length),a=n.line-1,u=r-1;u>=1;--u,--a)if(l[u]!=s(e.getLine(a)))return;var d=e.getLine(a),h=d.length-c[0].length;if(s(d.slice(h))!=l[0])return;return{from:i(a,h),to:o}}if(!(n.line+(l.length-1)>e.lastLine())){var d=e.getLine(n.line),h=d.length-c[0].length;if(s(d.slice(h))==l[0]){for(var p=i(n.line,h),a=n.line+1,u=1;r>u;++u,++a)if(l[u]!=s(e.getLine(a)))return;if(s(e.getLine(a).slice(0,c[r].length))==l[r])return{from:p,to:i(a,c[r].length)}}}}}}}function n(e,t,n){if(e.length==t.length)return n;for(var i=Math.min(n,e.length);;){var r=e.slice(0,i).toLowerCase().length;if(n>r)++i;else{if(!(r>n))return i;--i}}}var i=e.Pos;t.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t=i(e,0);return n.pos={from:t,to:t},n.atOccurrence=!1,!1}for(var n=this,r=this.doc.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,r))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!r.line)return t(0);r=i(r.line-1,this.doc.getLine(r.line-1).length)}else{var o=this.doc.lineCount();if(r.line==o-1)return t(o);r=i(r.line+1,0)}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(t,n){if(this.atOccurrence){var r=e.splitLines(t);this.doc.replaceRange(r,this.pos.from,this.pos.to,n),this.pos.to=i(this.pos.from.line+r.length-1,r[r.length-1].length+(1==r.length?this.pos.from.ch:0))}}},e.defineExtension("getSearchCursor",function(e,n,i){return new t(this.doc,e,n,i)}),e.defineDocExtension("getSearchCursor",function(e,n,i){return new t(this,e,n,i)}),e.defineExtension("selectMatches",function(t,n){for(var i=[],r=this.getSearchCursor(t,this.getCursor("from"),n);r.findNext()&&!(e.cmpPos(r.to(),this.getCursor("to"))>0);)i.push({anchor:r.from(),head:r.to()});i.length&&this.setSelections(i,0)})})},function(e,t,n){!function(e){e(n(163))}(function(e){function t(e,t,i,r){var o=e.getLineHandle(t.line),l=t.ch-1,c=l>=0&&s[o.text.charAt(l)]||s[o.text.charAt(++l)];if(!c)return null;var u=">"==c.charAt(1)?1:-1;if(i&&u>0!=(l==t.ch))return null;var d=e.getTokenTypeAt(a(t.line,l+1)),h=n(e,a(t.line,l+(u>0?1:0)),u,d||null,r);return null==h?null:{from:a(t.line,l),to:h&&h.pos,match:h&&h.ch==c.charAt(0),forward:u>0}}function n(e,t,n,i,r){for(var o=r&&r.maxScanLineLength||1e4,l=r&&r.maxScanLines||1e3,c=[],u=r&&r.bracketRegex?r.bracketRegex:/[(){}[\]]/,d=n>0?Math.min(t.line+l,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-l),h=t.line;h!=d;h+=n){var p=e.getLine(h);if(p){var f=n>0?0:p.length-1,m=n>0?p.length:-1;if(!(p.length>o))for(h==t.line&&(f=t.ch-(0>n?1:0));f!=m;f+=n){var g=p.charAt(f);if(u.test(g)&&(void 0===i||e.getTokenTypeAt(a(h,f+1))==i)){var v=s[g];if(">"==v.charAt(1)==n>0)c.push(g);else{if(!c.length)return{pos:a(h,f),ch:g};c.pop()}}}}}return h-n==(n>0?e.lastLine():e.firstLine())?!1:null}function i(e,n,i){for(var r=e.state.matchBrackets.maxHighlightLineLength||1e3,s=[],l=e.listSelections(),c=0;c<l.length;c++){var u=l[c].empty()&&t(e,l[c].head,!1,i);if(u&&e.getLine(u.from.line).length<=r){var d=u.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";s.push(e.markText(u.from,a(u.from.line,u.from.ch+1),{className:d})),u.to&&e.getLine(u.to.line).length<=r&&s.push(e.markText(u.to,a(u.to.line,u.to.ch+1),{className:d}))}}if(s.length){o&&e.state.focused&&e.focus();var h=function(){e.operation(function(){for(var e=0;e<s.length;e++)s[e].clear()})};if(!n)return h;setTimeout(h,800)}}function r(e){e.operation(function(){l&&(l(),l=null),l=i(e,!1,e.state.matchBrackets)})}var o=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),a=e.Pos,s={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;e.defineOption("matchBrackets",!1,function(t,n,i){i&&i!=e.Init&&t.off("cursorActivity",r),n&&(t.state.matchBrackets="object"==typeof n?n:{},t.on("cursorActivity",r))}),e.defineExtension("matchBrackets",function(){i(this,!0)}),e.defineExtension("findMatchingBracket",function(e,n,i){return t(this,e,n,i)}),e.defineExtension("scanForBracket",function(e,t,i,r){return n(this,e,t,i,r)})})},function(e,t,n){!function(e){e(n(163))}(function(e){function t(e,t){return"pairs"==t&&"string"==typeof e?e:"object"==typeof e&&null!=e[t]?e[t]:d[t]}function n(e){return function(t){return s(t,e)}}function i(e){var t=e.state.closeBrackets;if(!t)return null;var n=e.getModeAt(e.getCursor());return n.closeBrackets||t}function r(n){var r=i(n);if(!r||n.getOption("disableInput"))return e.Pass;for(var o=t(r,"pairs"),a=n.listSelections(),s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var l=c(n,a[s].head);if(!l||o.indexOf(l)%2!=0)return e.Pass}for(var s=a.length-1;s>=0;s--){var u=a[s].head;n.replaceRange("",h(u.line,u.ch-1),h(u.line,u.ch+1))}}function o(n){var r=i(n),o=r&&t(r,"explode");if(!o||n.getOption("disableInput"))return e.Pass;for(var a=n.listSelections(),s=0;s<a.length;s++){if(!a[s].empty())return e.Pass;var l=c(n,a[s].head);if(!l||o.indexOf(l)%2!=0)return e.Pass}n.operation(function(){n.replaceSelection("\n\n",null),n.execCommand("goCharLeft"),a=n.listSelections();for(var e=0;e<a.length;e++){var t=a[e].head.line;n.indentLine(t,null,!0),n.indentLine(t+1,null,!0)}})}function a(t){var n=e.cmpPos(t.anchor,t.head)>0;return{anchor:new h(t.anchor.line,t.anchor.ch+(n?-1:1)),head:new h(t.head.line,t.head.ch+(n?1:-1))}}function s(n,r){var o=i(n);if(!o||n.getOption("disableInput"))return e.Pass;var s=t(o,"pairs"),c=s.indexOf(r);if(-1==c)return e.Pass;for(var d,p,f=t(o,"triples"),m=s.charAt(c+1)==r,g=n.listSelections(),v=c%2==0,y=0;y<g.length;y++){var b,_=g[y],w=_.head,p=n.getRange(w,h(w.line,w.ch+1));if(v&&!_.empty())b="surround";else if(!m&&v||p!=r)if(m&&w.ch>1&&f.indexOf(r)>=0&&n.getRange(h(w.line,w.ch-2),w)==r+r&&(w.ch<=2||n.getRange(h(w.line,w.ch-3),h(w.line,w.ch-2))!=r))b="addFour";else if(m){if(e.isWordChar(p)||!u(n,w,r))return e.Pass;b="both"}else{if(!v||n.getLine(w.line).length!=w.ch&&!l(p,s)&&!/\s/.test(p))return e.Pass;b="both"}else b=f.indexOf(r)>=0&&n.getRange(w,h(w.line,w.ch+3))==r+r+r?"skipThree":"skip";if(d){if(d!=b)return e.Pass}else d=b}var x=c%2?s.charAt(c-1):r,C=c%2?r:s.charAt(c+1);n.operation(function(){if("skip"==d)n.execCommand("goCharRight");else if("skipThree"==d)for(var e=0;3>e;e++)n.execCommand("goCharRight");else if("surround"==d){for(var t=n.getSelections(),e=0;e<t.length;e++)t[e]=x+t[e]+C;n.replaceSelections(t,"around"),t=n.listSelections().slice();for(var e=0;e<t.length;e++)t[e]=a(t[e]);n.setSelections(t)}else"both"==d?(n.replaceSelection(x+C,null),n.triggerElectric(x+C),n.execCommand("goCharLeft")):"addFour"==d&&(n.replaceSelection(x+x+x+x,"before"),n.execCommand("goCharRight"))})}function l(e,t){var n=t.lastIndexOf(e);return n>-1&&n%2==1}function c(e,t){var n=e.getRange(h(t.line,t.ch-1),h(t.line,t.ch+1));return 2==n.length?n:null}function u(t,n,i){var r=t.getLine(n.line),o=t.getTokenAt(n);if(/\bstring2?\b/.test(o.type))return!1;var a=new e.StringStream(r.slice(0,n.ch)+i+r.slice(n.ch),4);for(a.pos=a.start=o.start;;){var s=t.getMode().token(a,o.state);if(a.pos>=n.ch+1)return/\bstring2?\b/.test(s);a.start=a.pos}}var d={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},h=e.Pos;e.defineOption("autoCloseBrackets",!1,function(t,n,i){i&&i!=e.Init&&(t.removeKeyMap(f),t.state.closeBrackets=null),n&&(t.state.closeBrackets=n,t.addKeyMap(f))});for(var p=d.pairs+"`",f={Backspace:r,Enter:o},m=0;m<p.length;m++)f["'"+p.charAt(m)+"'"]=n(p.charAt(m))})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";function t(e){var t=e.search(i);return-1==t?0:t}var n={},i=/[^\s\u00a0]/,r=e.Pos;e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e||(e=n);for(var t=this,i=1/0,o=this.listSelections(),a=null,s=o.length-1;s>=0;s--){var l=o[s].from(),c=o[s].to();l.line>=i||(c.line>=i&&(c=r(i,0)),i=l.line,null==a?t.uncomment(l,c,e)?a="un":(t.lineComment(l,c,e),a="line"):"un"==a?t.uncomment(l,c,e):t.lineComment(l,c,e))}}),e.defineExtension("lineComment",function(e,o,a){a||(a=n);var s=this,l=s.getModeAt(e),c=a.lineComment||l.lineComment;if(!c)return void((a.blockCommentStart||l.blockCommentStart)&&(a.fullLines=!0,s.blockComment(e,o,a)));var u=s.getLine(e.line);if(null!=u){var d=Math.min(0!=o.ch||o.line==e.line?o.line+1:o.line,s.lastLine()+1),h=null==a.padding?" ":a.padding,p=a.commentBlankLines||e.line==o.line;s.operation(function(){if(a.indent){for(var n=null,o=e.line;d>o;++o){var l=s.getLine(o),u=l.slice(0,t(l));(null==n||n.length>u.length)&&(n=u)}for(var o=e.line;d>o;++o){var l=s.getLine(o),f=n.length;(p||i.test(l))&&(l.slice(0,f)!=n&&(f=t(l)),s.replaceRange(n+c+h,r(o,0),r(o,f)))}}else for(var o=e.line;d>o;++o)(p||i.test(s.getLine(o)))&&s.replaceRange(c+h,r(o,0))})}}),e.defineExtension("blockComment",function(e,t,o){o||(o=n);var a=this,s=a.getModeAt(e),l=o.blockCommentStart||s.blockCommentStart,c=o.blockCommentEnd||s.blockCommentEnd;if(!l||!c)return void((o.lineComment||s.lineComment)&&0!=o.fullLines&&a.lineComment(e,t,o));var u=Math.min(t.line,a.lastLine());u!=e.line&&0==t.ch&&i.test(a.getLine(u))&&--u;var d=null==o.padding?" ":o.padding;e.line>u||a.operation(function(){if(0!=o.fullLines){var n=i.test(a.getLine(u));a.replaceRange(d+c,r(u)),a.replaceRange(l+d,r(e.line,0));var h=o.blockCommentLead||s.blockCommentLead;if(null!=h)for(var p=e.line+1;u>=p;++p)(p!=u||n)&&a.replaceRange(h+d,r(p,0))}else a.replaceRange(c,t),a.replaceRange(l,e)})}),e.defineExtension("uncomment",function(e,t,o){o||(o=n);var a,s=this,l=s.getModeAt(e),c=Math.min(0!=t.ch||t.line==e.line?t.line:t.line-1,s.lastLine()),u=Math.min(e.line,c),d=o.lineComment||l.lineComment,h=[],p=null==o.padding?" ":o.padding;e:if(d){for(var f=u;c>=f;++f){var m=s.getLine(f),g=m.indexOf(d);if(g>-1&&!/comment/.test(s.getTokenTypeAt(r(f,g+1)))&&(g=-1),-1==g&&(f!=c||f==u)&&i.test(m))break e;if(g>-1&&i.test(m.slice(0,g)))break e;h.push(m)}if(s.operation(function(){for(var e=u;c>=e;++e){var t=h[e-u],n=t.indexOf(d),i=n+d.length;0>n||(t.slice(i,i+p.length)==p&&(i+=p.length),a=!0,s.replaceRange("",r(e,n),r(e,i)))}}),a)return!0}var v=o.blockCommentStart||l.blockCommentStart,y=o.blockCommentEnd||l.blockCommentEnd;if(!v||!y)return!1;var b=o.blockCommentLead||l.blockCommentLead,_=s.getLine(u),w=c==u?_:s.getLine(c),x=_.indexOf(v),C=w.lastIndexOf(y);if(-1==C&&u!=c&&(w=s.getLine(--c),C=w.lastIndexOf(y)),-1==x||-1==C||!/comment/.test(s.getTokenTypeAt(r(u,x+1)))||!/comment/.test(s.getTokenTypeAt(r(c,C+1))))return!1;var k=_.lastIndexOf(v,e.ch),S=-1==k?-1:_.slice(0,e.ch).indexOf(y,k+v.length);if(-1!=k&&-1!=S&&S+y.length!=e.ch)return!1;S=w.indexOf(y,t.ch);var T=w.slice(t.ch).lastIndexOf(v,S-t.ch);return k=-1==S||-1==T?-1:t.ch+T,-1!=S&&-1!=k&&k!=t.ch?!1:(s.operation(function(){s.replaceRange("",r(c,C-(p&&w.slice(C-p.length,C)==p?p.length:0)),r(c,C+y.length));var e=x+v.length;if(p&&_.slice(e,e+p.length)==p&&(e+=p.length),s.replaceRange("",r(u,x),r(u,e)),b)for(var t=u+1;c>=t;++t){var n=s.getLine(t),o=n.indexOf(b);if(-1!=o&&!i.test(n.slice(0,o))){var a=o+b.length;p&&n.slice(a,a+p.length)==p&&(a+=p.length),s.replaceRange("",r(t,o),r(t,a))}}}),!0)})})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";function t(e){"object"==typeof e&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay,this.wordsOnly=e.wordsOnly),null==this.style&&(this.style=l),null==this.minChars&&(this.minChars=s),null==this.delay&&(this.delay=c),null==this.wordsOnly&&(this.wordsOnly=u),this.overlay=this.timeout=null}function n(e){var t=e.state.matchHighlighter;clearTimeout(t.timeout),t.timeout=setTimeout(function(){i(e)},t.delay)}function i(e){e.operation(function(){var t=e.state.matchHighlighter;if(t.overlay&&(e.removeOverlay(t.overlay),t.overlay=null),!e.somethingSelected()&&t.showToken){for(var n=t.showToken===!0?/[\w$]/:t.showToken,i=e.getCursor(),o=e.getLine(i.line),s=i.ch,l=s;s&&n.test(o.charAt(s-1));)--s;for(;l<o.length&&n.test(o.charAt(l));)++l;return void(l>s&&e.addOverlay(t.overlay=a(o.slice(s,l),n,t.style)))}var c=e.getCursor("from"),u=e.getCursor("to");if(c.line==u.line&&(!t.wordsOnly||r(e,c,u))){var d=e.getRange(c,u).replace(/^\s+|\s+$/g,"");d.length>=t.minChars&&e.addOverlay(t.overlay=a(d,!1,t.style))}})}function r(e,t,n){var i=e.getRange(t,n);if(null!==i.match(/^\w+$/)){if(t.ch>0){var r={line:t.line,ch:t.ch-1},o=e.getRange(r,t);if(null===o.match(/\W/))return!1}if(n.ch<e.getLine(t.line).length){var r={line:n.line,ch:n.ch+1},o=e.getRange(n,r);if(null===o.match(/\W/))return!1}return!0}return!1}function o(e,t){return!(e.start&&t.test(e.string.charAt(e.start-1))||e.pos!=e.string.length&&t.test(e.string.charAt(e.pos)))}function a(e,t,n){return{token:function(i){return!i.match(e)||t&&!o(i,t)?(i.next(),void(i.skipTo(e.charAt(0))||i.skipToEnd())):n}}}var s=2,l="matchhighlight",c=100,u=!1;e.defineOption("highlightSelectionMatches",!1,function(r,o,a){if(a&&a!=e.Init){var s=r.state.matchHighlighter.overlay;s&&r.removeOverlay(s),clearTimeout(r.state.matchHighlighter.timeout),r.state.matchHighlighter=null,r.off("cursorActivity",n)}o&&(r.state.matchHighlighter=new t(o),i(r),r.on("cursorActivity",n))})})},function(e,t,n){!function(e){e(n(163),n(171),n(174))}(function(e){"use strict";var t=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\.beep|\.lwz|\.xpc|\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\.beeps?|xmpp|xri|ymsgr|z39\.50[rs]?):(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?«»“”‘’]))/i;e.defineMode("gfm",function(n,i){function r(e){return e.code=!1,null}var o=0,a={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(e){return{code:e.code,codeBlock:e.codeBlock,ateSpace:e.ateSpace}},token:function(e,n){if(n.combineTokens=null,n.codeBlock)return e.match(/^```+/)?(n.codeBlock=!1,null):(e.skipToEnd(),null);if(e.sol()&&(n.code=!1),e.sol()&&e.match(/^```+/))return e.skipToEnd(),n.codeBlock=!0,null;if("`"===e.peek()){e.next();var r=e.pos;e.eatWhile("`");var a=1+e.pos-r;return n.code?a===o&&(n.code=!1):(o=a,n.code=!0),null}if(n.code)return e.next(),null;if(e.eatSpace())return n.ateSpace=!0,null;if((e.sol()||n.ateSpace)&&(n.ateSpace=!1,i.gitHubSpice!==!1)){if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+@)?(?:[a-f0-9]{7,40}\b)/))return n.combineTokens=!0,"link";if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+)?#[0-9]+\b/))return n.combineTokens=!0,"link"}return e.match(t)&&"]("!=e.string.slice(e.start-2,e.start)&&(0==e.start||/\W/.test(e.string.charAt(e.start-1)))?(n.combineTokens=!0,"link"):(e.next(),null)},blankLine:r},s={underscoresBreakWords:!1,taskLists:!0,fencedCodeBlocks:"```",strikethrough:!0};for(var l in i)s[l]=i[l];return s.name="markdown",e.overlayMode(e.getMode(n,s),a)},"markdown"),e.defineMIME("text/x-gfm","gfm")})},function(e,t,n){!function(e){e(n(163),n(172),n(173))}(function(e){"use strict";e.defineMode("markdown",function(t,n){function i(n){if(e.findModeByName){var i=e.findModeByName(n);i&&(n=i.mime||i.mimes[0])}var r=e.getMode(t,n);return"null"==r.name?null:r}function r(e,t,n){return t.f=t.inline=n,n(e,t)}function o(e,t,n){return t.f=t.block=n,n(e,t)}function a(e){return!e||!/\S/.test(e.string)}function s(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.strikethrough=!1,e.quote=0,e.indentedCode=!1,x||e.f!=c||(e.f=f,e.block=l),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.prevLine=e.thisLine,e.thisLine=null,null}function l(e,t){var o=e.sol(),s=t.list!==!1,l=t.indentedCode;t.indentedCode=!1,s&&(t.indentationDiff>=0?(t.indentationDiff<4&&(t.indentation-=t.indentationDiff),t.list=null):t.indentation>0?(t.list=null,t.listDepth=Math.floor(t.indentation/4)):(t.list=!1,t.listDepth=0));var c=null;if(t.indentationDiff>=4)return e.skipToEnd(),l||a(t.prevLine)?(t.indentation-=4,t.indentedCode=!0,S.code):null;if(e.eatSpace())return null;if((c=e.match(A))&&c[1].length<=6)return t.header=c[1].length,n.highlightFormatting&&(t.formatting="header"),t.f=t.inline,h(t);if(!(a(t.prevLine)||t.quote||s||l)&&(c=e.match(R)))return t.header="="==c[0].charAt(0)?1:2,n.highlightFormatting&&(t.formatting="header"),t.f=t.inline,h(t);if(e.eat(">"))return t.quote=o?1:t.quote+1,n.highlightFormatting&&(t.formatting="quote"),e.eatSpace(),h(t);if("["===e.peek())return r(e,t,y);if(e.match(D,!0))return t.hr=!0,S.hr;if((a(t.prevLine)||s)&&(e.match(M,!1)||e.match($,!1))){var d=null;return e.match(M,!0)?d="ul":(e.match($,!0),d="ol"),t.indentation=e.column()+e.current().length,t.list=!0,t.listDepth++,n.taskLists&&e.match(L,!1)&&(t.taskList=!0),t.f=t.inline,n.highlightFormatting&&(t.formatting=["list","list-"+d]),h(t)}return n.fencedCodeBlocks&&(c=e.match(j,!0))?(t.fencedChars=c[1],t.localMode=i(c[2]),t.localMode&&(t.localState=t.localMode.startState()),t.f=t.block=u,n.highlightFormatting&&(t.formatting="code-block"),t.code=!0,h(t)):r(e,t,t.inline)}function c(e,t){var n=C.token(e,t.htmlState);return(x&&null===t.htmlState.tagStart&&!t.htmlState.context&&t.htmlState.tokenize.isInText||t.md_inside&&e.current().indexOf(">")>-1)&&(t.f=f,t.block=l,t.htmlState=null),n}function u(e,t){return e.sol()&&t.fencedChars&&e.match(t.fencedChars,!1)?(t.localMode=t.localState=null,t.f=t.block=d,null):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),S.code)}function d(e,t){e.match(t.fencedChars),t.block=l,t.f=f,t.fencedChars=null,n.highlightFormatting&&(t.formatting="code-block"),t.code=!0;var i=h(t);return t.code=!1,i}function h(e){var t=[];if(e.formatting){t.push(S.formatting),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var i=0;i<e.formatting.length;i++)t.push(S.formatting+"-"+e.formatting[i]),"header"===e.formatting[i]&&t.push(S.formatting+"-"+e.formatting[i]+"-"+e.header),"quote"===e.formatting[i]&&(!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(S.formatting+"-"+e.formatting[i]+"-"+e.quote):t.push("error"))}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref?t.push(S.linkHref,"url"):(e.strong&&t.push(S.strong),e.em&&t.push(S.em),e.strikethrough&&t.push(S.strikethrough),e.linkText&&t.push(S.linkText),e.code&&t.push(S.code)),e.header&&t.push(S.header,S.header+"-"+e.header),e.quote&&(t.push(S.quote),!n.maxBlockquoteDepth||n.maxBlockquoteDepth>=e.quote?t.push(S.quote+"-"+e.quote):t.push(S.quote+"-"+n.maxBlockquoteDepth)),e.list!==!1){var r=(e.listDepth-1)%3;r?1===r?t.push(S.list2):t.push(S.list3):t.push(S.list1)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function p(e,t){return e.match(I,!0)?h(t):void 0}function f(t,i){var r=i.text(t,i);if("undefined"!=typeof r)return r;if(i.list)return i.list=null,h(i);if(i.taskList){var a="x"!==t.match(L,!0)[1];return a?i.taskOpen=!0:i.taskClosed=!0,n.highlightFormatting&&(i.formatting="task"),i.taskList=!1,h(i)}if(i.taskOpen=!1,i.taskClosed=!1,i.header&&t.match(/^#+$/,!0))return n.highlightFormatting&&(i.formatting="header"),h(i);var s=t.sol(),l=t.next();if("\\"===l&&(t.next(),n.highlightFormatting)){var u=h(i),d=S.formatting+"-escape";return u?u+" "+d:d}if(i.linkTitle){i.linkTitle=!1;var p=l;"("===l&&(p=")"),p=(p+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var f="^\\s*(?:[^"+p+"\\\\]+|\\\\\\\\|\\\\.)"+p;if(t.match(new RegExp(f),!0))return S.linkHref}if("`"===l){var v=i.formatting;n.highlightFormatting&&(i.formatting="code");var y=h(i),b=t.pos;t.eatWhile("`");var _=1+t.pos-b;return i.code?_===k?(i.code=!1,y):(i.formatting=v,h(i)):(k=_,i.code=!0,h(i))}if(i.code)return h(i);if("!"===l&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),i.inline=i.f=g,S.image;if("["===l&&t.match(/.*\](\(.*\)| ?\[.*\])/,!1))return i.linkText=!0,n.highlightFormatting&&(i.formatting="link"),h(i);if("]"===l&&i.linkText&&t.match(/\(.*\)| ?\[.*\]/,!1)){n.highlightFormatting&&(i.formatting="link");var u=h(i);return i.linkText=!1,i.inline=i.f=g,u}if("<"===l&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1)){i.f=i.inline=m,n.highlightFormatting&&(i.formatting="link");var u=h(i);return u?u+=" ":u="",u+S.linkInline}if("<"===l&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1)){i.f=i.inline=m,n.highlightFormatting&&(i.formatting="link");var u=h(i);return u?u+=" ":u="",u+S.linkEmail}if("<"===l&&t.match(/^(!--|\w)/,!1)){var w=t.string.indexOf(">",t.pos);if(-1!=w){var x=t.string.substring(t.start,w);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(x)&&(i.md_inside=!0)}return t.backUp(1),i.htmlState=e.startState(C),o(t,i,c)}if("<"===l&&t.match(/^\/\w*?>/))return i.md_inside=!1,"tag";var T=!1;if(!n.underscoresBreakWords&&"_"===l&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var D=t.pos-2;if(D>=0){var M=t.string.charAt(D);"_"!==M&&M.match(/(\w)/,!1)&&(T=!0)}}if("*"===l||"_"===l&&!T)if(s&&" "===t.peek());else{if(i.strong===l&&t.eat(l)){n.highlightFormatting&&(i.formatting="strong");var y=h(i);return i.strong=!1,y}if(!i.strong&&t.eat(l))return i.strong=l,n.highlightFormatting&&(i.formatting="strong"),h(i);if(i.em===l){n.highlightFormatting&&(i.formatting="em");var y=h(i);return i.em=!1,y}if(!i.em)return i.em=l,n.highlightFormatting&&(i.formatting="em"),h(i)}else if(" "===l&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return h(i);t.backUp(1)}if(n.strikethrough)if("~"===l&&t.eatWhile(l)){if(i.strikethrough){n.highlightFormatting&&(i.formatting="strikethrough");var y=h(i);return i.strikethrough=!1,y}if(t.match(/^[^\s]/,!1))return i.strikethrough=!0,n.highlightFormatting&&(i.formatting="strikethrough"),h(i)}else if(" "===l&&t.match(/^~~/,!0)){if(" "===t.peek())return h(i);t.backUp(2)}return" "===l&&(t.match(/ +$/,!1)?i.trailingSpace++:i.trailingSpace&&(i.trailingSpaceNewLine=!0)),h(i)}function m(e,t){var i=e.next();if(">"===i){t.f=t.inline=f,n.highlightFormatting&&(t.formatting="link");var r=h(t);return r?r+=" ":r="",r+S.linkInline}return e.match(/^[^>]+/,!0),S.linkInline}function g(e,t){if(e.eatSpace())return null;var i=e.next();return"("===i||"["===i?(t.f=t.inline=v("("===i?")":"]"),n.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,h(t)):"error"}function v(e){return function(t,i){var r=t.next();if(r===e){i.f=i.inline=f,n.highlightFormatting&&(i.formatting="link-string");var o=h(i);return i.linkHref=!1,o}return t.match(w(e),!0)&&t.backUp(1),i.linkHref=!0,h(i)}}function y(e,t){return e.match(/^([^\]\\]|\\.)*\]:/,!1)?(t.f=b,e.next(),n.highlightFormatting&&(t.formatting="link"),t.linkText=!0,h(t)):r(e,t,f)}function b(e,t){if(e.match(/^\]:/,!0)){t.f=t.inline=_,n.highlightFormatting&&(t.formatting="link");var i=h(t);return t.linkText=!1,i}return e.match(/^([^\]\\]|\\.)+/,!0),S.linkText}function _(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=f,S.linkHref+" url")}function w(e){return E[e]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),E[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),E[e]}var x=e.modes.hasOwnProperty("xml"),C=e.getMode(t,x?{name:"xml",htmlMode:!0}:"text/plain");void 0===n.highlightFormatting&&(n.highlightFormatting=!1),void 0===n.maxBlockquoteDepth&&(n.maxBlockquoteDepth=0),void 0===n.underscoresBreakWords&&(n.underscoresBreakWords=!0),void 0===n.taskLists&&(n.taskLists=!1),void 0===n.strikethrough&&(n.strikethrough=!1),void 0===n.tokenTypeOverrides&&(n.tokenTypeOverrides={});var k=0,S={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"tag",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var T in S)S.hasOwnProperty(T)&&n.tokenTypeOverrides[T]&&(S[T]=n.tokenTypeOverrides[T]);var D=/^([*\-_])(?:\s*\1){2,}\s*$/,M=/^[*\-+]\s+/,$=/^[0-9]+([.)])\s+/,L=/^\[(x| )\](?=\s)/,A=n.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,R=/^ *(?:\={1,}|-{1,})\s*$/,I=/^[^#!\[\]*_\\<>` "'(~]+/,j=new RegExp("^("+(n.fencedCodeBlocks===!0?"~~~+|```+":n.fencedCodeBlocks)+")[ \\t]*([\\w+#]*)"),E=[],N={startState:function(){return{f:l,prevLine:null,thisLine:null,block:l,htmlState:null,indentation:0,inline:f,text:p,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t.thisLine,block:t.block,htmlState:t.htmlState&&e.copyState(C,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,header:t.header,hr:t.hr,taskList:t.taskList,list:t.list,listDepth:t.listDepth,quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedChars:t.fencedChars}},token:function(e,t){if(t.formatting=!1,e!=t.thisLine){var n=t.header||t.hr;if(t.header=0,t.hr=!1,e.match(/^\s*$/,!0)||n){if(s(t),!n)return null;t.prevLine=null}t.prevLine=t.thisLine,t.thisLine=e,t.taskList=!1,t.trailingSpace=0,
t.trailingSpaceNewLine=!1,t.f=t.block;var i=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,r=4*Math.floor((i-t.indentation)/4);r>4&&(r=4);var o=t.indentation+r;if(t.indentationDiff=o-t.indentation,t.indentation=o,i>0)return null}return t.f(e,t)},innerMode:function(e){return e.block==c?{state:e.htmlState,mode:C}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:N}},blankLine:s,getType:h,fold:"markdown"};return N},"xml"),e.defineMIME("text/x-markdown","markdown")})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";e.defineMode("xml",function(t,n){function i(e,t){function n(n){return t.tokenize=n,n(e,t)}var i=e.next();if("<"==i)return e.eat("!")?e.eat("[")?e.match("CDATA[")?n(a("atom","]]>")):null:e.match("--")?n(a("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(s(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=a("meta","?>"),"meta"):(C=e.eat("/")?"closeTag":"openTag",t.tokenize=r,"tag bracket");if("&"==i){var o;return o=e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),o?"atom":"error"}return e.eatWhile(/[^&<]/),null}function r(e,t){var n=e.next();if(">"==n||"/"==n&&e.eat(">"))return t.tokenize=i,C=">"==n?"endTag":"selfcloseTag","tag bracket";if("="==n)return C="equals",null;if("<"==n){t.tokenize=i,t.state=d,t.tagName=t.tagStart=null;var r=t.tokenize(e,t);return r?r+" tag error":"tag error"}return/[\'\"]/.test(n)?(t.tokenize=o(n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function o(e){var t=function(t,n){for(;!t.eol();)if(t.next()==e){n.tokenize=r;break}return"string"};return t.isInAttribute=!0,t}function a(e,t){return function(n,r){for(;!n.eol();){if(n.match(t)){r.tokenize=i;break}n.next()}return e}}function s(e){return function(t,n){for(var r;null!=(r=t.next());){if("<"==r)return n.tokenize=s(e+1),n.tokenize(t,n);if(">"==r){if(1==e){n.tokenize=i;break}return n.tokenize=s(e-1),n.tokenize(t,n)}}return"meta"}}function l(e,t,n){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=n,(S.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function c(e){e.context&&(e.context=e.context.prev)}function u(e,t){for(var n;;){if(!e.context)return;if(n=e.context.tagName,!S.contextGrabbers.hasOwnProperty(n)||!S.contextGrabbers[n].hasOwnProperty(t))return;c(e)}}function d(e,t,n){return"openTag"==e?(n.tagStart=t.column(),h):"closeTag"==e?p:d}function h(e,t,n){return"word"==e?(n.tagName=t.current(),k="tag",g):(k="error",h)}function p(e,t,n){if("word"==e){var i=t.current();return n.context&&n.context.tagName!=i&&S.implicitlyClosed.hasOwnProperty(n.context.tagName)&&c(n),n.context&&n.context.tagName==i?(k="tag",f):(k="tag error",m)}return k="error",m}function f(e,t,n){return"endTag"!=e?(k="error",f):(c(n),d)}function m(e,t,n){return k="error",f(e,t,n)}function g(e,t,n){if("word"==e)return k="attribute",v;if("endTag"==e||"selfcloseTag"==e){var i=n.tagName,r=n.tagStart;return n.tagName=n.tagStart=null,"selfcloseTag"==e||S.autoSelfClosers.hasOwnProperty(i)?u(n,i):(u(n,i),n.context=new l(n,i,r==n.indented)),d}return k="error",g}function v(e,t,n){return"equals"==e?y:(S.allowMissing||(k="error"),g(e,t,n))}function y(e,t,n){return"string"==e?b:"word"==e&&S.allowUnquoted?(k="string",g):(k="error",g(e,t,n))}function b(e,t,n){return"string"==e?b:g(e,t,n)}var _=t.indentUnit,w=n.multilineTagIndentFactor||1,x=n.multilineTagIndentPastTag;null==x&&(x=!0);var C,k,S=n.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},T=n.alignCDATA;return i.isInText=!0,{startState:function(){return{tokenize:i,state:d,indented:0,tagName:null,tagStart:null,context:null}},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;C=null;var n=t.tokenize(e,t);return(n||C)&&"comment"!=n&&(k=null,t.state=t.state(C||n,e,t),k&&(n="error"==k?n+" error":k)),n},indent:function(t,n,o){var a=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+_;if(a&&a.noIndent)return e.Pass;if(t.tokenize!=r&&t.tokenize!=i)return o?o.match(/^(\s*)/)[0].length:0;if(t.tagName)return x?t.tagStart+t.tagName.length+2:t.tagStart+_*w;if(T&&/<!\[CDATA\[/.test(n))return 0;var s=n&&/^<(\/)?([\w_:\.-]*)/.exec(n);if(s&&s[1])for(;a;){if(a.tagName==s[2]){a=a.prev;break}if(!S.implicitlyClosed.hasOwnProperty(a.tagName))break;a=a.prev}else if(s)for(;a;){var l=S.contextGrabbers[a.tagName];if(!l||!l.hasOwnProperty(s[2]))break;a=a.prev}for(;a&&!a.startOfLine;)a=a.prev;return a?a.indent+_:0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:n.htmlMode?"html":"xml",helperType:n.htmlMode?"html":"xml"}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";e.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy"]},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Jade",mime:"text/x-jade",mode:"jade",ext:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps"},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mime:"text/n-triples",mode:"ntriples",ext:["nt"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:["php","php3","php4","php5","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["py","pyw"]},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"MariaDB",mime:"text/x-mariadb",mode:"sql"},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"YAML",mime:"text/x-yaml",mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var t=0;t<e.modeInfo.length;t++){var n=e.modeInfo[t];n.mimes&&(n.mime=n.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.mime==t)return i;if(i.mimes)for(var r=0;r<i.mimes.length;r++)if(i.mimes[r]==t)return i}},e.findModeByExtension=function(t){for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.ext)for(var r=0;r<i.ext.length;r++)if(i.ext[r]==t)return i}},e.findModeByFileName=function(t){for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.file&&i.file.test(t))return i}var r=t.lastIndexOf("."),o=r>-1&&t.substring(r+1,t.length);return o?e.findModeByExtension(o):void 0},e.findModeByName=function(t){t=t.toLowerCase();for(var n=0;n<e.modeInfo.length;n++){var i=e.modeInfo[n];if(i.name.toLowerCase()==t)return i;if(i.alias)for(var r=0;r<i.alias.length;r++)if(i.alias[r].toLowerCase()==t)return i}}})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";e.overlayMode=function(t,n,i){return{startState:function(){return{base:e.startState(t),overlay:e.startState(n),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(i){return{base:e.copyState(t,i.base),overlay:e.copyState(n,i.overlay),basePos:i.basePos,baseCur:null,overlayPos:i.overlayPos,overlayCur:null}},token:function(e,r){return(e!=r.streamSeen||Math.min(r.basePos,r.overlayPos)<e.start)&&(r.streamSeen=e,r.basePos=r.overlayPos=e.start),e.start==r.basePos&&(r.baseCur=t.token(e,r.base),r.basePos=e.pos),e.start==r.overlayPos&&(e.pos=e.start,r.overlayCur=n.token(e,r.overlay),r.overlayPos=e.pos),e.pos=Math.min(r.basePos,r.overlayPos),null==r.overlayCur?r.baseCur:null!=r.baseCur&&r.overlay.combineTokens||i&&null==r.overlay.combineTokens?r.baseCur+" "+r.overlayCur:r.overlayCur},indent:t.indent&&function(e,n){return t.indent(e.base,n)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),n.blankLine&&n.blankLine(e.overlay)}}}})},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";function t(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}function n(e){return e.scopes[e.scopes.length-1]}var i=t(["and","or","not","is"]),r=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield","in"],o=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"],a={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]},s={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None","async","await"]};e.registerHelper("hintWords","python",r.concat(o)),e.defineMode("python",function(l,c){function u(e,t){if(e.sol()&&"py"==n(t).type){var i=n(t).offset;if(e.eatSpace()){var r=e.indentation();return r>i?p(e,t,"py"):i>r&&f(e,t)&&(t.errorToken=!0),null}var o=d(e,t);return i>0&&f(e,t)&&(o+=" "+g),o}return d(e,t)}function d(e,t){if(e.eatSpace())return null;var n=e.peek();if("#"==n)return e.skipToEnd(),"comment";if(e.match(/^[0-9\.]/,!1)){var r=!1;if(e.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(r=!0),e.match(/^\d+\.\d*/)&&(r=!0),e.match(/^\.\d+/)&&(r=!0),r)return e.eat(/J/i),"number";var o=!1;if(e.match(/^0x[0-9a-f]+/i)&&(o=!0),e.match(/^0b[01]+/i)&&(o=!0),e.match(/^0o[0-7]+/i)&&(o=!0),e.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(e.eat(/J/i),o=!0),e.match(/^0(?![\dx])/i)&&(o=!0),o)return e.eat(/L/i),"number"}return e.match(T)?(t.tokenize=h(e.current()),t.tokenize(e,t)):e.match(_)||e.match(b)?"punctuation":e.match(y)||e.match(w)?"operator":e.match(v)?"punctuation":"."==t.lastToken&&e.match(x)?"property":e.match(D)||e.match(i)?"keyword":e.match(M)?"builtin":e.match(/^(self|cls)\b/)?"variable-2":e.match(x)?"def"==t.lastToken||"class"==t.lastToken?"def":"variable":(e.next(),g)}function h(e){function t(t,r){for(;!t.eol();)if(t.eatWhile(/[^'"\\]/),t.eat("\\")){if(t.next(),n&&t.eol())return i}else{if(t.match(e))return r.tokenize=u,i;t.eat(/['"]/)}if(n){if(c.singleLineStringErrors)return g;r.tokenize=u}return i}for(;"rub".indexOf(e.charAt(0).toLowerCase())>=0;)e=e.substr(1);var n=1==e.length,i="string";return t.isString=!0,t}function p(e,t,i){var r=0,o=null;if("py"==i)for(;"py"!=n(t).type;)t.scopes.pop();r=n(t).offset+("py"==i?l.indentUnit:C),"py"==i||e.match(/^(\s|#.*)*$/,!1)||(o=e.column()+1),t.scopes.push({offset:r,type:i,align:o})}function f(e,t){for(var i=e.indentation();n(t).offset>i;){if("py"!=n(t).type)return!0;t.scopes.pop()}return n(t).offset!=i}function m(e,t){var i=t.tokenize(e,t),r=e.current();if("@"==r)return c.version&&3==parseInt(c.version,10)?e.match(x,!1)?"meta":"operator":e.match(x,!1)?"meta":g;"variable"!=i&&"builtin"!=i||"meta"!=t.lastToken||(i="meta"),("pass"==r||"return"==r)&&(t.dedent+=1),"lambda"==r&&(t.lambda=!0),":"!=r||t.lambda||"py"!=n(t).type||p(e,t,"py");var o=1==r.length?"[({".indexOf(r):-1;if(-1!=o&&p(e,t,"])}".slice(o,o+1)),o="])}".indexOf(r),-1!=o){if(n(t).type!=r)return g;t.scopes.pop()}return t.dedent>0&&e.eol()&&"py"==n(t).type&&(t.scopes.length>1&&t.scopes.pop(),t.dedent-=1),i}var g="error",v=c.singleDelimiters||/^[\(\)\[\]\{\}@,:`=;\.]/,y=c.doubleOperators||/^([!<>]==|<>|<<|>>|\/\/|\*\*)/,b=c.doubleDelimiters||/^(\+=|\-=|\*=|%=|\/=|&=|\|=|\^=)/,_=c.tripleDelimiters||/^(\/\/=|>>=|<<=|\*\*=)/;if(c.version&&3==parseInt(c.version,10))var w=c.singleOperators||/^[\+\-\*\/%&|\^~<>!@]/,x=c.identifiers||/^[_A-Za-z\u00A1-\uFFFF][_A-Za-z0-9\u00A1-\uFFFF]*/;else var w=c.singleOperators||/^[\+\-\*\/%&|\^~<>!]/,x=c.identifiers||/^[_A-Za-z][_A-Za-z0-9]*/;var C=c.hangingIndent||l.indentUnit,k=r,S=o;if(void 0!=c.extra_keywords&&(k=k.concat(c.extra_keywords)),void 0!=c.extra_builtins&&(S=S.concat(c.extra_builtins)),c.version&&3==parseInt(c.version,10)){k=k.concat(s.keywords),S=S.concat(s.builtins);var T=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}else{k=k.concat(a.keywords),S=S.concat(a.builtins);var T=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}var D=t(k),M=t(S),$={startState:function(e){return{tokenize:u,scopes:[{offset:e||0,type:"py",align:null}],lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var n=t.errorToken;n&&(t.errorToken=!1);var i=m(e,t);return i&&"comment"!=i&&(t.lastToken="keyword"==i||"punctuation"==i?e.current():i),"punctuation"==i&&(i=null),e.eol()&&t.lambda&&(t.lambda=!1),n?i+" "+g:i},indent:function(t,i){if(t.tokenize!=u)return t.tokenize.isString?e.Pass:0;var r=n(t),o=i&&i.charAt(0)==r.type;return null!=r.align?r.align-(o?1:0):o&&t.scopes.length>1?t.scopes[t.scopes.length-2].offset:r.offset},closeBrackets:{triples:"'\""},lineComment:"#",fold:"indent"};return $}),e.defineMIME("text/x-python","python");var l=function(e){return e.split(" ")};e.defineMIME("text/x-cython",{name:"python",extra_keywords:l("by cdef cimport cpdef ctypedef enum exceptextern gil include nogil property publicreadonly struct union DEF IF ELIF ELSE")})})},function(e,t,n){var i,r;i=[n(177),n(179),n(181)],r=function(e,t,n){return{markdown:e,code:t,heading:e,raw:e,strategy:n}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(89),n(178)],r=function(e,t){return t.extend({initialize:function(t){var n=this;this.view=t.view,this.view.on("editorInited",function(){n.run()}),this.view.$el.addClass("cell-markdown no-handle no-toggler"),this.md=new e,this.view.on("switch render",function(){n.ensureMD()})},ensureMD:function(){var e,t=this;this.inited||(e=$('<div class="buffer"></div>'),t.view.ui.resultWrapper.append(e),this.md.Init({preview:this.view.ui.result[0],buffer:e[0],getText:function(){return t.view.editor.getValue()},emptyText:"This is an empty markdown cell"}),this.inited=!0,this.view.$el.find(".show-code").hide())},onDestroy:function(){this.view.off("editorInited"),this.view.$el.removeClass("cell-markdown no-handle no-toggler"),this.view.$el.find(".buffer").remove(),this.view.ui.result.show().css("position","static"),this.view.ui.resultWrapper.hide(),this.view.ui.code.show()},run:function(){this.noHandle=!0,this.view.ui.code.hide(),this.ensureMD(),this.md.Update(),this.view.ui.resultWrapper.show()},value:function(){return this.view.model.get("source")},setValue:function(e){this.view.model.set("source",e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(47)],r=function(e,t){return e.Controller.extend({runAndNext:function(){this.run(),this.view.trigger("next",function(e){t.menuVent.trigger("addCell")})},runAndAdd:function(){this.run(),t.menuVent.trigger("addCell")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(163),n(47),n(92),n(180),n(178)],r=function(e,t,n,i,r,o){return o.extend({initialize:function(e){var t=this;this.view=e.view,this.listenTo(this.view,{status:function(e){t.status(e)},executeReply:function(e){t.executeReply(e)}}),this.view.$el.addClass("cell-code"),this.view.on("render switch",function(){t.ensureDom()})},ensureDom:function(){this.inited||(this.view.ui.result.before('<div class="result-toggler"><span class="fa fa-chevron-up"></span></div>'),this.view.model.get("collapsed")&&this.view.$el.find(".result-toggler").addClass("folded"),this.inited=!0)},onDestroy:function(){this.stopListening(),this.view.$el.removeClass("cell-code"),this.view.ui.result.empty(),this.view.$el.find(".result-toggler").remove()},value:function(){return this.view.model.get("input")},setValue:function(e){return this.view.model.set("input",e)},run:function(){n.statusVent.trigger("status",{status:"busy"}),this.view.busy=!0,this.view.$el.addClass("busy"),this.view.clearResult(),this.view.model.clearOutputs()},getCode:function(){var e=this.view.editor.getValue();return this.setValue(e),this.view.model.get("input")},savedOut:function(e){if("stream"===e.output_type&&"stdout"===e.stream)this.view.appendResult(e.text).addClass("stream");else if("pyout"===e.output_type)this.view.appendResult(e.html||e.text).addClass("pyout");else if("display_data"===e.output_type)this.view.appendResult(this.outputImage(e.png));else if("pyerr"===e.output_type){var t=this.formatPyerr(e.traceback);this.view.appendResult(t,!0)}},outputImage:function(e){var t=$("<img>");return t.attr("src","data:image/png;base64,"+e),t},payload:function(e){if("page"===e.source){var t=this.formatPyerr(e.text);n.beltVent.trigger("flexo:manual:reset",t)}},executeReply:function(e){"aborted"===e.content.status&&(this.view.$el.removeClass("busy"),this.view.busy=!1)},status:function a(e){var a;e.content.execution_state&&(a=e.content.execution_state,"idle"===a&&(this.view.$el.removeClass("busy"),this.view.busy=!1,this.view.editor.hasFocus()&&this.view.handle.trigger("status","edit")),this.view.handle.trigger("status",a),n.statusVent.trigger("status",{status:a,reset:e.content.reset}))},formatPyerr:function(e){return null===e?"":(e=e.join?e.join("\n"):e,e=r.fixConsole(e),e=r.fixCarriageReturn(e),e=r.autoLinkUrls(e))},cmOptions:{readOnly:!0}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){var e={"01":"ansibold",30:"ansiblack",31:"ansired",32:"ansigreen",33:"ansiyellow",34:"ansiblue",35:"ansipurple",36:"ansicyan",37:"ansigray",40:"ansibgblack",41:"ansibgred",42:"ansibggreen",43:"ansibgyellow",44:"ansibgblue",45:"ansibgpurple",46:"ansibgcyan",47:"ansibggray"};return{_process_numbers:function(t,n){var i=n.shift();if(e[i])t["class"]?t["class"]+=" "+e[i]:t["class"]=e[i];else if("38"==i||"48"==i){if(n.length<2)return void console.log("Not enough fields for VT100 color",n);var r,o,a,s=n.shift();if("5"==s){var l=parseInt(n.shift());if(16>l){l%=8;var c=e[i[0]+(l%8).toString()];return void(t["class"]?t["class"]+=" "+c:t["class"]=c)}232>l?(l-=16,a=l%6,o=Math.floor(l/6)%6,r=Math.floor(l/36)%6,r=51*r,o=51*o,a=51*a):(l-=231,r=o=a=Math.floor(256*l/26))}else{if("2"!=s)return void console.log("unrecognized control",n);if(n.length>3)return void console.log("Not enough fields for RGB",n);r=n.shift(),o=n.shift(),a=n.shift()}if(void 0!==r){var u;u="38"==i?"color: ":"background-color: ",u=u+"rgb("+r+","+o+","+a+");",t.style?t.style+=" "+u:t.style=u}}},ansispan:function(e){var t=this;return e.replace(/\033\[(0?[01]|22|39)?([;\d]+)?m/g,function(e,n,i){if(!i)return"</span>";for(var r=i.match(/\d+/g),o={};r.length>0;)t._process_numbers(o,r);var a="<span ";for(var s in o){o[s];a=a+" "+s+'="'+o[s]+'"'}return a+">"})},xmlencode:function(e){return e.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;").replace(/`/g,"&#96;")},fixConsole:function(e){e=this.xmlencode(e);var t=/(?=(\033\[[\d;=]*[a-ln-zA-Z]{1}))\1(?!m)/g;return e=e.replace(t,""),e=this.ansispan(e)},fixCarriageReturn:function(e){var t=e;do e=t,t=e.replace(/\r+\n/gm,"\n"),t=t.replace(/^.*\r+/gm,"");while(t.length<e.length);return e},autoLinkUrls:function(e){return e.replace(/(^|\s)(https?|ftp)(:[^'">\s]+)/gi,'$1<a target="_blank" href="$2$3">$2$3</a>')}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(45),n(182),n(47),n(179),n(183)],r=function(e,t,n,i){return i.extend({initialize:function(){i.prototype.initialize.apply(this,arguments),this.view.$el.addClass("strategy-cell")},savedOut:function(e){var t=this;return"pyout"!==e.output_type?void(("stream"===e.output_type||"pyerr"===e.output_type)&&i.prototype.savedOut.apply(this,arguments)):(e=e.text,e=e.replace(/^'(.*)'$/,function(e,t){return t}),e=JSON.parse(e),this.outputBrief(e),void setTimeout(function(){t.outputChart(e)},10))},buildBrief:function(n){var i=$('<ul class="brief-list">'),r=e.template('<li><span class="title"><%= title %></span><span class="value"><%= value %></span></li>'),o={annualized_return:{title:"年化收益率",format:"0.0%"},benchmark_annualized_return:{title:"基准年化收益率",format:"0.0%"},alpha:{title:"阿尔法",format:"0.0%"},beta:"贝塔",sharpe:"夏普比率",volatility:{title:"收益波动率",format:"0.0%"},information:"信息比率",max_drawdown:{title:"最大回撤",format:"0.0%"},turnover_rate:"换手率"};return e.each(o,function(o,a){var s,l=o.title||o;s=e.isNull(n[a])||e.isUndefined(n[a])?"--":t.format(n[a],"0.00"),o.title&&(l=o.title),o.format&&!e.isNull(n[a])&&(s=t.format(n[a],o.format)),i.append(r({title:l,value:s}))}),i},outputBrief:function(e){var t=this.view.appendResult(this.buildBrief(e));this.view.ui.result.prepend(t),console.log("got strategy data",e)},buildChart:function(n,i){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],o={chart:{animation:!1},credits:{enabled:!1},title:{text:"累计收益率"},rangeSelector:{enabled:!1},plotOptions:{line:{marker:{enabled:!1}}},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%m-%d",week:"%m-%d",month:"%Y-%m",year:"%Y"},offset:20,minTickInterval:864e5},yAxis:{title:{text:""},labels:{formatter:function(){return t.format(this.value,"0.00%")}}},tooltip:{shared:!0,formatter:function(){var n="<b>"+Highcharts.dateFormat("%Y-%m-%d",this.x)+"</b>",i=e.template('<br><span style="color:<%= color %>"><%= name %></span>: <%= y %>');return e.each(this.points,function(e){n+=i({name:e.series.name,color:e.series.color,y:t.format(e.y,"0.00%")})}),n}},series:[{name:"策略",data:e.map(n.cumulative_return,function(e,t){return[parseInt(t),e]}).sort(function(e,t){return e[0]-t[0]})},{name:"基准",data:e.map(n.benchmark_cumulative_return,function(e,t){return[parseInt(t),e]}).sort(function(e,t){return e[0]-t[0]})}]};r?(e.extend(o,{scrollbar:{enabled:!1}}),o.yAxis.labels.align="right",o.yAxis.labels.y=5,o.yAxis.labels.x=-9,i.highcharts("StockChart",o)):i.highcharts(o)},outputChart:function(e){var t=$('<div class="chart"></div>'),n=this.view.appendResult(t);return this.view.ui.result.find(".brief-list").parent().after(n),this.buildChart(e,t),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_182__},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_183__;
},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="code">\n    <div class="input-wrapper">\n        <div class="input"></div>\n    </div>\n</div>\n<div class="result-wrapper">\n    <div class="result"></div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(161),n(186)],r=function(e,t,n,i){return n.extend({template:i,events:{"click .show-code":"showCode"},showCode:function(e){var t=this,n=t.$el.find(".input-wrapper").clone();n.find(".show-code").remove(),App.vent.trigger("show-code",n),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="code">\n    <div class="input-wrapper">\n        <div class="input"></div>\n    </div>\n</div>\n    <a href="" class="show-code">查看全部</a>\n<div class="result-wrapper">\n    <div class="result"></div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(48),n(188)],r=function(e,t){return e.Collection.extend({model:t,initialize:function(){}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(189)],r=function(e,t,n){var i={markdown:{code:{source:"input"},strategy:{source:"input"}},code:{markdown:{input:"source",language:null,outputs:null,prompt_number:null,trusted:null,collapsed:null},strategy:{input:"input"}},strategy:{markdown:{input:"source",language:null,outputs:null,prompt_number:null,trusted:null,collapsed:null},code:{input:"input"}}},r={code:{cell_type:"code",collapsed:!1,language:"python",metadata:{},outputs:[],input:""},strategy:{cell_type:"strategy",collapsed:!1,language:"python",metadata:{},outputs:[],input:""},markdown:{cell_type:"markdown",metadata:{},source:""}},o=t.Model.extend({initialize:function(i){t.Model.prototype.initialize.apply(this,arguments);-1!==i.cell_type.search("heading")&&(i.cell_type="markdown"),i=e.defaults(i,this.getDefaults(i.cell_type),this.toJSON()),this.set(i,{silent:!0}),this.get("id")||this.set("id",n())},idAttribute:"_id",getDefaults:function(e){return e=e||this.get("cell_type"),r[e]?r[e]:null},convert:function(t){var n=this,r=i[this.get("cell_type")][t],o={cell_type:t};e.isUndefined(r)||(e.isNull(r)||e.each(r,function(t,i){e.isNull(t)||(o[t]=n.get(i)),n.unset(i,{silent:!0})}),o=e.defaults(o,this.getDefaults(t)),n.set(o))},getCMMode:function(){switch(this.get("cell_type")){case"markdown":return"markdown";case"code":return"python";case"strategy":return"python"}return"text"},normalizeOutput:function(t){var n={};return"stream"===t.msg_type?n={output_type:"stream",stream:t.content.name,text:t.content.data}:"pyout"===t.msg_type?(n={output_type:"pyout",metadata:t.content.metadata,prompt_number:t.content.execution_count,text:t.content.data["text/plain"]},t.content.data["text/html"]&&(n.html=t.content.data["text/html"])):"display_data"===t.msg_type?n={output_type:"display_data",metadata:t.content.metadata,text:t.content.data["text/plain"],png:t.content.data["image/png"]}:"pyerr"===t.msg_type&&(n=e.extend({output_type:"pyerr"},t.content)),n},clearOutputs:function(){this.set("outputs",[])},addOutput:function(e){this.get("outputs").push(this.normalizeOutput(e))}});return o.types=e.keys(i),o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(){for(var e=[],t="0123456789ABCDEF",n=0;32>n;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);e[12]="4",e[16]=t.substr(3&e[16]|8,1);var i=e.join("");return i}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(45),n(49),n(162),n(191),n(192),n(171),n(193),n(194)],r=function(e,t,n,i,r){var o={bold:{replace:"**$1**",title:"粗体",placeholder:"粗体"},italic:{replace:"*$1*",title:"斜体",placeholder:"斜体"},link:{replace:"[$1](http://)",title:"链接",placeholder:"链接内容"},image:{replace:"![$1](http://)",title:"图片",icon:"picture-o",placeholder:"图片注释"},code:{replace:"\n```python\n$1\n```",title:"代码",placeholder:"代码内容"},quote:{title:"引用",line:"> $1",icon:"quote-right"},"list-ul":{title:"无序列表",line:"* $1"},"list-ol":{title:"有序列表",line:"1. $1"}},a=function(e,t,n){var i,r,o=e.getSelection();o||(o=n||""),e.replaceSelection(t.replace("$1",o),"start"),i=e.getCursor(),r=t.indexOf("$1")+o.length,o===n?e.setSelection({line:i.line,ch:i.ch+t.indexOf("$1")},{line:i.line,ch:i.ch+r}):e.setCursor({line:i.line,ch:i.ch+r})},s=function(e,t){var n=e.getCursor(),i=e.getLine(n.line),r=t.replace("$1",i);e.replaceRange(r,{line:n.line,ch:0},{line:n.line,ch:i.length})};return t.ItemView.extend({className:"markdown-editor",template:i,ui:{tools:".tools"},events:{"click .tool:not(.disabled)":"clickTool"},initialize:function(e){this.opts=e||{}},onRender:function(){this.editor=n(this.$el.find(".input")[0],{mode:"markdown",extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"},lineNumbers:!1,highlightSelectionMatches:!1,placeholder:this.opts.placeholder||""}),this.renderTools()},renderTools:function(){var t=this;e.each(o,function(n,i){t.ui.tools.append(r(e.defaults(n,{name:i,icon:""})))})},addTool:function(t){this.ui.tools.append(r(e.defaults(t,{icon:""})))},onShow:function(){this.editor.refresh()},clickTool:function(e){var t=$(e.currentTarget),n=t.data("action");o[n]&&(o[n].replace&&a(this.editor,o[n].replace,o[n].placeholder),o[n].line&&s(this.editor,o[n].line),o[n].click&&o[n].click.call(this,t),this.editor.focus())},setValue:function(e){this.editor.setValue(e)},getValue:function(){return this.editor.getValue()},focus:function(){this.editor.focus(),this.editor.setCursor(this.editor.lineCount(),0)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<ul class="tools"></ul>\n<div class="editor">\n    <div class="input"></div>\n    <div class="help-block">\n        <a href="help/faq/#如何编写文档" target="_blank">什么是Markdown？</a>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<li class="'+(null==(__t=name)?"":__t)+'-tool-item">\n    <span class="tool '+(null==(__t=name)?"":__t)+'" title="'+(null==(__t=title)?"":__t)+'" data-action="'+(null==(__t=name)?"":__t)+'">\n        <i class="fa fa-'+(null==(__t=icon||name)?"":__t)+'"></i>\n    </span>\n</li>\n';return __p}},function(e,t,n){!function(e){e(n(163))}(function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-]\s|(\d+)([.)]))(\s*)/,n=/^(\s*)(>[> ]*|[*+-]|(\d+)[.)])(\s*)$/,i=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(r){if(r.getOption("disableInput"))return e.Pass;for(var o=r.listSelections(),a=[],s=0;s<o.length;s++){var l=o[s].head,c=r.getStateAfter(l.line),u=c.list!==!1,d=0!==c.quote,h=r.getLine(l.line),p=t.exec(h);if(!o[s].empty()||!u&&!d||!p)return void r.execCommand("newlineAndIndent");if(n.test(h))r.replaceRange("",{line:l.line,ch:0},{line:l.line,ch:l.ch+1}),a[s]="\n";else{var f=p[1],m=p[5],g=i.test(p[2])||p[2].indexOf(">")>=0?p[2]:parseInt(p[3],10)+1+p[4];a[s]="\n"+f+g+m}}r.replaceSelections(a)}})},function(e,t,n){!function(e){e(n(163))}(function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function n(e){t(e);var n=e.state.placeholder=document.createElement("pre");n.style.cssText="height: 0; overflow: visible",n.className="CodeMirror-placeholder";var i=e.getOption("placeholder");"string"==typeof i&&(i=document.createTextNode(i)),n.appendChild(i),e.display.lineSpace.insertBefore(n,e.display.lineSpace.firstChild)}function i(e){o(e)&&n(e)}function r(e){var i=e.getWrapperElement(),r=o(e);i.className=i.className.replace(" CodeMirror-empty","")+(r?" CodeMirror-empty":""),r?n(e):t(e)}function o(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(n,o,a){var s=a&&a!=e.Init;if(o&&!s)n.on("blur",i),n.on("change",r),r(n);else if(!o&&s){n.off("blur",i),n.off("change",r),t(n);var l=n.getWrapperElement();l.className=l.className.replace(" CodeMirror-empty","")}o&&!n.hasFocus()&&i(n)})})},function(e,t,n){var i,r;i=[n(48),n(196)],r=function(e,t){return e.Collection.extend({model:t,initialize:function(e){this.shareID=e.shareID},parse:function(e){return e.data.comments||[]},url:function(){return window.getapi("mercury_community","/w/thread/"+this.shareID+"/comments")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(76)],r=function(e){return e.NestedModel.extend({defaults:{},urlRoot:function(){return window.getapi("mercury_community","/thread/"+this.collection.shareID+"/comment")},operationUrl:function(){return window.getapi("mercury_community","/thread/"+this.collection.shareID+"/comment/"+this.id)},parse:function(e){return 200===e.code?e.data.comment:e||{}},up:function(){var e=this;return $.ajax({url:this.operationUrl()+"/up",type:"PUT"}).done(function(t){t.data&&_.isNumber(t.data.up_count)&&e.set("up_count",t.data.up_count)})},collect:function(){var e=this;return $.ajax({url:this.operationUrl()+"/collect",type:"PUT"}).done(function(t){t.data&&_.isNumber(t.data.collect_count)&&e.set("collect_count",t.data.collect_count)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(198)],r=function(e,t){return e.CollectionView.extend({className:"comment-list",tagName:"ul",childView:t,onRender:function(){var e=this;0===this.collection.size()&&this.$el.addClass("empty"),this.listenTo(this.collection,"add remove",function(){0===e.collection.size()?e.$el.addClass("empty"):e.$el.removeClass("empty")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(46),n(116),n(84),n(87),n(88),n(89),n(103),n(199),n(156)],r=function(e,t,n,i,r,o,a,s,l,c,u,d){return t.ItemView.extend({className:"comment-item",tagName:"li",template:u,events:{"click .actions .action-delete":"clickDelete","click .actions .action-reply":"clickReply","click .actions .action-like":"clickLike","click .actions .action-collect":"clickCollect"},initialize:function(){this.md=new l({breaks:!0})},onRender:function(){var e=this;this.md.Init({preview:this.$el.find(".content")[0],buffer:this.$el.find(".buffer")[0],getText:function(){return e.model.get("content")},getAtArray:e.model.get("at"),emptyText:"",preMarked:function(e,t){return a(e,t)}}),this.md.Update(),this.listenTo(this.model,{"change:up_count":function(){e.$el.find(".action-like .comment-count").text(e.model.get("up_count"))},"change:collect_count":function(){e.$el.find(".action-collect .comment-count").text(e.model.get("collect_count"))}}),this.on("collect_able",function(t){t?e.$el.find(".action-collect").removeClass("icon-liked"):e.$el.find(".action-collect").addClass("icon-liked")}),this.on("up_able",function(t){t?e.$el.find(".action-like").removeClass("icon-liked"):e.$el.find(".action-like").addClass("icon-liked")})},onShow:function(){this.md.Update()},serializeData:function(){var t=r.get("profile"),n={time:o.fromNow(this.model.get("create"))};return n=e.extend(this.model.toJSON(),n),n.author.appUrl=new c({id:this.model.get("author.id")}).appUrl(),n.isMyComment=t.get("id")===n.author.id,n.anonymous=i.anonymous,n.content=s(n.content),n},clickDelete:function(e){var t,i=this;t=n.Confirm({title:"删除确认",content:"确认删除您的回复吗？",yes:function(){i.model.destroy()}}),t.$el.on("hidden.bs.modal",function(){t.destroy()}),e.preventDefault()},clickReply:function(e){var t=this.model.get("author.profile.nickname");this.trigger("at",t),e.preventDefault()},clickLike:function(e){var t=this,n=$(e.currentTarget);return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):(this.model.up().done(function(e){if(512===e.code){n.popover({content:"自己的回复，让别人感谢去吧",placement:"bottom",trigger:"manual",html:!0}),n.popover("toggle");var i=setTimeout(function(){n.popover("hide"),clearTimeout(i)},3e3)}else 200===e.code&&t.trigger("up_able",e.data.up_able)}),void e.preventDefault())},clickCollect:function(e){var t=this;$(e.currentTarget);return i.anonymous?void i.loginWithModal({appRoot:window.getApp("cloud-portal","")}):(this.model.collect().done(function(e){t.trigger("collect_able",e.data.collect_able)}),void e.preventDefault())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="user">\n    '+(null==(__t=_T.partial("simpleUser",author))?"":__t)+'\n</div>\n<div class="meta">\n    <span class="meta-item actions">\n    ',anonymous||(__p+="\n        ",isMyComment&&(__p+='\n        <a class="action-delete"><i class="fa fa-trash"></i>删除</a>\n        '),__p+="\n        ",isMyComment||(__p+='\n        <a class="action-reply"><i class="fa fa-reply"></i>回复</a>\n        '),__p+='\n        <a class="action-like like '+(null==(__t=up_able?"":" icon-liked")?"":__t)+'"><i class="fa fa-heart-o"></i><span class="text comment-count">'+(null==(__t=up_count)?"":__t)+'</span>感谢</a>\n        <a class="action-collect collect '+(null==(__t=collect_able?"":" icon-liked")?"":__t)+'"><i class="fa fa-star-o"></i><span class="text comment-count">'+(null==(__t=collect_count)?"":__t)+"</span>收藏</a>\n    </span>\n    "),__p+='\n    <span class="meta-item time">\n        '+(null==(__t=time)?"":__t)+'\n    </span>\n</div>\n<div class="content">'+(null==(__t=content)?"":__t)+'</div>\n<div class="buffer"></div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="cm_main">\n    <!-- <div class="header-overlay overlay"></div> -->\n    <div class="header-overlay header-actions">\n        ',"discuss"!==meta.type&&(__p+='\n        <a class="actionFork fork" ><i class="fa fa-clone"></i><span class="text count">'+(null==(__t=meta.fork_count)?"":__t)+"</span> 克隆</a>\n        "),__p+="\n        ","discuss"===meta.type&&(__p+='\n        <a class="actionFollow follow'+(null==(__t=meta.follow_able?"":" liked")?"":__t)+'"><i class="fa fa-plus"></i><span class="text count">'+(null==(__t=meta.follow_count)?"":__t)+"</span> 关注</a>\n        "),__p+='\n        <a class="actionLike like'+(null==(__t=meta.up_able?"":" liked")?"":__t)+'"><i class="fa fa-thumbs-o-up"></i><span class="text count">'+(null==(__t=meta.up_count)?"":__t)+'</span> 赞</a>\n        <a class="actionCollect collect'+(null==(__t=meta.collect_able?"":" liked")?"":__t)+'"><i class="fa fa-star-o"></i><span class="text count">'+(null==(__t=meta.collect_count)?"":__t)+'</span> 收藏</a>\n    </div>\n\n    <div class="thread-title">\n\n        <h1>'+__e(title)+'</h1>\n    </div>\n    <div class="handle">\n        <p>\n            ',"discuss"!==meta.type&&(__p+='\n            <a class="actionFork fork" ><i class="fa fa-clone"></i><span class="text count">'+(null==(__t=meta.fork_count)?"":__t)+"</span> 克隆</a>\n            "),__p+="\n            ","discuss"===meta.type&&(__p+='\n            <a class="actionFollow follow'+(null==(__t=meta.follow_able?"":" liked")?"":__t)+'"><i class="fa fa-plus"></i><span class="text count">'+(null==(__t=meta.follow_count)?"":__t)+"</span> 关注</a>\n            "),__p+='\n            <a class="actionLike like'+(null==(__t=meta.up_able?"":" liked")?"":__t)+'"><i class="fa fa-thumbs-o-up"></i><span class="text count">'+(null==(__t=meta.up_count)?"":__t)+'</span> 赞</a>\n            <a class="actionCollect collect'+(null==(__t=meta.collect_able?"":" liked")?"":__t)+'"><i class="fa fa-star-o"></i><span class="text count">'+(null==(__t=meta.collect_count)?"":__t)+"</span> 收藏</a>\n        </p>\n        发布于"+(null==(__t=time)?"":__t)+'\n    </div>\n\n    <div class="notebook notebook-detail"></div>\n\n    ',"retrieved"!==status&&(__p+='\n    <div class="delete-thread">\n        ',profile.id===author.id&&(__p+="\n\n        ","strategy"===meta.type&&(__p+='\n            <a href="#" class="delete">删除策略</a>\n        '),__p+="\n        ","research"===meta.type&&(__p+='\n            <a href="#" class="delete">删除研究</a>\n        '),__p+="\n        ","discuss"===meta.type&&(__p+='\n            <a href="community/share/edit/'+(null==(__t=id)?"":__t)+'" data-href="community/share/edit/'+(null==(__t=id)?"":__t)+'" class="edit">编辑</a>\n        '),__p+="\n        "),__p+="\n    </div>\n    "),__p+='\n\n    <div class="comments">\n        <div class="comments-header">\n            <span class="comments-count">'+__e(meta.comment_no)+'</span> 条评论\n            <div class="actions"></div>\n        </div>\n        <div class="list"></div>\n        <div class="reply clearfix">\n            ',anonymous||(__p+='\n            <div class="user">\n                <span class="name">'+__e(profile.profile.nickname)+"</span>",profile.profile.title&&(__p+='\n                <span class="signature">'+__e(profile.profile.title)+"</span>\n                "),__p+="\n            </div>\n            "),__p+='\n            <div class="form-group">\n                <div class="comment-input"></div>\n                <div class="help-block error-msg"></div>\n            </div>\n\n            <button class="submit btn btn-primary pull-right">发表评论</button>\n\n        </div>\n    </div>\n\n</div>\n<div class="sideBar">\n\n    <div class="cmBlock">\n        <div class="top">\n            <img src="'+(null==(__t=author.profile.avatar)?"":__t)+'" alt="">\n            '+(null==(__t=_T.partial("simpleUser",author))?"":__t)+'\n            <a class="follow-user follow-action" href="#"><span class="text">关注</span></a>\n            <a href="" class="follow-user followed-action">取消关注</a>\n            <p>'+__e(author.profile.introduction)+'</p>\n        </div>\n\n        <div class="bd achieve clearfix">\n            <a><i class="fa fa-thumbs-o-up"></i><span class="thread-up"></span>赞</a>\n            <a><i class="fa fa-heart-o"></i><span class="comment-up"></span>感谢</a>\n        </div>\n\n        <div class="bd honors">\n            <!-- <div class="status honors">\n            </div> -->\n        </div>\n\n        <div class="bd userThreads">\n        </div>\n    </div><!-- end cmBlock -->\n\n\n    <div class="cmBlock mTop">\n        <div class="top">\n            <h3>热门分享</h3>\n        </div>\n\n        <div class="bd hotThreads">\n        </div>\n    </div><!-- end cmBlock -->\n\n</div>\n\n<div class="overlay"></div>\n<div class="pop-up">\n    <div  class="close-div">\n    <!-- <span class="close" data-dismiss="modal">&times;</span> -->\n        <!-- <a href="" class="close-code">x</a> -->\n        <span class="close close-code" data-dismiss="modal">×</span>\n    </div>\n    <div class="pop-code"></div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(47),n(89),n(190),n(202)],r=function(e,t,n,i,r){return e.ItemView.extend({className:"create-share",template:r,events:{"click .submit":"clickSubmit","click .preview":"clickPreview","submit form":"submitForm","keyup .share-title":"keyupShareTitle"},ui:{title:".share-title",preview:".preview-wrapper",form:".form"},initialize:function(){t.vent.trigger("title","发表讨论")},onRender:function(){var e=this;this.markdownEditor=new i({placeholder:"支持Markdown语法"}),this.$el.find(".share-content").append(this.markdownEditor.render().el),this.markdownEditor.triggerMethod("show"),this.markdownEditor.editor.on("changes",function(){e.markdownEditor.getValue()&&e.clearError(e.$el.find(".share-content-wrapper"))}),this.markdownEditor.addTool({name:"preview",icon:"eye",title:"预览"})},fieldError:function(e,t){e.addClass("has-error"),e.find(".error-msg").text(t)},clearError:function(e){e.removeClass("has-error")},clickSubmit:function(e){var n,i,r=$(e.currentTarget);return n=this.$el.find(".share-title"),n.val()?n.val().length>100?void this.fieldError(n.parent(),"标题长度不能超过100个字符"):(i=this.markdownEditor.getValue())?i.length<8||i.length>2e4?void this.fieldError(this.$el.find(".share-content-wrapper"),"内容不能少于8个字符或多于20000个字符"):(r.button("loading"),$.ajax({url:window.getapi("mercury_community","/thread"),type:"POST",contentType:"application/json",data:JSON.stringify({title:n.val(),content:i})}).always(function(){r.button("reset")}).done(function(e){200===e.code&&t.Route.navigate("community/share/"+e.data.id,{trigger:!0})}),void e.preventDefault()):void this.fieldError(this.$el.find(".share-content-wrapper"),"内容不能为空"):void this.fieldError(n.parent(),"标题不能为空")},keyupShareTitle:function(e){var t=this.ui.title.val();t&&t.length<=100&&this.clearError(this.ui.title.parent())},clickPreview:function(e){var t=this,i=this.markdownEditor.$el.find(".CodeMirror"),r={height:i.height()-2,width:i.width()-2};i.offset();return this.previewShowed?(this.markdownEditor.$el.find(".tool:not(.preview)").removeClass("disabled"),this.markdownEditor.$el.find(".preview").attr("title","预览").find(".fa").addClass("fa-eye").removeClass("fa-eye-slash"),void this.ui.preview.velocity({translateX:"100%"},{duration:250,complete:function(){t.ui.preview.hide(),t.previewShowed=!1}})):(this.md||(this.md=new n({breaks:!0}),this.md.Init({preview:this.ui.preview.find(".content")[0],buffer:this.ui.preview.find(".buffer")[0],getText:function(){return t.markdownEditor.getValue()},emptyText:""})),this.markdownEditor.$el.find(".tool:not(.preview)").addClass("disabled"),this.markdownEditor.$el.find(".preview").attr("title","取消预览").find(".fa").removeClass("fa-eye").addClass("fa-eye-slash"),this.ui.preview.width(r.width).height(r.height).show().velocity({translateX:"100%"},{duration:0}).velocity({translateX:0},{duration:250,complete:function(){t.previewShowed=!0}}),this.md.Update(),void e.preventDefault())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<form class="form">\n    <div class="form-group">\n        <input class="form-control share-title" name="shareTitle" type="text" placeholder="请写下你的问题或想法">\n        <div class="help-block error-msg"></div>\n    </div>\n    <div class="form-group share-content-wrapper">\n        <div class="share-content"></div>\n        <div class="preview-wrapper">\n            <div class="content"></div>\n            <div class="buffer"></div>\n        </div>\n        <div class="help-block error-msg"></div>\n    </div>\n</form>\n<div class="btns">\n    <a class="btn btn-link cancel" href="community/" data-href="community/">取消</a>\n    <button class="btn btn-primary submit" data-loading-text="请稍候...">发布</button>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(48),n(47),n(116),n(84),n(204),n(103)],r=function(e,t,n,i,r,o,a,s){var l=300,c=200,u=1024,d=20;return t.LayoutView.extend({className:"edview clearfix",template:a,events:{"click .slides":"clickSwitch","click .submit":"clickSubmit","click .movebar":"clickMoveBar"},initialize:function(e){this.model=new(s.extend({url:window.getapi("mercury_community","/user/"+e.id)})),this.model.set({quantity:0,currentStatus:"init"})},serializeData:function(){var e=this.model.toJSON();return e.userUrl=new s({id:this.model.get("id")}).appUrl(),e},render:function(){var e=this;this.model.fetch({data:{field:"pointresourceorder"}}).done(function(n){return 200!==n.code?void i.Route.notFound():void t.LayoutView.prototype.render.apply(e)}).fail(function(e){404===e.status&&i.Route.notFound()})},onRender:function(){var e=this,t=this.$(".drag-bar"),n=this.$(".drag-container"),i=this.$(".choose"),r=0,o=0,a=this.model.get("resource_basic.ipython_memory.value"),s=this.model.get("resource.ipython_memory.value");this.$el.find(".basciMem").text(this.formatVal(a,!0)),this.$el.find(".exchangeInfo").hide(),this.initDom(a,s),this.$el.find(".available-points").text(this.model.get("point.available_points")),t.css("position","absolute"),t.draggable({containment:"parent",axis:"x",drag:function(){r=t.position().left-85,n.css("width",r);var e=0;o=parseInt(r/i.width()*100),12>o?e="0":37>o?e="1G":62>o?e="2G":87>o?e="3G":100>o&&(e="4G"),n.text(e)},stop:function(){o=parseInt(r/i.width()*100),12>o?(n.css("width",0),e.changeDom(0)):37>o?(n.css("width","25%"),r="1G",e.changeDom(1)):62>o?(n.css("width","50%"),r="2G",e.changeDom(2)):87>o?(n.css("width","75%"),r="3G",e.changeDom(3)):100>o&&(n.css("width",i.width()-20),r="4G",e.changeDom(4)),t.css("left",n.width()+85),n.text(r)}})},initDom:function(e,t){var n=this.formatVal(t-e),i=n*l;n=n>4?4:n,this.$el.find(".action .num").text(this.formatVal(t,!0)),this.$el.find(".action-points .info").hide(),this.$el.find(".auto-desc").hide(),this.$el.find(".final-points .plus .info").hide(),this.$el.find(".final-points .minus").hide(),this.$el.find(".final-points .plus .op").html(this.formatVal(this.model.get("resource.ipython_memory.value"),!0)),this.$(".drag-container").css("width",25*n+"%"),this.$(".drag-container").text(n+"G"),this.switchStatus(this.model.get("order.auto_renew")),t>e&&(this.model.set({currentStatus:"add"}),this.$el.find(".auto-points").text(i),this.$el.find(".action-points .unchange").show(),this.model.get("order.auto_renew")&&(this.$el.find(".openBtn .init").hide(),this.$el.find(".auto-desc").show()))},changeDom:function(e){var t=this.model.get("resource_basic.ipython_memory.value"),n=this.model.get("resource.ipython_memory.value"),i=e*u+t,r=this.formatVal(i-n),a=l,s=(this.model.get("order.auto_renew"),this.formatVal(i,!0));this.model.get("order.remain_days")<d&&(a=c),this.$(".action-points .info").hide(),this.$el.find(".final-points .plus").hide(),this.$el.find(".final-points .minus").hide(),4===e&&this.$(".origin .drag-container").css("width","100%"),this.model.set({changeVal:r}),r>0?(this.$el.find(".final-points .plus").show(),this.$el.find(".action-points .op").html(r*a),this.$el.find(".final-points .plus .op").html(s),this.$el.find(".final-points .plus .info").show(),n>t&&this.$(".action-points .plus").show(),this.$(".exchangeInfo .num").text(s),this.$el.find(".auto-points").text(this.formatVal(n-t)*l)):0===r?(this.$el.find(".final-points .plus").show(),this.$el.find(".action-points .op").html(0),this.$el.find(".final-points .plus .op").html(s),n>t&&this.$(".action-points .unchange").show(),this.$el.find(".auto-points").text(this.formatVal(n-t)*l)):(this.model.set({currentStatus:"reduce"}),this.$el.find(".action-points .op").html(0),this.$el.find(".expire-time").text(o.formatDate(this.model.get("resource.ipython_memory.expire_time"))),this.$el.find(".begin-time").text(o.addDay(this.model.get("resource.ipython_memory.expire_time"),1)),n>t&&this.$(".action-points .minus").show(),this.$el.find(".final-points .minus").show(),this.$(".origin-point").html(this.formatVal(n,!0)),this.$(".minus-point").html(s),this.$(".exchangeInfo .origin .num").text(this.formatVal(n,!0)),this.$(".exchangeInfo .reduce .num").text(s),this.$(".reduce .drag-container").text(s+"G"),this.$el.find(".auto-points").text(this.formatVal(i-t)*l),this.model.get("order.auto_renew")?this.$el.find(".final-points .isAutoOpen").show():this.$el.find(".final-points .isAutoOpen").hide()),this.$el.find(".auto-desc").show(),this.$el.find(".init").hide(),n-t===0&&this.$el.find(".auto-points").text(r*l),this.$el.find(".action .num").text(s),0>r?this.model.set({quantity:e}):this.model.set({quantity:r})},formatVal:function(e,t){return t?Number(e/u).toFixed(2)+"G":e/u},clickSwitch:function(e){var t=this.model.get("order.auto_renew");t=!t,this.switchStatus(t),this.model.set({"order.auto_renew":t}),e.preventDefault()},switchStatus:function(e){this.$el.find(".openBtn").hide(),this.$el.find(".closeBtn").hide(),e?(this.$el.find(".slides").addClass("open"),this.$el.find(".openBtn").show(),this.model.get("changeVal")<0&&this.$el.find(".final-points .isAutoOpen").show()):(this.$el.find(".slides").removeClass("open"),this.$el.find(".closeBtn").show(),this.$el.find(".final-points .isAutoOpen").hide())},clickSubmit:function(e){var t=this,n=($(e.currentTarget),{quantity:this.model.get("quantity"),auto_renew:this.model.get("order.auto_renew"),name:"1G iPython Memory",resource_type:"ipython_memory",spec:"1G",status:"reduce"===this.model.get("currentStatus")?"pending":"active"});this.model.orderPoints(n,"POST").done(function(e){t.$el.find(".infoTip").hide(),t.$el.find(".exchange-detail").hide(),t.$el.find(".exchangeInfo").show(),t.$el.find(".result-link").hide(),t.$el.find(".reduce").hide();var n=0,i="",r="";if(200===e.code){if(n=e.data.order.points,"init"===t.model.get("currentStatus"))t.$el.find(".success").show(),i="兑换成功",t.$el.find(".success .point").text(e.data.order.points),t.$el.find(".result-link .success").show(),t.$el.find(".available-points").text(t.model.get("point.available_points")-n);else if("add"===t.model.get("currentStatus"))i="兑换成功",t.$el.find(".success").show(),t.$el.find(".success .point").text(e.data.order.points),t.$el.find(".result-link .add").show(),t.$el.find(".available-points").text(t.model.get("point.available_points")-n);else if("reduce"===t.model.get("currentStatus")){t.$el.find(".reduce").show(),i="减内存成功";var a=t.model.get("resource_basic.ipython_memory.value"),s=t.model.get("resource.ipython_memory.value"),l=t.formatVal(s-a);t.$(".origin .drag-container").css("width",25*l+"%"),t.$(".origin .drag-container").text(l+"G")}t.$el.find(".end-time").text(o.formatDate(e.data.order.expire_time))}else i="兑换失败",r="积分不足，兑换失败",552===e.code&&(r="内存已超过使用最大值"),t.$(".submit-failed").text(r),t.$el.find(".failed").show(),t.$el.find(".result-link .failed").show();t.$el.find(".result").text(i)}),e.preventDefault()},clickMoveBar:function(e){var t=this,n=this.$(".drag-bar"),i=this.$(".drag-container"),r=this.$(".choose"),o=0,a=0;a=parseInt(e.offsetX/r.width()*100),12>a?(i.css("width",0),t.changeDom(0)):37>a?(i.css("width","25%"),o="1G",t.changeDom(1)):62>a?(i.css("width","50%"),o="2G",t.changeDom(2)):87>a?(i.css("width","75%"),o="3G",t.changeDom(3)):100>a&&(i.css("width",r.width()-20),o="4G",t.changeDom(4)),n.css("left",i.width()+85),i.text(o),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="community-mall">\n    <div class="mall-header clearfix">\n        <a href="community/mall" data-href="community/mall">\n        <img src="img/mall/cart.png" alt="">\n        <div class="fc">\n            <span>优矿积分商城</span>\n        </div>\n        </a>\n        <div class="header-right">\n            <span class="fcm">\n            <a href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'">'+(null==(__t=profile.nickname)?"":__t)+'</a>\n            </span>，您当前的积分为  <a href="community/exchange" data-href="community/exchange"><span class="available-points"></span></a>\n            <a class="back-user" href="'+(null==(__t=userUrl)?"":__t)+'" data-href="'+(null==(__t=userUrl)?"":__t)+'">返回个人主页</a>\n        </div>\n    </div>\n    <div class="exchange-detail">\n        <p>\n            <a href="community/mall" data-href="community/mall">积分商城</a>&nbsp;&gt;&nbsp;研究环境内存\n        </p>\n        <div class="detail clearfix">\n            <div class="introduce">\n                <div class="top">\n                    <div class="title">\n                        研究环境<br/>内存\n                    </div>\n                    <p>300积分起</p>\n                </div>\n                <div class="desc">\n                    <p>商品描述：</p>\n                    <br>\n                    开始研究环境中策略运行可使用的虚拟机分配的内存上限。<br>\n内存越大，研究时涵盖的股票池可以更大，回测周期可以更长。<br><br>\n例如：一个涉及全A股过去2年数据的策略，可能需要2G的内存。\n                </div>\n            </div>\n\n            <div class="action">\n                <div class="progress-div top clearfix">\n                    <span class="title">拖动选中内存：</span>\n\n                    <div class="selectBar">\n                        <div class="process-line">\n                            <div class="line">\n                                <span class="basciMem"></span>\n                                <div class="choose">\n                                    <p class="drag-container">\n                                    </p>\n                                    <div class="progress-gap movebar">\n                                        <a>|</a>\n                                        <a>|</a>\n                                        <a>|</a>\n                                    </div>\n                                    <p class="drag-bar"></p>\n                                </div>\n                                \n                            </div>\n                        </div>\n                    </div>\n                    <span class="num"></span>\n\n                </div>\n\n                <div class="progress-div line-sign clearfix">\n                    <ul class="sign">\n                        <li><br/>基础内存</li>\n                        <li class="gap-first">＋1G<br/>300积分/月</li>\n                        <li class="gap-sec">＋2G<br/>600积分/月</li>\n                        <li class="gap-third">＋3G<br/>900积分/月</li>\n                        <li class="gap-fourth">＋4G<br/>1200积分/月</li>\n                    </ul>\n                </div>\n\n                <div class="progress-div clearfix action-points">\n                    <span class="title">兑换时扣除积分：</span>\n                    <div class="progress-bd">\n                        <div class="clearfix">\n                            <div class="op">0</div>\n                            <div class="info minus"><span>减少内存时不扣积分，下月生效</span></div>\n                            <div class="info unchange"><span>内存不变时不扣积分</span></div>\n                            <div class="info plus"><span>补扣当月不足的积分</span></div>\n                        </div>\n                    </div>\n                </div>\n\n\n                <div class="progress-div clearfix ">\n                    <span class="title">是否自动续订：</span>\n                    <div class="progress-bd">\n                        <div class="clearfix">\n                            <div class="op">\n                                <div class="slides open">\n                                    <i></i>\n                                </div>\n                            </div>\n                            <div class="info openBtn">打开\n                                <span class="auto-desc">（下月起每月扣除<span class="auto-points"></span>积分）</span>\n                                <span class="init">(每月自动扣除积分)</span>\n                            </div>\n                            <div class="info closeBtn">\n                                关闭 <span class="closeInfo">（关闭状态下，到期后内存自动恢复初始值）</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="progress-div clearfix final-points">\n                    <span class="title">兑换后可用内存：</span>\n                    <div class="progress-bd">\n                        <div class="clearfix minus">\n                            <div class="op origin-point"></div>\n                            <div class="info"><span class="expire-time"></span>失效</div>\n                        </div>\n                        <div class="clearfix minus isAutoOpen">\n                            <div class="op minus-point"></div>\n                            <div class="info"><span class="begin-time"></span>生效</div>\n                        </div>\n                        <div class="clearfix plus">\n                            <div class="op"></div>\n                            <div class="info">立即生效</div>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="opBtn">\n                    <a href="" class="btnLink submit">立即兑换</a>\n                </div>\n\n            </div>\n        </div>\n    </div>\n    \n\n    <div class="exchangeInfo">\n        <p>\n            <a href="community/mall" data-href="community/mall">积分商城</a>&nbsp;&gt;&nbsp;<span class="result"></span>\n        </p>\n        \n        <div class="infoTip success">\n        <img src="img/mall/suc.png" alt="" align="absmiddle">兑换成功，扣除<span class="point"></span>积分，到期日期为<span class="end-time"></span>\n        </div>\n        <div class="infoTip add">\n        <img src="img/mall/suc.png" alt="" align="absmiddle">增加成功，扣除<span class="point"></span>积分，到期日期为<span class="end-time"></span>\n        </div>\n        <div class="infoTip failed">\n        <img src="img/mall/fail.png" alt="" align="absmiddle"><span class="submit-failed"></span>\n        </div>\n        <div class="infoTip reduce">\n        <img src="img/mall/suc.png" alt="" align="absmiddle">减少内存成功，扣除0积分，\n            <span class="begin-time"></span>日生效\n        </div>\n        \n        <div class="progress-div clearfix origin">\n            <span class="title">当前可用内存：</span>\n\n            <div class="selectBar">\n                <div class="process-line">\n                    <div class="line">\n                        <span class="basciMem"></span>\n                        <div class="choose">\n                            <p class="drag-container">\n                            </p>\n                        </div>\n                        \n                    </div>\n                </div>\n            </div>\n            <span class="num"></span>\n\n        </div>\n\n        <div class="progress-div clearfix reduce">\n            <span class="title">下月可用内存：</span>\n\n            <div class="selectBar">\n                <div class="process-line">\n                    <div class="line">\n                        <span class="basciMem"></span>\n                        <div class="choose">\n                            <p class="drag-container">\n                            </p>\n                        </div>\n                        \n                    </div>\n                </div>\n            </div>\n            <span class="num"></span>\n\n        </div>\n\n        <div class="result-link success">  \n            <a href="labs/" data-href="labs/">&lt;&nbsp;点击返回开始研究</a>\n        </div>  \n\n        <div class="result-link failed">  \n            <a href="help/faq/#积分FAQ" data-href="help/faq/#积分FAQ">积分常见问题？</a>\n        </div>  \n    </div>\n</div>\n\n';
return __p}},function(e,t,n){var i,r;i=[n(49),n(47),n(116),n(46),n(115),n(89),n(190),n(133),n(206)],r=function(e,t,n,i,r,o,a,s,l){return e.ItemView.extend({className:"create-share",template:l,events:{"click .submit":"clickSubmit","click .preview":"clickPreview","submit form":"submitForm","keyup .share-title":"keyupShareTitle","click .delete":"clickDelete"},ui:{title:".share-title",preview:".preview-wrapper",form:".form"},initialize:function(e){t.vent.trigger("title","编辑问答"),this.model=new s({id:e.id})},render:function(){if(i.anonymous)return void t.Route.notFound();var r=this,o=n.get("profile");return $.when(o.deferred,this.model.fetch()).done(function(n,i){return i[0]&&702===i[0].code?void t.Route.notFound():(e.ItemView.prototype.render.apply(r,arguments),o.get("id")!==r.model.get("author.id")?void t.Route.notFound():void 0)}).fail(function(e,n){return e&&n&&404!==n.status&&404!==e.status?void 0:void t.Route.notFound()}),this.profile=o,this},serializeData:function(){var e={};return e=_.extend(this.model.toJSON(),e),e.isNotEditTitle=this.model.get("meta.follow_count")>10||this.model.get("meta.collect_count")>10||this.model.get("comment_count")>10,this.model.set({isNotEditTitle:e.isNotEditTitle}),e},onRender:function(){var e=this;this.markdownEditor=new a({placeholder:"支持Markdown语法"}),this.$el.find(".share-content").append(this.markdownEditor.render().el),this.markdownEditor.triggerMethod("show"),this.markdownEditor.editor.on("changes",function(){e.markdownEditor.getValue()&&e.clearError(e.$el.find(".share-content-wrapper"))}),this.markdownEditor.addTool({name:"preview",icon:"eye",title:"预览"}),this.markdownEditor.setValue(this.model.get("content"))},fieldError:function(e,t){e.addClass("has-error"),e.find(".error-msg").text(t)},clearError:function(e){e.removeClass("has-error")},clickSubmit:function(e){var n,i,r,o=this,a=$(e.currentTarget);if(this.model.get("isNotEditTitle"))r=n=this.model.get("title");else{if(n=this.$el.find(".share-title"),!n.val())return void this.fieldError(n.parent(),"标题不能为空");if(n.val().length>100)return void this.fieldError(n.parent(),"标题长度不能超过100个字符");r=n.val()}return(i=this.markdownEditor.getValue())?i.length<8||i.length>2e4?void this.fieldError(this.$el.find(".share-content-wrapper"),"内容不能少于8个字符或多于20000个字符"):(a.button("loading"),$.ajax({url:window.getapi("mercury_community","/thread/"+this.model.get("id")),type:"PUT",contentType:"application/json",data:JSON.stringify({title:r,content:i})}).always(function(){a.button("reset")}).done(function(e){200===e.code&&t.Route.navigate("community/share/"+o.model.get("id"),{trigger:!0})}),void e.preventDefault()):void this.fieldError(this.$el.find(".share-content-wrapper"),"内容不能为空")},keyupShareTitle:function(e){var t=this.ui.title.val();t&&t.length<=100&&this.clearError(this.ui.title.parent())},clickPreview:function(e){var t=this,n=this.markdownEditor.$el.find(".CodeMirror"),i={height:n.height()-2,width:n.width()-2};n.offset();return this.previewShowed?(this.markdownEditor.$el.find(".tool:not(.preview)").removeClass("disabled"),this.markdownEditor.$el.find(".preview").attr("title","预览").find(".fa").addClass("fa-eye").removeClass("fa-eye-slash"),void this.ui.preview.velocity({translateX:"100%"},{duration:250,complete:function(){t.ui.preview.hide(),t.previewShowed=!1}})):(this.md||(this.md=new o({breaks:!0}),this.md.Init({preview:this.ui.preview.find(".content")[0],buffer:this.ui.preview.find(".buffer")[0],getText:function(){return t.markdownEditor.getValue()},emptyText:""})),this.markdownEditor.$el.find(".tool:not(.preview)").addClass("disabled"),this.markdownEditor.$el.find(".preview").attr("title","取消预览").find(".fa").removeClass("fa-eye").addClass("fa-eye-slash"),this.ui.preview.width(i.width).height(i.height).show().velocity({translateX:"100%"},{duration:0}).velocity({translateX:0},{duration:250,complete:function(){t.previewShowed=!0}}),this.md.Update(),void e.preventDefault())},clickDelete:function(e){var t=this,n=r.Confirm({title:"操作确认",content:"确定删除此问答?",yes:function(){$.when(t.model.deleteModel()).done(function(){Backbone.history.navigate("community",{trigger:!0})})}});n.$el.on("hidden.bs.modal",function(){n.destroy()}),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<form class="form">\n    <div class="form-group clearfix">\n        <div class="form-title">\n            ',__p+=isNotEditTitle?"\n            <h4>"+__e(title)+"</h4>\n            ":'\n            <input class="form-control share-title" name="shareTitle" type="text" placeholder="请写下你的问题或想法" value="'+__e(title)+'">\n            ',__p+='\n            <div class="help-block error-msg"></div>\n        </div>\n        <a class="btn btn-link delete">删除</a>\n    </div>\n    <div class="form-group share-content-wrapper">\n        <div class="share-content"></div>\n        <div class="preview-wrapper">\n            <div class="content"></div>\n            <div class="buffer"></div>\n        </div>\n        <div class="help-block error-msg"></div>\n    </div>\n</form>\n<div class="btns">\n    <a class="btn btn-link cancel" href="community/" data-href="community/">取消</a>\n    <button class="btn btn-primary submit" data-loading-text="请稍候...">保存</button>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(48),n(208)],r=function(e,t,n,i){return t.LayoutView.extend({className:"email-view clearfix",template:i,events:{"click .btn":"clickSubmit","click #view":"changeCheckbox"},initialize:function(e){console.log(e.id),this.type=e.type,this.userId=e.id,this.subscribe=e.subscribe,this.thread_id=e.thread_id,this.title=e.title,this.followee_id=e.followee_id,this.nickname=e.nickname},onRender:function(){this.$(".discuss").hide(),this.$(".user").hide(),this.$(".result").hide(),"thread_follow"===this.subscribe?(this.$(".discuss").show(),this.$(".discuss .text").text(this.title)):"user_follow"===this.subscribe&&(this.$(".user").show(),this.$(".user .text").text(this.nickname))},clickSubmit:function(e){var t=this,n=($(e.currentTarget),{op_type:this.type,subscribe_type:this.subscribe,user_id:this.id});"thread_follow"===this.subscribe?n.thread_id=this.thread_id:"user_follow"===this.subscribe&&(n.followee_id=this.followee_id),$.ajax({url:window.getapi("mercury_community","/w/user/"+this.id+"/subscribes"),type:"PUT",contentType:"application/json",data:JSON.stringify(n)}).done(function(e){t.$(".result").show(),t.$(".infoTip").hide(),t.$(".email-main").hide(),200===e.code?t.$(".success").show():t.$(".failed").show()}),e.preventDefault()},changeCheckbox:function(e){this.$("#view").is(":checked")?this.$(".btn").removeClass("disabled"):this.$(".btn").addClass("disabled")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="email-main">\n    <p class="title">邮件订阅设置</p>\n\n    <div class="content">\n        <p class="discuss">对关注的问答『<span class="text"></span>』的邮件提醒</p>\n        <p class="user">对关注的人『<span class="text"></span>』的邮件提醒</p>\n\n        <div class="checkbox">\n            <label>\n              <input type="checkbox" checked id="view"> 取消该信息的更新提醒\n            </label>\n        </div>\n        <div class="opBtn">\n            <!-- <a href="" class="btnLink submit">保存</a> -->\n            <a href="#" class="btn btn-primary" role="button">保存</a>\n        </div>\n    </div>\n</div>\n<div class="result">\n    <div class="infoTip success">\n    <img src="img/mall/suc.png" alt="" align="absmiddle">退订成功\n    </div>\n    <div class="infoTip failed">\n    <img src="img/mall/fail.png" alt="" align="absmiddle">退订失败\n    </div>\n    <div class="result-link success">\n        <a href="community/" data-href="community/">&lt;&nbsp;点击返回社区首页</a>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(48),n(47),n(116),n(84),n(210),n(46),n(129)],r=function(e,t,n,i,r,o,a,s,l){return t.LayoutView.extend({className:"user-detail clearfix",template:"<div></div>",initialize:function(e){t.LayoutView.prototype.initialize.apply(this,arguments),this.currentTab=e.tab;return s.anonymous?void s.loginWithModal({appRoot:window.getApp("cloud-portal","")}):void 0},onRender:function(){var e=this;r.get("profile").deferred.done(function(){e.$el.append(new a({tab:e.currentTab}).render().el)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(48),n(47),n(116),n(84),n(211),n(212),n(213),n(103),n(46)],r=function(e,t,n,i,r,o,a,s,l,c,u){return t.LayoutView.extend({className:"user-detail clearfix",template:a,events:{"click .mall-tab ul a":"changeView","click .closeAuto":"clickClose","click .openAuto":"clickOpen"},initialize:function(e){t.LayoutView.prototype.initialize.apply(this,arguments),this.currentTab=e.tab;var i=r.get("profile"),o=n.Collection.extend({url:window.getapi("mercury_community","/user/"+i.get("id")+"/orders"),parse:function(e){return e.data||[]}});this.orders=new o,this.user=new(c.extend({url:window.getapi("mercury_community","/user/"+i.get("id"))}))},onRender:function(){var e=this;this.user.fetch({data:{field:"pointresourceorder"}}).done(function(t){return 200!==t.code?void i.Route.notFound():void e._render()}).fail(function(e){404===e.status&&i.Route.notFound()})},_render:function(){var e=this,t=new c({id:this.user.get("id")}).appUrl();this.$(".back-user,user-link").attr("href",t),this.$(".back-user,.user-link").attr("data-href",t),this.$(".user-link").html(this.user.get("profile.nickname")),this.$(".available-points").html(this.user.get("point.available_points")),"mall"===this.currentTab?(this.setMallView(),this.$el.find(".mall").addClass("active")):"exchange"===this.currentTab&&(this.fetchRecord(),this.$el.find(".exchange").addClass("active")),this.listenTo(this.orders,"reset",function(){e.renderPoints()})},fetchRecord:function(){this.orders.fetch({reset:!0})},renderPoints:function(){var t=this.orders.toJSON(),n={};e.map(t,function(t){n=e.each(t.orders,function(t){var n=e.extend(t,n);return n.time=o.format(t.order_time),n})}),this.$el.find(".mall-content").empty().append(l({list:n}))},changeView:function(e){e.preventDefault();var t=$(e.currentTarget),n=t.attr("href");n=n.substring(1,n.length),"mall"===n&&n!==this.currentTab?this.setMallView():"exchange"===n&&n!==this.currentTab&&this.fetchRecord(),this.currentTab=n,i.Route.navigate("/community/"+n,{trigger:!0})},setMallView:function(e){var t=o.formatDate(this.user.get("resource.ipython_memory.expire_time")),n=this.user.get("resource.ipython_memory.value")-this.user.get("resource_basic.ipython_memory.value"),i=this.user.get("order.auto_renew"),r=Number(n)>0;n=Number(n/1024)+"G",this.$el.find(".mall-content").empty().append(s({time:t,value:n,isOrder:r,exchangeUrl:"community/exchangeDetail/"+this.user.get("id")})),this.$el.find(".product .openP").hide(),this.$el.find(".product .closeP").hide(),i&&r?this.$el.find(".product .openP").show():r&&this.$el.find(".product .closeP").show()},putModel:function(e){var t=this;this.user.orderPoints({auto_renew:e},"PUT").done(function(e){200===e.code&&(t.user.set({"order.auto_renew":e.data.auto_renew}),t.$el.find(".product .openP").hide(),t.$el.find(".product .closeP").hide(),e.data.auto_renew?t.$el.find(".product .openP").show():t.$el.find(".product .closeP").show())})},clickClose:function(e){this.putModel(!1),e.preventDefault()},clickOpen:function(e){this.putModel(!0),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="community-mall">\n    <div class="mall-header clearfix">\n        <a href="community/mall" data-href="community/mall">\n        <img src="img/mall/cart.png" alt="">\n        <div class="fc">\n            <span>优矿积分商城</span>\n        </div>\n        </a>\n        <div class="header-right">\n            <span class="fcm">\n            <a href="" data-href="" class="user-link"></a>\n            </span>，您当前的积分为  <a href="community/exchange" data-href="community/exchange"><span class="available-points"></span></a>\n            <a class="back-user" href="" data-href="">返回个人主页</a>\n        </div>\n    </div>\n    <div class="mall-tab">\n        <ul>\n            <li>\n                <a href="#mall" class="mall">积分商城</a>\n            </li>\n            <li>\n                <a href="#exchange" class="exchange">兑换记录</a>\n            </li>\n        </ul>\n        <div class="mall-content clearfix"></div>\n    </div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="product">\n    <div class="inner">\n        <div class="title">\n            研究环境<br/>内存\n        </div>\n        <div class="endline">\n        ',isOrder&&(__p+="\n                正在使用 <span>"+(null==(__t=value)?"":__t)+"</span> 兑换内存<br/>"+(null==(__t=time)?"":__t)+" 到期\n        "),__p+='\n        </div>   \n        <a href="'+(null==(__t=exchangeUrl)?"":__t)+'" data-href="'+(null==(__t=exchangeUrl)?"":__t)+'" class="btnLink">立即兑换</a>\n            <p class="tips openP">已开通自动续订，<a href="" class="closeAuto">点击关闭</a></p>\n            <p class="tips closeP">未开通自动续订，<a href="" class="openAuto">点击开通</a></p>\n    </div>\n</div>\n\n<div class="product">\n    <div class="inner more">\n        <p>更多商品<br/>敬请期待</p>\n    </div>\n</div>';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<table class="table table-bordered table-striped">\n    <thead>\n        <tr>\n            <th>兑换日期</th>\n            <th>兑换商品</th>\n            <th>兑换个数</th>\n            <th>消耗积分</th>\n            <th>状态</th>\n        </tr>\n    </thead>\n    <tbody>\n        ',_.each(list,function(e,t){__p+="\n        <tr>\n            <td>"+(null==(__t=e.time)?"":__t)+"</td>\n            <td>"+(null==(__t=e.name)?"":__t)+"</td>\n            <td>"+(null==(__t=e.quantity)?"":__t)+"</td>\n            <td>"+(null==(__t=e.points)?"":__t)+"</td>\n            <td>"+(null==(__t="failed"==e.status?"兑换失败":"兑换成功")?"":__t)+"</td>\n            \n        </tr>\n        "}),__p+="\n    </tbody>\n</table>\n";return __p}},function(e,t,n){var i,r;i=[n(215),n(217),n(219),n(223),n(229),n(231)],r=function(e,t,n,i,r,o){return{Layout:e,HomeView:t,RankView:n,HistoryView:i,GuideView:r,RankPKView:o}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(67),n(47),n(216)],r=function(e,t,n,i){return e.LayoutView.extend({className:"contest",name:"contest",template:i,ui:{tabs:".nav-tabs"},regions:{main:".region-content"},onRender:function(){n.vent.trigger("title:module","量化投资策略大赛"),n.vent.trigger("title","首页"),new t({appendTo:this.el,appName:n.name,appVersion:n.version,links:!1})},focusTab:function(e){this.ui.tabs.find(".tab-"+e).parent().addClass("active").siblings().removeClass("active")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div id="contest-carousel" class="carousel slide" data-ride="carousel">\n    <!-- <ol class="carousel-indicators">\n    <li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>\n    <li data-target="#carousel-example-generic" data-slide-to="1"></li>\n    <li data-target="#carousel-example-generic" data-slide-to="2"></li>\n    </ol> -->\n\n    <div class="carousel-inner" role="listbox">\n        <div class="item active slide1">\n            <img src="img/contest/slide1.jpg">\n        </div>\n    </div>\n\n    <a class="left carousel-control" href="#contest-carousel" role="button" data-slide="prev">\n        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>\n        <span class="sr-only">下一个</span>\n    </a>\n    <a class="right carousel-control" href="#contest-carousel" role="button" data-slide="next">\n        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\n        <span class="sr-only">上一个</span>\n    </a>\n</div>\n<div class="tabs">\n    <div class="container">\n        <ul class="nav nav-tabs">\n            <li class="active">\n                <a class="tab-home" href="contest/home" data-href="contest/home">首页</a>\n            </li>\n            <li>\n                <a class="tab-rank" href="contest/rank" data-href="contest/rank">排行榜</a>\n            </li>\n            <li>\n                <a class="tab-history" href="contest/history" data-href="contest/history">往期排行</a>\n            </li>\n            <li>\n                <a class="tab-rankPK" href="contest/newbie" data-href="contest/newbie">最佳新人奖</a>\n            </li>\n        </ul>\n    </div>\n</div>\n<div class="region-content"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(46),n(47),n(116),n(218)],r=function(e,t,n,i,r){return e.LayoutView.extend({className:"contest-home",template:r,onShow:function(){window.location.hash&&this.scrollTo(window.location.hash)},scrollTo:function(e){var t=$(".wrapper .main"),n=$(e);n[0]&&t.scrollTop(n.position().top+t.scrollTop()-40)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="contest-block">\n    <div class="container">\n        <h3>循环赛奖励</h3>\n        <ul class="awards">\n            <li class="first">\n                <span class="grade">第一名</span>\n                <span class="bonus">100万</span>\n                实盘资金一个月管理权\n            </li>\n            <li class="second">\n                <span class="grade">第二名</span>\n                <span class="bonus">50万</span>\n                实盘资金一个月管理权\n            </li>\n            <li class="third">\n                <span class="grade">第三名</span>\n                <span class="bonus">30万</span>\n                实盘资金一个月管理权\n            </li>\n            <li>\n                <span class="grade">第四名</span>\n                <span class="bonus">20万</span>\n                实盘资金一个月管理权\n            </li>\n            <li>\n                <span class="grade">第五名</span>\n                <span class="bonus">10万</span>\n                实盘资金一个月管理权\n            </li>\n            <li>\n                <span class="grade">优秀策略</span>\n                若干名，入选“优矿众包对冲基金计划”\n            </li>\n        </ul>\n        <p>\n            循环赛每期比赛单独排名，所有获奖策略共享“优矿众包对冲基金计划”500万实盘，亏损由优矿承担，超额收益全部归参赛者。\n        </p>\n    </div>\n</div>\n<div class="contest-block schedule">\n    <div class="container">\n        <h3>循环赛日程</h3>\n    </div>\n</div>\n<div class="contest-block join">\n    <div class="container">\n        <h3>参赛方法</h3>\n        <ul class="join-step clearfix">\n            <li class="step1">\n                <div class="bg"></div>\n                <h4>策略回测</h4>\n                <p>从社区或市场数据中挖掘策略灵感</p>\n            </li>\n            <li class="step2">\n                <div class="bg"></div>\n                <h4>策略模拟盘</h4>\n                <p>在开始研究中构建策略代码，运行回测并提交参赛</p>\n            </li>\n            <li class="step3">\n                <div class="bg"></div>\n                <h4>策略实盘</h4>\n                <p>排行榜每日更新策略排名</p>\n            </li>\n        </ul>\n        <div class="join-btn">\n            <a class="contest-btn" href="contest/guide" data-href="contest/guide">立即参赛</a>\n        </div>\n    </div>\n</div>\n<div class="contest-block mentors">\n    <div class="container">\n        <h3>大赛特聘伯乐</h3>\n        <p class="mentor-intro">中国顶级投资人全程关注你的表现。只要你足够出色，不一定要等比赛结束，他们就会<strong>为你转身!</strong></p>\n        <div class="mentor-order">\n            <small>导师排名不分先后，按姓名首字母排序</small>\n        </div>\n        <ul class="mentor-list">\n            <li>\n                <div class="avatar">\n                    <img alt="刘磊导师" src="img/contest/mentor/mentor1.png">\n                </div>\n                <h6>刘磊<small>导师</small></h6>\n                <p>毕业于清华大学，哥伦比亚大学。曾就职于美国twosigma投资公司，现任青骓投资合伙人。</p>\n            </li>\n            <li>\n                <div class="avatar">\n                    <img alt="董可人" src="img/contest/mentor/mentor2.jpg">\n                </div>\n                <h6>董可人<small>导师</small></h6>\n                <p>利物浦大学计算机博士，高频交易工程师，凯纳资本技术总监。</p>\n            </li>\n            <li><div class="empty"></div></li>\n            <li><div class="empty"></div></li>\n        </ul>\n    </div>\n</div>\n<div class="contest-block explain">\n    <div class="container">\n        <h3 id="contest-requirement">策略要求</h3>\n        <p>优矿将在每一期结束后校验获奖策略是否满足参赛要求，如果不满足要求，优矿有权取消该策略的名次。参赛策略原则上满足如下要求：</p>\n        <ol>\n            <li>只允许投资于沪深两市上市的A股股票；  </li>\n            <li>不允许投资于S、ST、*ST、S*ST以及SST类上市公司股票； </li>\n            <li>不允许投资于流动性过差的股票，包括在每个交易日之前的20个交易日平均日交易量小于1000万人民币的股票（如果股票在过去20个交易日或停牌或涨跌停，通联数据将自行决定是否禁买）；</li>\n            <li>单只股票持股不得高于10%；</li>\n            <li>股票仓位在任意三个以上收盘日低于80%则不达标；</li>\n            <li>相对HS300，强制平仓线90%。</li>\n            <li>首日上市新股或复牌首日股票；</li>\n            <li>参赛策略不允许在参赛期间进行手动调仓。</li>\n        </ol>\n        <h5>特别说明：</h5>\n        <ul>\n            <li>A、大赛获奖者在进行实盘操作前，与主办方签署资金使用协议后，获得账户操作权限；</li>\n            <li>B、签署实盘资金使用协议前，主办方有权核对获奖者身份。实盘操作者需年满十八周岁，并具备独立民事责任承担能力。</li>\n        </ul>\n        <ul>\n            <li><span class="emphasis">*</span> <em>通联数据拥有对参赛策略的审核权，一旦发现抄袭，则取消该参赛者的参赛资格。</em></li>\n            <li><span class="emphasis">*</span> <em>所有参赛选手必须遵守比赛规则，比赛规则最终解释权由通联数据所有，主办方有权对规则漏洞进行修改或补充。</em></li>\n        </ul>\n        <hr>\n        <h3>参赛规则</h3>\n        <p>\n            为了保障比赛的公平公正，优矿将在策略提交参赛之后，对参赛策略中的部分参数进行统一设置，包括如起止时间（2012-8-01至2015-08-01），初始资金为100万，股票历史仓位为空，手续费标准为万八，滑点为空等内容。\n        </p>\n        <h5>循环赛计分规则：</h5>\n        <p>分别包括回测与模拟交易部分。<br>\n        策略表现以相对于沪深300全收益指数的超额收益为基准，例如：<br>\n        比赛期内，选手策略收益为20%，同时期沪深300全收益指数的收益为15%，则选手策略的超额收益即为：20% - 15% = 5%。<br>\n        以下积分计算时涉及的指标中全部使用超额收益部分进行计算。</p>\n        <p>1. 回测积分：<br>\n            参赛策略根据统一的参数设置后，由优矿统一在后台进行回测，并记录回测中的各个指标进行打分。<br>\n            使用超额收益、年化波动率、最大回撤三个指标作为评分标准。根据三个指标在所有参赛策略中的表现单独进行排名计分，再根据三个指标的排名信息计算策略的总体排名，若分数一样则以参赛时间为标准，参赛时间在前的选手排名在前。<br>\n            大赛第一期回测积分占总积分的30%，从第二期开始回测积分占总积分的10%。\n        </p>\n        <p>2. 模拟交易积分：<br>\n            提交的参赛策略根据统一的参数设置后，使用超额收益、年化波动率、最大回撤三个指标作为评分标准。根据三个指标在所有参赛策略中的表现单独进行排名计分，再根据三个指标的排名信息计算策略的总体排名，若分数一样则以参赛时间为标准，参赛时间在前的选手排名在前。<br>\n            大赛第一期模拟交易积分占总积分的70%，从第二期开始模拟交易积分占总积分的90%。<br>\n            模拟交易的积分只计算排名当期的表现，例如第一期模拟交易的积分只考虑2015年9月15日至10月22日期间的策略表现。\n        </p>\n        <h5 id="contest-fund-intro">“ 优矿众包对冲基金计划”优选策略：</h5>\n        <p>\n            1. 什么是“ 优矿众包对冲基金计划”<br>\n            优矿众包对冲基金计划是优矿网为任何有代码编程能力以及有金融想法的人，提供的实战成长平台。<br>\n            在这里您提供好想法，优矿提供好平台。<br>\n            您拥有在优矿中生产的所有策略与代码的版权。<br>\n            优矿为您的策略代码保密，只根据策略下单持仓等表现，对每个参赛策略在回测和模拟盘上的收益与风险表现进行综合评定。\n        </p>\n        <p>\n            2. 如何成为优选策略<br>\n优矿在所有参赛策略中选择5-20 个策略参加优矿众包对冲基金计划，入选的策略将分享 500 万实盘资金1个自然月的管理权。<br>\n“优矿众包对冲基金计划”将从策略的超额收益、波动率、最大回撤、换手率、回测与模拟交易的一致性、对优矿众包对冲基金策略池的附加值、策略的合理性等方面进行综合考量。<br>\n        </p>\n        <p>\n            3. 优选策略的奖励<br>\n循环赛每一期的五强获奖策略在获奖管理金额的基础上，根据优矿众包基金计划的选择标准，可能获得更多的实盘资金。<br>\n每一期循环赛，将根据策略的表现以及优矿众包基金计划的选择标准，选拔优秀策略，加入优矿众包对冲基金计划，获得一定的实盘资金。<br>\n实盘策略与模拟盘比赛策略一致，不得更改。<br>\n实盘资金管理期间，亏损部分由优矿承担，相比HS300指数的超额收益部分除国家规定税款外，全部由策略提供者获得。\n        </p>\n        <h5>退赛：</h5>\n        <ul>\n            <li>1、	参赛者主动要求退赛。</li>\n            <li>2、	参赛者违反主办方规定的交易规则。</li>\n            <li>3、	主办方认为参赛账户存在异常的。</li>\n            <li>4、	参赛策略在回测或模拟盘期间崩溃的。</li>\n        </ul>\n        <div class="join-btn">\n            <a class="contest-btn" href="contest/guide" data-href="contest/guide">立即参赛</a>\n        </div>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(220),n(221),n(222)],r=function(e,t,n,i,r,o){var a={max_loss:"达到强制平仓线",max_security_position:"单只股票持股高于10%",min_market_position:"股票仓位在收盘日低于80%"},s=function(t){return e.keys(e.pick(e.pick(t,e.keys(a)),function(e,t){return!e})).join(",")};return n.LayoutView.extend({className:"contest-rank",template:i,ui:{my:".my-ranks",all:".all-ranks",date:".contest-date",currentPeriod:".current-period",nextPeriod:".next-period"},events:{"click .season-nav a":"clickSeasonNav","mouseenter .none-score,.waiting":"enterPopover","mouseleave .none-score,.waiting":"leavePopover"},initialize:function(){var n={},i=t.Collection.extend({url:window.getapi("mercury_trade","/w/leaderboard?mine=true"),parse:function(t){return e.extend(n,e.pick(t,["period","start_date","end_date"])),t.data||[]}}),r=i.extend({url:window.getapi("mercury_trade","/w/leaderboard")});this.next=!1,this.myRanks=new i,this.allRanks=new r,this.season=n},onRender:function(){var e=this;this.listenTo(this.myRanks,"reset",function(){e.renderMyRanks()}),this.listenTo(this.allRanks,"reset",function(){e.renderAllRanks(),e.renderSeasonInfo()}),this.fetchAll()},fetchAll:function(){var e=this,t=[];return this.fetching=!0,t.push(this.myRanks.fetch({reset:!0,data:{next:e.next}})),t.push(this.allRanks.fetch({reset:!0,data:{next:e.next}})),$.when.apply($,t).done(function(){e.fetching=!1}).fail(function(){e.$el.find(".container").empty().append('<h3 class="empty-rank">排行榜正在计算中, 请稍后再试</h3>')})},renderSeasonInfo:function(){this.season.start_date&&this.season.end_date&&this.ui.date.text(this.season.start_date+" 至 "+this.season.end_date),this.season.period&&!this.next&&(this.ui.currentPeriod.text(this.season.period),this.ui.nextPeriod.text(this.season.period+1))},renderMyRanks:function(){if(this.myRanks.isEmpty())return void this.ui.my.empty();var e=this.myRanks.toJSON();this.ui.my.empty().append("<h4>我的策略</h4>").append(r({next:this.next,ranks:e,pickRequirements:s}))},renderAllRanks:function(){var t=this.allRanks.toJSON();e.isEmpty(t)?this.ui.all.empty().append("所有参赛策略正在计分中，请于正式排名开始后第三天查看排行榜。"):this.ui.all.empty().append(o({next:this.next,ranks:t}))},clickSeasonNav:function(e){if(e.preventDefault(),!this.fetching){var t=$(e.currentTarget);"#next"!==t.attr("href")||this.next?"#next"!==t.attr("href")&&this.next&&(this.next=!1,t.parent().addClass("active").siblings().removeClass("active"),this.fetchAll()):(this.next=!0,t.parent().addClass("active").siblings().removeClass("active"),this.fetchAll())}},enterPopover:function(t){var n=$(t.currentTarget);if(n.hasClass("waiting"))n.popover({content:"名次会在提交策略或正式排名开始两个交易日后产生",trigger:"manual",container:n});else{var i=n.attr("data-requirements").split(",");i=e.map(i,function(e){return a[e]}).join(", "),n.popover({content:"策略未达标, 由于"+i+', <a href="contest/home#contest-requirement" data-href="contest/home#contest-requirement">点击这里查看策略要求</a>',trigger:"manual",container:n,html:!0})}n.popover("show")},leavePopover:function(e){$(e.currentTarget).popover("hide").one("hidden.bs.popover",function(){$(e.currentTarget).popover("destroy")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="contest-block">\n    <div class="container">\n        <h3>循环赛排行</h3>\n        <div class="rank-info">\n            正式排名时间 <span class="contest-date"></span>\n            <ul class="season-nav">\n                <li class="active">\n                    <a href="#current">当期(第<span class="current-period">0</span>期)</a>\n                </li>\n                <li>\n                    <a href="#next">下期(第<span class="next-period">0</span>期)</a>\n                </li>\n            </ul>\n        </div>\n        <div class="my-ranks"></div>\n        <h4>Top 50</h4>\n        <div class="all-ranks"></div>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<table class="table table-bordered table-striped rank-table">\n    <thead>\n        <tr>\n            <th>名次</th>\n            <th width="200">策略名称</th>\n            <th>总分</th>\n            <th>回测得分</th>\n            <th>模拟盘得分</th>\n            <th>模拟超额收益</th>\n            <th>模拟波动率</th>\n            <th>模拟最大回撤</th>\n        </tr>\n    </thead>\n    <tbody>\n        ',_.each(ranks,function(e,t){__p+="\n        <tr>\n            <td>\n                ","score"===e.contest_status?__p+="\n                "+(null==(__t=_T.partial("contestGrade",e))?"":__t)+"\n                ":"none_score"===e.contest_status?__p+='\n                未达标 <span class="none-score" data-requirements="'+(null==(__t=pickRequirements(e))?"":__t)+'"><i class="fa fa-question-circle"></i></span>\n                ':"waiting"===e.contest_status&&(__p+='\n                计分中 <span class="waiting"><i class="fa fa-question-circle"></i></span>\n                '),__p+='\n            </td>\n            <td class="strategy-name" title="'+__e(e.strategy_name)+'"><span>'+__e(e.strategy_name)+"</span></td>\n            <td>"+__e(_.isNull(e.scores)?"--":e.scores.toFixed(2))+"</td>\n            <td>"+__e(_.isNull(e.bt_score)?"--":e.bt_score.toFixed(2))+"</td>\n            <td>"+__e(_.isNull(e.pt_score)?"--":e.pt_score.toFixed(2))+"</td>\n            <td>"+__e(_.isNull(e.pt_excess_return)?"--":(100*e.pt_excess_return).toFixed(2)+"%")+"</td>\n            <td>"+__e(_.isNull(e.pt_volatility)?"--":e.pt_volatility.toFixed(2))+"</td>\n            <td>"+__e(_.isNull(e.pt_max_drawdown)?"--":(100*e.pt_max_drawdown).toFixed(2)+"%")+"</td>\n        </tr>\n        "}),__p+="\n    </tbody>\n</table>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<table class="table table-bordered table-striped rank-table">\n    <thead>\n        <tr>\n            <th>名次</th>\n            <th width="180">参赛者</th>\n            <th width="300">策略名称</th>\n            <th>总分</th>\n            <th>回测得分</th>\n            <th>模拟盘得分</th>\n        </tr>\n    </thead>\n    <tbody>\n        ',_.each(ranks,function(e,t){__p+="\n        <tr>\n            <td>"+(null==(__t=_T.partial("contestGrade",e))?"":__t)+"</td>\n            <td>"+__e(e.nickname)+'</td>\n            <td class="strategy-name" title="'+__e(e.strategy_name)+'"><span>'+__e(e.strategy_name)+"</span></td>\n            <td>"+__e(_.isNull(e.scores)?"--":e.scores.toFixed(2))+"</td>\n            <td>"+__e(_.isNull(e.bt_score)?"--":e.bt_score.toFixed(2))+"</td>\n            <td>"+__e(_.isNull(e.pt_score)?"--":e.pt_score.toFixed(2))+"</td>\n        </tr>\n        "}),__p+="\n    </tbody>\n</table>\n";return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(224),n(226),n(228)],r=function(e,t,n,i,r){var o=t.ItemView.extend({template:e.template('<div class="empty"></div>')});return t.CompositeView.extend({className:"contest-history",template:r,childView:i,emptyView:o,initialize:function(){this.collection=new n,this.collection.fetch()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(225)],r=function(e,t){return e.Collection.extend({model:t,url:window.getapi("mercury_trade","/w/historyleaderboard")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48)],r=function(e){return e.Model.extend({})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(84),n(103),n(227)],r=function(e,t,n,i,r){return t.ItemView.extend({className:"season-item",template:r,serializeData:function(){var e=this.model.toJSON();return e.start=n.calendar(e.start),e.end=n.calendar(e.end),e},onRender:function(){var t=this,n=function(e,n){var r=t.$el.find(".rank-"+e),o=n.profile.avatar;-1===o.search(/^http/)&&(o=window.getfile("public_resources/"+o)),r.find(".nickname").text(n.profile.nickname).attr("title",n.profile.nickname).attr("href",new i({id:n.id}).appUrl()),n.profile.avatar&&(r.find(".avatar img").attr("src",o),r.find(".avatar").removeClass("default-avatar"))};e.each(this.model.get("users"),function(e){$.ajax({url:window.getapi("mercury_community","/w/user")+"/"+e.user_id}).done(function(t){200===t.code&&n(e.rank,t.data)})})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){
obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="container">\n    第 '+(null==(__t=period)?"":__t)+' 期 正式排名时间 <span class="contest-date">'+(null==(__t=start)?"":__t)+"-"+(null==(__t=end)?"":__t)+'</span>\n    <ul class="user-list clearfix">\n        ',_.each(users,function(e,t){__p+='\n        <li class="user-item rank-'+(null==(__t=t+1)?"":__t)+(null==(__t=4>=t?" top5":"")?"":__t)+'">\n            <span class="ribbon">\n                <i class="icon-num icon-num0'+(null==(__t=t+1)?"":__t)+'"></i>\n            </span>\n            <div class="user-detail">\n                <div class="avatar default-avatar">\n                    <img src="http://app.wmcloud.com/cloud-portal/img/account/avatar-bg.png">\n                </div>\n                <a class="nickname" href="#"></a>\n            </div>\n            <div class="award">\n                <span class="bonus">'+(null==(__t=e.capital_base/1e4)?"":__t)+'万</span>\n                实盘资金\n                <div class="explain">一个月管理权</div>\n            </div>\n        </li>\n        '}),__p+="\n    </ul>\n</div>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+="";return __p}},function(e,t,n){var i,r;i=[n(49),n(46),n(230)],r=function(e,t,n){return e.ItemView.extend({className:"contest-guide",template:n,serializeData:function(){return{logined:!t.anonymous,loginUrl:window.getApp("","/login.html?RelayState="+encodeURIComponent(window.location.href)),registerUrl:window.getApp("cloud-portal","/#/application/start?registType=personal&RelayState="+encodeURIComponent(window.location.href))}},onRender:function(){$(".main").scrollTop(0),$(".contest").addClass("no-head")},onDestroy:function(){$(".contest").removeClass("no-head")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="container">\n    <h3>优矿量化大赛循环赛参赛方法</h3>\n    <ul class="steps">\n        <li>\n            <div class="step-desc"><span class="step-num">1</span>注册成为“优矿”用户</div>\n            <img alt="" src="img/contest/guide/1.jpg">\n        </li>\n        <li>\n            <div class="step-desc"><span class="step-num">2</span>研究策略，并回测</div>\n            <img alt="" src="img/contest/guide/2.jpg">\n        </li>\n        <li>\n            <div class="step-desc"><span class="step-num">3</span>参赛成功，随时查看策略状态和排名</div>\n            <img alt="" src="img/contest/guide/3.jpg">\n        </li>\n    </ul>\n</div>\n<div class="register-or-go">\n    ',__p+=logined?'\n    <div class="go-strategy">\n        <a class="strategy" href="labs/" data-href="labs/">写策略</a>\n        <a class="learn" href="community/" data-href="community/">还不会写策略？去社区看看</a>\n    </div>\n    ':'\n    <div class="login-and-register">\n        <a class="login" href="'+(null==(__t=loginUrl)?"":__t)+'">登录</a>\n        <a class="register" href="'+(null==(__t=registerUrl)?"":__t)+'">注册</a>\n    </div>\n    ',__p+="\n</div>\n";return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=(i(r),n(48)),a=i(o),s=n(49),l=i(s),c=n(232),u=i(c);t["default"]=l["default"].ItemView.extend({className:"contest-rankPK",template:u["default"],ui:{table:".rank-table"},initialize:function(){this.rankData=$.ajax({url:window.getapi("mercury_trade","/w/fastleaderboard")})},render:function(){var e=this,t=new a["default"].Model;return this.model=t,this.rankData.done(function(n){t.set("ranks",n),l["default"].ItemView.prototype.render.apply(e,arguments)}),this}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="container">\n    <p>\n        <strong>获奖标准</strong>：截至2016年1月25日19：00，达标策略排名最高者，获得1000元现金奖励。\n    </p>\n    <p>\n        <strong>活动资格</strong>：在2015年12月26日-2016年1月22日期间提交过达标策略，并且未进入第一期、第二期、第三期、第四期前五十名的优矿用户，都有资格角逐最佳新人奖。\n    </p>\n    <p>\n        <strong>策略提交时间</strong>：2015年12月26日-2016年1月22日\n    </p>\n    <p>\n        <strong>排名截止时间</strong>：2016年1月25日19：00\n    </p>\n\n    <div class="ranking">\n        <h5>最佳新人top10</h5>\n        <div class="rank-table">\n            <table class="table table-bordered table-striped rank-table">\n                <thead>\n                    <tr>\n                        <th>上升排名</th>\n                        <th>参赛者</th>\n                        <th>策略名称</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ',_.each(ranks,function(e,t){__p+='\n                    <tr>\n                        <td><i class="'+(null==(__t=e.index<=1?"icon icon-num icon-num0"+e.index:"")?"":__t)+'"></i>'+(null==(__t=e.index>1?e.index:"")?"":__t)+"</td>\n                        <td>"+__e(e.nickname)+'</td>\n                        <td class="strategy-name" title="'+__e(e.strategy_name)+'"><span>'+__e(e.strategy_name)+"</span></td>\n                    </tr>\n                    "}),__p+='\n                </tbody>\n            </table>\n        </div>\n    </div>\n</div>\n<a class="banner" href="https://uqer.io/activity/cansaichoujiang" target="_blank"></a>\n';return __p}},function(e,t,n){var i,r;i=[n(234),n(236),n(239),n(242),n(246),n(264)],r=function(e,t,n,i,r,o){return{Layout:e,FaqView:t,ChangelogView:n,APILayout:i,BrowseView:r,SearchView:o}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(47),n(235)],r=function(e,t,n){return e.LayoutView.extend({className:"help",name:"help",template:n,regions:{main:".region-help-main"},onRender:function(){t.vent.trigger("title:module","帮助")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="region-help-main"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(90),n(47),n(237),n(238)],r=function(e,t,n,i,r,o){return t.ItemView.extend({className:"faq",template:r,ui:{nav:".nav .list-group",content:".content"},events:{"click .nav a":"clickNav"},initialize:function(){$(".wrapper .main").scrollTop(0)},onRender:function(){this.ui.content.append(n(o)),this.buildNav(),i.vent.trigger("title","FAQ")},onDestroy:function(){$(".wrapper .main").data("bs.scrollspy",null).off("scroll.bs.scrollspy")},onShow:function(){var e=this,t=$(".wrapper .main"),n=[];t.css({overflow:"hidden"}),this.ui.content.find("img").each(function(e,t){var i=$.Deferred();$(t).on("load",function(){i.resolve()}),n.push(i)}),this.ui.content.find("a").attr({target:"_blank"}),$.when.apply($,n).done(function(){t.css({overflow:"auto"}).scrollspy({target:".help .faq"}),window.location.hash&&e.scrollTo(window.location.hash.replace("#","#faq-"))})},buildNav:function(){var t=this,n=e.template('<li><a class="list-group-item small-padding" href="#faq-<%= text %>"><%= text %></a></li>'),i=this.ui.content.find("h2");i.each(function(e,i){i=$(i),t.ui.nav.append(n({text:i.text()})),i.attr({id:"faq-"+i.text()})})},scrollTo:function(e){var t=$(".wrapper .main"),n=$(e);n[0]&&t.scrollTop(n.position().top+t.offset().top)},clickNav:function(e){var t=$(e.currentTarget),n=t.attr("href");window.location.hash=n.replace("#faq-","#"),this.scrollTo(n),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="nav">\n    <div class="list-group"></div>\n</div>\n<div class="content"></div>\n';return __p}},function(e,t){e.exports="> 在这里，我们希望能够解答您在使用『优矿』中『开始研究』页面下的大部分问题，更详细的编程帮助文档请参考 [《深入浅出量化实验室》](img/深入浅出量化实验室.pdf)。\r\n\r\n> 如果这些都不能解答您的问题，您可以将问题发布到社区，或者直接邮件联系我们 service.uqer@datayes.com 。\r\n\r\n## 什么是『优矿』\r\n\r\n\r\n『优矿』是您的私人金融量化分析的平台。我们旨在打破金融量化的壁垒，为广大量化爱好者提供华尔街专业量化机构的装备。通过提供高质量的海量金融数据与高性能的分析工具，共襄智慧与金融在大数据时代的红利。\r\n\r\n* **社区** ：我们聚集了一批量化从业者、量化爱好者，他们开放各种想法、算法、策略，共享思维碰撞带来的灵感；\r\n* **开始研究** ：我们为每个用户提供了独立安全的研究开发环境，您在『开始研究』中的所有内容都是您私有的；\r\n    * 同时您还可以将研究成果、或者问题一键分享至『社区』，让更多的人发现你，并在讨论中获得提升。\r\n    * 甚至您还可以将感兴趣的『社区』内容，一键克隆至您个人的研究开发环境『开始研究』。\r\n* **模拟交易**  ：您可以将开始研究中的策略，一键发布，进行实盘模拟。\r\n\r\n\r\n在 **开始研究** 中，您可以通过编写python 2.7代码，快速实现各种金融数据分析、量化策略研究、定价模型分析。我们提供了：\r\n* 海量金融大数据\r\n    * 提供包括市场行情、财报、宏观、基于文本分析的股票关联数据等，通过简单的DataAPI便可获取（所有提供的数据请见 [DataAPI帮助](data/browse/)）；\r\n* 交易回测框架\r\n    * 我们提供了quartz交易回测框架，使得用户可以专注于描述交易算法逻辑，而不必关心底层的实现细节，同时快速获得策略表现评估。\r\n* 金融计算分析库\r\n    * 我们提供了CAL——金融计算分析库，涵盖金融计算的方方面面，包括定价、风险指标分析、数值计算等等。CAL让金融分析高度模块化，方便专业金融人士在此基础之上设计自己的模型。\r\n\r\n\r\n## 知识产权与安全\r\n\r\n1. 您在优矿的所有研究策略，包括社区分享的所有原创内容、在开始研究中的所有策略研究、在我的交易中的所有策略以及所有参加大赛的策略，其知识产权100%均归您本人所有。\r\n\r\n2. 尊重用户隐私数据是优矿的一贯原则，优矿会竭尽全力通过各种技术手段、强化内部管理等办法保障您的隐私数据的安全。\r\n\r\n    * Https加密通道：全程保障您在优矿使用期间的数据传输安全。\r\n\r\n    * 用户数据加密：您的隐私数据以加密方式存储，让您的研究和交易环境只属于您一个人。\r\n\r\n    * 独立隔离的研究环境：优矿为每个用户分配安全独立的虚拟机，虚拟机之间完全隔离，确保您的隐私研究和交易环境环境不受其他用户的侵扰。\r\n\r\n    * 安全运行机制：优矿从python运行机制入手，在研究和交易环境限制用户使用底层系统方法，同时采用恶意代码过滤机制，从根源上遏制了外部用户的入侵。\r\n\r\n    * 定期安全检测：优矿定期展开安全测评，以确保您使用的研究和交易环境安全稳定。\r\n\r\n    * 数据灾备与恢复：优矿采用的云灾难备份与快速恢复方案，有效保障了您的研究策略数据不丢失。\r\n\r\n## Notebook是干什么的\r\n\r\n\r\n在『优矿』中的所有金融研究都可在Notebook中实现，Notebook文件采用输入与输出混排的交互方式，让您的研究过程所见即所得。\r\n\r\n您可以在『开始研究』中新建Notebook，新建的Notebook默认为以下界面：\r\n\r\n![New Notebook](img/NewNotebook.png)\r\n\r\n我们将其称之为单元，每个Notebook都可以由多个这样的单元组成。\r\n\r\n当您的鼠标移动到单元的上边界上方、或下边界下方时，您将会看到添加单元的按钮。\r\n\r\n您还可以在该单元的左上方，将单元都切换为不同的模式：\r\n\r\n![Change Type](img/ChangeType.png)\r\n\r\n* __Strategy__ 模式：您可以用程序化的方法，定义每个交易日在某种条件下买入卖出一定数量的股票，并进行策略表现评估；\r\n* __Code__ 模式：您可以在这个模式下进行各种数据的研究分析、金融建模、定价分析等；\r\n* __Markdown__ 模式：您可以在这个模式下编写Markdown格式的文档。\r\n\r\n> 在不同的单元模式间切换，您将在Notebook中实现各种丰富的研究。\r\n\r\nNotebook中支持了丰富的函数库，包括：\r\n* 『优矿』内置： `CAL`, `DataAPI`，`quartz`，本平台已经将`DataAPI`，`quartz`这两个函数库内置，您无需额外import即可使用；\r\n* python其他库： `array`, `cmath`, `collections`, `copy`, `datetime`, `dateutil`, `functools`, `heapq`, `itertools`, `json`, `math`, `operator`, `random`, `re`, `string`, `time`, `xml`,`__future__`,`numpy`,`pandas`, `scipy`, `matplotlib`, `mpl_toolkits`, `statsmodels`, `datetime`, `talib`,`time`, `sklearn`, `seaborn`, `statsmodels`, `cvxopt`, `MLPlatformClient`, `jieba`, `pymc`, `pybrain`, `tables`, `gensim`, `fractions`, `sets`,  `arch`,`xlrd`,`xlwt`,`io`,`pickle`, `cPickle`, `StringIO`,`networkx`, `sympy`, `pywt`\r\n\r\n\r\n## 如何写个策略\r\n\r\n『开始研究』页面的 notebook当中，可以将每个单元切换为 Strategy 模式。\r\nStrategy模式中，支持各种类型的日间股票量化投资策略的编写，并有着交易策略的定制化输出。\r\n\r\n未来我们会提供股票日内、期货日间、期货日内等策略。\r\n\r\n### ** 策略结构 **\r\n\r\n您将Notebook中的单元切换为 **Strategty** 模式后，会显示如下策略代码模板：\r\n\r\n```\r\nstart = '2014-01-01'                       # 回测起始时间\r\nend = '2015-01-01'                         # 回测结束时间\r\nbenchmark = 'HS300'                        # 策略参考标准\r\nuniverse = ['000001.XSHE', '600000.XSHG']  # 证券池，支持股票和基金\r\ncapital_base = 100000                      # 起始资金\r\nfreq = 'd'                                 # 策略类型，'d'表示日间策略使用日线回测，'m'表示日内策略使用分钟线回测\r\nrefresh_rate = 1                           # 调仓频率，表示执行handle_data的时间间隔，若freq = 'd'时间间隔的单位为交易日，若freq = 'm'时间间隔为分钟\r\n\r\ndef initialize(account):                   # 初始化虚拟账户状态\r\n    pass\r\n\r\ndef handle_data(account):                  # 每个交易日的买入卖出指令\r\n    return\r\n```\r\n\r\n该策略代码由两部组成：\r\n\r\n1. **全局变量参数**：\r\n\r\n    策略模板中提供了7个全局变量参数 `start`, `end`, `benchmark`, `universe`, `capital_base`, `refresh_rate`,上述6个参数是最重要的。通过这6个参数的代码注释，您应该非常清楚他们的作用了。本平台还提供其他更丰富的参数设置，比如滑点、交易手续费等，可以查看 '全局变量参数' 章节。\r\n\r\n2. **函数**：\r\n\r\n    策略模板的第二部分包括 `initialize(account)`和`handle_data(account)` 两个函数，这两个函数缺一不可。\r\n\r\n    在了解这两个函数的作用以前，我们需要大概了解一下交易账户 `account` 的概念：\r\n\r\n    策略初始化之前，会建立一个虚拟的交易账户 `account`，在这个账户会存储上述全局变量参数信息，并在整个策略执行期间更新并维护可用现金、证券的头寸、每日交易指令明细、历史数据等。account会在策略整个回测期间存续。`account`的详细信息可以查看 '常用变量与函数' 章节。\r\n\r\n    * `initialize(account)`：\r\n        * 该函数在在系统初始化后被调用一次。\r\n        * 您可以通过给account添加新的属性的方法，自定义各种指标变量等等。\r\n    * `handle_data(account)` ：\r\n        * 这个函数在每个交易日开盘前被调用，模拟每个交易日开盘前，交易策略会根据历史数据或者其他信息进行交易判断，模拟下达交易指令\r\n        * 接下来系统回测引擎会根据当天的市场数据对这些指令进行能否交易的判断，并更新account当中的现金数量、股票头寸和交易指令信息\r\n        * 随后该交易日结束，在该函数中定义的局部变量会被清空，循环进入下一个交易日，即继续调用handle_data函数\r\n\r\n\r\n### ** 一个最简单的策略 **\r\n\r\n基于以上了解，现在让我们来实现一个最简单的交易策略：每天买入一手股票池里的所有股票。\r\n\r\n```\r\nstart = '2014-01-01'                       # 回测起始时间\r\nend = '2015-01-01'                         # 回测结束时间\r\nbenchmark = 'HS300'                        # 策略参考标准\r\nuniverse = ['000001.XSHE', '600000.XSHG']  # 证券池，支持股票和基金\r\ncapital_base = 100000                      # 起始资金\r\nfreq = 'd'                                 # 策略类型，'d'表示日间策略使用日线回测\r\nrefresh_rate = 1                           # 调仓频率，表示执行handle_data的时间间隔，由于freq = 'd'，时间间隔的单位为交易日\r\n\r\ndef initialize(account):                   # 初始化虚拟账户状态\r\n    pass\r\n\r\ndef handle_data(account):                  # 每个交易日的买入卖出指令\r\n    for stock in account.universe:\r\n        order(stock,100)\r\n```\r\n\r\n您会发现上述代码中出现了两个比较陌生的内容：\r\n* `account.universe`：\r\n\r\n    表示交易日当天，universe 中可以进行交易的证券池。\r\n\r\n* `order(symbol, amount)`：\r\n\r\n    用来模拟下达买卖指令，表示买入amount股symbol股票。如果amount为正数，表示买入；为负数，则表示卖出。\r\n\r\n这样，每天买入一手股票池里的所有股票就完成了。尽管还很简陋，但这是走向各种复杂策略的第一步！\r\n\r\n### ** 策略回测 **\r\n\r\n构建好策略后，您可以单击Notebook界面右边的运行按钮，或使用'Shift'+'Enter'快捷键，运行该策略，运行成功后，将会看到策略表现与沪深300指数的比较。\r\n\r\n您可以看到回测结果的上面部分显示了一些主要的风险收益指标；下面部分显示的是当前策略和参照基准的累计收益率随时间变化的对比图。\r\n\r\n__风险收益指标__ 的定义为：\r\n* __Annualized Returns__: 策略年化收益率。表示投资期限为一年的预期收益率。具体计算方式为：\r\n\r\n  ![Annualized Returns](img/AnnualizedReturns.png)\r\n\r\n* __Benchmark Returns__：参考标准年化收益率。具体计算方式为：\r\n\r\n  ![Benchmark Returns](img/BenchmarkReturns.png)\r\n\r\n* __Alpha__：阿尔法。投资中面临着系统性风险（即Beta）和非系统性风险（即Alpha），Alpha是投资者获得与市场波动无关的回报，一般用来度量投资者的投资技艺。比如投资者获得了12%的回报，其基准获得了10%的回报，那么Alpha或者价值增值的部分就是2%，Alpha具体计算方式为：\r\n\r\n  ![Alpha](img/Alpha.png)\r\n\r\n其中：\r\n\r\n  * α>0，策略相对于风险，获得了超额收益\r\n  * α=0，策略相对于风险，获得了适当收益\r\n  * α<0，策略相对于风险，获得了较少收益\r\n\r\n* __Beta__：贝塔。表示投资的系统性风险，反映了策略对大盘变化的敏感性。例如一个策略的Beta为1.3，则大盘涨1%的时候，策略可能涨1.3%，反之亦然；如果一个策略的Beta为-1.3，说明大盘涨1%的时候，策略可能跌1.3%，反之亦然。Beta具体计算方式为：\r\n\r\n  ![Beta](img/Beta.png)\r\n\r\n* __Sharpe Ratio__：夏普比率。表示每承受一单位总风险，会产生多少的超额报酬，可以同时对策略的收益与风险进行综合考虑。Sharpe Ratio具体计算方式为：\r\n\r\n  ![Sharpe Ratio](img/SharpeRatio.png)\r\n\r\n* __Volatility__：策略收益波动率。用来测量资产的风险性，波动越大代表策略风险越高。Volatility\r\n具体计算方式为：\r\n\r\n  ![Volatility](img/Volatility.png)\r\n\r\n* __Information Ratio__：信息比率。衡量单位超额风险带来的超额收益。信息比率越大，说明该策略单位跟踪误差所获得的超额收益越高，因此，信息比率较大的策略的表现要优于信息比率较低的基金。合理的投资目标应该是在承担适度风险下，尽可能追求高信息比率。Information Ratio具体计算方式为：\r\n\r\n  ![Information Ratio](img/InformationRatio.png)\r\n\r\n* __Max Drawdown__：最大回撤。描述策略可能出现的最糟糕的情况。Max Drawdown具体计算方式为：\r\n\r\n  ![MaxDrawdown](img/MaxDrawdown.png)\r\n\r\n* __Turnover Rate__：换手率。描述策略变化的频率以及持有某只股票平均时间的长短。Turnover Rate具体计算方式为：买入总价值与卖出总价值中的较小者 / 虚拟账户平均价值\r\n\r\n此外，Strategy单元还提供了回测详情，详细记录了每个订单的成交情况（下单数量、成交均价、成交数量等）、每个交易日的持仓信息，以及收益率、Alpha、Beta、Sharpe Ratio、Volatility、Information Ratio、Max Drawdown等时间序列数值。\r\n\r\n同时，如果您想要更详细的分析策略回测的结果，Strategy还提供了两个变量记录策略回测结果，您可以在一个code模式单元调用这两个变量：\r\n* __bt__：\r\n    * 记录了每个交易日收盘之后虚拟账户的详细信息，包含日期（tradeDate）、现金头寸（cash）、股票头寸（security_position）、投资组合价值（portfolio_value）、基准收益率（benchmark_return）、交易指令明细表（blotter）等6列；\r\n    * 交易指令明细表（blotter）中记录了每个交易日的下单指令详情、订单成交状态、涨停/跌停等信息。\r\n    * 数据结构为`pandas.DataFrame`。\r\n* __perf__:\r\n    * 记录了丰富的风险收益指标，包含`return`, `cumulative_return`, `benchmark_return`, `benchmark_cumulative_return`, `benchmark_volatility`, `treasury_return`, `sharpe`, `information_ratio`,`information_coefficient`, `annualized_return`, `volatility`, `beta`, `alpha`, `excess_return`, `max_drawdown`,`turnover_rate`；\r\n    * 数据结构为 `dict`，您可以根据具体的指标名称查询更加详细的指标内容。\r\n\r\n### ** 一个使用历史数据的策略 **\r\n\r\n在写一个具体的策略的时候，很多想法都是与股票过去一段时间的价格、成交量等等指标有关的，于是我们需要在策略中取得并使用历史数据。\r\n\r\n以下是一个简单的例子，策略思路是：计算股票前 10 个交易日的累计收益率，如果累计收益率大于 1% 并且手中没有该股票则买入100 股，如果累计收益率小于 0 并且手中有该股票则全部抛出。\r\n\r\n```\r\nstart = '2014-01-01'                       # 回测起始时间\r\nend = '2015-01-01'                         # 回测结束时间\r\nbenchmark = 'HS300'                        # 策略参考标准\r\nuniverse = ['000001.XSHE', '600000.XSHG']  # 证券池，支持股票和基金\r\ncapital_base = 100000                      # 起始资金\r\nfreq = 'd'                                 # 策略类型，'d'表示日间策略使用日线回测\r\nrefresh_rate = 1                           # 调仓频率，表示执行handle_data的时间间隔，由于freq = 'd'，时间间隔的单位为交易日\r\n\r\ndef initialize(account):                   # 初始化虚拟账户状态\r\n    pass\r\n\r\ndef handle_data(account):                  # 每个交易日的买入卖出指令\r\n    hist = account.get_attribute_history('closePrice', 10)\r\n    for s in account.universe:\r\n        if hist[s][-1]/hist[s][0]-1 > 0.01 and s not in account.valid_secpos:\r\n            order(s, 10000)\r\n        elif hist[s][-1]/hist[s][0]-1 < 0 and s in account.valid_secpos:\r\n            order_to(s, 0)\r\n```\r\n\r\n您会发现上述代码中出现了三个比较陌生的内容：\r\n* `account.get_attribute_history(attribute, time_range) `：\r\n    * 表示获取所有证券 `attribute` 属性 `time_range` 天的历史数据，返回数据类型为 `dict`，键为每个证券的secID\r\n    * 例如上述例子中，某一个交易日的hist的值为：\r\n    ```\r\n    hist == {\r\n        '000001.XSHE': array([ 16.36,  16.54,  16.3 ,  16.65,  17.  ,  16.93,  16.3 ,  16.56, 16.95,  16.66]),\r\n        '600000.XSHG': array([ 17.53,  18.03,  17.89,  17.96,  18.65,  18.6 ,  17.9 ,  18.16, 18.5 ,  18.22])\r\n    }\r\n    ```\r\n    * 除了该函数，还可以通过 `account.get_symbol_history(symbol, time_range) ` 和 `account.get_history(time_range) `函数获取历史数据，具体使用方法请见 **常用变量与函数** 章节\r\n* `order_to(symbol, amount)`：     \r\n    * 用于模拟下达买卖指令，表示卖出symbol股票直至剩余amount股\r\n* `account.valid_secpos`：\r\n    * 虚拟账户的一个属性\r\n    * 数据结构为字典，键为证券代码，值为虚拟账户当前所持有该证券的数量\r\n\r\n使用历史数据后，回测收益从历史数据生效的日期开始计算。\r\n\r\n此例子中，由于 `start = '2014-01-01'`，以及 `account.get_attribute_history('closePrice', 10)`，则收益生效日期为2014年1月1日10个交易日后的第一个交易日即2014年1月16日，即收益生效日期会根据获取的历史数据长度进行调整。\r\n\r\n\r\n\r\n### ** 如何写个日内策略 **\r\n\r\n> 日内策略暂不支持模拟交易功能\r\n\r\n上文描述的相关策略是日间策略，即使用的是日线的数据进行回测。\r\n\r\n以下介绍如何写个日内策略，即使用了分钟线进行回测。相比日间策略，日内策略回测控制更加精细，可以定义更加丰富的策略细节，使交易策略更加完善。\r\n\r\n日内策略的运行框架与日间策略基本一致，都遵循着 定义参数——获取数据——进行回测——分析结果 的逻辑，其中主要的区别在数据获取方面。同时，由于数据的不同，在进行回测上也会有一些针对性的变动。\r\n\r\n除了像日间策略一样获取日线数据之外，日内策略在每个交易日都会获取该日的分钟线数据，同时在每一分钟结束的时候（即分钟线数据刷新的时候）运行handle_data，在下一分钟内进行交易指令的下达和模拟成交，更新所有数据（如referencePrice、referencePortfolioValue、valid_secpos等等），直到这一分钟的分钟线数据更新。\r\n\r\nQuartz日间策略在handle_data当中提供了交易日当日所有的历史分钟线数据、前一交易日之前的日线历史数据、昨日持仓、未成交订单等等日内交易所需要的信息，此外，在日间策略中支持限价指令。\r\n\r\n\r\n```\r\nstart = '2014-01-01'                       # 回测起始时间\r\nend = '2015-01-01'                         # 回测结束时间\r\nbenchmark = 'HS300'                        # 策略参考标准\r\nuniverse = ['000001.XSHE', '600000.XSHG']  # 证券池，支持股票和基金\r\ncapital_base = 100000                     # 起始资金\r\nfreq = 'm'                                 # 策略类型，'m'表示日内策略使用分钟线回测\r\nrefresh_rate = 1                           # 调仓频率，表示执行handle_data的时间间隔，由于freq = 'm'，时间间隔的单位为分钟\r\n\r\ndef initialize(account):                   # 初始化虚拟账户状态\r\n    pass\r\n\r\ndef handle_data(account):                  # 每个交易日的买入卖出指令\r\n    return\r\n```\r\n\r\n其中的策略部分——initialize()和handle_data()部分与日间策略几乎一样，只不过account会多出一些日内回测专用的属性，这些属性在下一部分会详细列出。\r\n\r\n\r\n### ** 日内策略特殊属性 **\r\n\r\n以下函数和属性只可在handle_data函数中使用\r\n* 现价指令：\r\n\r\n        order('000001.XSHE', 1000, price = 6.5, otype = 'limit')\r\n\r\n        order('000001.XSHE', -1000, 6.8, 'limit')\r\n\r\n        order_to('000001.XSHE', 1000, price = 6.5, otype = 'limit')\r\n\r\n        order_to('000001.XSHE', 0, 6.8, 'limit')\r\n\r\n* 时间控制：\r\n\r\n        # 只可在handle_data函数中使用，值为字符串，如'09:45', '13:37'等等\r\n        account.current_minute\r\n\r\n* 日内历史窗口：\r\n\r\n        # 数据结构与日间获取的历史窗口数据一致\r\n\r\n        # range表示当日历史分钟线的数量，注意同样的函数名称在日间回测时有不同的含义\r\n        account.get_symbol_history(symbol, range)\r\n        account.get_attribute_history(attribute, range)\r\n        account.get_history(range)\r\n\r\n        # range表示前一交易日开始算的日线的数量（包含前一交易日），这些函数只有日内回测时才有\r\n        account.get_daily_symbol_history(symbol, range)\r\n        account.get_daily_attribute_history(attribute, range)\r\n        account.get_daily_history(range)\r\n\r\n* 持仓与下单：\r\n\r\n        # 当前可卖持仓，数据结构与valid_secpos一致\r\n        account.avail_secpos\r\n\r\n        # 当前待成交指令，数据结构为列表，元素为Order实例，可以通过Order的属性访问相应数据，详见函数列表\r\n        account.pending_blotter\r\n\r\n\r\n至此，您已经掌握了构建策略的基本步骤和方法，现在可以充分发挥自己的聪明才智，开始挖掘收益更高更稳定的量化投资策略了！\r\n\r\n\r\n### ** 快速回测 **\r\n\r\n在策略开发中，不可避免地会遇到参数优化的问题，即需要反复设定某些参数的值，反复运行策略，以获得最佳的参数组合。在这种情况下，如果回测所需的行情数据并不依赖于参数（start, end, benchmark,universe, capital_base 保持不变），那么可以使用 quick_backtest 功能，省去每次回测获取数据的过程，加速回测。\r\n\r\n> ！注意：quick_backtest 必须在 code 环境下调用\r\n\r\n> ！注意：quick_backtest 仅限日间策略\r\n\r\n我们先来看一段例子：\r\n\r\n```\r\n# 可编辑部分与 strategy 模式一样，其余部分按本例代码编写即可\r\n\r\n# -----------回测参数部分开始，可编辑------------\r\n\r\nstart = '2015-10-01'\r\nend = '2015-12-01'\r\nbenchmark = 'SH50'\r\nuniverse = set_universe('SH50')\r\ncapital_base = 10000\r\n\r\n# ---------------回测参数部分结束----------------\r\n\r\n# 把回测参数封装到 SimulationParameters 中，供 quick_backtest 使用\r\nsim_params = quartz.SimulationParameters(start, end, benchmark, universe, capital_base)\r\n# 获取回测行情数据\r\nidxmap, data = quartz.get_daily_data(sim_params)\r\n# 运行结果\r\nresults = {}\r\n# 调整参数快速回测\r\nfor x in range(1, 10):\r\n\r\n    # -----------策略逻辑部分开始，可编辑------------\r\n\r\n    # refresh_rate 的值和回测行情数据无关，所以也可以在参数调优中修改\r\n    # 类似的还有 commission 和 slippage\r\n    refresh_rate = 1\r\n    # commission = ...\r\n    # slippage = ...\r\n\r\n    def initialize(account):\r\n        account.my_paramter = x\r\n\r\n    def handle_data(account):\r\n        # 调用 account.my_parameter 进行计算或其他操作\r\n        return\r\n\r\n    # ---------------策略逻辑部分结束----------------\r\n\r\n    # 把回测逻辑封装到 TradingStrategy 中，供 quick_backtest 使用\r\n    strategy = quartz.TradingStrategy(initialize, handle_data)\r\n    # 回测部分\r\n    bt, acct = quartz.quick_backtest(sim_params, strategy, idxmap, data, refresh_rate = refresh_rate)\r\n    # commission = commission,\r\n    # slippage = slippage\r\n\r\n    # 对于回测的结果，可以通过 perf_parse 函数计算风险指标\r\n    perf = quartz.perf_parse(bt, acct)\r\n\r\n    # 保存运行结果\r\n    results[x] = perf['returns']\r\n\r\n# 直接打印结果\r\n# print results\r\n# 转换为 DataFrame 并画图\r\n# import pandas\r\n# results = pandas.DataFrame(results)\r\n# results.plot()\r\n\r\n```\r\n\r\n从代码中可以清晰地看出，这一过程分成了两大部分，其中第一部分是根据 start, end, benchmark, universe, capital_base 获取回测用的数据，并保存在 idxmap 和 data 两个变量当中，以供在不同的参数下回测时反复调用。\r\n\r\n第二部分则是参数调优部分，需要定义的东西包括 referesh_rate, commission 等参数和 initialize()、handle_data() 两个决定回测逻辑的函数。在定义完成后，调用 quartz.quick_backtest，把相关参数和策略逻辑都输入，即可得到回测结果 bt。注意到这里 idxmap 和 data 也是输入的一部分，所以节省了获取数据的时间。\r\n\r\n对于每一次的回测结果，可以直接打印result信息来观察，也可以另外创建一个 list 或者 dict 把其中的信息存下来，之后在其他单元中观察比较。\r\n\r\n\r\n\r\n### ** 全局变量参数 **\r\n\r\n您可以在策略中设置如下全局变量参数：\r\n\r\n* __start__\r\n\r\n    回测起始时间。支持多种格式，包括：`'20150101'`, `'2015-01-01'`, `datetime(2015,1,1)`\r\n\r\n* __end__\r\n\r\n    回测结束时间。支持多种格式，包括：`'20150101'`, `'2015-01-01'`, `datetime(2015,1,1)`\r\n\r\n* __benchmark __\r\n    策略基准，默认值为'HS300'。benchmark支持三种赋值方式：\r\n    * 指数名称，包括 上证综指`'SHCI'`、上证50`'SH50'`、上证180 `'SH180'`、沪深300`'HS300'`、中证500`'ZZ500'`\r\n    * 指数secID，例如用创业板指当做基准 ` benchmark = '399006.ZICN'`\r\n    * 个股secID，例如 ` benchmark = '000001.XSHE'`\r\n\r\n* __universe__\r\n\r\n    证券池，支持股票和基金两种证券，支持两种赋值方式：\r\n    * 证券代码列表，证券代码必须包含后缀，其中上证证券为`.XSHG`，深证证券为`.XSHE`，例如：`universe = ['000001.XSHE', '600000.XSHG']`\r\n    * 使用 `set_universe` 函数进行赋值，例如 `universe = set_universe('HS300') `，`set_universe`的使用方法见 **常用变量与函数** 章节。\r\n\r\n* __capital_base__\r\n\r\n    起始资金\r\n\r\n* __refresh_rate__\r\n\r\n    调仓频率，即每 `refresh_rate` 个交易日执行一次 `handle_data()` 函数。\r\n\r\n* __security_base__\r\n\r\n    初始证券头寸，例如： `stock_base = {'000001.XSHE': 100, '600000.XSHG':200}` ，表示策略初始情况下，拥有100股000001.XSHE和200股600000.XSHG\r\n\r\n* __slippage__\r\n\r\n    滑点标准，用于处理市场冲击问题，例如： `slippage = Slippage(value=0.0, unit='perValue')` 。\r\n    * value为滑点的值\r\n    * unit为滑点的单位，支持 `perValue`和`perShare` 两种类型，前者为默认值。\r\n\r\n        perValue 表示，买入股票的交易价格调整为 S × (1 + value)，卖出股票的交易价格调整为 S × (1 - value)，其中S表示股票当前实际价格；\r\n\r\n        perShare 表示，买入股票价格调整为 S + value，卖出股票价格调整为 S - value 。\r\n\r\n* __commission__\r\n\r\n    手续费标准，例如 `commission = Commission(buycost=0.001, sellcost=0.002, unit='perValue')`。\r\n    * buycost 表示买进手续费\r\n    * sellcost 表示卖出手续费\r\n    * unit 表示手续费单位，支持 `perValue` 和 `perShare` 两种类型，前者为默认值。\r\n\r\n        perValue 表示按股价百分比收取每股手续费\r\n\r\n        perShare 表示按股数收取的每股手续费\r\n\r\n    若策略中定义了slippage，则commission在slippage调整后的股价基础上进行计算。\r\n\r\n    股票的最终成交价(transact price)的值为 slippage调整后的股价 + commission。您可以在策略运行后，在回测详情中的调仓记录中查看订单成交价格。\r\n\r\n\r\n### **常用变量与函数**\r\n\r\n* __account__\r\n\r\n    虚拟账户，策略初始化之前，会建立一个虚拟的交易账户 `account`，在这个账户会存储上述全局变量参数信息，并在整个策略执行期间更新并维护可用现金、证券的头寸、每日交易指令明细、历史数据等。account会在策略整个回测期间存续。\r\n\r\n    常用属性有：\r\n    * account.universe：当前交易日的证券池，从全局变量universe中剔除了当天停牌、退市和数据缺失证券的证券池。数据类型为列表\r\n    * account.universe_all：所有证券池，等于在全局变量参数中设置的universe。数据类型为列表\r\n    * account.current_date：当前回测日期\r\n    * account.days_counter：交易日计数\r\n    * account.trading_days：回测期间的所有交易日列表\r\n    * account.cash：前一交易日收盘之后的现金头寸。数据类型为浮点数\r\n    * account.secpos：前一交易日收盘之后的证券头寸（即您持有的股票或基金），持有的数量可能为0。数据类型为字典，键为证券代码，值为头寸，例如：\r\n      ```\r\n      {'000001.XSHE': 100, '600000.XSHG': 100}\r\n      ```\r\n    * account.valid_secpos：当前交易日的有效证券头寸，即在account.secpos中持有数量大于0的证券头寸。数据类型为字典，键为证券代码，值为头寸。\r\n    * account.avail_secpos：可卖证券头寸。日间策略中与account.valid_secpos没有区别，日内策略时，由于T+1，account.avail_secpos表示当前证券头寸中可以卖出的证券。数据类型为字典，键为证券代码，值为头寸。\r\n    * account.referencePrice：证券的参考价，一般使用的是上一日收盘价或者上一分钟收盘价。 数据类型为字典，键为证券代码，值为参考价，例如：\r\n      ```\r\n      {'000001.XSHE': 12.477, '600000.XSHG': 14.112}\r\n      ```\r\n    * account.referenceReturn：证券的参考收益率，一般使用的是上一日收益率。数据类型为字典，键为证券代码，值为参考价，例如：\r\n      ```\r\n      {'000001.XSHE': 0.033, '600000.XSHG': 0.032}\r\n      ```\r\n    * account.referencePortfolioValue：投资策略的参考价值，使用参考价计算\r\n    * account.valid_seccost：平均持仓成本，数据类型为字典，键为证券代码，值为平均持仓成本，例如：\r\n      ```\r\n      {'000001.XSHE': 10.411, '600000.XSHG': 11.89}\r\n      ```\r\n    * account.previous_date：前一交易日日期，数据类型为datetime。\r\n    * account.blotter：当前的下单指令列表，由于handle_data函数还未运行完毕，因此此时获得的下单指令列表中，所有指令还未成交。\r\n    * account.commission：手续费标准\r\n    * account.slippage：滑点标准\r\n    * account.current_minute：当前回测分钟线（仅对日内策略有效）\r\n    * account.pending_blotter：所有未成交指令（仅对日内策略有效）\r\n\r\n* __account.get_attribute_history(attribute, time_range)__\r\n\r\n    * 日间策略时，即freq='d'时：表示获取所有证券 `attribute` 属性在 `time_range` 天的历史数据\r\n    * 日内策略时，即freq='m'时：表示获取所有证券 `attribute` 属性在过去 `time_range` 个历史分钟线的历史数据。日内策略中获取历史日线数据，请使用下文描述的```account.get_daily_attribute_history(attribute, time_range)```方法\r\n    * 返回数据类型为 `dict`，键为每个证券的secID，值的数据类型为 `list`\r\n    * `attribute` 支持 `closePrice`, `highPrice`, `lowPrice`, `openPrice`, `preClosePrice`, `turnoverValue`, `turnoverVol`\r\n    * 例如：\r\n    ```\r\n    def handle_data(account):\r\n      all_close_prices = account.get_attribute_history('closePrice', 10)     \r\n\r\n    某次all_close_prices的值为：\r\n    ```\r\n    all_close_prices = {\r\n        '000001.XSHE': array([ 10.072,  10.841,  10.824,  11.535,  12.006,  12.584,  11.328,11.725,  11.502,  11.518]),\r\n        '600000.XSHG': array([ 11.619,  12.297,  12.02 ,  12.679,  12.928,  13.195,  12.087,  12.574,  12.469,  12.402])\r\n    }\r\n    ```\r\n\r\n* __account.get_symbol_history(symbol, time_range)__  \r\n\r\n    * 日间策略时，即freq='d'时：表示获取单只证券的历史数据，即获取symbol证券中所有属性在 `time_range` 天的历史数据\r\n    * 日内策略时，即freq='m'时：表示获取单只证券的历史数据，即获取symbol证券中所有属性过去 `time_range` 个历史分钟线的历史数据。日内策略中获取历史日线数据，请使用下文描述的```account.get_daily_symbol_history(symbol, time_range)```方法\r\n    * 返回数据类型为 `dict`，键为 `closePrice`, `highPrice`, `lowPrice`, `openPrice`, `preClosePrice`, `turnoverValue`, `turnoverVol`，值的数据类型为 `list`\r\n    * 例如：\r\n    ```\r\n    def handle_data(account):\r\n     single_symbol_history = account.get_symbol_history('000001.XSHE', 5)\r\n    ```\r\n    某次single_symbol_history的值为：\r\n    ```\r\n    single_symbol_history == {\r\n       'closePrice': array([ 16.93,  16.3 ,  16.56,  16.95,  16.66]),\r\n       'turnoverValue': array([  4.44733303e+09,   5.77643795e+09,   3.94335705e+09, 4.64033583e+09,   3.89352207e+09]),\r\n       'turnoverVol': array([  2.60952337e+08,   3.44725740e+08,   2.41593696e+08, 2.77314172e+08,   2.31968840e+08]),\r\n       'lowPrice': array([ 16.8 ,  16.16,  15.98,  16.5 ,  16.56]),\r\n       'highPrice': array([ 17.5 ,  17.2 ,  16.7 ,  16.98,  17.04]),\r\n       'openPrice': array([ 17.5 ,  17.1 ,  16.32,  16.58,  16.98]),\r\n       'preClosePrice': array([ 17.  ,  16.93,  16.3 ,  16.56,  16.95])\r\n   }\r\n    ```\r\n\r\n* __account.get_history(time_range)__  \r\n\r\n    * 日间策略时，即freq='d'时：表示获取所有证券的所有属性在过去 `time_range` 天的历史数据\r\n    * 日间策略时，即freq='d'时：表示获取所有证券的所有属性在过去 `time_range` 个历史分钟线的历史数据。日内策略中获取历史日线数据，请使用下文描述的```account.get_daily_history(range)```方法\r\n    * 返回数据类型为 `dict`，键为每个证券的secID，值为字典，等同于 `account.get_symbol_history(symbol, time_range)` 返回的内容\r\n    * 例如：\r\n   ```\r\n    def handle_data(account):\r\n     all_history = account.get_history(3) # 返回所有证券最近3个交易日的行情数据\r\n   ```\r\n    某次all_history的值为：\r\n   ```\r\n    all_history == {\r\n           '000001.XSHE': {\r\n               'closePrice': array([ 16.56,  16.95,  16.66]),\r\n               'turnoverValue': array([  3.94335705e+09,   4.64033583e+09,   3.89352207e+09]),\r\n               'turnoverVol': array([  2.41593696e+08,   2.77314172e+08,   2.31968840e+08]),\r\n               'lowPrice': array([ 15.98,  16.5 ,  16.56]),\r\n               'highPrice': array([ 16.7 ,  16.98,  17.04]),\r\n               'openPrice': array([ 16.32,  16.58,  16.98]),\r\n               'preClosePrice': array([ 16.3 ,  16.56,  16.95])\r\n            },\r\n           '600000.XSHG': {\r\n               'closePrice': array([ 18.16,  18.5 ,  18.22]),\r\n               'turnoverValue': array([  6.61554064e+09,   7.71213068e+09,   6.67554199e+09]),\r\n               'turnoverVol': array([  3.68194681e+08,   4.20766743e+08,   3.63593631e+08]),\r\n               'lowPrice': array([ 17.75,  18.08,  18.11]),\r\n               'highPrice': array([ 18.19,  18.55,  18.64]),\r\n               'openPrice': array([ 17.75,  18.3 ,  18.5 ]),\r\n               'preClosePrice': array([ 17.9 ,  18.16,  18.5 ])\r\n           },\r\n           'benchmark': {\r\n               'closeIndex': array([ 4619.164,  4739.814,  4740.892]),\r\n               'return': array([ 0.02150525,  0.02611944,  0.00022744]),\r\n               'preCloseIndex': array([ 4521.919,  4619.164,  4739.814])\r\n           },\r\n           'tradeDate':\r\n               [datetime.datetime(2015, 4, 21, 0, 0),\r\n                datetime.datetime(2015, 4, 22, 0, 0),\r\n                datetime.datetime(2015, 4, 23, 0, 0)]\r\n           }\r\n   }\r\n   ```\r\n* __account.get_daily_attribute_history(attribute, time_range)__\r\n\r\n    * 只支持日内策略，即freq='m'时。\r\n    * 表示获取所有证券某个 `attribute` 属性在过去 `time_range` 天的历史数据\r\n    * 返回数据类型为 `dict`，键为每个证券的secID，值的数据类型为 `list`\r\n    * `attribute` 支持 `closePrice`, `highPrice`, `lowPrice`, `openPrice`, `preClosePrice`, `turnoverValue`, `turnoverVol`\r\n    * 例如：\r\n    ```\r\n    def handle_data(account):\r\n      all_close_prices = account.get_attribute_history('closePrice', 10)     \r\n\r\n    某次all_close_prices的值为：\r\n    ```\r\n    all_close_prices = {\r\n        '000001.XSHE': array([ 10.072,  10.841,  10.824,  11.535,  12.006,  12.584,  11.328,11.725,  11.502,  11.518]),\r\n        '600000.XSHG': array([ 11.619,  12.297,  12.02 ,  12.679,  12.928,  13.195,  12.087,  12.574,  12.469,  12.402])\r\n    }    \r\n    ```\r\n\r\n* __account.get_daily_symbol_history(symbol, time_range)__\r\n\r\n    * 只支持日内策略，即freq='m'时。\r\n    * 表示获取单只证券的日线历史数据表示，即获取symbol证券中所有属性在过去 `time_range` 天的历史数据\r\n    * 返回数据类型为 `dict`，键为 `closePrice`, `highPrice`, `lowPrice`, `openPrice`, `preClosePrice`, `turnoverValue`, `turnoverVol`，值的数据类型为 `list`\r\n    * 例如：\r\n    ```\r\n    def handle_data(account):\r\n     single_daily_symbol_history = account.get_daily_symbol_history('000001.XSHE', 5)\r\n    ```\r\n    某次single_daily_symbol_history的值为：\r\n    ```\r\n    single_daily_symbol_history == {\r\n        'closePrice': array([ 14.07,  14.69,  15.1 ,  14.92,  15.5 ]),\r\n        'turnoverValue': array([  2.85420788e+09,   2.88758145e+09,   3.62569026e+09,   3.98392322e+09,   3.63748423e+09]),\r\n        'turnoverVol': array([  2.01027102e+08,   1.99727585e+08,   2.43707335e+08,   2.58614817e+08,   2.36607838e+08]),\r\n        'lowPrice': array([ 13.68,  14.04,  14.52,  14.75,  14.87]),\r\n        'highPrice': array([ 14.85,  14.75,  15.18,  16.05,  15.59]),\r\n        'openPrice': array([ 14.74,  14.35,  14.61,  15.61,  14.93]),\r\n        'accumAdjFactor': array([ 0.82626265,  0.82626265,  0.82626265,  0.82626265,  0.82626265]),\r\n        'preClosePrice': array([ 14.75,  14.07,  14.69,  15.1 ,  14.92])\r\n    }\r\n    ```\r\n* __account.get_daily_history(time_range)__\r\n\r\n    * 只支持日内策略，即freq='m'时。\r\n    * 表示获取所有证券的所有属性在过去 `time_range` 天的历史数据\r\n    * 返回数据类型为 `dict`，键为每个证券的secID，值为字典，等同于 `account.get_symbol_history(symbol, time_range)` 返回的内容\r\n    * 例如：\r\n   ```\r\n    def handle_data(account):\r\n     all_history = account.get_history(3) # 返回所有证券最近3个交易日的行情数据\r\n   ```\r\n    某次all_history的值为：\r\n   ```\r\n    all_history == {\r\n           '000001.XSHE': {\r\n               'closePrice': array([ 16.56,  16.95,  16.66]),\r\n               'turnoverValue': array([  3.94335705e+09,   4.64033583e+09,   3.89352207e+09]),\r\n               'turnoverVol': array([  2.41593696e+08,   2.77314172e+08,   2.31968840e+08]),\r\n               'lowPrice': array([ 15.98,  16.5 ,  16.56]),\r\n               'highPrice': array([ 16.7 ,  16.98,  17.04]),\r\n               'openPrice': array([ 16.32,  16.58,  16.98]),\r\n               'preClosePrice': array([ 16.3 ,  16.56,  16.95])\r\n            },\r\n           '600000.XSHG': {\r\n               'closePrice': array([ 18.16,  18.5 ,  18.22]),\r\n               'turnoverValue': array([  6.61554064e+09,   7.71213068e+09,   6.67554199e+09]),\r\n               'turnoverVol': array([  3.68194681e+08,   4.20766743e+08,   3.63593631e+08]),\r\n               'lowPrice': array([ 17.75,  18.08,  18.11]),\r\n               'highPrice': array([ 18.19,  18.55,  18.64]),\r\n               'openPrice': array([ 17.75,  18.3 ,  18.5 ]),\r\n               'preClosePrice': array([ 17.9 ,  18.16,  18.5 ])\r\n           },\r\n           'benchmark': {\r\n               'closeIndex': array([ 4619.164,  4739.814,  4740.892]),\r\n               'return': array([ 0.02150525,  0.02611944,  0.00022744]),\r\n               'preCloseIndex': array([ 4521.919,  4619.164,  4739.814])\r\n           },\r\n           'tradeDate':\r\n               [datetime.datetime(2015, 4, 21, 0, 0),\r\n                datetime.datetime(2015, 4, 22, 0, 0),\r\n                datetime.datetime(2015, 4, 23, 0, 0)]\r\n           }\r\n   }\r\n   ```\r\n\r\n\r\n* __set_universe(symbol,date)__\r\n\r\n    获取预设股票代码列表，例如 `universe = set_universe(‘SH50’)` ，支持两种方式：\r\n    * 参数symbol支持七个预设值：\r\n        * SH50，表示上证50；\r\n        * SH180，表示上证180；\r\n        * HS300，表示沪深300；\r\n        * ZZ500，表示中证500；\r\n        * CYB，表示创业板；\r\n        * ZXB，表示中小板；\r\n        * A，表示全A股。\r\n    * 支持可以用 `DataAPI.IdxConsGet` 函数获取的所有指数，例如 `set_universe('000906.ZICN') `\r\n    * 参数 date 表示该日期时，symbol对应的股票代码列表，例如  `set_universe('HS300','20150101') ` 表示2015年1月1日沪深300的股票列表。通过使用 date 参数，可以避免策略中的生存者偏差问题，让您动态获得股票池列表。\r\n\r\n\r\n* __order(symbol, amount, price = 0., otype = 'market')__\r\n\r\n    * 在handle_data(account)函数中使用\r\n    * 用来模拟下达买卖指令，表示买入amount股symbol股票。\r\n    * 参数 symbol，str类型，表示需要交易的证券代码，必须包含后缀，其中上证证券为.XSHG，深证\r\n证券为.XSHE\r\n    * 参数 amount，整数类型，表示需要交易的证券代码为symbol证券数量，为正则为买入，为负则\r\n为卖出；程序会自动对 amount 向下取整到最近的整百\r\n    * 参数 price，该参数仅限日内策略使用，float类型，表示下限价单时的下单价格\r\n    * 参数 otype，str类型，表示交易指令类型，可选值为 'market'和'limit','market'表示市价仅限日内策略使用，'limit'限价。\r\n\r\n\r\n* __order_to(symbol, amount, price = 0., otype = 'market')__\r\n\r\n    * 在handle_data(account)函数中使用\r\n    * 用于模拟下达买卖指令，表示卖出symbol股票直至剩余amount股\r\n    * 后台实现为对order的包装，因此如果在同一天多次对同一证券使用order_to函数，可能导致下单数量异常。\r\n    * 参数 symbol，str类型，表示需要交易的证券代码，必须包含后缀，其中上证证券为.XSHG，深证\r\n证券为.XSHE\r\n    * 参数 amount，值只能为正整数，程序会自动对 amount 向下取整到百\r\n    * 参数 price，该参数仅限日内策略使用，float类型，表示下限价单时的下单价格\r\n    * 参数 otype，str类型，表示交易指令类型，可选值为 'market'和'limit','market'表示市价仅限日内策略使用，'limit'限价。\r\n\r\n* __order_pct(symbol, pct, price=0., otype = 'market')__\r\n\r\n    * 在handle_data(account)函数中使用\r\n    * 表示证券symbol需要买入（卖出）的价值为虚拟账户当前总价值的pct百分比，仅限市价单\r\n    * 参数 symbol，str类型，表示需要交易的证券代码，必须包含后缀，其中上证证券为.XSHG，深证\r\n证券为.XSHE\r\n    * 参数 pct，float类型，表示需要交易证券价值占虚拟账户达昂前总价值的百分比，范围为 -1 ~ 1，为正则为买入，为负则为卖出；程序会自动对 amount 向下取整到最近的整百\r\n    * 参数 price，该参数仅限日内策略使用，float类型，表示下限价单时的下单价格\r\n    * 参数 otype，str类型，表示交易指令类型，可选值为 'market'和'limit','market'表示市价仅限日内策略使用，'limit'限价。\r\n\r\n* __order_pct_to(symbol, pct, price=0., otype = 'market')__\r\n\r\n    * 在handle_data(account)函数中使用\r\n    * 表示为买入（卖出）证券symbol，使得其价值为虚拟账户当前总价值的pct百分比，仅限市价单\r\n    * 参数 symbol，str类型，表示需要交易的证券代码，必须包含后缀，其中上证证券为.XSHG，深证\r\n证券为.XSHE\r\n    * 参数 pct，float类型，表示需要交易的证券代码为symbol的证券占虚拟账户当前总价值的百分比，范围为 -1 ~ 1，为正则为买入，为负则为卖出；程序会自动对 amount 向下取整到最近的整百\r\n    * 参数 price，该参数仅限日内策略使用，float类型，表示下限价单时的下单价格\r\n    * 参数 otype，str类型，表示交易指令类型，可选值为 'market'和'limit','market'表示市价仅限日内策略使用，'limit'限价。\r\n\r\n* __observe(name, value)__\r\n\r\n    * 在handle_data(account)函数中使用，用于运行回测后，在 bt 中增加一列自定义需要观测的变量。\r\n    * 参数 name ，str类型，表示需要观测的变量名称\r\n    * 参数 value，表示需要观测的变量值\r\n    * 如果 refresh_rate > 1，那么不交易期间的 name 依然保留上一次调用 handle_date 时候的 value。\r\n    * 仅限日间策略。\r\n    * 详细使用方法参考社区分享 [回测数据保存监控 - observe使用示例](https://uqer.io/community/share/563b3076f9f06c713ddfeac9)\r\n\r\n### **数据预处理**\r\n\r\n* 股价前复权：\r\n\r\n    股票价格受拆分、股息等事件的影响，股价会出现大幅的变动。\r\n\r\n    我们对股价和成交量进行了权息修复，即使用了前复权股价，您在回测时不必关心股票的拆分、股息等事件的影响。\r\n\r\n    前复权的数据您可以通过调用DataAPI进行校验查看，例如：\r\n    ```\r\n    DataAPI.MktEqudAdjGet(ticker=u\"000001\")\r\n    ```\r\n\r\n* 涨跌停、停牌、未上市等情况\r\n\r\n    我们在回测框架中对证券涨跌停、停牌、未上市等情况做了预处理：\r\n    * 涨跌停：当天股票涨停则该股票无法买入，当天股票跌停则该股票无法卖出\r\n    * 停牌：当天股票停牌，则无法买入\r\n    * 未上市：当天股票未上市，则无法买入\r\n\r\n* 其他\r\n\r\n    为了保障回测期间的数据的可用性，您的下单对象若不在universe中设置的证券池之中，我们将不对该证券做下单处理。\r\n\r\n  当前可以下单的证券池，您可以通过 `account.unverse` 获取。\r\n\r\n\r\n\r\n> 『优矿』中的Strategy模式由Quartz框架提供支持；\r\n\r\n> 包括上文提到的各种变量与函数，都是在Quartz框架下运行的。\r\n\r\n> 关于Quartz下各个变量与函数的更详细信息，请查看 [Quartz详细帮助](img/深入浅出量化实验室.pdf#page=17)\r\n\r\n## 如何使用股票筛选器\r\n\r\n写策略的时候您可能会遇到这样的场景：\r\n\r\n1. 在一个很大的大股票池中计算各个股票的指标数据，比如PE，PB.\r\n\r\n2. 根据1中计算的结果，从大股票池中筛选出一部分的股票，将这些股票作为股票池，构建策略。\r\n\r\n股票筛选器就是为这样的场景构建的工具，便于用户动态维护股票池，节省获取大量股票数据、计算指标的时间。\r\n\r\n股票筛选器基于通联数据提供的133个基本面和技术面的因子数据（正在不断扩充）。\r\n\r\n您可以基于股票因子数据定义筛选条件，而后在回测中使用它们的结果。\r\n\r\n目前仅支持从2011年1月4日开始至今的股票日间回测\r\n\r\n在阅读本部分之前，建议先阅读 [如何写个策略](https://uqer.io/help/faq/#如何写个策略)，以对策略回测运行的框架、交易策略参数以及相关术语有一定的了解，这样可以更好地理解本部分的内容。\r\n\r\n### 构建筛选条件表达式\r\n\r\n对于单个因子筛选条件来说，可以通过以下方法进行定义：\r\n\r\n```\r\n# from quartz.api import *\r\n# 在非strategy单元模式下运行时，最好加上上面这句\r\n\r\n# Factor.<factor_name>.<筛选方法>，例如：\r\nFactor.PE.nlarge(10)\r\n```\r\n\r\n其中，共有两个地方需要输入：\r\n\r\n1. ```factor_name```:\r\n\r\n  因子名，即该筛选条件是基于何种因子的。您可以输入```Factor. ```之后按Tab键通过代码提示获得支持的所有因子，也可以使用以下方法获得股票筛选器支持的所有因子：\r\n\r\n    StockScreener.available_factors()\r\n\r\n2. ```筛选方法```：\r\n\r\n    即采用何种筛选方法来挑选股票。目前提供了5种方法：value_range （按值筛选）, pct_range （按百分比筛选）, num_range （按序号筛选）, nlarge （取最大）, nsmall （取最小），具体使用方法参看 Factor。\r\n\r\n  * value_range(self, lbound, ubound)： 筛选因子值处于上下界之间的证券（包含两端）。\r\n\r\n    参数:\r\n\r\n    lbound (float) – 条件参数下界\r\n\r\n    ubound (float) – 条件参数上界\r\n\r\n  * pct_range(self, lbound, ubound)： 筛选因子值处于百分比上下分位点之间的证券（包含两端），默认升序排列\r\n\r\n    参数:\r\n\r\n    lbound (float) – 条件参数下界\r\n\r\n    ubound (float) – 条件参数上界\r\n\r\n  * num_range(self, lbound, ubound)： 筛选因子值处于上下界序号之间的证券（包含两端），默认升序排列\r\n\r\n    参数:\r\n\r\n    lbound (int) – 条件参数下界\r\n\r\n    ubound (int) – 条件参数上界\r\n\r\n  * nlarge(self, n)： 筛选因子值最大的n只证券\r\n\r\n    参数:\r\n\r\n      n (int) – 条件参数\r\n\r\n  * nsmall(self, n)： 筛选因子值最小的n只证券\r\n\r\n    参数:\r\n      n (int) – 条件参数\r\n\r\n通过以上方法，就可以很方便的定义出一条因子筛选条件了。然而在实际使用中，我们往往希望使用多个筛选条件综合作用，以获得更佳的效果。股票筛选器在单因子筛选条件的基础上，也提供了多条筛选条件复合表达的功能。\r\n\r\n在两个筛选条件之间，您可以可以进行与（&）和或（|）两种运算，分别代表将筛选出股票列表进行交运算和并运算，学习过集合论基础知识的话应该能够很容易的理解。\r\n\r\n对于三个或更多筛选条件，您还可以加上括号来构成更为复杂的表达式，例如：\r\n\r\n```\r\n(Factor.PE.nlarge(100) | Factor.PB.pct_range(0.95, 1)) & Factor.RSI.value_range(70, 100)\r\n```\r\n\r\n### 构建股票筛选器\r\n\r\n\r\n在构建完筛选条件的表达式之后，我们可以构建股票筛选器了。构建方法十分简单：\r\n\r\n```\r\n# StockScreener(<筛选条件表达式>)\r\n# 例如\r\nStockScreener(Factor.PE.nlarge(100))\r\n```\r\n\r\n在某些情况下，我们可能需要在筛选器以外自定义一些股票作为筛选器的补充，我们可以使用如下的语句来完成这一任务：\r\n\r\n```\r\n# StockScreener(<筛选条件表达式>) + [自定义股票列表]\r\n# 例如\r\nStockScreener(Factor.PE.nlarge(100)) + ['000001.XSHE', '600000.XSHG']\r\n```\r\n\r\n注意：为了避免性能上的问题，StockScreener中使用的筛选条件表达式中的单因子条件数量限制为最多5条。\r\n\r\n\r\n通过以上方法构建了股票筛选器后，您可以先初步查看下筛选结果，例如：\r\n```\r\nuniverse = StockScreener(Factor.PE.nlarge(10))\r\n# 查看某一天的筛选结果\r\nuniverse.preview('2015-12-17')\r\n# 输出结果为以日期为key的字典：\r\n# {'2015-12-17': [u'000736.XSHE',  u'002151.XSHE',  u'002288.XSHE',  u'002468.XSHE',  u'002474.XSHE',  u'002639.XSHE',  u'600107.XSHG',  u'600536.XSHG',  u'600556.XSHG',  u'600764.XSHG']}\r\n```\r\n\r\n### 使用股票筛选器的例子\r\n\r\n上面我们学习了如何构建一个股票筛选器，那么如何在Quartz的回测框架中使用这个筛选器呢？\r\n\r\n使用的方法非常简单，只需要把股票池定义成筛选器就可以了：\r\n\r\n```\r\nstart = ...\r\nend = ...\r\nbenchmark = ...\r\nuniverse = StockScreener(<筛选条件表达式>) + [自定义股票列表]\r\n...\r\n\r\ndef initialize(account):\r\n    ...\r\n\r\ndef handle_data(account):\r\n    account.universe\r\n    account.screenerData\r\n```\r\n\r\n例如：\r\n\r\n```\r\nstart = '2014-01-01'\r\nend = '2015-01-01'\r\nbenchmark = 'HS300'\r\nuniverse = StockScreener(Factor.PE.nlarge(10)) + ['000001.XSHE', '600000.XSHG']\r\ncapital_base = 100000\r\nfreq = 'd'\r\nrefresh_rate = 1\r\n\r\ndef initialize(account):\r\n    pass\r\n\r\ndef handle_data(account):\r\n    for s in account.universe:\r\n        order(s,100)\r\n```\r\n\r\n当使用筛选器定义股票池之后，在每个交易日的handle_data中，account.universe中即为前一个交易日通过股票筛选器筛选出来的股票列表，再除去当日不能交易的那些股票。\r\n\r\n\r\n## 如何做个分析\r\n\r\n\r\nCode模式下，您可以在单元中调用多种金融、数学相关的函数库，包括：\r\n\r\n* `CAL`：是量化实验为固定收益及衍生品建模定制的金融分析库。\r\n* `numpy`, `pandas`, `scipy`, `matplotlib`, `mpl_toolkits`, `math`, `datetime`, `dateutil`, `talib` 等python开源函数库。\r\n\r\npython开源函数库相关的帮助说明您可以在网络中轻易获取。\r\n\r\n接下来介绍CAL的相关信息。\r\n\r\n### ** CAL（Common Analytic Library） **\r\n\r\n* 固定收益及衍生品建模\r\n* 核心以 C++ 开发，保证高性能\r\n* 有 Python 接口，方便使用\r\n\r\n相比于QuantLib，CAL在中国市场化方面做了如下努力：\r\n* 我们提供了CAL的 [详细中文文档](img/深入浅出量化实验室.pdf#page=59)\r\n* 金融工具中国市场化，QuantLib开发人员主要为欧美，直接使用后将带来局限性。我们根据正宗国市场需求定制了Shibor 市场指数、回购互换、中国国债期货等等。\r\n\r\n> 关于CAL下具体函数的使用方法，请查看 [CAL详细帮助](img/深入浅出量化实验室.pdf#page=59)\r\n\r\n## 如何编写文档\r\n\r\n\r\nMarkdown模式下，您可以通过Markdown文档、LaTeX方程、代码等行使自由编写丰富的文档内容。\r\n\r\nMarkdown是一种轻量级的标记语言，由于它简单的语法、不超过10个的标记符号，学习成本非常低，被越来越多的文档编写人员、写作爱好者所广泛使用。一单掌握了它的语法规则，会有一劳永逸的效果。\r\n\r\n>  [Markdown官方语法说明](http://daringfireball.net/projects/markdown/syntax)\r\n\r\n> [Markdown中文版语法说明](http://markdown.cn/)\r\n\r\n\r\n## 如何获取数据\r\n\r\n> 您可以在Notebook中通过调用 `DataAPI` 函数，获取债券、股票、基金、基本面、期货、指数、宏观、市场、新闻等海量数据；\r\n\r\n> 您可以在 [DataAPI帮助](data/browse) 页面中查看每个DataAPI的详细帮助文档，其中显示未购买的数据您可以在[数据商城](http://m.datayes.com) 中获得；\r\n\r\n> 您也可以在Data中上传本地txt、csv、xls、xlsx文件。\r\n\r\n### ** DataAPI **\r\n\r\n* `DataAPI.函数名称` 的方式，可以免费使用通联数据提供的债券、股票、基金、基本面、期货、指数、宏观、市场等海量数据。\r\n\r\n\r\n为了方便您的使用，我们已经将 DataAPI 作为内置函数，您无需 import`，可以直接在Code模式或Strategy模式下调用 `DataAPI`函数\r\n\r\n以下为一个简单的例子，通过 DataAPI 函数获取市场日线数据MarketEqud，并绘图。\r\n```\r\n# DataAPI.MktEqudGet返回pandas.DataFrame格式的市场日线数据\r\nMarketEqud =  DataAPI.MktEqudGet(secID = \"000002.XSHE\", beginDate = \"20000106\", endDate = \"20140110\")\r\n# 绘制返回的数据\r\nimport seaborn\r\nMarketEqud.plot(x='tradeDate', y='closePrice',title=u'the Close Price',figsize=(14,6))\r\n```\r\n\r\n* 通过`DataAPI.数据提供商缩写.函数名称` 的方式，您可以使用在 [数据商城](http://m.datayes.com) 中购买的数据。\r\n\r\n例如，您在数据商城购买恒生聚源交易所债券行情后，可以通过以下方式在Notebook中调用：\r\n```\r\nDataAPI.JY.MktBonddJYGet(secID='100213.XSHE')\r\n```\r\n\r\n\r\n### ** 数据文件 **\r\n\r\n您可以在Data标签页中上传txt、csv、xls、xlsx文件，并在Notebook中调用。\r\n\r\n* 在Notebook中的Code或Strategy单元中，您可以使用pandas读写xls、xlsx。例如：\r\n\r\n```\r\nimport pandas as pd\r\n\r\nMarketEqud.to_excel('test1.xls','Sheet1',)        # DataFrame数据写入excel文件\r\npd.read_excel('test1.xls','Sheet1')               # 读取excel文件为DataFrame数据结构\r\n```\r\n\r\n* 在Notebook中的Code或Strategy单元中，您可以使用 `read` 和 `write` 函数对Data标签页中的 txt 和 csv 文件进行读写。例如：\r\n\r\n```\r\nwrite('test2.csv','We can do all kinds of investment research in one place!')        # 写入的文件若不存在，则创建\r\nread('test2.csv')\r\n```\r\n这里默认编码方式为gbk，如果您想要使用其他编码方式，可以在write或read函数中添加encoding参数，比如：\r\n\r\n```\r\nwrite('test3.csv','We can do all kinds of investment research in one place!', encoding = 'utf-8')\r\nread('test3.csv',encoding = 'utf-8')\r\n```\r\nData标签页中的数据预览目前只支持gbk编码文件的预览。\r\n\r\n\r\n## Library是干什么的\r\n\r\nNotebook中的code单元模式可以创建为Library，创建成功后，可以像普通函数库如pandas一样在Notebook中被调用，区别于『优矿』中的其它模块，您创建的Library将是您私有的。该功能将大大提升您的代码扩展性。\r\n\r\nLibrary的使用流程为：\r\n1. 在Notebook的Code模式下编辑代码，并运行全部，确保所有code模式下的单元不报错；   \r\n2. 在Notebook的菜单栏中，点击“文件”、“创建为Library”；\r\n3. 输入Library的名称，例如 “test”，确认创建后，您可以在Library中看到 lib.test 库；\r\n4. 在需要调用该Library的Notebook中import该库，例如，`import lib.test`，其中`lib.` 是我们为您设置的自定义Library命名空间，因此此时的`lib.`是必须的。\r\n5. 然后您就可以像使用一般的函数库一样使用该Library了。\r\n\r\n这里举个最简单的例子，您可以先在Notebook中输入以下代码：\r\n```\r\ndef HelloWorld():\r\n    print 'Hello World!'\r\n\r\nclass SampleClass:\r\n    def HelloWorld(self):\r\n        print 'Hello World! Again'\r\n```\r\n代码运行正常后，选择创建为Library，并命名为test，您在当前的Notebook或新建的Notebook中使用该模块了：\r\n```\r\nimport lib.test as t  \r\n\r\nt.HelloWorld()              # 输出中打印 Hello World!\r\n\r\nsample = t.SampleClass()\r\nsample.HelloWorld()         # 输出中打印 Hello World! Again\r\n\r\n```\r\n\r\n注意：\r\n* 只有Code单元模式下的代码会被创建为Library，其他单元模式如Markdown、Strategy，将会被忽略；\r\n\r\n\r\n## 模拟交易是干什么的\r\n\r\n> 模拟交易功能让您在不需要实际投资的情况下，观察策略在真实市场中的实时表现。\r\n\r\n> 模拟交易是程序化策略中必不可少的步骤。在模拟交易过程会暴露出例如过度拟合等问题，降低您在真实投资中的风险。\r\n\r\n> 本模拟交易功能中，将根据您的策略代码于每天早上开市之前生成下单指令，下单指令的执行由通联数据旗下的PMS系统提供支持。\r\n\r\n> 日内策略暂不支持模拟交易功能\r\n\r\n『优矿』提供您在策略回测后，一键进行策略的模拟交易。\r\n\r\n模拟交易功能的功能流程为：\r\n\r\n* 创建模拟交易时，根据策略的起始资金等参数设置，创建模拟证券账号\r\n* 每天早上开市之前时间运行 `handle_data` 函数，生成当天的交易信号\r\n* 每天开始后，将交易信号下达至后台PMS系统，由PMS系统处理订单的成交情况\r\n\r\n例如，您在周一晚上19:00在Notebook strategy模式下输入以下代码，写了每只股票每天购买100股的策略：\r\n\r\n```\r\nstart = '2014-01-01'                       # 回测起始时间\r\nend = '2015-01-01'                         # 回测结束时间\r\nbenchmark = 'HS300'                        # 策略参考标准\r\nuniverse = ['000001.XSHE', '600000.XSHG']  # 证券池，回测支持股票和基金\r\ncapital_base = 100000                      # 起始资金\r\nrefresh_rate = 1                           # 调仓频率，即每 refresh_rate 个交易日执行一次 handle_data() 函数\r\n\r\ndef initialize(account):                   # 初始化虚拟账户状态\r\n    pass\r\n\r\ndef handle_data(account):                  # 每个交易日的买入卖出指令\r\n    for stock in account.universe:\r\n        order(stock,100)\r\n```\r\n\r\n策略回测运行成功后，点击该单元输出右上角的 “模拟交易” 按钮，输入策略名称后点击 “开始模拟”，此时您将在 [『模拟交易』](trade/strategies/) 页面看到您刚刚创建的策略，点击策略名称，进入模拟交易详情页面，可以查看该策略的业绩表现、日志、代码等信息。\r\n\r\n由于当前为非交易时间，策略会先执行 `initialize` 函数部分，等到第二天交易时间之前（周二9:30之前），平台会自动运行 `handle_data` 函数生成当天的下单指令，下单指令可以在策略概览的调仓记录中查看，由于是非交易时间，显示“准备下单”状态。\r\n\r\n等到9:30之后，系统会将当天的所有下单指令发送至后台PMS（组合管理系统）进行模拟交易。您可以在模拟交易详情页面中的调仓记录中查看每个订单的成交情况。\r\n\r\n若模拟交易创建时间为交易时间，则策略会依次运行 `initialize` 函数和 `handle_data` 函数生成下单指令，并且该下单指令会立马进行模拟成交。\r\n\r\n\r\n### 模拟交易日志\r\n\r\n模拟交易中支持两种日志：\r\n\r\n* 系统日志，共有三种系统类型，本平台会将策略运行中的一些运行错误信息、错误后修复等信息在日志中显示，若对日志内容有疑问，可以邮件联系 service.uqer@datayes.com 或者电话 4000-820-386 ：\r\n\r\n  * [SYS FATAL]: 策略出现严重错误，可能为内存过大、`initialize` 函数运行出错等原因，策略将会停止。\r\n  * [SYS ERROR]: 策略出现错误，可能为当天`handle_data` 函数运行错误、系统服务不稳定等原因，只影响策略当天生成的下单指令，策略未来会继续运行。\r\n  * [SYS INFO]:  表示策略状态，一般为成功操作的提示。\r\n\r\n* 用户自定义日志：\r\n\r\n  * 您可以在策略代码中使用 `log` 相关函数，回测中，您将看到该函数会有类似print的输出，模拟交易中，您将在日志中看到对应的输出。\r\n  * log相关函数有4种:\r\n    * `log.info('message')` : 在模拟交易中显示 [INFO] 日志。\r\n    * `log.debug('message')` : 在模拟交易中显示 [DEBUG] 日志。\r\n    * `log.error('message')` : 在模拟交易中显示 [ERROR] 日志。\r\n    * `log.warn('message')` : 在模拟交易中显示 [WARN] 日志。\r\n\r\n平台每天晚上会对日志进行回收，保留最近的100条日志在模拟交易中显示。\r\n\r\n### 模拟交易与回测的差异\r\n\r\n1. 模拟交易中，`capital_base` 参数只支持变量；\r\n2. 模拟交易中，`start`, `end`, `csvs`, `stock_base`, `slippage`, `commission`等参数会被忽略 ；\r\n3. 模拟交易中，只能整手地购买股票，但可以以股为单位卖出；\r\n4. 模拟交易中，每个交易日运行 `handle_data` 时发生的运行错误，只影响当天下单不成功，不影响第二天的下单状态；\r\n5. 模拟交易中，订单数量按整数手处理，即订单量除以100后向下取整。\r\n\r\n\r\n## 如何进行实盘交易\r\n\r\n您可以通过参加量化大赛赢取实盘管理资金的资格，优矿出资金，您出策略，亏损算优矿，超额收益全归您，可查看大赛页面了解详情： [500万实盘量化大赛](contest/home/)\r\n\r\n未来您还可以在优矿中使用自己的资金，进行实盘操作。该功能即将推出，敬请期待！\r\n\r\n\r\n## 如何玩转『优矿』\r\n\r\n\r\n* **代码补全**：单元为Code或Strategy模式时，输入部分变量或函数，按 Tab 键后，会进行代码自动补全，若有多个选项时，显示补全列表。\r\n* **帮助面板**：单元为Code或Strategy模式时，输入“完整的变量名称或函数名称+？”，运行后，在界面右下方会显示该变量或函数的帮助面板。（请克隆本文档后，尝试运行下方代码）\r\n* **Notebook状态**：\r\n    * 当一个单元处于运行中或等待运行时，其单元边框会变为绿色，页面右下方的状态栏中会显示绿色圆点，并提示开始运行；\r\n    * 若单元运行结束，其边框颜色会恢复成蓝色，若Notebook中所有单元都运行结束，页面右下方状态栏的绿色圆点会变回灰色，并提示运行完毕。\r\n    * Notebook自动保存、重启、网络连接等状态将在页面右下方状态栏中以文字显示。\r\n* **Notebook快捷键**， Notebook中支持sublime中的大部分快捷键，常用快捷键例如：\r\n    * Ctrl+i —— 光标在函数的括号中时，提示该函数的参数列表\r\n    * Ctrl+S —— 保存当前Notebook\r\n    * Tab —— 光标前面有代码时，显示代码提示；光标前无代码时，则缩进\r\n    * Ctrl+Enter —— 运行当前\r\n    * Shift+Enter —— 运行并继续\r\n    * Ctrl+/ —— 注释整行/撤销注释\r\n    * Ctrl+Z —— 撤销当前单元操作\r\n    * Ctrl+Y —— 恢复当前单元撤销\r\n    * Ctrl+[ —— 多行/当前行去除缩进\r\n    * Ctrl+] —— 多行/当前行缩进\r\n    * Ctrl+D —— 选择当前光标附近的字符串，多次按键，可选择同一单元中的相同字符串，多用于替换等操作\r\n    * Ctrl+Shift+D —— 复制并粘贴当前行\r\n    * Ctrl+J —— 与下一行合并\r\n    * Ctrl+L —— 选择一行\r\n    * Shift-Ctrl-Up —— 交换上一行代码\r\n    * Shift-Ctrl-Down —— 交换下一行代码\r\n    * Alt+Left —— 向左移动一个字符串\r\n    * Alt+Right —— 向右移动一个字符串\r\n* **分享到社区**：每个Notebook都可以一键分享到『社区』，在Notebook页面标题右方您会看到分享的按钮。分享到社区后，您的Notebook将会被所有人看到。\r\n* **从社区克隆**：您在社区看到的任何感兴趣的Notebook分享，都可以一键克隆至自己的研究环境 —— 『开始研究』页面。克隆后，您对该Notebook编辑等等改变都是私有的。\r\n\r\n\r\n## 开始研究FAQ\r\n\r\n1. 策略回测结果中策略收益无论涨跌比例都很小，为什么？  \r\n\r\n  请检查参数 capital_base 的数值，如果数值过大而下单的股票数量较小的话，则会出现策略收益过小的情况。\r\n\r\n2. 策略回测时，下单买入股票时现金不够了，会发生什么？  \r\n\r\n  此单会成交一部分，从输出的回测报告中调出当天的 blotter 细节，可以看到 Order 里有一个属性是 filled，这个属性即是指这一笔 Order 成交的数量。\r\n\r\n3. 策略回测时，有时候 Order 不能成交，为什么？\r\n\r\n  如果是买入的话，原因是当天该股票停牌，即该股票交易量为0；如果是卖出的话，原因是虚拟账户中没有足够多的该股票。\r\n\r\n4. 策略回测中遇到涨跌停怎么办？\r\n\r\n  Quartz 处理了 涨跌停、停牌、未上市 等事件下的情况，具体可以参见 数据预处理 章节\r\n\r\n5. 策略回测时，如果买卖数量较大，都能成交吗？\r\n\r\n  Quartz 对交易的判断所用买卖数量上限是当日的交易量，如果指令数量超出了该股票当日交易量，只会成交相当于当日交易量的部分。\r\n\r\n\r\n\r\n## 500万实盘量化大赛FAQ\r\n\r\n1. 500万实盘量化大赛的日程安排是怎么样的？\r\n\r\n    * 第一期：提交策略阶段从8月18日至9月14日，正式排名阶段从9月15日至10月22日，实盘阶段从11月23日至12月18日；\r\n    * 第二期：提交策略从9月15日至10月22日，正式排名从10月23日至11月22日，实盘从12月21日至1月15日；\r\n    * 第三期：提交策略从10月23日至11月22日，正式排名从11月23日至12月22日，实盘从1月18日至2月19日；\r\n    * 第四期：提交策略从11月23日至12月25日，正式排名从12月26日至1月22日，实盘从2月22日至3月18日；\r\n    * 第五期：提交策略从12月26日至1月25日，正式排名从1月26日至2月29日，实盘从3月21日至4月15日；\r\n    * 后续日程安排敬请期待\r\n\r\n2. 我如何报名参加大赛？\r\n\r\n  1）无需报名，只需注册成为优矿用户；\r\n\r\n  2）进入开始研究页面，提交策略参加大赛，详细参赛方法请参考 [优矿量化大赛循环赛参赛方法](contest/guide)。\r\n\r\n3. 我的策略中应该注意什么？  \r\n\r\n  大赛的评分由两部分组成：回测积分以及模拟盘积分.\r\n\r\n  提交的参赛策略后，系统会将策略中的参数按照如下设置，运行回测，根据该回测结果计算回测积分：\r\n```\r\nstart = '2012-08-01'\r\nend = '2015-08-01'\r\nbenchmark = 'HS300'\r\ncapital_base = 1000000\r\ncsvs = []\r\nsecurity_base = {}\r\ncommission = Commission(buycost=0.0008, sellcost=0.0018)  # 佣金万八\r\nslippage = Slippage()\r\n```\r\n\r\n  **提交参赛后，您当前策略所在的Notebook会被后台用于执行该策略的回测，从而处于无法运行的状态，当您提交的策略回测结束后，Notebook可以正常使用。**\r\n\r\n  模拟交易过程中，策略中的部分参数会按照如下设置运行：\r\n```  \r\ncapital_base = 1000000\r\ncsvs = []\r\nsecurity_base = {}\r\ncommission = Commission(buycost=0.0008, sellcost=0.0018)  # 佣金万八\r\nslippage = Slippage()\r\n```\r\n\r\n4. 为什么我提交的策略大赛状态显示“停止参赛”？\r\n\r\n  以下3种情况下你的策略会显示“停止参赛”\r\n\r\n  1）“回测错误”：若您在“策略状态”栏中看到该策略状态为“回测错误”，您可以在Notebook中将您的参赛策略按照第2点描述的回测参数设置，运行后查看回测错误原因。\r\n\r\n  2）“回测超时”：若您在“策略状态”栏中看到该策略状态为“回测超时”，是由于您的参赛策略所在的Notebook微核被关闭，或策略回测时间超过2小时，请检查Notebook的微核状态，或优化策略将回测运行时间缩减至5小时以内。\r\n\r\n  3）“终止”：若您在“策略状态”栏中看到该策略状态为“终止”，是由于您的手动终止了该参赛策略。\r\n\r\n5. 为什么我的参赛策略状态显示 “异常”？\r\n\r\n  策略状态“异常”后，您的策略不会继续参赛。\r\n\r\n  有较多原因会导致你的策略状态显示异常，如果您检查您的策略代码没有问题，可以联系我们帮您重启策略。邮件 lianghua@datayes.com , 或电话 4000 820 386 ，或在社区中进行提问。\r\n\r\n## 积分FAQ\r\n\r\n优矿的积分点数（简称优点）是优矿对活跃用户的一种激励。用户可以通过登录、分享策略或研究、答复其他用户的疑问、积极参与优矿组织的活动等行为获得积分；而获得其他用户的克隆、点赞、关注你等方式也会为增加积分哦。优矿的积分可以用来兑换研究策略时所需要的资源（内存等），今后也可以兑换更多的奖品（如通联特色数据、研报、周边产品、甚至和其他平台的积分进行兑换）。\r\n\r\n1. 积分是什么？\r\n\r\n    优矿的积分点数（简称优点）是优矿对活跃用户的一种激励，在优矿平台内可作为通用货币，兑换各种资源和其他奖励。\r\n\r\n2. 积分有什么作用？\r\n\r\n    目前，积分可兑换开始研究环境下的内存。（开始研究环境中策略运行可使用的虚拟机分配的内存上限。内存越大，研究时涵盖的股票池可以更大，回测周期可以更长。例如：一个涉及全A股过去2年数据的策略，可能需要2G的内存。）[点击前往兑换内存](community/mall)\r\n\r\n    今后，我们会提供更多奖品给到大家，除了优矿的其他资源外，还会有通联特色数据、研报、周边产品（Uqer的文化衫、擦眼镜布、钥匙扣）、实物奖品（iphone）、甚至和其他平台的积分进行兑换（航空里程、Q币、比特币maybe）。\r\n\r\n    敬请期待！\r\n\r\n3. 如何获得积分？\r\n\r\n    主要有三种方式获得积分：\r\n\r\n    a. 多多使用优矿平台：每天登录、[分享策略或研究](labs/)、[答复其他用户的疑问](community/)等行为可以获得积分；\r\n\r\n    b. 给优矿社区提供[高质量内容](community/)：获得其他用户的克隆、点赞、收藏、关注等方式也会增加积分；（被推荐、加精华的好帖，管理员会额外赠送积分哦）\r\n\r\n    c. 积极参与[优矿的各项活动](contest/home/)：获得作为奖品的积分；\r\n\r\n    d. 每个注册用户都会获得500积分的欢迎礼，不谢。\r\n\r\n4. 积分可以转让吗？\r\n\r\n    积分以帐号为单位，不可以转移给其他帐号。\r\n\r\n5. 为什么我发了一个帖子却没有获得积分？\r\n\r\n    首先，不是所有的发帖都有积分奖励哦，只有分享策略和研究才能获得积分。提问是没有积分的哦；\r\n\r\n    然后，每天每个类型的积分奖励是会有一个上限的，为了控制社区中帖子的普遍质量；\r\n\r\n    最后，如果你觉得“我不服，我发了好几个帖子，超了奖励上限，但是都是好帖“，那么欢迎发送邮件到 service.uqer@datayes.com ，向我们的美女客服”讨个说法“。\r\n\r\n6. 为什么我的积分变少了？\r\n\r\n    部分获取积分的行为是可撤销的，一旦撤销，所赠送的积分也会相应扣除。比如：删除了分享的策略，其他用户取消了点赞，取消了对你的关注等。\r\n\r\n7. 哪里能看到我的积分明细？\r\n\r\n    积分商城的第二个tab页可以看到积分兑换的明细。[点击前往积分明细](community/exchange)\r\n\r\n    积分获取的明细，数量庞大、内容繁琐，因此目前还没有直接的展示页面，如需要查询，欢迎发送邮件到 service.uqer@datayes.com ，让我们的开发帅哥给你导。\r\n\r\n8. 为什么要兑换奖品，比如：开始研究环境内存？\r\n\r\n    开始研究环境中策略运行可使用的虚拟机分配的内存上限。\r\n\r\n    内存越大，研究时涵盖的股票池可以更大，回测周期可以更长。\r\n\r\n    例如：一个涉及全A股过去2年数据的策略，可能需要2G的内存。\r\n";
},function(e,t,n){var i,r;i=[n(45),n(49),n(90),n(47),n(240),n(241)],r=function(e,t,n,i,r,o){return t.ItemView.extend({className:"changelog",template:r,ui:{content:".content"},onRender:function(){this.ui.content.append(n(o)),i.vent.trigger("title","变更日志")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="content"></div>\n';return __p}},function(e,t){e.exports="## 2016-1-14 更新\n\n1. quartz中新增account.valid_seccost、account.previous_date参数，分别表示股票的平均持仓成本和前一交易日。\n\n2. 新增list_files()函数，用于返回Data目录下的所有文件的名称列表。\n\n3. 修复社区用户反馈的参赛策略capital_base未统一问题。\n\n\n## 2016-1-6 更新\n\n1. 新增代码提示功能，使用方法为:\n\n    * 输入代码的时候，按tab键，则会显示代码补全提示以及代码帮助，按enter键则会自动补全。\n    * 上述enter键补全代码后，如果是函数，则会提示该函数的参数列表。\n    * 光标放在函数的括号内，按ctrl+i，则会提示该函数的参数列表。\n\n2. 修复stockerscreener中pct_range排序问题。\n\n3. 优化Alpha对冲模型框架——MFHandler的细节数据处理，MFHandler的用法可以参考[量化分析师的Python日记【第14天：如何在优矿上做Alpha对冲模型】](https://uqer.io/community/share/55e662f9f9f06c1ea481f9cf)。\n\n\n## 2015-12-22 更新\n\n1. StockScreener支持模拟交易，并在回测中新增preview功能。功能详情查看 [如何使用股票筛选器](help/faq/#如何使用股票筛选器) 。\n\n2. DataAPI支持长参数，修复股票参数长度过长报错问题。\n\n3. 回测和模拟交易中的基金行情数据使用前复权。\n\n4. 优化快速回测功能。功能详情查看 [《深入浅出量化实验室》](https://uqer.io/img/深入浅出量化实验室.pdf) 的Chapter 8。\n\n5. 新增sympy、PyWavelets、networkx三方库的支持。\n\n## 2015-12-14 更新\n\n1. 上线积分体系及兑换商城。 [什么是积分？](help/faq/#积分FAQ)\n\n2. 上线积分兑换开始研究环境内存功能。\n\n## 2015-11-26 更新\n\n1. 优化股票筛选器调用方式。将Factor中因子的方式更改为：```Factor.PE.nlarge(10)```，方法更新前的调用方式将不支持。\n\n2. 升级DataAPI，新增基金前复权行情等数据。\n\n3. 修复模拟交易中下单数量不准确问题。\n\n4. quartz中移除对csvs参数的支持。\n\n5. 修复开始研究中的部分问题。\n\n## 2015-11-10 更新\n\n1. 开始研究中新增回测详情功能，更加方便查看。\n\n2. 优化策略回测风险收益指标公式：将Alpha计算公式里的年化收益率从单利计算改为复利计算。\n\n3. 优化模拟交易页面。\n\n4. 优化社区界面，包括代码显示方式。\n\n5. 优化策略回测结果：bt表格中的security_position列数据格式更改为字典类型。\n\n## 2015-10-29 更新\n\n1. 社区更丰富的个人主页。\n\n2. 社区新增收藏、关注帖子。\n\n3. 升级模拟交易功能，优化模拟交易性能。\n\n4. 修复社区用户反馈的整百下单后零头无法卖出等问题。\n\n\n## 2015-10-22 更新\n\n1. 大赛模拟盘中下单后做合规处理，具体订单要求见大赛策略要求。\n\n2. 升级模拟交易，提升模拟交易稳定性并优化性能。\n\n3. 优化策略框架：order、order_to回测时做取整处理；account.universe在回测和模拟盘中都剔除当日停牌、退市股票；修复一些细节问题。\n\n\n## 2015-09-25 更新\n\n1. 提升策略重复运行速度，策略调试时间大幅降低。\n\n2. 开始研究、我的交易中显示CPU、内存、磁盘等资源使用情况。优矿为每位用户提供隔离私密的云端环境，保障数据安全性。\n\n## 2015-09-14 更新\n\n1. 优化社区\n\n2. 优矿中国行上线\n\n3. 大赛进入第二期\n\n## 2015-09-10 更新\n\n1. 优化大赛未达标原因提示\n\n\n## 2015-08-18 更新\n\n1. 优矿推出500万实盘量化大赛，亏损部分由优矿承担，超额收益全归您！  详情请查看 [500万实盘大赛](contest/home/)\n\n2. 日间策略支持股票筛选器功能，您可以自定义因子数据的筛选条件，通过几行代码快速构建动态股票池。\n\n3. 取消CAL预加载： 为了提升您的资源使用效率，取消了CAL在Notebook中的预加载，未来您使用CAL函数库时需要提前输入\n\n    ```\n    import CAL.PyCAL as CAL\n    ```\n\n4. 修复模拟交易中若干问题。\n\n## 2015-07-16 更新\n\n1. Notebook中支持日内策略，即您可以使用分钟线回测。 具体使用方法参考 [如何写个策略](https://uqer.io/help/faq/#如何写个策略) 的 **如何写个日内策略** 章节。\n\n2. 可以在开始研究Notebook页面查看当前研究环境的资源信息。\n\n    优矿的“开始研究”以及“模拟交易”环境皆为独立隔离的虚拟环境，为每个用户的策略安全保驾护航。\n\n    您现在可以看到当前环境的CPU、内存、硬盘等资源配置信息。\n\n3. 策略回测结果动态显示，策略运行的进度更加清晰。您可以通过运行Notebook中的Strategy单元体验该功能。\n\n## 2015-07-09 更新\n\n1. 社区新增发布讨论功能，并支持部分标准Markdown语法\n\n2. 社区回复支持部分标准Markdown语法\n\n3. 修复用户反馈的策略（quartz）部分问题，包括：\n\n    * account.get_history()数据中closePrice、openPrice等数据错误异常\n    * 有初始持仓时，收益率异常\n    * referencePrice 第0天价格异常\n    * 未上市股票 portfolio_value异常\n\n## 2015-06-30 更新\n\n1. 参赛策略回测的年化收益统一设置为复利计算。\n\n2. 修复模拟交易详情页面出现的夏普比率不一致、回撤走势第一天值为0的问题。\n\n3. 修复调仓记录中的证券名称无法显示问题。\n\n\n## 2015-06-18 更新\n\n1. 通联量化实验室正式更名为 **“优矿”** ，您可以通过 [uqer.io](https://uqer.io) 访问，若您通过 q.datayes.com 、app.wmcloud.com/mecury 等域名访问都将跳转到相应的 www.uqer.io 域名。\n\n2. 新增 “模拟交易业绩表现”页面：\n\n    在模拟交易页面点击策略名称，您将看到该策略的业绩表现、持仓、调仓记录、风险指标、日志等信息。\n\n    调仓记录中，会记录所有通过handle_data函数运行出来的下单指令，并按照下单先后顺序排列，并在状态等列中标志该订单的成交情况。\n\n    但是6月18号之前的调仓记录中，只显示在PMS系统中有记录的下单指令，部分无法成交的订单将不会再显示。\n\n3. 新增模拟交易日志功能：\n\n    您可以在策略中使用 `log.info('message')`、`log.debug('message')`、`log.error('message')`、`log.warn('message')`四个函数，用于在模拟交易的日志中查看`message`信息。\n\n    平台每天晚上会对日志进行回收，保留最近的100条日志在模拟交易中显示。\n\n4. 修复策略框架（quartz）若干问题：\n\n    * 回测时，bt的blotter列中增加Order的state属性，用于表示该股票当天涨停、跌停、停牌状态。\n    * set_universe支持指定日期，方式为 set_universe('HS300', '20150101')，表示获取2015年1月1日的沪深300股票列表，解决生存者偏差问题。\n    * 模拟交易中的account.universe清除退市股票。\n    * 修复bt为空时，perf运行失败。\n    * 修复模拟交易过程中当universe中有重复股票时，获取历史数据失败问题。\n\n5. DataAPI使用帮助，增加API的概要描述、非通联数据提供的DataAPI增加一键购买链接。\n\n> 非常感谢 **中科大-Fuchao**、**pku_ss-严正**、**中科大 xlcc**、**符城**等用户为我们指出产品中的不足！\n\n\n\n## 2015-06-04 更新\n\n1. 开始研究中增加了 “**策略生成器**” 功能：\n\n  * 您可以通过可视化配置的方式，自动生成热点主题策略代码。您可以在开始研究首页的“**策略生成器**”按钮、或者Notebook中的单元之间的 “**策略**” 按钮，使用该功能。\n\n  * 您可以通过策略生成器，快速生成热点主题的策略，也可以通过它一步步学会简单的主题投资策略的代码生成过程。\n\n  * 策略生成器提供当天涨跌榜top10主题，选择主题中的股票作为股票池，对股票进行权重配置，生成的策略将根据调仓频率与股票权重配置进行调仓。\n\n2. 大赛排名显示 **模拟盘得分** 作为参考分数：\n\n   * 大赛第二阶段会根据 **30%回测得分 + 70%模拟盘得分** 进行策略排名，为了让参赛者对大赛第二阶段有个适应，在大赛排名页面新增模拟盘得分作为参考。\n\n   * 模拟盘得分每天12：00、16:00更新。\n\n   * 大赛第一阶段时，即2015年5月18日-6月19日期间，总分仍然等于回测得分，模拟盘得分根据每个策略发布日期开始进行计算。\n\n   * 大赛第二阶段时，即2015年6月23日-7月24日期间，总分 = 30%回测得分 + 70%模拟盘得分，该阶段模拟盘得分只计算2015年6月23日-7月24日期间的表现，2015年7月24日15:00的总分代表该策略本次大赛的最终得分。\n\n\n## 2015-05-26 更新\n\n1. 社区中，增加讨论回复、@功能；\n\n2. 社区中，被赞、被@、分享的notebook被讨论，都可以在页面右上角查看消息通知。\n\n3. Quartz中修复，回测第一天的`account.referencePrice` 与 `account.get_history` 不一致问题。\n\n## 2015-05-14 更新\n\n1. **通联杯量化策略大赛** 正式启动，提供高额奖金与名企实习机会，前往 [大赛](contest) 页面参赛，“码”上量化未来吧！\n\n2. 在策略中调取历史数据，不再受 `longest_history` 参数限制，代码更灵活。\n\n  上个版本推出后，我们一直致力于为您提供极致的策略研发体验。舍去了 `longest_history` 参数的设置，您在 `handle_data` 中调用 `account.get_attribute_history`，`account.get_symbol_history`，`account.get_history` 函数获取证券历史数据时，历史窗口的长度不再受 `longest_history` 参数设置的限制，其他使用方法不变。\n\n  例如您的策略可以用如下方式调用历史数据：    \n   ```\n   start = '2014-01-01'                       # 回测起始时间\n   end = '2015-01-01'                         # 回测结束时间\n   benchmark = 'HS300'                        # 策略参考标准\n   universe = ['000001.XSHE', '600000.XSHG']  # 证券池，回测支持股票和基金\n   capital_base = 100000                      # 起始资金\n   refresh_rate = 1                           # 调仓频率，即每 refresh_rate 个交易日执行一次 handle_data() 函数\n\n   def initialize(account):                   # 初始化虚拟账户状态\n       pass\n\n   def handle_data(account):                  # 每个交易日的买入卖出指令\n       all_close_prices = account.get_attribute_history('closePrice', 10) #   \n   ```\n  此次更新兼容 `longest_history` 参数设置。\n\n\n## 2015-04-28 更新\n\n本更新带来了更加丰富便捷的回测功能，并在回测运行效率上做了巨大提升。\n\n更新包括：\n\n1. **回测使用的前复权价格**\n\n  股票价格受拆分、股息等事件的影响，股价会出现大幅的变动。\n\n  我们在quartz中对股价和成交量进行了权息修复，即使用了前复权股价，您在strategy单元模式下，进行回测时不必关心股票的拆分、股息等事件的影响。\n\n  前复权的数据您可以通过调用DataAPI进行校验查看，例如：\n  ```\n   DataAPI.MktEqudAdjGet(ticker=u\"000001\")\n  ```\n\n2. **quartz中处理了开盘涨跌停**\n\n    当天股票涨停则该股票无法买入，当天股票跌停则该股票无法卖出。\n\n3. **支持基金回测**\n\n  quartz中增加对基金的回测，目前quartz支持股票、基金的日间策略的回测，同时模拟交易也支持上市基金(ETF或LOF)。\n\n   例如下述每个证券每天买100股的例子：\n    ```   \n   start = '2014-01-01'                       # 回测起始时间\n   end = '2015-01-01'                         # 回测结束时间\n   benchmark = 'HS300'                        # 策略参考标准\n   universe = ['000001.XSHE', '510050.XSHG']  # 证券池，000001.XSHE是股票，510050.XSHG是基金\n   capital_base = 100000                      # 起始资金\n   longest_history = 0                        # handle_data 函数中可以使用的历史数据最长窗口长度\n   refresh_rate = 1                           # 调仓频率，即每 refresh_rate 个交易日执行一次 `handle_data()` 函数\n\n   def initialize(account):                   # 初始化虚拟账户状态\n       pass\n\n   def handle_data(account):                  # 每个交易日的买入卖出指令\n       for s in account.universe:\n           order(s,100)\n    ```\n\n4. **关于昨日收盘价和组合估值 **\n\n   新版quartz新增了虚拟账户account中的reference系列属性以供使用\n   ```\n   # 新版quartz新增了虚拟账户中的reference系列属性以供使用\n   def handle_data(account):\n       account.referencePortfolioValue # float，按昨日收盘价算出的组合估值（现金+证券）\n       account.referencePrice          # dict，昨日收盘价，键为证券ID，值为价格\n       account.referenceReturn         # dict，昨日收益率（收盘/前一日收盘-1），键为证券ID，值为收益率\n    ```\n\n   由此带来的策略代码方面的便捷有：\n\n   1) **获取昨日收盘价估值**;\n\n   原来：\n   ```\n   stock = '000001.XSHE'\n   account.hist[stock]['closePrice'].iloc[-1]\n    ```\n   现在：\n   ```\n   stock = '000001.XSHE'\n   account.referencePrice[stock]\n    ```\n    2) **估算投资组合价值**\n\n   原来：\n   ```\n   c= account.cash\n   for stock, am in account.stkpos.items():\n       c += account.hist[stock]['closePrice'].iloc[-1]\n   ```\n   现在：\n   ```\n   c = account.referencePortfolioValue    \n   ```\n\n\n\n###  对用户的影响\n\n由于版本为了提升策略运行效率，quartz在架构上做了较大调整，会导致您的部分策略无法运行。\n\n如果您的策略代码中出现如下情景，请按照指示进行调整。\n\n我们对给您带来的不便深表歉意，在未来的版本更新中，我们会尽全力做到向下兼容。\n\n1. **关于使用历史数据：**\n\n   如果您的策略中用 `add_history` 的方式获取了历史数据窗口，例如：\n   ```\n   def initialize(account):\n       add_history('hist', 10)\n\n   def handle_data(account):\n       account.hist['000001.XSHE']['closePrice']...\n       account.hist['000002.XSHE']['turnoverValue']...\n   ```\n\n   您需要修改为：\n\n   ```\n   longest_history = 10     # 必不可少的参数，最长历史窗口长度作为参数进行定义，任何小于该历史窗口的数值都可以取用\n\n   def initialize(account):  # 不再需要add_history了\n       pass\n\n   def handle_data(account):\n       # 为了使您调用历史数据更加便捷，我们提供了三种获取历史数据的方式\n\n       all_close_prices = account.get_attribute_history('closePrice', 10) # 第二个参数小于等于longest_history的数值均可，返回所有证券最近n个交易日的收盘价列表\n       # all_close_prices == {\n       #    '000001.XSHE': array([ 16.36,  16.54,  16.3 ,  16.65,  17.  ,  16.93,  16.3 ,  16.56, 16.95,  16.66]),\n       #    '600000.XSHG': array([ 17.53,  18.03,  17.89,  17.96,  18.65,  18.6 ,  17.9 ,  18.16, 18.5 ,  18.22])\n       # }\n\n       single_symbol_history = account.get_symbol_history('000001.XSHE', 5) # 第二个参数小于等于longest_history的数值均可，返回某只证券最近n个交易日的行情数据\n       # single_symbol_history == {\n       #    'closePrice': array([ 16.93,  16.3 ,  16.56,  16.95,  16.66]),\n       #    'turnoverValue': array([  4.44733303e+09,   5.77643795e+09,   3.94335705e+09, 4.64033583e+09,   3.89352207e+09]),\n       #    'turnoverVol': array([  2.60952337e+08,   3.44725740e+08,   2.41593696e+08, 2.77314172e+08,   2.31968840e+08]),\n       #    'lowPrice': array([ 16.8 ,  16.16,  15.98,  16.5 ,  16.56]),\n       #    'highPrice': array([ 17.5 ,  17.2 ,  16.7 ,  16.98,  17.04]),\n       #    'openPrice': array([ 17.5 ,  17.1 ,  16.32,  16.58,  16.98]),\n       #    'preClosePrice': array([ 17.  ,  16.93,  16.3 ,  16.56,  16.95])\n       # }\n\n       # get_symbol_history还有以下两种用法：\n\n       benchmark_history = account.get_symbol_history('benchmark', 5)\n       # benchmark_history == {\n       #    'closeIndex': array([ 4596.136,  4521.919,  4619.164,  4739.814,  4740.892]),\n       #    'return': array([ 0.01829825, -0.01614769,  0.02150525,  0.02611944,  0.00022744]),\n       #    'preCloseIndex': array([ 4513.546,  4596.136,  4521.919,  4619.164,  4739.814])}\n\n       trading_days = account.get_symbol_history('tradeDate', 5)\n       # trading_days == [\n       #     datetime.datetime(2015, 4, 17, 0, 0),\n       #     datetime.datetime(2015, 4, 20, 0, 0),\n       #     datetime.datetime(2015, 4, 21, 0, 0),\n       #     datetime.datetime(2015, 4, 22, 0, 0),\n       #     datetime.datetime(2015, 4, 23, 0, 0)\n       # ]\n\n       all_history = account.get_history(3) # 参数小于等于longest_history的数值均可，，返回所有证券最近n个交易日的行情数据\n       # all_history == {\n       #    '000001.XSHE': {\n       #        'closePrice': array([ 16.56,  16.95,  16.66]),\n       #        'turnoverValue': array([  3.94335705e+09,   4.64033583e+09,   3.89352207e+09]),\n       #        'turnoverVol': array([  2.41593696e+08,   2.77314172e+08,   2.31968840e+08]),\n       #        'lowPrice': array([ 15.98,  16.5 ,  16.56]),\n       #        'highPrice': array([ 16.7 ,  16.98,  17.04]),\n       #        'openPrice': array([ 16.32,  16.58,  16.98]),\n       #        'preClosePrice': array([ 16.3 ,  16.56,  16.95])\n       #     },\n       #    '600000.XSHG': {\n       #        'closePrice': array([ 18.16,  18.5 ,  18.22]),\n       #        'turnoverValue': array([  6.61554064e+09,   7.71213068e+09,   6.67554199e+09]),\n       #        'turnoverVol': array([  3.68194681e+08,   4.20766743e+08,   3.63593631e+08]),\n       #        'lowPrice': array([ 17.75,  18.08,  18.11]),\n       #        'highPrice': array([ 18.19,  18.55,  18.64]),\n       #        'openPrice': array([ 17.75,  18.3 ,  18.5 ]),\n       #        'preClosePrice': array([ 17.9 ,  18.16,  18.5 ])\n       #    },\n       #    'benchmark': {\n       #        'closeIndex': array([ 4619.164,  4739.814,  4740.892]),\n       #        'return': array([ 0.02150525,  0.02611944,  0.00022744]),\n       #        'preCloseIndex': array([ 4521.919,  4619.164,  4739.814])\n       #    },\n       #    'tradeDate':\n       #        [datetime.datetime(2015, 4, 21, 0, 0),\n       #         datetime.datetime(2015, 4, 22, 0, 0),\n       #         datetime.datetime(2015, 4, 23, 0, 0)]\n       # }\n   ```\n\n2. **关于证券头寸 **\n\n   由于支持了基金数据，所以所有包含stkpos（表示stock_position）的属性名称改成了secpos（表示security_position）\n   例如您原来的代码：\n   ```\n   def handle_data(account):\n       account.stkpos.get(stock, 0)\n   ```\n   现在：\n   ```\n   def handle_data(account):\n       account.secpos.get(stock, 0)\n   ```\n\n   此外，quartz在account中加入了valid_secpos属性，数据格式为list，记录了当前持有数量为正的股票仓位，因为判断当前股票是否有持仓的方式需要做如下修改：\n\n   原来：\n   ```\n   if account.stkpos.get(stock, 0) == 0:\n       ...\n\n   if account.stkpos.get(stock, 0) > 0:\n       ...\n   ```\n   现在：\n   ```\n   if stock not in account.valid_secpos:\n       ...\n\n   if stock in account.valid_secpos:\n       ...\n   ```   \n3. **关于模拟交易：**\n\n   您当前的模拟交易由于代码兼容，将被停止，需要您按照上述指示修改代码并重新发布。\n"},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(47),n(123),n(243),n(244),n(245)],r=function(e,t,n,i,r,o,a,s){return n.LayoutView.extend({className:"api",template:a,regions:{search:".region-api-search",main:".region-api-main"},initialize:function(n){this.keyword=n?n.keyword:null,i.categoryReqres=i.categoryReqres||new t.Wreqr.RequestResponse,i.categoryReqres.deferred=i.categoryReqres.deferred||$.ajax({url:window.getapi("mercury_community","/w/api")}),i.categoryReqres.deferred.done(function(t){var n,r,o=[];e.each(t.data,function(e){"datayes"!==e[0]?o.push(e):n=e}),o.unshift(n),r=e.zipObject(o),i.categoryReqres.setHandler("category",function(e){return r[e.toLowerCase()]}),i.categoryReqres.setHandler("categories",function(t){return e.map(r,function(e,t){return{id:t,name:e}})})});var r=document.createElement("a");r.href="img/ZeroClipboard.swf",s.config({swfPath:r.href}),i.vent.trigger("title:module","数据"),i.vent.trigger("title","DataAPI")},onDestroy:function(){this.goTop&&this.goTop.destroy()},onRender:function(){this.search.show(new o({keyword:this.keyword}))},onShow:function(){this.goTop=new r({target:this.$el,scroll:$(".main")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(47),n(127)],r=function(e,t){return t.extend({placeholderText:"搜索",buttonText:"搜索API",suggestionAPI:window.getapi("mercury_community","/w/api/suggestion"),onSearch:function(){var t,n=this.ui.input.val();n&&(t="/help/api/search/"+encodeURIComponent(n),e.Route.navigate(t,{trigger:!0}))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="region-api-search"></div>\n<div class="region-api-main"></div>\n';return __p}},function(e,t,n){var i;!function(r,o){"use strict";var a,s,l,c=r,u=c.document,d=c.navigator,h=c.setTimeout,p=c.clearTimeout,f=c.setInterval,m=c.clearInterval,g=c.getComputedStyle,v=c.encodeURIComponent,y=c.ActiveXObject,b=c.Error,_=c.Number.parseInt||c.parseInt,w=c.Number.parseFloat||c.parseFloat,x=c.Number.isNaN||c.isNaN,C=c.Date.now,k=c.Object.keys,S=c.Object.defineProperty,T=c.Object.prototype.hasOwnProperty,D=c.Array.prototype.slice,M=function(){var e=function(e){return e};if("function"==typeof c.wrap&&"function"==typeof c.unwrap)try{var t=u.createElement("div"),n=c.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=c.unwrap)}catch(i){}return e}(),$=function(e){return D.call(e,0)},L=function(){var e,t,n,i,r,a,s=$(arguments),l=s[0]||{};for(e=1,t=s.length;t>e;e++)if(null!=(n=s[e]))for(i in n)T.call(n,i)&&(r=l[i],a=n[i],l!==a&&a!==o&&(l[i]=a));return l},A=function(e){var t,n,i,r;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)t=e;else if("number"==typeof e.length)for(t=[],n=0,i=e.length;i>n;n++)T.call(e,n)&&(t[n]=A(e[n]));else{t={};for(r in e)T.call(e,r)&&(t[r]=A(e[r]))}return t},R=function(e,t){for(var n={},i=0,r=t.length;r>i;i++)t[i]in e&&(n[t[i]]=e[t[i]]);return n},I=function(e,t){var n={};for(var i in e)-1===t.indexOf(i)&&(n[i]=e[i]);return n},j=function(e){if(e)for(var t in e)T.call(e,t)&&delete e[t];return e},E=function(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},N=function(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},P=function(e){var t,n;return"string"==typeof e&&e&&(n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]&&(t=n[1]))),t},O=function(){var e,t;try{throw new b}catch(n){t=n}return t&&(e=t.sourceURL||t.fileName||P(t.stack)),e},V=function(){var e,t,n;if(u.currentScript&&(e=u.currentScript.src))return e;if(t=u.getElementsByTagName("script"),1===t.length)return t[0].src||o;if("readyState"in t[0])for(n=t.length;n--;)if("interactive"===t[n].readyState&&(e=t[n].src))return e;return"loading"===u.readyState&&(e=t[t.length-1].src)?e:(e=O())?e:o},F=function(){var e,t,n,i=u.getElementsByTagName("script");for(e=i.length;e--;){if(!(n=i[e].src)){t=null;break}if(n=N(n),null==t)t=n;else if(t!==n){t=null;break}}return t||o},H=function(){var e=N(V())||F()||"";return e+"ZeroClipboard.swf"},z=function(){return null==r.opener&&(!!r.top&&r!=r.top||!!r.parent&&r!=r.parent)}(),B={bridge:null,version:"0.0.0",pluginType:"unknown",disabled:null,outdated:null,sandboxed:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},W="11.0.0",U={},q={},G=null,Y=0,X=0,K={ready:"Flash communication is established",error:{"flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity"}},J=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],Z=["flash-disabled","flash-outdated","flash-sandboxed","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],Q=new RegExp("^flash-("+Z.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),ee=new RegExp("^flash-("+Z.slice(1).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),te={swfPath:H(),trustedDomains:r.location.host?[r.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},ne=function(e){if("object"==typeof e&&null!==e)for(var t in e)if(T.call(e,t))if(/^(?:forceHandCursor|title|zIndex|bubbleEvents)$/.test(t))te[t]=e[t];else if(null==B.bridge)if("containerId"===t||"swfObjectId"===t){if(!ve(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");te[t]=e[t]}else te[t]=e[t];{if("string"!=typeof e||!e)return A(te);if(T.call(te,e))return te[e]}},ie=function(){return Xe(),{browser:R(d,["userAgent","platform","appName"]),flash:I(B,["bridge"]),zeroclipboard:{version:Je.version,config:Je.config()}}},re=function(){return!!(B.disabled||B.outdated||B.sandboxed||B.unavailable||B.degraded||B.deactivated)},oe=function(e,t){var n,i,r,s={};if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)T.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Je.on(n,e[n]);if(r&&r.length){for(n=0,i=r.length;i>n;n++)e=r[n].replace(/^on/,""),s[e]=!0,U[e]||(U[e]=[]),U[e].push(t);if(s.ready&&B.ready&&Je.emit({type:"ready"}),s.error){for(n=0,i=Z.length;i>n;n++)if(B[Z[n].replace(/^flash-/,"")]===!0){Je.emit({type:"error",name:Z[n]});break}a!==o&&Je.version!==a&&Je.emit({type:"error",name:"version-mismatch",jsVersion:Je.version,swfVersion:a})}}return Je},ae=function(e,t){var n,i,r,o,a;if(0===arguments.length)o=k(U);else if("string"==typeof e&&e)o=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)T.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&Je.off(n,e[n]);if(o&&o.length)for(n=0,i=o.length;i>n;n++)if(e=o[n].toLowerCase().replace(/^on/,""),a=U[e],a&&a.length)if(t)for(r=a.indexOf(t);-1!==r;)a.splice(r,1),r=a.indexOf(t,r);else a.length=0;return Je},se=function(e){var t;return t="string"==typeof e&&e?A(U[e])||null:A(U)},le=function(e){var t,n,i;return e=ye(e),e&&!Se(e)?"ready"===e.type&&B.overdue===!0?Je.emit({type:"error",name:"flash-overdue"}):(t=L({},e),Ce.call(this,t),"copy"===e.type&&(i=Ie(q),n=i.data,G=i.formatMap),n):void 0},ce=function(){var e=B.sandboxed;if(Xe(),"boolean"!=typeof B.ready&&(B.ready=!1),B.sandboxed!==e&&B.sandboxed===!0)B.ready=!1,Je.emit({type:"error",name:"flash-sandboxed"});else if(!Je.isFlashUnusable()&&null===B.bridge){var t=te.flashLoadTimeout;"number"==typeof t&&t>=0&&(Y=h(function(){"boolean"!=typeof B.deactivated&&(B.deactivated=!0),B.deactivated===!0&&Je.emit({type:"error",name:"flash-deactivated"})},t)),B.overdue=!1,Ae()}},ue=function(){Je.clearData(),Je.blur(),Je.emit("destroy"),Re(),Je.off()},de=function(e,t){var n;if("object"==typeof e&&e&&"undefined"==typeof t)n=e,Je.clearData();else{if("string"!=typeof e||!e)return;n={},n[e]=t}for(var i in n)"string"==typeof i&&i&&T.call(n,i)&&"string"==typeof n[i]&&n[i]&&(q[i]=n[i])},he=function(e){"undefined"==typeof e?(j(q),G=null):"string"==typeof e&&T.call(q,e)&&delete q[e]},pe=function(e){return"undefined"==typeof e?A(q):"string"==typeof e&&T.call(q,e)?q[e]:void 0},fe=function(e){if(e&&1===e.nodeType){s&&(He(s,te.activeClass),s!==e&&He(s,te.hoverClass)),s=e,Fe(e,te.hoverClass);var t=e.getAttribute("title")||te.title;if("string"==typeof t&&t){var n=Le(B.bridge);n&&n.setAttribute("title",t)}var i=te.forceHandCursor===!0||"pointer"===ze(e,"cursor");Ge(i),qe()}},me=function(){var e=Le(B.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px"),s&&(He(s,te.hoverClass),He(s,te.activeClass),s=null)},ge=function(){return s||null},ve=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},ye=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){t=t.toLowerCase(),!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||"error"===t&&"clipboard-error"===e.name)&&(e.target=l),L(e,{type:t,target:e.target||s||null,relatedTarget:e.relatedTarget||null,currentTarget:B&&B.bridge||null,timeStamp:e.timeStamp||C()||null});var n=K[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&L(e,{target:null,version:B.version}),"error"===e.type&&(Q.test(e.name)&&L(e,{target:null,minimumVersion:W}),ee.test(e.name)&&L(e,{version:B.version})),"copy"===e.type&&(e.clipboardData={setData:Je.setData,clearData:Je.clearData}),"aftercopy"===e.type&&(e=je(e,G)),e.target&&!e.relatedTarget&&(e.relatedTarget=be(e.target)),_e(e)}},be=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?u.getElementById(t):null},_e=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,n="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:o,i="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:o,r=Be(t),a=c.screenLeft||c.screenX||0,s=c.screenTop||c.screenY||0,l=u.body.scrollLeft+u.documentElement.scrollLeft,d=u.body.scrollTop+u.documentElement.scrollTop,h=r.left+("number"==typeof e._stageX?e._stageX:0),p=r.top+("number"==typeof e._stageY?e._stageY:0),f=h-l,m=p-d,g=a+f,v=s+m,y="number"==typeof e.movementX?e.movementX:0,b="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,L(e,{srcElement:t,fromElement:n,toElement:i,screenX:g,screenY:v,pageX:h,pageY:p,clientX:f,clientY:m,x:f,y:m,movementX:y,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},we=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},xe=function(e,t,n,i){i?h(function(){e.apply(t,n)},0):e.apply(t,n)},Ce=function(e){if("object"==typeof e&&e&&e.type){var t=we(e),n=U["*"]||[],i=U[e.type]||[],r=n.concat(i);if(r&&r.length){var o,a,s,l,u,d=this;for(o=0,a=r.length;a>o;o++)s=r[o],l=d,"string"==typeof s&&"function"==typeof c[s]&&(s=c[s]),"object"==typeof s&&s&&"function"==typeof s.handleEvent&&(l=s,s=s.handleEvent),"function"==typeof s&&(u=L({},e),xe(s,l,[u],t))}return this}},ke=function(e){var t=null;return(z===!1||e&&"error"===e.type&&e.name&&-1!==J.indexOf(e.name))&&(t=!1),t},Se=function(e){var t=e.target||s||null,n="swf"===e._source;switch(delete e._source,e.type){case"error":var i="flash-sandboxed"===e.name||ke(e);"boolean"==typeof i&&(B.sandboxed=i),-1!==Z.indexOf(e.name)?L(B,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(a=e.swfVersion,L(B,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Ue();break;case"ready":a=e.swfVersion;var r=B.deactivated===!0;L(B,{disabled:!1,outdated:!1,sandboxed:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:r,ready:!r}),Ue();break;case"beforecopy":l=t;break;case"copy":var o,c,u=e.relatedTarget;!q["text/html"]&&!q["text/plain"]&&u&&(c=u.value||u.outerHTML||u.innerHTML)&&(o=u.value||u.textContent||u.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",o),c!==o&&e.clipboardData.setData("text/html",c)):!q["text/plain"]&&e.target&&(o=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",o));break;case"aftercopy":Te(e),Je.clearData(),t&&t!==Ve()&&t.focus&&t.focus();break;case"_mouseover":Je.focus(t),te.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!E(e.relatedTarget,t)&&De(L({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),De(L({},e,{type:"mouseover"})));break;case"_mouseout":Je.blur(),te.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!E(e.relatedTarget,t)&&De(L({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),De(L({},e,{type:"mouseout"})));break;case"_mousedown":Fe(t,te.activeClass),te.bubbleEvents===!0&&n&&De(L({},e,{type:e.type.slice(1)}));break;case"_mouseup":He(t,te.activeClass),te.bubbleEvents===!0&&n&&De(L({},e,{type:e.type.slice(1)}));break;case"_click":l=null,te.bubbleEvents===!0&&n&&De(L({},e,{type:e.type.slice(1)}));break;case"_mousemove":te.bubbleEvents===!0&&n&&De(L({},e,{type:e.type.slice(1)}))}return/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)?!0:void 0},Te=function(e){if(e.errors&&e.errors.length>0){var t=A(e);L(t,{type:"error",name:"clipboard-error"}),delete t.success,h(function(){Je.emit(t)},0)}},De=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||null,i=n&&n.ownerDocument||u,r={view:i.defaultView||c,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:i.createEvent?0:1},o=L(r,e);n&&i.createEvent&&n.dispatchEvent&&(o=[o.type,o.canBubble,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget],t=i.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,o),t._source="js",n.dispatchEvent(t)))}},Me=function(){var e=te.flashLoadTimeout;if("number"==typeof e&&e>=0){var t=Math.min(1e3,e/10),n=te.swfObjectId+"_fallbackContent";X=f(function(){var e=u.getElementById(n);We(e)&&(Ue(),B.deactivated=null,Je.emit({type:"error",name:"swf-not-found"}))},t)}},$e=function(){var e=u.createElement("div");return e.id=te.containerId,e.className=te.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+Ye(te.zIndex),e},Le=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},Ae=function(){var e,t=B.bridge,n=Le(t);if(!t){var i=Oe(c.location.host,te),r="never"===i?"none":"all",o=Ne(L({jsVersion:Je.version},te)),a=te.swfPath+Ee(te.swfPath,te);n=$e();var s=u.createElement("div");n.appendChild(s),u.body.appendChild(n);var l=u.createElement("div"),d="activex"===B.pluginType;l.innerHTML='<object id="'+te.swfObjectId+'" name="'+te.swfObjectId+'" width="100%" height="100%" '+(d?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+a+'"')+">"+(d?'<param name="movie" value="'+a+'"/>':"")+'<param name="allowScriptAccess" value="'+i+'"/><param name="allowNetworking" value="'+r+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+o+'"/><div id="'+te.swfObjectId+'_fallbackContent">&nbsp;</div></object>',t=l.firstChild,l=null,M(t).ZeroClipboard=Je,n.replaceChild(t,s),Me()}return t||(t=u[te.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),B.bridge=t||null,t},Re=function(){var e=B.bridge;if(e){var t=Le(e);t&&("activex"===B.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var i in e)"function"==typeof e[i]&&(e[i]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else h(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),Ue(),B.ready=null,B.bridge=null,B.deactivated=null,a=o}},Ie=function(e){var t={},n={};if("object"==typeof e&&e){for(var i in e)if(i&&T.call(e,i)&&"string"==typeof e[i]&&e[i])switch(i.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[i],n.text=i;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[i],n.html=i;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[i],n.rtf=i}return{data:t,formatMap:n}}},je=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var i in e)if(T.call(e,i))if("errors"===i){n[i]=e[i]?e[i].slice():[];for(var r=0,o=n[i].length;o>r;r++)n[i][r].format=t[n[i][r].format]}else if("success"!==i&&"data"!==i)n[i]=e[i];else{n[i]={};var a=e[i];for(var s in a)s&&T.call(a,s)&&T.call(t,s)&&(n[i][t[s]]=a[s])}return n},Ee=function(e,t){var n=null==t||t&&t.cacheBust===!0;return n?(-1===e.indexOf("?")?"?":"&")+"noCache="+C():""},Ne=function(e){var t,n,i,r,o="",a=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?r=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(r=e.trustedDomains)),
r&&r.length)for(t=0,n=r.length;n>t;t++)if(T.call(r,t)&&r[t]&&"string"==typeof r[t]){if(i=Pe(r[t]),!i)continue;if("*"===i){a.length=0,a.push(i);break}a.push.apply(a,[i,"//"+i,c.location.protocol+"//"+i])}return a.length&&(o+="trustedOrigins="+v(a.join(","))),e.forceEnhancedClipboard===!0&&(o+=(o?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(o+=(o?"&":"")+"swfObjectId="+v(e.swfObjectId)),"string"==typeof e.jsVersion&&e.jsVersion&&(o+=(o?"&":"")+"jsVersion="+v(e.jsVersion)),o},Pe=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=-1===t?e:e.slice(t+2);var n=e.indexOf("/");return e=-1===n?e:-1===t||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},Oe=function(){var e=function(e){var t,n,i,r=[];if("string"==typeof e&&(e=[e]),"object"!=typeof e||!e||"number"!=typeof e.length)return r;for(t=0,n=e.length;n>t;t++)if(T.call(e,t)&&(i=Pe(e[t]))){if("*"===i){r.length=0,r.push("*");break}-1===r.indexOf(i)&&r.push(i)}return r};return function(t,n){var i=Pe(n.swfPath);null===i&&(i=t);var r=e(n.trustedDomains),o=r.length;if(o>0){if(1===o&&"*"===r[0])return"always";if(-1!==r.indexOf(t))return 1===o&&t===i?"sameDomain":"always"}return"never"}}(),Ve=function(){try{return u.activeElement}catch(e){return null}},Fe=function(e,t){var n,i,r,o=[];if("string"==typeof t&&t&&(o=t.split(/\s+/)),e&&1===e.nodeType&&o.length>0)if(e.classList)for(n=0,i=o.length;i>n;n++)e.classList.add(o[n]);else if(e.hasOwnProperty("className")){for(r=" "+e.className+" ",n=0,i=o.length;i>n;n++)-1===r.indexOf(" "+o[n]+" ")&&(r+=o[n]+" ");e.className=r.replace(/^\s+|\s+$/g,"")}return e},He=function(e,t){var n,i,r,o=[];if("string"==typeof t&&t&&(o=t.split(/\s+/)),e&&1===e.nodeType&&o.length>0)if(e.classList&&e.classList.length>0)for(n=0,i=o.length;i>n;n++)e.classList.remove(o[n]);else if(e.className){for(r=(" "+e.className+" ").replace(/[\r\n\t]/g," "),n=0,i=o.length;i>n;n++)r=r.replace(" "+o[n]+" "," ");e.className=r.replace(/^\s+|\s+$/g,"")}return e},ze=function(e,t){var n=g(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},Be=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),i=c.pageXOffset,r=c.pageYOffset,o=u.documentElement.clientLeft||0,a=u.documentElement.clientTop||0,s=0,l=0;if("relative"===ze(u.body,"position")){var d=u.body.getBoundingClientRect(),h=u.documentElement.getBoundingClientRect();s=d.left-h.left||0,l=d.top-h.top||0}t.left=n.left+i-o-s,t.top=n.top+r-a-l,t.width="width"in n?n.width:n.right-n.left,t.height="height"in n?n.height:n.bottom-n.top}return t},We=function(e){if(!e)return!1;var t=g(e,null),n=w(t.height)>0,i=w(t.width)>0,r=w(t.top)>=0,o=w(t.left)>=0,a=n&&i&&r&&o,s=a?null:Be(e),l="none"!==t.display&&"collapse"!==t.visibility&&(a||!!s&&(n||s.height>0)&&(i||s.width>0)&&(r||s.top>=0)&&(o||s.left>=0));return l},Ue=function(){p(Y),Y=0,m(X),X=0},qe=function(){var e;if(s&&(e=Le(B.bridge))){var t=Be(s);L(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+Ye(te.zIndex)})}},Ge=function(e){B.ready===!0&&(B.bridge&&"function"==typeof B.bridge.setHandCursor?B.bridge.setHandCursor(e):B.ready=!1)},Ye=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return"number"!=typeof e||x(e)?"string"==typeof e&&(t=Ye(_(e,10))):t=e,"number"==typeof t?t:"auto"},Xe=function(e){var t,n,i,o=B.sandboxed,a=null;if(e=e===!0,z===!1)a=!1;else{try{n=r.frameElement||null}catch(s){i={name:s.name,message:s.message}}if(n&&1===n.nodeType&&"IFRAME"===n.nodeName)try{a=n.hasAttribute("sandbox")}catch(s){a=null}else{try{t=document.domain||null}catch(s){t=null}(null===t||i&&"SecurityError"===i.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(i.message.toLowerCase()))&&(a=!0)}}return B.sandboxed=a,o===a||e||Ke(y),a},Ke=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function i(e){e&&(s=!0,e.version&&(u=t(e.version)),!u&&e.description&&(u=t(e.description)),e.filename&&(c=n(e.filename)))}var r,o,a,s=!1,l=!1,c=!1,u="";if(d.plugins&&d.plugins.length)r=d.plugins["Shockwave Flash"],i(r),d.plugins["Shockwave Flash 2.0"]&&(s=!0,u="2.0.0.11");else if(d.mimeTypes&&d.mimeTypes.length)a=d.mimeTypes["application/x-shockwave-flash"],r=a&&a.enabledPlugin,i(r);else if("undefined"!=typeof e){l=!0;try{o=new e("ShockwaveFlash.ShockwaveFlash.7"),s=!0,u=t(o.GetVariable("$version"))}catch(h){try{o=new e("ShockwaveFlash.ShockwaveFlash.6"),s=!0,u="6.0.21"}catch(p){try{o=new e("ShockwaveFlash.ShockwaveFlash"),s=!0,u=t(o.GetVariable("$version"))}catch(f){l=!1}}}}B.disabled=s!==!0,B.outdated=u&&w(u)<w(W),B.version=u||"0.0.0",B.pluginType=c?"pepper":l?"activex":s?"netscape":"unknown"};Ke(y),Xe(!0);var Je=function(){return this instanceof Je?void("function"==typeof Je._createClient&&Je._createClient.apply(this,$(arguments))):new Je};S(Je,"version",{value:"2.2.0",writable:!1,configurable:!0,enumerable:!0}),Je.config=function(){return ne.apply(this,$(arguments))},Je.state=function(){return ie.apply(this,$(arguments))},Je.isFlashUnusable=function(){return re.apply(this,$(arguments))},Je.on=function(){return oe.apply(this,$(arguments))},Je.off=function(){return ae.apply(this,$(arguments))},Je.handlers=function(){return se.apply(this,$(arguments))},Je.emit=function(){return le.apply(this,$(arguments))},Je.create=function(){return ce.apply(this,$(arguments))},Je.destroy=function(){return ue.apply(this,$(arguments))},Je.setData=function(){return de.apply(this,$(arguments))},Je.clearData=function(){return he.apply(this,$(arguments))},Je.getData=function(){return pe.apply(this,$(arguments))},Je.focus=Je.activate=function(){return fe.apply(this,$(arguments))},Je.blur=Je.deactivate=function(){return me.apply(this,$(arguments))},Je.activeElement=function(){return ge.apply(this,$(arguments))};var Ze=0,Qe={},et=0,tt={},nt={};L(te,{autoActivate:!0});var it=function(e){var t=this;t.id=""+Ze++,Qe[t.id]={instance:t,elements:[],handlers:{}},e&&t.clip(e),Je.on("*",function(e){return t.emit(e)}),Je.on("destroy",function(){t.destroy()}),Je.create()},rt=function(e,t){var n,i,r,s={},l=Qe[this.id],c=l&&l.handlers;if(!l)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof e&&e)r=e.toLowerCase().split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)T.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.on(n,e[n]);if(r&&r.length){for(n=0,i=r.length;i>n;n++)e=r[n].replace(/^on/,""),s[e]=!0,c[e]||(c[e]=[]),c[e].push(t);if(s.ready&&B.ready&&this.emit({type:"ready",client:this}),s.error){for(n=0,i=Z.length;i>n;n++)if(B[Z[n].replace(/^flash-/,"")]){this.emit({type:"error",name:Z[n],client:this});break}a!==o&&Je.version!==a&&this.emit({type:"error",name:"version-mismatch",jsVersion:Je.version,swfVersion:a})}}return this},ot=function(e,t){var n,i,r,o,a,s=Qe[this.id],l=s&&s.handlers;if(!l)return this;if(0===arguments.length)o=k(l);else if("string"==typeof e&&e)o=e.split(/\s+/);else if("object"==typeof e&&e&&"undefined"==typeof t)for(n in e)T.call(e,n)&&"string"==typeof n&&n&&"function"==typeof e[n]&&this.off(n,e[n]);if(o&&o.length)for(n=0,i=o.length;i>n;n++)if(e=o[n].toLowerCase().replace(/^on/,""),a=l[e],a&&a.length)if(t)for(r=a.indexOf(t);-1!==r;)a.splice(r,1),r=a.indexOf(t,r);else a.length=0;return this},at=function(e){var t=null,n=Qe[this.id]&&Qe[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:A(n)),t},st=function(e){if(ht.call(this,e)){"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=L({},e));var t=L({},ye(e),{client:this});pt.call(this,t)}return this},lt=function(e){if(!Qe[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");e=ft(e);for(var t=0;t<e.length;t++)if(T.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?-1===tt[e[t].zcClippingId].indexOf(this.id)&&tt[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+et++,tt[e[t].zcClippingId]=[this.id],te.autoActivate===!0&&mt(e[t]));var n=Qe[this.id]&&Qe[this.id].elements;-1===n.indexOf(e[t])&&n.push(e[t])}return this},ct=function(e){var t=Qe[this.id];if(!t)return this;var n,i=t.elements;e="undefined"==typeof e?i.slice(0):ft(e);for(var r=e.length;r--;)if(T.call(e,r)&&e[r]&&1===e[r].nodeType){for(n=0;-1!==(n=i.indexOf(e[r],n));)i.splice(n,1);var o=tt[e[r].zcClippingId];if(o){for(n=0;-1!==(n=o.indexOf(this.id,n));)o.splice(n,1);0===o.length&&(te.autoActivate===!0&&gt(e[r]),delete e[r].zcClippingId)}}return this},ut=function(){var e=Qe[this.id];return e&&e.elements?e.elements.slice(0):[]},dt=function(){Qe[this.id]&&(this.unclip(),this.off(),delete Qe[this.id])},ht=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=Qe[this.id],n=t&&t.elements,i=!!n&&n.length>0,r=!e.target||i&&-1!==n.indexOf(e.target),o=e.relatedTarget&&i&&-1!==n.indexOf(e.relatedTarget),a=e.client&&e.client===this;return t&&(r||o||a)?!0:!1},pt=function(e){var t=Qe[this.id];if("object"==typeof e&&e&&e.type&&t){var n=we(e),i=t&&t.handlers["*"]||[],r=t&&t.handlers[e.type]||[],o=i.concat(r);if(o&&o.length){var a,s,l,u,d,h=this;for(a=0,s=o.length;s>a;a++)l=o[a],u=h,"string"==typeof l&&"function"==typeof c[l]&&(l=c[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(u=l,l=l.handleEvent),"function"==typeof l&&(d=L({},e),xe(l,u,[d],n))}}},ft=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},mt=function(e){if(e&&1===e.nodeType){var t=function(e){(e||(e=c.event))&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},n=function(n){(n||(n=c.event))&&(t(n),Je.focus(e))};e.addEventListener("mouseover",n,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),nt[e.zcClippingId]={mouseover:n,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},gt=function(e){if(e&&1===e.nodeType){var t=nt[e.zcClippingId];if("object"==typeof t&&t){for(var n,i,r=["move","leave","enter","out","over"],o=0,a=r.length;a>o;o++)n="mouse"+r[o],i=t[n],"function"==typeof i&&e.removeEventListener(n,i,!1);delete nt[e.zcClippingId]}}};Je._createClient=function(){it.apply(this,$(arguments))},Je.prototype.on=function(){return rt.apply(this,$(arguments))},Je.prototype.off=function(){return ot.apply(this,$(arguments))},Je.prototype.handlers=function(){return at.apply(this,$(arguments))},Je.prototype.emit=function(){return st.apply(this,$(arguments))},Je.prototype.clip=function(){return lt.apply(this,$(arguments))},Je.prototype.unclip=function(){return ct.apply(this,$(arguments))},Je.prototype.elements=function(){return ut.apply(this,$(arguments))},Je.prototype.destroy=function(){return dt.apply(this,$(arguments))},Je.prototype.setText=function(e){if(!Qe[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("text/plain",e),this},Je.prototype.setHtml=function(e){if(!Qe[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("text/html",e),this},Je.prototype.setRichText=function(e){if(!Qe[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("application/rtf",e),this},Je.prototype.setData=function(){if(!Qe[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData.apply(this,$(arguments)),this},Je.prototype.clearData=function(){if(!Qe[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Je.clearData.apply(this,$(arguments)),this},Je.prototype.getData=function(){if(!Qe[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Je.getData.apply(this,$(arguments))},i=function(){return Je}.call(t,n,t,e),!(i!==o&&(e.exports=i))}(function(){return this||window}())},function(e,t,n){var i,r;i=[n(49),n(47),n(247),n(249),n(253),n(262),n(263)],r=function(e,t,n,i,r,o,a){return e.LayoutView.extend({className:"api-browse",template:o,regions:{category:".region-category",list:".region-list"},initialize:function(e){this.which={category:e.category,sub:e.sub},this.page=e.page},onRender:function(){var e=this,o=new n([],{category:this.which.category,sub:this.which.sub}),s=function l(e,n,i){var r,l="data/browse/";return!e&&!n&&o.state.category&&o.state.sub&&(e=o.state.category,n=o.state.sub),i=i||o.state.currentPage,r={page:i},e&&n&&(l+=e+"/"+n+"/"),l+=t.Route.toFragment("",r)};this.listenTo(o,{fetched:function(){t.Route.navigate(s(),{trigger:!1})}}),this.page&&(o.state.currentPage=this.page-1),this.apiList=new i({collection:o,emptyText:"即将上线，敬请期待"}),this.loading=!0,o.fetchNext().done(function(){e.loading=!1,t.categoryReqres.deferred.done(function(){e.categoryList=new r({hideAll:!0,categories:t.categoryReqres.request("categories"),onSubChange:function(e,t){o.reset(),o.state.category=e,o.state.sub=t,o.fetchNext()},expandTo:e.which.category+"."+e.which.sub}),e.category.show(e.categoryList),t.categoryReqres.setHandler("subCategoryUrl",function(e,t){return s(e,t,1)}),$(".api").after(a()),$(".go-top").css("bottom",297)})}),this.list.show(this.apiList)},onDestroy:function(){t.categoryReqres.removeHandler("subCategoryUrl"),$(".api").next(".be-provider").remove(),$(".go-top").css("bottom",40)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(248)],r=function(e,t,n){return t.Collection.extend({model:n,url:function(){return this.state.category&&this.state.sub?window.getapi("mercury_community","/w/api/"+this.state.category+"/"+this.state.sub):window.getapi("mercury_community","/w/api")},parse:function(e){return 200===e.code?e.data.data:[]},initialize:function(t,n){var i={currentPage:0,pageSize:20,totalPage:999,which:void 0,category:void 0,sub:void 0};n=n||{},e.defaults(n,i),this.state=n,this.on("reset",function(){e.extend(this.state,i)})},fetch:function(){return this.trigger("sync:before"),t.Collection.prototype.fetch.apply(this,arguments)},fetchNext:function(){var e=this,t={page:this.state.currentPage+1,page_size:this.state.pageSize};if(this.state.which&&(t.which=this.state.which),this.state.currentPage>=this.state.totalPage){var n=$.Deferred();return n.reject(),n}return this.fetch({data:t}).done(function(t){e.state.currentPage=t.data.current_page,e.state.totalPage=t.data.total_page,e.state.totalCount=t.data.total_api,e.state.pageSize=t.data.page_size,e.trigger("fetched")})},categories:function(){var t,n={};return this.each(function(e){t=e.get("f_category.tree[0]"),n[t]||(n[t]=[]),n[t].push({name:e.get("f_category.tree[1]"),display:e.get("f_category.name")})}),e.map(n,function(e,t){return{name:t,children:e}})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(76)],r=function(e){return e.NestedModel.extend({defaults:{expanded:!1,f_example:null,f_desc:null,f_return:null,f_return_keys:null,privelege:!1},idAttribute:"f_id",url:function(){return window.getapi("mercury_community","/w/api/"+this.get("f_category.tree[0]").toLowerCase()+"/"+this.get("f_category.tree[1]")+"/"+this.get("f_name"))},parse:function(e){return 200===e.code?e.data:e||{}},getMethodName:function(){var e=["DataAPI"];return"DATAYES"!==this.get("f_category.tree[0]")&&e.push(this.get("f_category.tree[0]")),e.push(this.get("f_name")),e.join(".")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(250),n(252),n(149)],r=function(e,t,n,i){return t.CompositeView.extend({childViewContainer:".api-list",template:i,childView:n,className:"api-list-wrapper",tagName:"div",getEmptyView:function(){return t.ItemView.extend({className:"empty-api-list",template:e.template(this.emptyText||"没有找到相关API")})},ui:{paginator:".paginator"},initialize:function(e){var t=this;this.listenTo(this.collection,{fetched:function(){t.paginate()},sync:function(){t.$el.find(".empty-api-list").show(),t.ui.paginator.show&&t.ui.paginator.show()},"sync:before":function(){t.$el.find(".empty-api-list").hide(),t.ui.paginator.hide&&t.ui.paginator.hide()}}),this.emptyText=e?e.emptyText:""},paginate:function(){var e=this;return this.collection.isEmpty()?void this.ui.paginator.pagination("destroy"):void this.ui.paginator.pagination({items:e.collection.state.totalCount,itemsOnPage:e.collection.state.pageSize,currentPage:e.collection.state.currentPage,cssStyle:"pagination",prevText:"上一页",nextText:"下一页",onPageClick:function(t,n){e.collection.state.currentPage=t-1,e.collection.fetchNext().done(function(){$(".main").scrollTop(0)}),n.preventDefault()}})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(251),n(245)],r=function(e,t,n,i,r){return t.ItemView.extend({className:"api-item",tagName:"li",template:i,events:{"click .api-name":"clickApiName","click .toggler":"clickToggler","mouseenter .api-example input":"enterApiExampleInput","click .copy-example":"clickCopyExample"},serializeData:function(){var t=this.model.toJSON(),i=/:param\s(.*?)\s(.*?):(.*?)$/i,r=function(e){var t=i.exec(e);return t&&4===t.length?{name:t[2],type:t[1],desc:t[3]}:null};return t.methodName=this.model.getMethodName(),t.categoryName=n.categoryReqres.request("category",this.model.get("f_category.tree[0]")),t.privelege||(t.shopUrl=window.getApp("datamkt","/datapreview/"+this.model.get("goods_id"))),t.f_desc&&(t.f_desc=e.compact(e.map(t.f_desc,r))),t.f_return&&(t.f_return_always=[],t.f_return_optional=[],e.each(t.f_return,function(e){"Y"===e[3]?t.f_return_always.push({name:e[0],type:e[1],desc:e[2]}):t.f_return_optional.push({name:e[0],type:e[1],desc:e[2]})})),t},initialize:function(){var e=this;this.listenTo(this.model,"change:expanded",function(){e.render()})},onRender:function(){var e,t=this;this.model.get("expanded")&&(e=new r(this.$el.find(".copy-example")[0]),e.on("copy",function(e){e.clipboardData.setData("text/plain",t.model.get("f_example"))}))},fetchAndExpand:function(){var e=this,t=function(){e.model.set("expanded",!e.model.get("expanded"))};this.model.fetched?t():this.model.fetch().done(function(){t(),e.model.fetched=!0})},clickApiName:function(){this.fetchAndExpand()},clickToggler:function(e){this.fetchAndExpand(),e.preventDefault()},enterApiExampleInput:function(e){$(e.currentTarget).select()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<h3 class="api-name">\n    ',privelege||(__p+='\n    <span class="privilege badge">未购买</span>\n    '),__p+="\n    "+(null==(__t=f_short_intro)?"":__t)+'\n</h3>\n<div class="api-meta">\n    <span class="api-source">['+(null==(__t=categoryName)?"":__t)+']</span> -\n    <span class="api-category">'+(null==(__t=methodName)?"":__t)+"</span>\n    ",privelege||(__p+='\n    <a class="buy" href="'+(null==(__t=shopUrl)?"":__t)+'" target="_blank">\n        <i class="fa fa-shopping-cart"></i>\n        购买\n    </a>\n    '),__p+="\n</div>\n",expanded&&f_example&&(__p+='\n<div class="api-example">\n    <div class="input-group">\n        <input class="form-control" type="text" value="'+__e(f_example)+'" readonly>\n        <span class="input-group-btn"><button class="btn btn-primary copy-example">复制代码</button></span>\n    </div>\n</div>\n'),__p+='\n<div class="api-intro">\n    '+(null==(__t=f_intro)?"":__t)+"\n</div>\n",expanded&&f_desc&&(__p+='\n<div class="api-params api-block">\n    <h4>参数</h4>\n    '+(null==(__t=_T.partial("apiTable",{head:{name:"名称",type:"类型",desc:"描述"},body:f_desc}))?"":__t)+"\n</div>\n"),__p+="\n",expanded&&!_.isEmpty(f_return_always)&&(__p+='\n<div class="api-return api-block">\n    <h4>固定返回值</h4>\n    '+(null==(__t=_T.partial("apiTable",{head:{name:"名称",type:"类型",desc:"描述"},body:f_return_always}))?"":__t)+"\n</div>\n"),__p+="\n",expanded&&!_.isEmpty(f_return_optional)&&(__p+='\n<div class="api-optional-return api-block">\n    <h4>可选返回值</h4>\n    '+(null==(__t=_T.partial("apiTable",{head:{name:"名称",type:"类型",desc:"描述"},body:f_return_optional}))?"":__t)+"\n</div>\n"),__p+='\n<a class="toggler" href="#">\n    ',__p+=expanded?'\n    <i class="fa fa-angle-double-up"></i>收起详情\n    ':'\n    <i class="fa fa-angle-double-down"></i>展开详情\n    ',__p+="\n</a>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<ul class="api-list"></ul>\n<ul class="paginator"></ul>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(254),n(256)],r=function(e,t,n,i,r){return t.CollectionView.extend({childView:r,className:"category-tree",tagName:"ul",events:{"click .sub-category-name":"clickSubCategoryName"},childEvents:{goAll:function(e){this.onSubChange("all","all"),this.focusSubCategory(e.$el)},expanded:function(e){var t;this.focus&&this.focus[0]===e.model.id&&(t=e.collection.get(this.focus[1]),this.focusSubCategory(e.children.findByModel(t).$el))}},initialize:function(e){e.hideAll||e.categories.unshift({id:"all",name:"所有来源",noChildren:!0}),this.collection=new i(e.categories),this.onSubChange=e.onSubChange,this.expandTo=e.expandTo},onRender:function(){var e,t,n=this;if(this.expandTo){if(e=this.expandTo.split(".")[0],t=this.expandTo.split(".")[1],e=this.collection.get(e),!e)return;if(e=this.children.findByModel(e),!e)return;e.expand().done(function(e){t=e.collection.get(t),t&&(t=e.children.findByModel(t),t&&n.focusSubCategory(t.$el))})}},clickSubCategoryName:function(e){var t=$(e.currentTarget);this.onSubChange(t.data("category"),t.data("id")),this.focusSubCategory(t.parent()),e.preventDefault()},focusSubCategory:function(e){e.parent().parent().parent().find(".active").removeClass("active"),e.addClass("active"),this.focus=[e.children("a").data("category"),e.children("a").data("id")]}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(255)],r=function(e,t){return e.Collection.extend({model:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48)],r=function(e){return e.Model.extend({urlRoot:window.getapi("mercury_community","/w/api"),parse:function(e){return 200===e.code?e.data:e||{}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(257),n(259),n(261)],r=function(e,t,n,i,r,o){return t.CompositeView.extend({className:"category-item",tagName:"li",template:o,childView:i,childViewContainer:".sub-category-list",childViewOptions:function(){return{category:this.model.get("id")}},events:{"click .category-name":"clickCategoryName"},initialize:function(){this.collection=new r(this.model.get("children"))},serializeData:function(){var e=this.model.toJSON();return e.display||(e.display=n.categoryReqres.request("category",e.name)),e},clickCategoryName:function(e){"all"!==this.model.id?this.expanded()?this.collapse():this.expand():this.trigger("goAll")},expanded:function(){return 0!==this.collection.size()},expand:function(){var t=this,n=$.Deferred(),i=function(){var i=t.model.get("sub");t.once("render:collection",function(){n.resolve(t)}),t.collection.reset(e.map(i,function(e,t){return{id:t,name:e.name,index:e.index}})),t.$el.addClass("expanded"),t.trigger("expanded")};return this.model.get("sub")?i():this.model.fetch().done(function(){i()}),n},collapse:function(){this.collection.reset(),this.$el.removeClass("expanded")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(47),n(258)],r=function(e,t,n){return e.ItemView.extend({className:"sub-category-item",tagName:"li",template:n,initialize:function(e){this.category=e.category},serializeData:function(){var e=this.model.toJSON();return e.category=this.category,e.url=t.categoryReqres.request("subCategoryUrl",this.category,this.model.get("id")),e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<a class="sub-category-name" href="'+(null==(__t=url)?"":__t)+'" data-category="'+(null==(__t=category)?"":__t)+'" data-id="'+(null==(__t=id)?"":__t)+'">'+(null==(__t=name)?"":__t)+"</a>\n";return __p}},function(e,t,n){var i,r;i=[n(48),n(260)],r=function(e,t){return e.Collection.extend({model:t,comparator:"index"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48)],r=function(e){return e.Model.extend({})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<span class="category-name">\n    ',"all"!==id&&(__p+='<i class="fa fa-angle-double-down"></i>'),__p+=(null==(__t=name)?"":__t)+'\n</span>\n<ul class="sub-category-list"></ul>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="row">\n    <div class="region-category col-md-2"></div>\n    <div class="region-list col-md-10"></div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="be-provider">\n    <div class="container">\n        您也可以为其他用户提供数据支持，<br>\n        想成为我们的数据供应商吗？<br>\n        <a class="btn btn-primary btn-lg" href="mailto:Service.DataMall@datayes.com" target="_blank">联系我们</a>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(47),n(247),n(249),n(253),n(265),n(263)],r=function(e,t,n,i,r,o,a){return e.LayoutView.extend({className:"api-search",template:o,regions:{list:".region-list"},initialize:function(e){this.keyword=e?e.keyword:null,this.which=e.category&&e.sub?{category:e.category,sub:e.sub}:void 0,this.page=e.page},onRender:function(){var e=this,r=n.extend({url:window.getapi("mercury_community","/w/api/search?key="+this.keyword)}),o=function s(n,i,o){var a,s="help/api/search/"+encodeURIComponent(e.keyword);return n||i||!r.state.which||(n=r.state.which.split(","),i=n[1],n=n[0]),o=o||r.state.currentPage,a={page:o},n&&i&&(a.category=n,a.sub=i),s+=t.Route.toFragment("",a)};r=new r,this.listenTo(r,{fetched:function(){t.Route.navigate(o(),{trigger:!1})}}),this.page&&(r.state.currentPage=this.page-1),this.apiList=new i({collection:r}),this.which&&(r.state.which=this.which.category+","+this.which.sub),this.loading=!0,r.fetchNext().done(function(){e.loading=!1,t.categoryReqres.deferred.done(function(){t.categoryReqres.setHandler("subCategoryUrl",function(e,t){return o(e,t,1)}),$(".api").after(a()),$(".go-top").css("bottom",297)})}),this.list.show(this.apiList)},onDestroy:function(){t.categoryReqres.removeHandler("subCategoryUrl"),$(".api").next(".be-provider").remove(),$(".go-top").css("bottom",40)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="search-meta">\n    <a class="back-to-browse" href="help/api/browse/" data-href="help/api/browse/">\n        <i class="fa fa-chevron-left"></i> 返回\n    </a>\n</div>\n<div class="region-list"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(267),n(400),n(426),n(565),n(566)],r=function(e,t,n,i,r){return{Layout:e,Welcome:t,NotebookDetailView:n,DataDetailView:i,LibraryDetailView:r}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(47),n(116),n(270),n(271),n(272),n(277),n(373),n(377),n(268),n(380),n(382),n(383),n(385),n(386),n(399),n(158),n(145),n(147)],r=function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v,y,b,_){var w=t.LayoutView.extend({className:"labs",regions:{sidebar:".region-sidebar",main:".region-main",menu:".region-menu",title:".region-title",belt:".region-belt"},ui:{itemName:".item-name"},template:v,name:"labs",check:function x(){var e=this,t=(arguments,0),n=$.Deferred(),x=function s(){t+=1,$.ajax({url:window.getapi("mercury","/api/kernels/isbusy"),type:"GET",headers:{}}).done(function(e){return e&&-403===e.code?void n.reject():void n.resolve()}).fail(function(e){if(503===e.status){if(i.initializeError=!0,t>=5)return void n.reject();setTimeout(function(){s()},400)}})},r=function(){i.body.append('<div class="loading-cover"><div class="init-spinner"><span class="spinner primary"></span>初始化中...</div></div>')},a=function(){i.body.children(".loading-cover").remove()};a(),r(),x(),n.done(function(){a(),e.trigger("checkFinish"),e.checkFinish=!0,o.resetMode()}).fail(function(){i.body.find(".init-spinner").addClass("failed").text("初始化失败, 请稍后重试.")})},initialize:function(){var e,t=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase());t||(e=n.Alert({title:"提示",content:'我们检测到您未使用Chrome浏览器，为了保障您正常使用开始研究功能，切换至Chrome浏览器。<br>我们将在未来提供更加丰富的浏览器支持。<a href="http://www.google.cn/chrome" target="_blank">点此下载安装Chrome浏览器</a>'}),e.$el.on("hidden.bs.modal",function(){e.destroy()}))},onShow:function(){var e=this,t=r.get("profile");t.deferred.done(function(){e.getAnnounceMents()})},onRender:function(){var e=r.get("profile"),t=this;i.vent.trigger("title:module","开始研究"),e.deferred.done(function(){var t=e.get("profile.guide");(!t||"v1">t)&&(console.log("new user notebook"),$.ajax({url:window.getapi("mercury","/api/notebooks")}).done(function(t){t&&t.length>0&&(e.guideDone("v1").done(function(){console.log("guide done")}),console.log("open guide book"),i.Route.navigate("labs/notebooks/"+encodeURIComponent(y.toNB(t[0].name)),{trigger:!0}))}))}),d(),h(),f(),p(),m(),this.sidebar.show(new l),this.menu.show(new c),this.title.show(new u),this.belt.show(new g),this.check(),this.listenTo(i.vent,"remove:announce",function(){t.showAnnounce()})},onDestroy:function(){o.stop()},forceGuide:function(){},getAnnounceMents:function(){var e=this,t=r.get("profile");this.announceItem={},this.announceItem.index=-1,this.announceItem.userId=t.get("id"),this.announces=new b({}),$.when(this.announces.fetch()).done(function(t){e.showAnnounce()})},showAnnounce:function(){this.announceItem.index=this.announceItem.index+1,this.$el.find(".notice").remove(),this.announceItem.index<this.announces.length&&this.$el.prepend(new _({model:this.announces.at(this.announceItem.index),userId:this.announceItem.userId}).render().el)}});return w}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(47),n(116),n(269)],r=function(e,t,n,i){return function(){var r=new i;n.set("notebooks",r),t.keyVent=new e.Wreqr.EventAggregator,t.notebookReqres=new e.Wreqr.RequestResponse}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(157)],r=function(e,t,n){return t.Collection.extend({model:n,url:window.getapi("mercury","/api/notebooks"),parse:function(t){return e.isArray(t)?t:[]},fetch:function(){var e=this;return t.Collection.prototype.fetch.apply(this,arguments).always(function(){e.fetched=!0})},comparator:function(e,t){var n=e.get("last_modified"),i=t.get("last_modified"),r=e.get("session_id"),o=t.get("session_id");return r&&!o?-1:!r&&o?1:n>i?-1:i>n?1:0}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48)],r=function(e){var t="ipython",n=1e4,i=e.Model.extend({defaults:{cpu_usage:0,memory_usage:0,memory_desc:"--",disk_usage:0,disk_desc:"--"},parse:function(e){return e.data||{}},initialize:function(){this.mode=t,this.interval=n,this.getDisk=!0,this.noDisk=!1},url:window.getapi("mercury_ops","/containerUsage/"),setMode:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];this.mode=e||this.mode,this.interval=t||this.interval,this.noDisk=n,this.start()},resetMode:function(){this.mode=t,this.interval=n,this.noDisk=!1,this.start()},update:function(){var e=this;this.jqXHR=this.fetch({data:{mode:this.mode,option:this.getDisk?"all":"cpu_mem"},success:function(){e.fetchTimeout=setTimeout(function(){e.update()},e.interval)}}),this.noDisk?this.getDisk=!1:this.getDisk=!this.getDisk},
start:function(){this.getDisk=!0,this.stop(),this.update()},stop:function(){this.jqXHR&&(this.jqXHR.abort(),this.jqXHR=null),clearTimeout(this.fetchTimeout)},getData:function(){return this.toJSON()},setNoDisk:function(e){this.noDisk=e}});return new i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(47)],r=function(e,t){return function(){t.guideVent=new e.Wreqr.EventAggregator}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(116),n(273),n(274),n(276)],r=function(e,t,n,i,r,o,a){return t.ItemView.extend({template:!1,initialize:function(e){this.current=0,this.guides=this.buildGuides(a),this.size=this.guides.length},onRender:function(){var e=this;this.layers=(new r).render(),this.listenTo(this.layers,{close:function(){e.finishAll()}})},onDestroy:function(){this.stopListening(),this.layers.destroy(),this.popover.destroy()},reset:function(){this.current=0},buildGuides:function(t){return e.map(t,function(t,n){return e.extend(t,{step:n+1})})},getGuide:function(t){return t=e.filter(this.guides,function(e){return e.name===t})[0],t?t:void 0},refresh:function(){this.layers.pos(),this.popover.pos()},start:function(e){e=this.getGuide(e),e.step===this.current+1&&(this.layers.reset(e.target,e),this.popover=new o(e).render(),this.listenTo(this.popover,{skipAll:this.finishAll,next:this.next}))},next:function s(){var e=this.guides[this.current],s=this.guides[this.current+1];this.finish(e.name),s&&this.start(s.name)},finish:function(e){e=this.getGuide(e),e.step===this.current+1&&(this.current=e.step,this.layers.shrink(),this.popover.destroy(),this.current===this.size&&this.finishAll())},finishAll:function(){var e=this,t=i.get("profile");t.guideDone("v1").done(function(){e.destroy()})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47)],r=function(e,t,n){return t.ItemView.extend({template:!1,initialize:function(){this.layers={},this.centerOpts={},this.on({reset:this.reset,shrink:this.shrink})},reset:function(t,n){this.center=$(t),this.centerOpts=e.defaults(n||{},{padding:0}),this.pos(),n.introOnly?this.layers.center.show():this.layers.center.hide()},onDestroy:function(){$(window).off("resize.guideLayers"),n.body.off("click.guideLayers"),e.each(this.layers,function(e){e.remove()}),$(".close-guide").remove()},onRender:function(){var t,i=this,r=$('<div class="guide-layer"></div>');e.each(["top","right","bottom","left","center"],function(e){t=r.clone(),t.addClass(e),n.body.append(t),i.layers[e]=t}),n.body.append('<a href="#" class="close-guide" title="跳过引导"><i class="fa fa-times"></i></a>');var o=e.throttle(function(){i.pos()},150);$(window).on("resize.guideLayers",function(){i.center&&o()}),n.body.on("click.guideLayers",".guide-layer",function(e){e.stopPropagation()}),n.body.on("click.closeGuide",".close-guide",function(e){i.trigger("close"),e.preventDefault()})},pos:function(){var e,t,n,i,r,o,a=this.centerOpts.padding;e=$(window).width(),t=$(window).height(),n=this.center.outerWidth()+2*a,i=this.center.outerHeight()+2*a,r=this.center.offset().left-a,o=this.center.offset().top-a,this.layers.left.css({width:r,height:"100vh",left:0,top:0}),this.layers.top.css({width:n,height:o,left:r,top:0}),this.layers.right.css({width:e-r-n,height:"100vh",left:n+r,top:0}),this.layers.bottom.css({width:n,height:t-o-i,left:r,top:i+o}),this.layers.center.css({width:n,height:i,left:r,top:o}),this.offset={top:o,right:e-r-n,bottom:t-o-i,left:r}},shrink:function(){var e,t,n=this.centerOpts.padding;e=this.center.outerWidth(),t=this.center.outerHeight(),this.layers.top.css({height:this.layers.top.height()+t/2+n}),this.layers.bottom.css({top:this.layers.bottom.position().top-t/2-n,height:this.layers.bottom.height()+t/2+n})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(47),n(275)],r=function(e,t,n,i,r){return n.ItemView.extend({className:"guide-popover popover",template:r,ui:{title:".popover-title",content:".content",btns:".btns"},events:{click:"click","click .skip-all-link":"clickSkipLink"},triggers:{"click .skip-all":"skipAll","click .guide-btn-next":"next"},initialize:function(e){this.model=new t.Model({title:e.title,content:e.content||""}),this.btns=e.btns||[],e.introOnly&&this.btns.push({name:"next",text:"知道了"}),this.attachTo=$(e.target),this.placement=e.placement||"bottom"},onRender:function(){var t=e.template('<button class="btn btn-air-primary btn-xs pull-right guide-btn-<%= name %>"><%= text %></button>'),n=e.map(this.btns,function(e){return t(e)}).join("");this.ui.btns.append(n),i.body.append(this.$el),this.$el.show(),this.pos()},pos:function(){var e=this.attachTo,t=e.outerHeight(),n=e.outerWidth(),i=e.offset().left,r=e.offset().top,o=this.$el.outerHeight(),a=this.$el.outerWidth(),s={top:r,left:i},l={};switch(this.placement){case"bottom-left":s.top+=t+10,l.left=20;break;case"bottom":s.top+=t+10,s.left+=n/2-a/2;break;case"bottom-right":s.top+=t+10,s.left+=n+-a,l.left=a-20;break;case"top-left":s.top-=o,l.left=20;break;case"top":s.top-=o,s.left+=t/2-a/2;break;case"top-right":s.top-=o,s.left+=n+-a,l.left=a-20;break;case"left":s.left-=a,s.top+=t/2-o/2;break;case"right":s.left+=n+10,s.top+=t/2-o/2}l.left&&this.$el.find(".arrow").css(l),this.$el.addClass(this.placement.split("-")[0]).css(s)},click:function(e){e.stopPropagation()},clickSkipLink:function(){this.trigger("skipAll")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="arrow"></div>\n<div class="popover-content">\n    <div class="content">\n        <h5>'+(null==(__t=title)?"":__t)+"</h5>\n        "+(null==(__t=content)?"":__t)+'\n    </div>\n    <div class="btns clearfix">\n        <a class="skip-all pull-left" href="#">跳过引导</a>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i;i=function(){return[{name:"click-notebook",target:".main-nav .tab-notebook",placement:"right",title:"请选择Notebook标签",content:"Notebook中您能完成所有金融研究。"},{name:"create-notebook",target:".notebook-list .add.tool",padding:5,title:"请新建一个Notebook",placement:"bottom-left"},{name:"intro-cell",introOnly:!0,target:".cell-list .cell.focused",padding:7,placement:"bottom-left",title:"这是一个单元",text:"每个Notebook都可以由多个这样的单元组成，您可以在单元中编写并实现各种程序化分析。"},{name:"click-type-switcher",target:".cell-list .cell.focused .type-switcher",placement:"right",title:"请选择单元的模式",content:"每个单元都可以切换为Code模式、Strategy模式，以及Markdown模式。"},{name:"change-strategy",target:".cell-list .cell.focused .type-switcher li:nth-child(3)",placement:"right",title:"请将单元切换为Strategy模式",content:"在Strategy模式下，您可以用程序化的方法，定义每个交易日在某种条件下以开盘价买入卖出一定数量的股票。"},{name:"intro-strategy",introOnly:!0,target:".cell-list .cell.focused",padding:7,placement:"bottom-left",title:"这是系统为您自动生成的策略代码模板"},{name:"click-run",target:".toolbar .btn:nth-child(2)",placement:"bottom-left",title:"请单击运行按钮，查看策略回测结果"},{name:"intro-strategy-result",introOnly:!0,target:".cell-list .cell:nth-child(2) .result",placement:"top-left",title:"这是策略回测结果",content:'上半部分是一些主要的风险收益指标；<br>下半部分是当前策略和沪深300的累计收益率随时间变化的对比图。<br>现在您可以在单元中自由编写金融分析或策略实现代码，或<a class="skip-all-link" href="help/faq/#如何写个策略" target="_blank">查看更详细的策略帮助</a>。'}]}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(282),n(289),n(278),n(291),n(294),n(296),n(372)],r=function(e,t,n,i,r,o,a,s,l,c){return t.LayoutView.extend({className:"sidebar",region:{toolbar:".toolbar",mainNav:".main-nav"},template:c,render:function(){return t.LayoutView.prototype.render.apply(this,arguments),this.toolbar=new l({el:this.$el.find(".toolbar")[0]}).render(),this.nav=new s({el:this.$el.find(".main-nav")[0]}).render(),this.nav.addGroup(r,{id:"notebook",href:"tab-notebook",name:"Notebook",icon:"book"}),this.nav.addGroup(o,{id:"data",href:"tab-data",name:"Data",icon:"tasks"}),this.nav.addGroup(a,{id:"library",href:"tab-library",name:"Library",icon:"archive"}),this},onDestroy:function(){this.toolbar.destroy(),this.nav.destroy()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(156),n(115),n(279),n(284),n(47),n(116),n(286),n(287),n(288)],r=function(e,t,n,i,r,o,a,s,l,c,u){var d,h,p;return d=r.ItemView.extend({type:"datas",template:u,events:{"click .delete":"clickDelete","click .download":"clickDownload"},serializeData:function(){return e.extend(this.model.toJSON(),{appUrl:this.model.appUrl()})},clickDownload:function(e){var t=window.getapi("mercury","/databooks/"+this.model.get("name")),n=function(){i.Alert({title:"下载错误",content:"无法下载大小超过100M的文件.",autoRemove:!0})};$.ajax({url:t+"?size",dataType:"json"}).done(function(e){e.size&&e.size/1024/1024<=100?l(t):n()})}}),h=r.CollectionView.extend({type:"datas",childView:d,emptyText:'没有Data, <a href="help/faq/#如何获取数据" target="_blank">查看Data帮助</a>'}),p=r.LayoutView.extend({className:"data-list",collectionViewClass:h,events:{"click .close":"clickClose","click .upload":"clickUpload"},render:function(){return r.LayoutView.prototype.render.apply(this,arguments),this.ui.tools.append('<span class="upload tool"><span class="fa fa-upload"></span>上传</span>'),this.renderUpload(),this},renderUpload:function(){var e=this.$el.find(".upload"),t=$('<form class="hide"><input type="file" name="datafile"></form>'),i=t.find("input");i.attr({accept:".txt,.csv,.xls,.xlsx"}),e.after(t),i.on("change",function(){var e=new FormData(t[0]),r=s.get("datas"),o=i.prop("files")[0];return o.size/1e3/1e3>100?void new n({type:"warn",msg:"文件过大.",timeout:3e3}):(new c).validateName(o.name)?void $.ajax({url:window.getapi("mercury","/api/databooks"),type:"POST",processData:!1,cache:!1,contentType:!1,data:e,dataType:"json",success:function(e){e.name=i.prop("files")[0].name,r.add(new c(e))},error:function(e){413===e.status&&new n({type:"warn",msg:"文件过大.",timeout:3e3})}}).always(function(){t[0].reset()}):void new n({type:"warn",msg:"只允许 .txt,.csv,.xls,.xlsx 类型的文件.",timeout:3e3})})},clickUpload:function(){this.ui.tools.find("input").trigger("click")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(280),n(47),n(116),n(282),n(82),n(283)],r=function(e,t,n,i,r,o,a,s){var l,c,u;return l=t.ItemView.extend({tagName:"li",className:"list-group-item",template:e.template("<%- name %>"),initialize:function(){var e=this;this.listenTo(this.model,{"change:search_hit":function(){e.model.get("search_hit")?e.$el.show():e.$el.hide()}})},destroy:function(){var n=this;$.Velocity.animate(this.$el,{height:0,"padding-top":0,"padding-bottom":0},e.extend({complete:function(){t.ItemView.prototype.destroy.apply(n,arguments)}},o.base))},clickDelete:function(e){if(!this.deleteConfirmShowed){this.deleteConfirmShowed=!0;var t=this,i=$(e.currentTarget),r=new n({target:i,text:"确定删除吗?"});r.on("yes",function(){t.model.destroy({wait:!0}),r.destroy()}),r.on("no",function(){r.destroy()}),r.on("destroy",function(){t.deleteConfirmShowed=!1}),e.stopPropagation()}}}),c=t.CollectionView.extend({className:"list-group",tagName:"ul",emptyText:"Nothing here",getEmptyView:function(){return this.collection.fetched?t.ItemView.extend({className:"list-group-item",tagName:"li",template:e.template(this.emptyText)}):a},initialize:function(e){this.collection=r.get(this.type)}}),u=t.LayoutView.extend({template:s,regions:{list:".list"},ui:{tools:".tools",search:".search"},render:function(){var e=this;return t.LayoutView.prototype.render.apply(this,arguments),this.collectionView=new this.collectionViewClass,this.collectionView.collection.fetch().done(function(){e.list.show(e.collectionView)}).always(function(){0===e.collectionView.collection.length&&(e.collectionView.destroyEmptyView(),e.collectionView.showEmptyView())}),this.initSearch(),this},search:function(e){e?(e=e.toLowerCase(),this.collectionView.collection.each(function(t){var n=t.get("search_name")||t.get("name");-1!=n.toLowerCase().search(e)?t.set("search_hit",!0):t.set("search_hit",!1)})):this.collectionView.collection.each(function(e){e.set("search_hit",!0)})},clickClose:function(e){i.vent.trigger("mainNav:collapse")},initSearch:function(){var t=this,n=t.ui.search.find(".keyword"),i=t.ui.search.find(".empty"),r=function(){n.val(""),o(),t.ui.search.removeClass("expanded")},o=e.debounce(function(){var e=n.val();e?i.show():i.hide(),t.search(e)},120);this.$el.on("keyup.search",".keyword",function(e){o()}).on("focus",".keyword",function(){t.ui.search.addClass("expanded")}).on("blur",".keyword",function(){r()}).on("click",".empty",function(){n.val(""),o()}).on("click",".cancel",function(){r()})}}),{ItemView:l,CollectionView:c,LayoutView:u}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(48),s=(i(a),n(49)),l=i(s),c=n(281),u=i(c),d={text:"",positive:"确定",negtive:"取消"};t["default"]=l["default"].ItemView.extend({"class":"popover",template:!1,initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.opts=o["default"].defaults(e,d),this.target=e.target,this.render()},onRender:function(){var e=this,t=$(u["default"](this.opts));$("body").one("mouseup",function(){e.destroy()}),t.on("click",".positive",function(){e.trigger("yes")}).on("click",".negtive",function(){e.trigger("no")}),this.target.popover({html:!0,container:"body",template:'<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content"></div></div>',content:t,placement:"auto top",trigger:"manual"}),this.target.popover("show")},onDestroy:function(){this.target.popover("destroy")}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<div class="popover-confirm">\n    <div class="popover-confirm-text">'+(null==(__t=text)?"":__t)+'</div>\n    <button class="btn btn-primary btn-sm positive">'+(null==(__t=positive)?"":__t)+'</button>\n    <button class="btn btn-default btn-sm negtive">'+(null==(__t=negtive)?"":__t)+"</button>\n</div>\n";return __p}},function(e,t,n){var i;i=function(){return{base:{duration:200,easing:"easeOut"}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="tools"></div>\n<div class="search">\n    <input class="keyword" type="text" placeholder="搜索">\n    <i class="empty fa fa-times"></i>\n    <a class="cancel" href="#">取消</a>\n</div>\n<span class="close"><i class="fa fa-chevron-left"></i></span>\n<div class="list"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(282),n(285)],r=function(e,t,n,i){return t.ItemView.extend({className:"inline-confirm",template:i,triggers:{"click .yes":{event:"yes",stopPropagation:!0},"click .no":{event:"no",stopPropagation:!0}},initialize:function(){var e=this;t.ItemView.prototype.initialize.apply(this,arguments),this.on("render",function(){e.$el.css("position","fixed");var t=this.$el.width();e.$el.css({position:"static",visibility:"visible",width:0}).velocity({width:t+5},n.base)})},destroy:function(){var i=this;$.Velocity.animate(this.$el,{width:0},e.extend({complete:function(){t.ItemView.prototype.destroy.apply(i,arguments)}},n.base))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="btn-group btn-group-xs">\n    <button type="button" class="yes btn btn-danger">OK</button><button type="button" class="no btn btn-default">Cancel</button>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(47)],r=function(e){var t=$("<iframe>");return t.css("display","none"),t.attr("id","downloader"),e.body.append(t),function(e){t.attr("src",e)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48)],r=function(e,t){return t.Model.extend({idAttribute:"name",defaults:{type:"databook"},appUrl:function(){return"labs/datas/"+encodeURIComponent(this.get("name"))},parse:function(e){return e.name&&e.type?e:{}},filename:function(){return this.get("name").replace(/\.(txt|csv|xls|xlsx)$/,"")},extname:function(){return"."+e.last(this.get("name").split("."))},validateName:function(e){return-1!==e.search(/.*\.(txt|csv|xls|xlsx)$/)?!0:!1},urlRoot:window.getapi("mercury","/api/databooks")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<a class="name" href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'">'+__e(name)+'</a>\n<div class="actions">\n    <span class="delete action" title="删除">\n        <i class="fa fa-trash"></i>\n    </span>\n    <span class="download action" title="下载">\n        <i class="fa fa-download"></i>\n    </span>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(156),n(279),n(280),n(47),n(158),n(116),n(157),n(290)],r=function(e,t,n,i,r,o,a,s,l,c){var u,d,h;return u=i.ItemView.extend({type:"notebooks",template:c,events:{"click .delete":"clickDelete","click .copy":"clickCopy","click .shutdown":"clickShutdown"},initialize:function(){i.ItemView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,{"change:session_id":function(){this.render()},"delete:forbid":function(){new n({type:"warn",msg:"删除失败, 请先关闭微核.",timeout:5e3})},"delete:notFound":function(){new n({type:"warn",msg:"删除失败, Notebook不存在.",timeout:5e3})}})},onDestroy:function(){this.stopListening()},serializeData:function(){return e.extend(this.model.toJSON(),{appUrl:this.model.appUrl(),displayName:this.model.displayName()})},clickCopy:function(){this.model.copy()},clickShutdown:function(e){if(!this.shutdownConfirmShowed){this.shutdownConfirmShowed=!0;var t=this,n=$(e.currentTarget),i=new r({target:n,text:"确定关闭此微核吗?"});i.on("yes",function(){t.model.closeSession().done(function(){t.render()}),i.destroy()}),i.on("no",function(){i.destroy()}),i.on("destroy",function(){t.shutdownConfirmShowed=!1}),e.stopPropagation()}}}),d=i.CollectionView.extend({type:"notebooks",childView:u,emptyText:'没有Notebook, <a href="help/faq/#Notebook是干什么的" target="_blank">查看Notebook帮助</a>',reorderOnSort:!0}),h=i.LayoutView.extend({className:"notebook-list",collectionViewClass:d,events:{"click .close":"clickClose","click .add":"clickAdd","click .upload":"clickUpload"},animated:function(){},initialize:function(){i.LayoutView.prototype.initialize.apply(this,arguments);var e=this;this.on("show",function(){e.collectionView.collection.sort(),e.renderUpload(),e.$el.parent().parent().on("animated",function(){e.animated()})})},onDestroy:function(){this.collectionView.destroy(),this.$el.parent().parent().off("animated")},render:function(){return i.LayoutView.prototype.render.apply(this,arguments),this.ui.tools.append('<span class="add tool"><span class="fa fa-plus"></span>新建</span>'),this.ui.tools.append('<span class="upload tool"><span class="fa fa-upload"></span>上传</span>'),this},renderUpload:function(){var e=this.ui.tools.find(".upload"),t=$('<form><input type="file" class="hide"></form>'),n=t.find("input"),i=new FileReader;n.attr({accept:".nb"}),n.on("change",function(e){i.readAsText(n.prop("files")[0])}),i.onload=function(e){var r,c=i.result,u=a.toIPYNB(n.prop("files")[0].name),d=s.get("notebooks");try{c=JSON.parse(c)}catch(e){return}r=new l,r.save({},{wait:!0,attrs:{content:c,name:u},success:function(){d.add(r),o.Route.navigate(r.appUrl(),{trigger:!0})}}).always(function(){t[0].reset()})},e.after(t)},clickClose:function(){o.vent.trigger("mainNav:collapse")},clickAdd:function(){var e=this.collectionView.collection;e.create({},{wait:!0,success:function(e){o.Route.navigate(e.appUrl(),{trigger:!0}),o.vent.trigger("mainNav:collapse")}})},clickUpload:function(){this.ui.tools.find("input").trigger("click")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<a class="name" href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'">'+__e(displayName)+'</a>\n<div class="actions">\n    ',__p+=session_id?'\n    <span class="shutdown action" title="关闭微核">\n        <i class="fa fa-power-off"></i>\n    </span>\n    ':'\n    <span class="delete action" title="删除">\n        <i class="fa fa-trash"></i>\n    </span>\n    ',__p+='\n    <span class="copy action" title="复制">\n        <i class="fa fa-clipboard"></i>\n    </span>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(156),n(279),n(284),n(47),n(116),n(286),n(292),n(293)],r=function(e,t,n,i,r,o,a,s,l,c){var u,d,h;return u=i.ItemView.extend({type:"libraries",template:c,events:{"click .delete":"clickDelete","click .download":"clickDownload"},serializeData:function(){return e.extend(this.model.toJSON(),{appUrl:this.model.appUrl(),filename:this.model.filename()})},clickDownload:function(e){s(window.getapi("mercury","/library/"+this.model.get("name")))}}),d=i.CollectionView.extend({type:"libraries",childView:u,emptyText:'没有Library, <a href="help/faq#Library是干什么的" target="_blank">查看Library帮助</a>'}),h=i.LayoutView.extend({className:"library-list",collectionViewClass:d,events:{"click .close":"clickClose"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48)],r=function(e,t){return t.Model.extend({idAttribute:"name",defaults:{type:"library"},appUrl:function(){return"labs/library/"+encodeURIComponent(this.filename())},parse:function(e){return e.name&&e.type?e:{}},filename:function(){return this.get("name").replace(/\.py$/,"")},extname:function(){return"."+e.last(this.get("name").split("."))},hasExt:function(e){return-1!==e.search(/.*\.py$/)?!0:!1},validateName:function(e){var t=/^[a-zA-Z_]\w{0,19}$/i,n=/^(and|as|assert|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|not|or|pass|print|raise|return|try|while|with|yield)$/i;return t.test(e)&&!n.test(e)},urlRoot:window.getapi("mercury","/api/library")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<span class="prefix">lib.</span><a class="name" href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'">'+__e(filename)+'</a>\n<div class="actions">\n    <span class="delete action" title="删除">\n        <i class="fa fa-trash"></i>\n    </span>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(78),n(47),n(282),n(295)],r=function(e,t,n,i,r){return t.extend({events:{"click .nav a":"clickNav"},navItemTpl:r,onDestroy:function(){n.vent.trigger("cover:hide")},initialize:function(){var e=this;t.prototype.initialize.apply(this,arguments),this.nav=this.$el.find(".nav"),this.listenTo(n.vent,"mainNav:focus",function(t){e.focus(t)}),this.listenTo(n.vent,"mainNav:collapse",function(){e.collapse()}),this.listenTo(n.vent,"mainNav:expand",function(){e.expand()}),this.listenTo(n.vent,"mainNav:reset",function(){e.reset()})},template:!1,addGroup:function(e,i){t.prototype.addGroup.apply(this,arguments),n.vent.trigger("mainNav:add",i)},reset:function(){this.$el.find("li").removeClass("current")},focus:function(e){this.$el.find(".tab-"+e).parent().addClass("current").siblings().removeClass("current")},clickNav:function(e){if(this.animating)return void e.preventDefault();var t=$(e.currentTarget),n=t.attr("href").replace("#tab-","");t.parent().hasClass("active")?(t.parent().removeClass("active"),this.collapse()):(t.parent().addClass("active").siblings().removeClass("active"),this.showGroup(n),this.expand()),e.preventDefault()},expand:function(){var t=this,r=this.$el.find(".nav-list");n.body.on("click.toggleSidebar",".workspace",function(e){var n=$(e.target);0===n.parents(".sidebar").length&&t.collapse()}),n.vent.trigger("toolbar:hide"),$(".workspace").addClass("pushed"),this.animating=!0,r.show(),$.Velocity.animate(r,{translateX:0},e.extend({complete:function(){t.animating=!1,n.vent.trigger("mainNav:expanded"),setTimeout(function(){r.trigger("animated")},10)}},i.base)),this.$el.addClass("expand")},collapse:function(){var t=this,r=this.$el.find(".nav-list");this.$el.removeClass("expand"),n.vent.trigger("toolbar:show"),this.animating=!0,$.Velocity.animate(r,{translateX:"-100%"},e.extend({complete:function(){t.animating=!1,r.hide(),n.vent.trigger("mainNav:collapsed")}},i.base)),this.$el.find("li").removeClass("active"),$(".workspace").removeClass("pushed"),n.body.off("click.toggleSidebar")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<li>\n    <a class="tab-'+(null==(__t=id)?"":__t)+'" href="#'+(null==(__t=href)?"":__t)+'">\n        <span class="fa fa-'+(null==(__t=icon)?"":__t)+'"></span>\n        <span class="name">'+(null==(__t=name)?"":__t)+"</span>\n    </a>\n</li>\n";return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(282),n(297),n(371)],r=function(e,t,n,i,r,o){return t.ItemView.extend({template:o,ui:{bar:".toolbar-group"},onRender:function(){var e=this;this.listenTo(n.vent,{"toolbar:reset":function(t){e.ui.bar.empty(),e.addBtns(t)},"toolbar:show":function(t){e.show()},"toolbar:hide":function(t){e.hide()}})},addTool:function(e){return e=new r[e.type](e).render(),this.ui.bar.append(e.el),e},addBtns:function(t){var n,i=this,r=function(t){var n=i.addTool(e.extend({type:"button"},t));return i.listenTo(n,"click",function(){i.btnClicked(t.action)}),n};e.each(t,function(t){e.isArray(t)?(n=i.addTool({type:"buttonGroup"}),e.each(t,function(e){n.addButton(r(e).el)})):e.isObject(t)&&r(t)})},btnClicked:function(e){n.vent.trigger("toolbar:click",e)},show:function(){this.$el.velocity({translateX:"0"},i.base)},hide:function(){this.$el.velocity({translateX:"-100%"},i.base)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(298),n(300),n(301)],r=function(e,t,n){return{navs:e,buttonGroup:t,button:n}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(299)],r=function(e,t,n,i){return t.ItemView.extend({className:"mini-nav",tagName:"ul",template:!1,events:{"click .mini-nav-item":"clickItem"},initialize:function(){var e=this;t.ItemView.prototype.initialize.apply(this,arguments),n.vent.on("mainNav:add",function(t){e.addLink(t)})},addLink:function(e){this.$el.append(i(e))},clickItem:function(e){var t=$(e.currentTarget).data("nav");n.vent.trigger("mainNav:expand",t),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<li>\n    <a class="mini-nav-item" data-nav="'+(null==(__t=id)?"":__t)+'" title="'+(null==(__t=name)?"":__t)+'" href="#">\n        <span class="glyphicon glyphicon-'+(null==(__t=icon)?"":__t)+'"></span>\n    </a>\n</li>\n';return __p}},function(e,t,n){var i,r;i=[n(49)],r=function(e){return e.ItemView.extend({className:"btn-group-vertical",template:!1,addButton:function(e){this.$el.append(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(302)],r=function(e,t){return e.ItemView.extend({tagName:"button",className:"btn btn-sm",template:!1,triggers:{click:{event:"click",stopPropagation:!1}},initialize:function(t){e.ItemView.prototype.initialize.apply(this,arguments),this.state=t.state||"air-default",this.icon=t.icon||"",this.title=t.title,this.action=t.action},render:function(){return e.ItemView.prototype.render.apply(this,arguments),this.$el.attr("title",this.title),this.$el.addClass("btn-"+this.state),this.$el.append('<span class="fa fa-'+this.icon+'"></span>'),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";function i(e){return this instanceof i?void(this._wrapped=e):new i(e)}function r(e,t){"function"==typeof t&&(i.prototype[e]=function(){var e=[this._wrapped].concat(Array.prototype.slice.call(arguments)),n=t.apply(null,e);return"string"==typeof n?new i(n):n})}function o(e){r(e,function(t){var n=Array.prototype.slice.call(arguments,1);return String.prototype[e].apply(t,n)})}i.VERSION="3.2.2",i.isBlank=n(303),i.stripTags=n(305),i.capitalize=n(306),i.decapitalize=n(307),i.chop=n(308),i.trim=n(309),i.clean=n(312),i.cleanDiacritics=n(313),i.count=n(314),i.chars=n(315),i.swapCase=n(316),i.escapeHTML=n(317),i.unescapeHTML=n(319),i.splice=n(321),i.insert=n(322),i.replaceAll=n(323),i.include=n(324),i.join=n(325),i.lines=n(326),i.dedent=n(327),i.reverse=n(328),i.startsWith=n(329),i.endsWith=n(331),i.pred=n(332),i.succ=n(334),i.titleize=n(335),i.camelize=n(336),i.underscored=n(337),i.dasherize=n(338),i.classify=n(339),i.humanize=n(340),i.ltrim=n(341),i.rtrim=n(342),i.truncate=n(343),i.prune=n(344),i.words=n(345),i.pad=n(346),i.lpad=n(348),i.rpad=n(349),i.lrpad=n(350),i.sprintf=n(351),i.vsprintf=n(352),i.toNumber=n(353),i.numberFormat=n(354),i.strRight=n(355),i.strRightBack=n(356),i.strLeft=n(357),i.strLeftBack=n(358),i.toSentence=n(359),i.toSentenceSerial=n(360),i.slugify=n(361),i.surround=n(362),i.quote=n(363),i.unquote=n(364),i.repeat=n(365),i.naturalCmp=n(366),i.levenshtein=n(367),i.toBoolean=n(368),i.exports=n(369),i.escapeRegExp=n(311),i.wrap=n(370),i.strip=i.trim,i.lstrip=i.ltrim,i.rstrip=i.rtrim,i.center=i.lrpad,i.rjust=i.lpad,i.ljust=i.rpad,i.contains=i.include,i.q=i.quote,i.toBool=i.toBoolean,i.camelcase=i.camelize,i.prototype={value:function(){return this._wrapped}};for(var a in i)r(a,i[a]);r("tap",function(e,t){return t(e)});var s=["toUpperCase","toLowerCase","split","replace","slice","substring","substr","concat"];for(var a in s)o(s[a]);e.exports=i},function(e,t,n){var i=n(304);e.exports=function(e){return/^\s*$/.test(i(e))}},function(e,t){e.exports=function(e){return null==e?"":""+e}},function(e,t,n){var i=n(304);e.exports=function(e){return i(e).replace(/<\/?[^>]+>/g,"")}},function(e,t,n){var i=n(304);e.exports=function(e,t){e=i(e);var n=t?e.slice(1).toLowerCase():e.slice(1);return e.charAt(0).toUpperCase()+n}},function(e,t,n){var i=n(304);e.exports=function(e){return e=i(e),e.charAt(0).toLowerCase()+e.slice(1)}},function(e,t){e.exports=function(e,t){return null==e?[]:(e=String(e),t=~~t,t>0?e.match(new RegExp(".{1,"+t+"}","g")):[e])}},function(e,t,n){var i=n(304),r=n(310),o=String.prototype.trim;e.exports=function(e,t){return e=i(e),!t&&o?o.call(e):(t=r(t),e.replace(new RegExp("^"+t+"+|"+t+"+$","g"),""))}},function(e,t,n){var i=n(311);e.exports=function(e){return null==e?"\\s":e.source?e.source:"["+i(e)+"]"}},function(e,t,n){var i=n(304);e.exports=function(e){return i(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}},function(e,t,n){var i=n(309);e.exports=function(e){return i(e).replace(/\s\s+/g," ")}},function(e,t,n){var i=n(304),r="ąàáäâãåæăćčĉęèéëêĝĥìíïîĵłľńňòóöőôõðøśșšŝťțŭùúüűûñÿýçżźž",o="aaaaaaaaaccceeeeeghiiiijllnnoooooooossssttuuuuuunyyczzz";r+=r.toUpperCase(),o+=o.toUpperCase(),o=o.split(""),r+="ß",o.push("ss"),e.exports=function(e){return i(e).replace(/.{1}/g,function(e){var t=r.indexOf(e);return-1===t?e:o[t]})}},function(e,t,n){var i=n(304);e.exports=function(e,t){return e=i(e),t=i(t),0===e.length||0===t.length?0:e.split(t).length-1}},function(e,t,n){var i=n(304);e.exports=function(e){return i(e).split("")}},function(e,t,n){var i=n(304);e.exports=function(e){return i(e).replace(/\S/g,function(e){return e===e.toUpperCase()?e.toLowerCase():e.toUpperCase()})}},function(e,t,n){var i=n(304),r=n(318),o="[";for(var a in r)o+=a;o+="]";var s=new RegExp(o,"g");e.exports=function(e){return i(e).replace(s,function(e){return"&"+r[e]+";"})}},function(e,t){var n={"¢":"cent","£":"pound","¥":"yen","€":"euro","©":"copy","®":"reg","<":"lt",">":"gt",'"':"quot","&":"amp","'":"#39"};e.exports=n},function(e,t,n){var i=n(304),r=n(320);e.exports=function(e){return i(e).replace(/\&([^;]+);/g,function(e,t){var n;return t in r?r[t]:(n=t.match(/^#x([\da-fA-F]+)$/))?String.fromCharCode(parseInt(n[1],16)):(n=t.match(/^#(\d+)$/))?String.fromCharCode(~~n[1]):e})}},function(e,t){var n={nbsp:" ",cent:"¢",pound:"£",yen:"¥",euro:"€",copy:"©",reg:"®",lt:"<",gt:">",quot:'"',amp:"&",apos:"'"};e.exports=n},function(e,t,n){var i=n(315);e.exports=function(e,t,n,r){
var o=i(e);return o.splice(~~t,~~n,r),o.join("")}},function(e,t,n){var i=n(321);e.exports=function(e,t,n){return i(e,t,0,n)}},function(e,t,n){var i=n(304);e.exports=function(e,t,n,r){var o=r===!0?"gi":"g",a=new RegExp(t,o);return i(e).replace(a,n)}},function(e,t,n){var i=n(304);e.exports=function(e,t){return""===t?!0:-1!==i(e).indexOf(t)}},function(e,t,n){var i=n(304),r=[].slice;e.exports=function(){var e=r.call(arguments),t=e.shift();return e.join(i(t))}},function(e,t){e.exports=function(e){return null==e?[]:String(e).split(/\r\n?|\n/)}},function(e,t,n){function i(e){for(var t=e.match(/^[\s\\t]*/gm),n=t[0].length,i=1;i<t.length;i++)n=Math.min(t[i].length,n);return n}var r=n(304);e.exports=function(e,t){e=r(e);var n,o=i(e);return 0===o?e:(n="string"==typeof t?new RegExp("^"+t,"gm"):new RegExp("^[ \\t]{"+o+"}","gm"),e.replace(n,""))}},function(e,t,n){var i=n(315);e.exports=function(e){return i(e).reverse().join("")}},function(e,t,n){var i=n(304),r=n(330);e.exports=function(e,t,n){return e=i(e),t=""+t,n=null==n?0:Math.min(r(n),e.length),e.lastIndexOf(t,n)===n}},function(e,t){e.exports=function(e){return 0>e?0:+e||0}},function(e,t,n){var i=n(304),r=n(330);e.exports=function(e,t,n){return e=i(e),t=""+t,n="undefined"==typeof n?e.length-t.length:Math.min(r(n),e.length)-t.length,n>=0&&e.indexOf(t,n)===n}},function(e,t,n){var i=n(333);e.exports=function(e){return i(e,-1)}},function(e,t,n){var i=n(304);e.exports=function(e,t){return e=i(e),0===e.length?"":e.slice(0,-1)+String.fromCharCode(e.charCodeAt(e.length-1)+t)}},function(e,t,n){var i=n(333);e.exports=function(e){return i(e,1)}},function(e,t,n){var i=n(304);e.exports=function(e){return i(e).toLowerCase().replace(/(?:^|\s|-)\S/g,function(e){return e.toUpperCase()})}},function(e,t,n){var i=n(309),r=n(307);e.exports=function(e,t){return e=i(e).replace(/[-_\s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),t===!0?r(e):e}},function(e,t,n){var i=n(309);e.exports=function(e){return i(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()}},function(e,t,n){var i=n(309);e.exports=function(e){return i(e).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()}},function(e,t,n){var i=n(306),r=n(336),o=n(304);e.exports=function(e){return e=o(e),i(r(e.replace(/[\W_]/g," ")).replace(/\s/g,""))}},function(e,t,n){var i=n(306),r=n(337),o=n(309);e.exports=function(e){return i(o(r(e).replace(/_id$/,"").replace(/_/g," ")))}},function(e,t,n){var i=n(304),r=n(310),o=String.prototype.trimLeft;e.exports=function(e,t){return e=i(e),!t&&o?o.call(e):(t=r(t),e.replace(new RegExp("^"+t+"+"),""))}},function(e,t,n){var i=n(304),r=n(310),o=String.prototype.trimRight;e.exports=function(e,t){return e=i(e),!t&&o?o.call(e):(t=r(t),e.replace(new RegExp(t+"+$"),""))}},function(e,t,n){var i=n(304);e.exports=function(e,t,n){return e=i(e),n=n||"...",t=~~t,e.length>t?e.slice(0,t)+n:e}},function(e,t,n){var i=n(304),r=n(342);e.exports=function(e,t,n){if(e=i(e),t=~~t,n=null!=n?String(n):"...",e.length<=t)return e;var o=function(e){return e.toUpperCase()!==e.toLowerCase()?"A":" "},a=e.slice(0,t+1).replace(/.(?=\W*\w*$)/g,o);return a=a.slice(a.length-2).match(/\w\w/)?a.replace(/\s*\S+$/,""):r(a.slice(0,a.length-1)),(a+n).length>e.length?e:e.slice(0,a.length)+n}},function(e,t,n){var i=n(303),r=n(309);e.exports=function(e,t){return i(e)?[]:r(e,t).split(t||/\s+/)}},function(e,t,n){var i=n(304),r=n(347);e.exports=function(e,t,n,o){e=i(e),t=~~t;var a=0;switch(n?n.length>1&&(n=n.charAt(0)):n=" ",o){case"right":return a=t-e.length,e+r(n,a);case"both":return a=t-e.length,r(n,Math.ceil(a/2))+e+r(n,Math.floor(a/2));default:return a=t-e.length,r(n,a)+e}}},function(e,t){e.exports=function(e,t){if(1>t)return"";for(var n="";t>0;)1&t&&(n+=e),t>>=1,e+=e;return n}},function(e,t,n){var i=n(346);e.exports=function(e,t,n){return i(e,t,n)}},function(e,t,n){var i=n(346);e.exports=function(e,t,n){return i(e,t,n,"right")}},function(e,t,n){var i=n(346);e.exports=function(e,t,n){return i(e,t,n,"both")}},function(e,t,n){var i=n(347),r=Object.prototype.toString,o=function(){function e(e){return r.call(e).slice(8,-1).toLowerCase()}var t=i,n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,i){var r,a,s,l,c,u,d,h=1,p=n.length,f="",m=[];for(a=0;p>a;a++)if(f=e(n[a]),"string"===f)m.push(n[a]);else if("array"===f){if(l=n[a],l[2])for(r=i[h],s=0;s<l[2].length;s++){if(!r.hasOwnProperty(l[2][s]))throw new Error(o('[_.sprintf] property "%s" does not exist',l[2][s]));r=r[l[2][s]]}else r=l[1]?i[l[1]]:i[h++];if(/[^s]/.test(l[8])&&"number"!=e(r))throw new Error(o("[_.sprintf] expecting number but found %s",e(r)));switch(l[8]){case"b":r=r.toString(2);break;case"c":r=String.fromCharCode(r);break;case"d":r=parseInt(r,10);break;case"e":r=l[7]?r.toExponential(l[7]):r.toExponential();break;case"f":r=l[7]?parseFloat(r).toFixed(l[7]):parseFloat(r);break;case"o":r=r.toString(8);break;case"s":r=(r=String(r))&&l[7]?r.substring(0,l[7]):r;break;case"u":r=Math.abs(r);break;case"x":r=r.toString(16);break;case"X":r=r.toString(16).toUpperCase()}r=/[def]/.test(l[8])&&l[3]&&r>=0?"+"+r:r,u=l[4]?"0"==l[4]?"0":l[4].charAt(1):" ",d=l[6]-String(r).length,c=l[6]?t(u,d):"",m.push(l[5]?r+c:c+r)}return m.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],i=[],r=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))i.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))i.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw new Error("[_.sprintf] huh?");if(n[2]){r|=1;var o=[],a=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw new Error("[_.sprintf] huh?");for(o.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))o.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw new Error("[_.sprintf] huh?");o.push(s[1])}n[2]=o}else r|=2;if(3===r)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");i.push(n)}t=t.substring(n[0].length)}return i},n}();e.exports=o},function(e,t,n){var i=n(351);e.exports=function(e,t){return t.unshift(e),i.apply(null,t)}},function(e,t,n){n(309);e.exports=function(e,t){if(null==e)return 0;var n=Math.pow(10,isFinite(t)?t:0);return Math.round(e*n)/n}},function(e,t){e.exports=function(e,t,n,i){if(isNaN(e)||null==e)return"";e=e.toFixed(~~t),i="string"==typeof i?i:",";var r=e.split("."),o=r[0],a=r[1]?(n||".")+r[1]:"";return o.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+i)+a}},function(e,t,n){var i=n(304);e.exports=function(e,t){e=i(e),t=i(t);var n=t?e.indexOf(t):-1;return~n?e.slice(n+t.length,e.length):e}},function(e,t,n){var i=n(304);e.exports=function(e,t){e=i(e),t=i(t);var n=t?e.lastIndexOf(t):-1;return~n?e.slice(n+t.length,e.length):e}},function(e,t,n){var i=n(304);e.exports=function(e,t){e=i(e),t=i(t);var n=t?e.indexOf(t):-1;return~n?e.slice(0,n):e}},function(e,t,n){var i=n(304);e.exports=function(e,t){e=i(e),t=i(t);var n=e.lastIndexOf(t);return~n?e.slice(0,n):e}},function(e,t,n){var i=n(342);e.exports=function(e,t,n,r){t=t||", ",n=n||" and ";var o=e.slice(),a=o.pop();return e.length>2&&r&&(n=i(t)+n),o.length?o.join(t)+n+a:a}},function(e,t,n){var i=n(359);e.exports=function(e,t,n){return i(e,t,n,!0)}},function(e,t,n){var i=(n(304),n(310),n(309)),r=n(338),o=n(313);e.exports=function(e){return i(r(o(e).replace(/[^\w\s-]/g,"-").toLowerCase()),"-")}},function(e,t){e.exports=function(e,t){return[t,e,t].join("")}},function(e,t,n){var i=n(362);e.exports=function(e,t){return i(e,t||'"')}},function(e,t){e.exports=function(e,t){return t=t||'"',e[0]===t&&e[e.length-1]===t?e.slice(1,e.length-1):e}},function(e,t,n){var i=n(304),r=n(347);e.exports=function o(e,t,n){if(e=i(e),t=~~t,null==n)return r(e,t);for(var o=[];t>0;o[--t]=e);return o.join(n)}},function(e,t){e.exports=function(e,t){if(e==t)return 0;if(!e)return-1;if(!t)return 1;for(var n=/(\.\d+|\d+|\D+)/g,i=String(e).match(n),r=String(t).match(n),o=Math.min(i.length,r.length),a=0;o>a;a++){var s=i[a],l=r[a];if(s!==l){var c=+s,u=+l;return c===c&&u===u?c>u?1:-1:l>s?-1:1}}return i.length!=r.length?i.length-r.length:t>e?-1:1}},function(e,t,n){var i=n(304);e.exports=function(e,t){"use strict";if(e=i(e),t=i(t),e===t)return 0;if(!e||!t)return Math.max(e.length,t.length);for(var n=new Array(t.length+1),r=0;r<n.length;++r)n[r]=r;for(r=0;r<e.length;++r){for(var o=r+1,a=0;a<t.length;++a){var s=o;o=n[a]+(e.charAt(r)===t.charAt(a)?0:1);var l=s+1;o>l&&(o=l),l=n[a+1]+1,o>l&&(o=l),n[a]=s}n[a]=o}return o}},function(e,t,n){function i(e,t){var n,i,r=e.toLowerCase();for(t=[].concat(t),n=0;n<t.length;n+=1)if(i=t[n]){if(i.test&&i.test(e))return!0;if(i.toLowerCase()===r)return!0}}var r=n(309);e.exports=function(e,t,n){return"number"==typeof e&&(e=""+e),"string"!=typeof e?!!e:(e=r(e),i(e,t||["true","1"])?!0:i(e,n||["false","0"])?!1:void 0)}},function(e,t){e.exports=function(){var e={};for(var t in this)this.hasOwnProperty(t)&&!t.match(/^(?:include|contains|reverse|join)$/)&&(e[t]=this[t]);return e}},function(e,t,n){makeString=n(304),e.exports=function(e,t){if(e=makeString(e),t=t||{},width=t.width||75,seperator=t.seperator||"\n",cut=t.cut||!1,preserveSpaces=t.preserveSpaces||!1,trailingSpaces=t.trailingSpaces||!1,width<=0)return e;if(cut){for(index=0,result="";index<e.length;)index%width==0&&index>0&&(result+=seperator),result+=e.charAt(index),index++;if(trailingSpaces)for(;index%width>0;)result+=" ",index++;return result}for(words=e.split(" "),result="",current_column=0;words.length>0;){if(1+words[0].length+current_column>width&&current_column>0){if(preserveSpaces)result+=" ",current_column++;else if(trailingSpaces)for(;current_column<width;)result+=" ",current_column++;result+=seperator,current_column=0}current_column>0&&(result+=" ",current_column++),result+=words[0],current_column+=words[0].length,words.shift()}if(trailingSpaces)for(;current_column<width;)result+=" ",current_column++;return result}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="toolbar-group"></div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="main-nav">\n    <ul class="nav nav-sidebar"></ul>\n    <div class="nav-list">\n        <div class="tab-content"></div>\n    </div>\n</div>\n<div class="toolbar"></div>\n<div class="sidebar-bg"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(47),n(374),n(375)],r=function(e,t,n,i){return e.LayoutView.extend({className:"top-menu",template:n,ui:{container:".container-fluid"},initialize:function(){var n=this;e.ItemView.prototype.initialize.apply(this,arguments),this.listenTo(t.vent,"menu:reset",function(e){e=e||[],n.renderMenu(e)}),this.listenTo(t.vent,"menu:hide",function(){n.$el.hide()}),this.listenTo(t.vent,"menu:show",function(){n.$el.show()})},renderMenu:function(e){this.menu&&this.menu.destroy(),e={menu:e},this.menu=new i(e).render(),this.ui.container.append(this.menu.el)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="navbar navbar-default">\n    <div class="container-fluid">\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(376)],r=function(e,t,n,i){return t.ItemView.extend({className:"menu nav navbar-nav",tagName:"ul",template:!1,events:{"click a[data-action]":"clickItem"},initialize:function(e){t.ItemView.prototype.initialize.apply(this,arguments),this.menu=e.menu},render:function(){var n=this;return t.ItemView.prototype.render.apply(this,arguments),e.each(this.menu,function(e,t){var r=$(i(e));n.$el.append(r),r.find(".dropdown-menu").menu()}),this},clickItem:function(e){var t=$(e.currentTarget),i=t.data("action"),r=t.data("param");i&&n.menuVent.trigger(i,r),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)items?(__p+='\n<li class="dropdown">\n    <a class="dropdown-toggle" href="#" data-toggle="dropdown">'+(null==(__t=title)?"":__t)+'</a>\n    <ul class="dropdown-menu">\n        ',_.each(items,function(e,t){__p+="\n        ",e.divider?__p+='\n        <li class="divider"></li>\n        ':(__p+='\n        <li>\n            <a href="#" data-action="'+(null==(__t=e.action||null)?"":__t)+'">\n                <span class="title">'+(null==(__t=e.title)?"":__t)+'</span>\n                <span class="shortcut">'+(null==(__t=e.shortcut||"")?"":__t)+"</span>\n            </a>\n            ",e.items&&(__p+="\n            <ul>\n                ",_.each(e.items,function(e,t){__p+='\n                <li>\n                    <a href="#" data-action="'+(null==(__t=e.action)?"":__t)+'" data-param="'+(null==(__t=e.param)?"":__t)+'">\n                        <span class="title">'+(null==(__t=e.title)?"":__t)+'</span>\n                        <span class="shortcut">'+(null==(__t=e.shortcut||"")?"":__t)+"</span>\n                    </a>\n                </li>\n                "}),__p+="\n            </ul>\n            "),__p+="\n        </li>\n        "),__p+="\n        "}),__p+="\n    </ul>\n</li>\n"):__p+='\n<li>\n    <a href="#" data-action="'+(null==(__t=action)?"":__t)+'">'+(null==(__t=title)?"":__t)+"</a>\n</li>\n",__p+="\n";return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(378),n(47),n(88),n(379)],r=function(e,t,n,i,r,o,a){return t.ItemView.extend({className:"title-wrapper",ui:{title:".title"},events:{"click .editable":"edit"},template:a,initialize:function(){t.ItemView.prototype.initialize.apply(this,arguments);var e=this;this.listenTo(r.vent,"title:reset",function(t){e.$el.show(),e.reset(t)}),this.listenTo(r.vent,"title:hide",function(t){e.$el.hide()}),this.on("show",function(){e.reset({title:"",edit:!1})})},reset:function(t){this.title=t.title,this.editTitle=t.editTitle||"",e.isUndefined(t.edit)&&(t.edit=!0),this.ui.title.text(this.title),this.ui.title.attr({title:this.title}),t.title&&r.vent.trigger("title",t.title),t.edit?this.ui.title.addClass("editable"):this.ui.title.removeClass("editable")},edit:function(e){var t=n.Prompt({title:"重命名",placeholder:"名称",defaults:o(this.editTitle||this.title),autoHide:!1,val:function(e){r.vent.trigger("title:change",e,t)}});t.error=function(e){t.$el.find(".form-group").find(".help-block").remove().end().append('<span class="help-block">'+e+"</span>").addClass("has-error")},t.$el.on("hidden.bs.modal",function(){t.destroy()})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_378__},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="title"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(116),n(381)],r=function(e,t){return function(){var n=new t;e.set("datas",n)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(287)],r=function(e,t,n){return t.Collection.extend({model:n,url:window.getapi("mercury","/api/databooks"),parse:function(t){return e.isArray(t)?t:[]},fetch:function(){var e=this;return t.Collection.prototype.fetch.apply(this,arguments).always(function(){e.fetched=!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(47)],r=function(e,t){return function(){t.menuVent=new e.Wreqr.EventAggregator}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(116),n(384)],r=function(e,t){return function(){var n=new t;e.set("libraries",n)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(292)],r=function(e,t,n){return t.Collection.extend({model:n,url:window.getapi("mercury","/api/library"),parse:function(t){return e.isArray(t)?t:[]},fetch:function(){var e=this;return t.Collection.prototype.fetch.apply(this,arguments).always(function(){e.fetched=!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(47)],r=function(e,t){return function(){t.beltVent=new e.Wreqr.EventAggregator,t.statusVent=new e.Wreqr.EventAggregator}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(52),n(47),n(387),n(389),n(398)],r=function(e,t,n,i,r,o){return e.ItemView.extend({className:"belt",template:o,ui:{bar:".bar"},events:{"click .flexo-toggler":"clickFlexoToggler"},initialize:function(){var e=this;this.children=new t,this.listenTo(n.vent,{"notebook:loaded":function(){e.repos()},"belt:hide":function(){e.$el.hide()},"belt:show":function(){e.$el.show()}}),this.listenTo(n.beltVent,{"flexo:show":function(){e.$el.addClass("flexo-showed")},"flexo:hide":function(){e.$el.removeClass("flexo-showed")},"flexo:toggle":function(t){e.$el.toggleClass("flexo-showed"),t(e.$el.hasClass("flexo-showed"))}}),this.$el.hide()},onDestroy:function(){this.children.invoke("destroy")},onRender:function(){var e=new i,t=new r;this.children.add(e,"status"),this.children.add(t,"flexo"),this.ui.bar.append(e.render().el),this.$el.append(t.render().el),this.repos()},repos:function(){var e=n.body.find(".cells"),t=n.body.find(".cell-list"),i=20;e.length&&t.length&&(i+=e.width()-t.width()),this.$el.parent().css({right:i})},clickFlexoToggler:function(e){this.$el.hasClass("flexo-showed")?n.beltVent.trigger("flexo:hide"):n.beltVent.trigger("flexo:show")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(388)],r=function(e,t,n,i){return t.ItemView.extend({className:"status navbar-right",template:i,ui:{message:".message",indicator:".indicator"},initialize:function(){t.ItemView.prototype.initialize.apply(this,arguments);var e=this;this.listenTo(n.statusVent,"status",function(t){e.status(t)})},onDestroy:function(){clearTimeout(this.timeout)},message:function(e){this.ui.message.html(e)},indicate:function(t,i){this.ui.indicator.removeClass("busy"),e.isEmpty(n.notebookReqres.request("busyCells"))&&!i&&this.statusTip(t),this.ui.indicator.addClass(t||"")},statusTip:function(e){var t=this,n="busy"===e?"运行中":"运行完毕";clearTimeout(this.statusTipTimeout),this.ui.indicator.tooltip("destroy"),this.ui.indicator.tooltip({container:"body",title:n,trigger:"hover",template:'<div class="tooltip'+("busy"===e?" state-success":" state-default")+'" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'}).tooltip("show"),this.statusTipTimeout=setTimeout(function(){"busy"===e?t.ui.indicator.tooltip("hide"):t.ui.indicator.tooltip("destroy")},2e3)},emptyMsg:function(){this.ui.message.html('<span class="empty-message">Notebook状态</span>')},status:function(e){var t=this;this.timeout&&clearTimeout(this.timeout),e.message&&this.message(e.message),e.status&&this.indicate(e.status,e.reset),this.timeout=setTimeout(function(){t.emptyMsg()},5e3)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<span class="indicator"></span>\n<span class="message"></span>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(48),n(76),n(47),n(270),n(78),n(390),n(392),n(394),n(397)],r=function(e,t,n,i,r,o,a,s,l,c){return o.extend({className:"flexo",template:c,events:{"click .nav a":"clickNav","click .close":"clickClose"},navItemTpl:e.template('<li><a class="tab-<%= id %>" href="#<%= href %>"><i class="fa fa-<%= icon %>"></i><span class="name"><%= name %></span></a></li>'),onRender:function(){var e=this,o=new n.NestedModel({logs:[]}),a=new t.Model({text:""}),c=function(){e.showGroup("flexo-manual",{model:a})};this.nav=this.$el.find(".nav"),this.models={"flexo-log":o,"flexo-manual":a},this.addGroup(s,{id:"flexo-manual",name:"手册",href:"tab-flexo-manual",icon:"book"}),this.addGroup(l,{id:"flexo-monitor",name:"--",href:"tab-flexo-monitor",icon:"tachometer"}),this.listenTo(i.beltVent,{"flexo:log:reset":function(e){o.set("logs",e),o.trigger("reset")},"flexo:manual:reset":function(t){i.beltVent.trigger("flexo:show"),e.triggerMethod("flexo:shown"),a.set("text",t),c(),a.trigger("change")}}),r.setMode(null,1e4,!0),this.listenTo(r,{change:function(){var t=r.get("memory_usage")+"%";e.nav.find(".tab-flexo-monitor .name").text(t)}}),this.nav.find(".tab-flexo-monitor").attr({"data-toggle":"tooltip",title:"内存"}).tooltip({content:"内存",placement:"top"})},onDestroy:function(){this.stopListening()},clickNav:function(e){var t=this,n=$(e.currentTarget),r=n.attr("href").replace("#tab-","");n.parent().hasClass("active")?i.beltVent.trigger("flexo:toggle",function(e){e?t.triggerMethod("flexo:shown"):t.triggerMethod("flexo:hidden")}):(n.parent().addClass("active").siblings().removeClass("active"),this.showGroup(r,{model:this.models[r]}),i.beltVent.trigger("flexo:show"),this.triggerMethod("flexo:shown")),e.preventDefault()},clickClose:function(){i.beltVent.trigger("flexo:hide"),this.triggerMethod("flexo:hidden")},onFlexoShown:function(){var e=this.getCurrentGroup();e&&e.triggerMethod("flexo:child:show")},onFlexoHidden:function(){var e=this.getCurrentGroup();e&&e.triggerMethod("flexo:child:hide")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(391)],r=function(e,t,n){return t.ItemView.extend({className:"flexo-log",template:n,ui:{list:".list"},onRender:function(){var t=this;this.listenTo(this.model,{"add:logs":function(n,i){t.addLog(e.last(i))},reset:function(){t.resetLog()}}),this.on("tab:show",function(){t.scrollToBottom()}),this.resetLog()},resetLog:function(){var t=this;t.ui.list.empty(),e.isEmpty(this.model.get("logs"))?t.ui.list.append("此单元没有log"):e.each(e.last(this.model.get("logs"),200),function(e){t.addLog(e)}),this.scrollToBottom()},addLog:function(t){var n=e.template('<div class="flexo-log-item"><%= content %></div>');this.ui.list.append(n({content:t})),this.scrollToBottom()},scrollToBottom:function(){this.$el.parent().scrollTop(this.$el.height())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="list"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(282),n(393)],r=function(e,t,n,i,r){return t.ItemView.extend({className:"flexo-manual",template:r,ui:{text:".text"},onRender:function(){var e=this;this.model.get("text")||this.model.set("text",'运行如: "dict?", 可以查看其文档.'),this.text(),this.listenTo(this.model,"change",function(){e.text()})},text:function(){this.ui.text.html(this.model.get("text"))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="text"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(270),n(395),n(396)],r=function(e,t,n,i,r){return t.ItemView.extend({className:"flexo-monitor monitor",template:r,ui:{cpu:".cpu",mem:".mem",disk:".disk"},onRender:function(){var e=this;this.renderBars(n.getData()),this.listenTo(n,{change:function(){e.renderBars(n.getData())}})},onDestroy:function(){clearTimeout(this.updateTimeout),this.stopListening()},renderBars:function(e){this.ui.cpu.find(".value").text(e.cpu_usage+"%").end().find(".bar").attr("class","bar "+i(e.cpu_usage)).find("span").width(e.cpu_usage+"%"),this.ui.mem.find(".value").text(e.memory_desc).end().find(".bar").attr("class","bar "+i(e.memory_usage)).find("span").width(e.memory_usage+"%"),this.ui.disk.find(".value").text(e.disk_desc).end().find(".bar").attr("class","bar "+i(e.disk_usage)).find("span").width(e.disk_usage+"%")},onFlexoChildShow:function(){n.setMode("ipython",5e3)},onFlexoChildHide:function(){n.setMode(null,1e4,!0)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45)],r=function(e){var t=["usage-idle","usage-normal","usage-busy"];return function(n,i){return i=e.defaults(i||{},{colors:t,min:0,max:100}),i.colors[Math.floor(n*i.colors.length/i.max)]}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<h4>开始研究资源</h4>\n<ul class="stat-list">\n    <li class="cpu">\n        <span class="name">CPU</span>\n        <span class="used">\n            <span class="bar">\n                <span></span>\n            </span>\n            <span class="value">--</span>\n        </span>\n    </li>\n    <li class="mem">\n        <span class="name">内存</span>\n        <span class="used">\n            <span class="bar">\n                <span></span>\n            </span>\n            <span class="value">--</span>\n        </span>\n    </li>\n    <li class="disk">\n        <span class="name">硬盘</span>\n        <span class="used">\n            <span class="bar">\n                <span></span>\n            </span>\n            <span class="value">--</span>\n        </span>\n    </li>\n    <li>\n        <a href="community/mall" data-href="community/mall">用积分兑换大内存</a>\n    </li>\n</ul>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<span class="close">\n    <i class="fa fa-close"></i>\n</span>\n<ul class="nav nav-tabs panel-tab"></ul>\n<div class="tab-content"></div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="bar"></div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="region-sidebar"></div>\n<div class="workspace">\n    <div class="menu-bar clearfix">\n        <div class="region-title"></div>\n        <div class="region-menu"></div>\n    </div>\n    <div class="region-main"></div>\n</div>\n<div class="region-belt"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(67),n(47),n(116),n(401),n(424),n(425),n(158)],r=function(e,t,n,i,r,o,a,s){return e.LayoutView.extend({className:"labs-welcome",template:a,events:{"click .strategy-builder-go .btn":"goBuilder"},onRender:function(){new t({appendTo:this.el,appName:n.name,appVersion:n.version,links:!1});var e=this;n.vent.trigger("title","首页"),this.listenTo(n.vent,"guide:notebook",function(){console.log("fetchback"),e.fetchNoteBook()})},fetchNoteBook:function(){$.ajax({url:window.getapi("mercury","/api/notebooks")}).done(function(e){e&&e.length>0&&(console.log("open guide book"),n.Route.navigate("labs/notebooks/"+encodeURIComponent(s.toNB(e[0].name)),{trigger:!0}))})},onDestroy:function(){this.stopListening()},goBuilder:function(){var e=new r;this.listenTo(e,"finish",function(e){var t,r=i.get("notebooks");r.create({},{wait:!0,success:function(i){t=new o({cell_type:"strategy",input:e}),i.setCells([t]),i.save().done(function(){n.Route.navigate(i.appUrl(),{trigger:!0})})}})}),$(document.body).append(e.render().el)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(402),n(423)],r=function(e,t,n,i,r){return n.ItemView.extend({className:"strategy-builder modal fade",template:r,ui:{main:".modal-dialog",step:".step-body","public":".public-body"},initialize:function(){var e=this;this._current=null,this._currentIndex=-1,this.builder=i.topic,this.storage=new t.Model,this.$el.on("shown.bs.modal",function(){e.triggerMethod("shown")}).on("hidden.bs.modal",function(){e.triggerMethod("hidden"),e.destroy()})},onRender:function(){this.builder.className&&this.ui.main.addClass(this.builder.className),this.show()},onShown:function(){this.builder["public"]&&this.renderPublic(),this.next()},renderPublic:function(){var e=new this.builder["public"]({storage:this.storage});this.ui["public"].append(e.render().el),e.triggerMethod("show"),this["public"]=e},bindCurrentEvents:function(){var e=this;this.listenTo(this._current,{prev:function(){e.prev()},next:function(){-1===e.next()&&this.finish()},destroy:function(){e.unbindCurrentEvents()}})},unbindCurrentEvents:function(){this.stopListening(this._current)},show:function(){this.$el.modal("show")},hide:function(){this.$el.modal("hide")},onShow:function(){this["public"]&&this["public"].triggerMethod("shown"),this._current&&this._current.triggerMethod("shown")},go:function(e){var t=this.builder.steps[e];return t?(this._current&&this._current.destroy(),this._current=new t({storage:this.storage}),this._currentIndex=e,this.bindCurrentEvents(),this.ui.step.append(this._current.render().el),this._current.triggerMethod("show"),this._currentIndex):-1},next:function o(){var o=this._currentIndex+1;return this.go(o)},prev:function a(){var a=this._currentIndex-1;return this.go(a)},finish:function(){this.trigger("finish",this.storage.get("code")),this.hide()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(403)],r=function(e){return{topic:e}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(404),n(406),n(411)],r=function(e,t,n){return{className:"topic-builder",steps:[t,n],"public":e}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(162),n(405)],r=function(e,t,n){return e.ItemView.extend({className:"strategy-code-preview",template:n,ui:{code:".code"},initialize:function(e){var t=this;this.storage=e.storage,this.listenTo(this.storage,{"change:code":function(){t.reloadCode()}})},onDestroy:function(){this.storage=null},onRender:function(){this.cm=t(this.ui.code[0],{value:this.storage.get("code")||"",mode:"python",readOnly:!0})},onShow:function(){this.cm.refresh()},reloadCode:function(){this.cm.setValue(this.storage.get("code")||"")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<h3>策略代码预览</h3>\n<div class="public-wrapper">\n    <div class="code"></div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(407),n(408),n(409),n(410)],r=function(e,t,n){var i={startDate:"2014-01-01",endDate:"2015-01-01",capitalBase:1e6,refreshRate:5,universe:[],weight:[]},r=function(e){return/^\d{4}-\d{2}-\d{2}$/i.test(e)};return e.ItemView.extend({className:"topic-builder-step1",template:t,ui:{form:"form"},events:{"input input":"inputInput","change input":"inputInput","click .next":"clickNext"},initialize:function(e){this.storage=e.storage},onRender:function(){this.defaultPlaceholder(),this.desrializeForm(),this.storage.set(i),this.updateCode(),this.$el.find(".date").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(2006,0,1),maxDate:new Date,changeYear:!0,changeMonth:!0}).datepicker("widget").addClass("strategy-builder-datepicker")},updateCode:function(){this.storage.set("code",n(this.storage.toJSON()))},serializeForm:function(){var e,t={};return this.ui.form.find("input").each(function(n,i){i=$(i),e=i.attr("name"),t[e]=i.val()}),t},desrializeForm:function(){var e,t=this;this.ui.form.find("input").each(function(n,i){i=$(i),e=i.attr("name"),i.val(t.storage.get(e)||"")})},defaultPlaceholder:function(){var e;this.ui.form.find("input").each(function(t,n){n=$(n),e=n.attr("name"),n.attr("placeholder",i[e]||"")})},inputInput:function(e){var t,n=$(e.target),r=n.attr("name");-1!==r.search(/date/i)?this.checkDate():(t=n.val(),/^\d+$/i.test(t)&&t>0?(n.parent().parent().removeClass("has-error"),this.storage.set(r,t)):(t?n.parent().parent().addClass("has-error"):n.parent().parent().removeClass("has-error"),this.storage.set(r,i[r]))),this.updateCode()},checkDate:function(){var e=this.$el.find(".start-date"),t=this.$el.find(".end-date"),n=e.val(),o=t.val();return n?!r(n)||"2006-01-01">n?(e.parent().parent().addClass("has-error"),void this.storage.set("startDate",i.startDate)):(e.parent().parent().removeClass("has-error"),o?!r(o)||o>(new Date).toISOString().split("T")[0]?(t.parent().parent().addClass("has-error"),void this.storage.set("endDate",i.endDate)):(t.parent().parent().removeClass("has-error"),void(n>o?(e.parent().parent().addClass("has-error"),t.parent().parent().addClass("has-error"),this.storage.set({startDate:i.startDate,endDate:i.endDate})):(e.parent().parent().removeClass("has-error"),t.parent().parent().removeClass("has-error"),this.storage.set({startDate:n,endDate:o})))):void this.storage.set("endDate",i.endDate)):void this.storage.set("startDate",i.startDate)},clickNext:function(){this.trigger("next")}})}.apply(t,i),
!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<h3>主题投资组合调仓</h3>\n<div class="step-wrapper">\n    <form class="form-inline">\n        <div class="form-group">\n            <label for="startDate">起始日期: </label>\n            <div class="input-group">\n                <input name="startDate" type="text" class="date start-date form-control">\n                <div class="input-group-addon">\n                    <i class="fa fa-calendar"></i>\n                </div>\n            </div>\n        </div>\n        <div class="form-group">\n            <label for="endDate">结束日期: </label>\n            <div class="input-group">\n                <input name="endDate" type="text" class="date end-date form-control">\n                <div class="input-group-addon">\n                    <i class="fa fa-calendar"></i>\n                </div>\n            </div>\n        </div>\n        <div class="form-group">\n            <label for="capitalBase">初始资金: </label>\n            <div class="input-group">\n                <input name="capitalBase" type="text" class="number form-control">\n                <div class="input-group-addon">元</div>\n            </div>\n        </div>\n        <div class="form-group">\n            <label for="refreshRate">调仓频率: </label>\n            <div class="input-group">\n                <input name="refreshRate" type="text" class="number form-control">\n                <div class="input-group-addon">交易日</div>\n            </div>\n        </div>\n    </form>\n    <div class="step-nav clearfix">\n        <button class="btn btn-primary next">下一步</button>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="# 第一步：设置基本参数\nstart = '"+(null==(__t=startDate)?"":__t)+"'                         # 回测起始时间\nend   = '"+(null==(__t=endDate)?"":__t)+"'                         # 回测结束时间\ncapital_base = "+(null==(__t=capitalBase)?"":__t)+"                       # 起始资金\nrefresh_rate = "+(null==(__t=refreshRate)?"":__t)+"                             # 调仓频率\nbenchmark = 'HS300'                          # 策略参考标准\n";return __p}},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_409__},function(e,t,n){var i,r;i=[n(409)],r=function(){var e=$.datepicker;return e.regional["zh-CN"]={closeText:"关闭",prevText:"&#x3C;上月",nextText:"下月&#x3E;",currentText:"今天",monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthNamesShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayNames:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayNamesShort:["周日","周一","周二","周三","周四","周五","周六"],dayNamesMin:["日","一","二","三","四","五","六"],weekHeader:"周",dateFormat:"yy-mm-dd",firstDay:1,isRTL:!1,showMonthAfterYear:!0,yearSuffix:"年"},e.setDefaults(e.regional["zh-CN"]),e.regional["zh-CN"]}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(182),n(415),n(416),n(417),n(412),n(419),n(420),n(421),n(422),n(409)],r=function(e,t,n,i,r,o,a,s,l,c,u){return t.ItemView.extend({className:"topic-builder-step2",template:s,events:{"show.bs.dropdown .topic-select":"showHotTopic","click .topic-select a":"clickTopic","click .stock-search .submit":"clickStockSearchSubmit","click .fifty-fifty":"clickFiftyFifty","click .prev":"clickPrev","click .next":"clickNext"},ui:{hotTopicsSelected:".topic-select .selected",hotTopics:".topic-select .dropdown-menu",stocks:".selected-stocks",stockListBody:".selected-stocks .tbody",stockSearch:".stock-search",next:".next"},initialize:function(e){this.storage=e.storage},onDestroy:function(){$(window).off("resize.topicBuilder")},onRender:function(){var t=this,n=function(){t.$el.find(".selected-count").text(t.stocks.size())},i=e.debounce(function(){t.$el.find(".cash-remain").text((100-t.stocks.sum()).toFixed(2))},50);this.stocks=this.storage.get("stocks")||new o,this.stockList=new a({collection:this.stocks}),this.storage.set("code",l(this.storage.toJSON())),this.ui.stockListBody.append(this.stockList.render().el),this.listenTo(this.stocks,{"add remove reset":function(){n(),i(),t.checkStocks()},"add reset":function(){t.ui.stockListBody.scrollTop(9999999)},"change reset":function(){i(),t.checkStocks()}}),this.checkStocks(!0),i(),n(),this.initStockSearch()},onShow:function(){this.resizeTable()},checkStocks:function(e){var t,n=[],o=[];if(this.stocks.size())this.ui.next.removeAttr("disabled");else if(this.ui.next.attr("disabled",""),e)return;this.stocks.each(function(e){t=e.get("ticker"),n.push(i(t)),o.push(r(e.getWeight()/100,4))}),this.storage.set({universe:n,weights:o,stocks:this.stocks}),this.storage.set("code",c(this.storage.toJSON()))},resizeTable:function(){var t,n,i,r=this,o=this.ui.stocks.find(".tbody"),a=o.siblings(),s=this.ui.stocks.siblings(),l=this.$el.find("h3");i=function(){var e=0;a.each(function(t,n){e+=$(n).outerHeight()}),s.each(function(t,n){e+=$(n).outerHeight()}),e+=40,t=l.outerHeight(),n=r.$el.height(),o.height(n-t-e)},i(),i=e.debounce(i,40),$(window).on("resize.topicBuilder",function(){i()})},showHotTopic:function(){var t=this.ui.hotTopics,i="";t.empty(),$.ajax({url:window.getapi("irr","/newsapi/getCurrentSubjectIndices"),data:{day:0,selectType:"CS",sortedType:"updown"}}).done(function(r){1===r.code&&r.data&&(e.each(r.data,function(e){i+=u({id:e.subjectId,name:e.subjectName,type:e.subkjectType,changeClass:e.indexDelta>0?"change-up":"change-down",changeText:(e.indexDelta>0?"+":"")+n.format(e.indexDelta,"0.00%")})}),t.html(i))})},clickTopic:function(t){var n=this,i=$(t.currentTarget);t.preventDefault(),$.ajax({url:window.getapi("irr","/newsapi/getCurrentSubjectIndex"),data:{subjectId:i.data("id"),subjectType:i.data("type")}}).done(function(t){1===t.code&&t.data&&(n.ui.hotTopicsSelected.text(t.data.subjectName),n.stocks.reset(e.map(t.data.stocks,function(e){return{name:e.tickerName,ticker:e.stockId}})))})},initStockSearch:function(){var t=this,n=this.ui.stockSearch.find("input"),i=e.template('<a><span class="name"><%= name %></span><span class="ticker"><%= ticker %></span></a>');n.autocomplete({source:function(t,n){$.ajax({url:window.getapi("irr","/search"),data:{key:t.term}}).done(function(t){1===t.code&&t.data&&n(e.map(e.filter(t.data,function(e){return 2===e.type||1===e.type}),function(e){return{ticker:e.result,name:e.searchStrAlias,value:e.searchStrAlias}}))})},select:function(e,n){t.stockSearchSelected=n.item}}).data("ui-autocomplete")._renderItem=function(e,t){return $('<li class="ui-menu-item">').attr("data-value",t.name).append(i(t)).appendTo(e)}},clickStockSearchSubmit:function(){this.submitStockSearch()},submitStockSearch:function(){this.stockSearchSelected&&(this.stocks.add(this.stockSearchSelected),this.stockSearchSelected=null,this.ui.stockSearch.find("input").val(""))},clickFiftyFifty:function(){var e=100/this.stocks.size();e=(Math.floor(100*e)/100).toFixed(2),this.stocks.each(function(t){t.set("weight",e),t.trigger("change:weight:force")})},clickNext:function(){this.trigger("next")},clickPrev:function(e){this.trigger("prev"),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(413)],r=function(e,t){return e.CollectionView.extend({className:"stock-list",tagName:"ul",childView:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(414)],r=function(e,t){return e.ItemView.extend({className:"stock-item",tagName:"li",template:t,events:{"click .destroy":"clickDestroy","keypress input":"keypressInput","input input":"inputInput"},ui:{input:"input",bg:".bg"},onRender:function(){var e=this;this.listenTo(this.model,{"change:weight":function(){e.updateWeight()},"change:weight:force":function(){e.ui.input.val(e.model.get("weight"))}})},updateWeight:function(){this.ui.bg.width(this.model.get("weight")+"%")},clickDestroy:function(){this.model.destroy()},keypressInput:function(e){var t=".",n=!1,i=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(13==i&&"input"==e.currentTarget.nodeName.toLowerCase())return!0;if(13==i)return!1;var r=!1;if(e.ctrlKey&&97==i||e.ctrlKey&&65==i)return!0;if(e.ctrlKey&&120==i||e.ctrlKey&&88==i)return!0;if(e.ctrlKey&&99==i||e.ctrlKey&&67==i)return!0;if(e.ctrlKey&&122==i||e.ctrlKey&&90==i)return!0;if(e.ctrlKey&&118==i||e.ctrlKey&&86==i||e.shiftKey&&45==i)return!0;if(48>i||i>57){if(0!=e.currentTarget.value.indexOf("-")&&n&&45==i&&(0==e.currentTarget.value.length||0==$.fn.getSelectionStart(e.currentTarget)))return!0;t&&i==t.charCodeAt(0)&&-1!=e.currentTarget.value.indexOf(t)&&(r=!1),8!=i&&9!=i&&13!=i&&(35>i||i>40)&&46!=i?r=!1:"undefined"!=typeof e.charCode&&(e.keyCode==e.which&&0!=e.which?(r=!0,46==e.which&&(r=!1)):0!=e.keyCode&&0==e.charCode&&0==e.which&&(r=!0)),t&&i==t.charCodeAt(0)&&(-1==e.currentTarget.value.indexOf(t)?(r=!0,""==e.currentTarget.value&&(e.currentTarget.value=0)):r=!1)}else r=!0,"0"==e.currentTarget.value&&(e.currentTarget.value="");return r},inputInput:function(e){var t=this.ui.input.val(),n=100-this.model.collection.sum()+this.model.getWeight();t=t>n?n.toFixed(2):t,100>=t?this.model.set("weight",t||0):this.model.set("weight",0),this.ui.input.val(t)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<span class="c stock">\n    <span class="name">'+(null==(__t=name)?"":__t)+'</span>\n    <span class="ticker">('+(null==(__t=ticker)?"":__t)+')</span>\n    <span class="bg" style="width: '+(null==(__t=weight)?"":__t)+'%;"></span>\n</span>\n<span class="c weight">\n    <input class="form-control" type="text" value="'+(null==(__t=weight)?"":__t)+'"> %\n    <i class="fa fa-times destroy"></i>\n</span>\n';return __p}},function(e,t,n){var i;i=function(){return function(e){return"0"===e[0]||"3"===e[0]?e+".XSHE":"6"===e[0]?e+".XSHG":e}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){return function(e,t){var n=Math.pow(10,t||0);return String(Math.round(e*n)/n)}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(48),n(418)],r=function(e,t){return e.Collection.extend({model:t,sum:function(){return this.reduce(function(e,t){return e+t.getWeight()},0)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48)],r=function(e){return e.Model.extend({idAttribute:"ticker",defaults:{weight:0},destroy:function(){this.trigger("destroy",this,this.collection)},getWeight:function(){return parseFloat(this.get("weight"))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<h3>主题投资组合调仓</h3>\n<div class="step-wrapper">\n    <div class="hot-topic">\n        <div class="topic-select dropdown">\n            <span class="dropdown-toggle" data-toggle="dropdown">\n                <span class="selected">选择热门主题</span>\n                <span class="caret"></span>\n            </span>\n            <ul class="dropdown-menu"></ul>\n        </div>\n    </div>\n    <div class="form-group stock-search ui-front">\n        <div class="input-group">\n            <input class="form-control" type="text" placeholder="输入股票名称/代码">\n            <div class="input-group-btn">\n                <button class="btn btn-primary submit">添加</button>\n            </div>\n        </div>\n    </div>\n    <div class="selected-stocks">\n        <div class="table-faker">\n            <div class="thead">\n                <span class="c">股票(<span class="selected-count">0</span>)只</span>\n                <span class="c">仓位权重 <i class="fa fa-random fifty-fifty" title="平均分"></i></span>\n            </div>\n            <div class="tbody"></div>\n            <div class="tfoot">\n                <span class="c">可用现金</span>\n                <span class="c cash-remain-wrapper"><span class="cash-remain">100.00</span>%</span>\n            </div>\n        </div>\n    </div>\n    <div class="step-nav clearfix">\n        <a class="btn btn-link prev">上一步</a>\n        <button class="btn btn-primary next" disabled>创建主题策略</button>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="# 第一步：设置基本参数\nstart = '"+(null==(__t=startDate)?"":__t)+"'                         # 回测起始时间\nend   = '"+(null==(__t=endDate)?"":__t)+"'                         # 回测结束时间\ncapital_base = "+(null==(__t=capitalBase)?"":__t)+"                       # 起始资金\nrefresh_rate = "+(null==(__t=refreshRate)?"":__t)+"                             # 调仓频率\nbenchmark = 'HS300'                          # 策略参考标准\nfreq = 'd'                                 # 策略类型，'d'表示日间策略使用日线回测\n\n# 第二步：选择主题，设置股票池\nuniverse = []                              # 股票池\n\ndef initialize(account):                   # 初始化虚拟账户状态\n    pass\n\ndef handle_data(account):                  # 每个交易日的买入卖出指令\n    return\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+="import numpy as np\n\n# 第一步：设置基本参数\nstart = '"+(null==(__t=startDate)?"":__t)+"'\nend   = '"+(null==(__t=endDate)?"":__t)+"'\ncapital_base = "+(null==(__t=capitalBase)?"":__t)+"\nrefresh_rate = "+(null==(__t=refreshRate)?"":__t)+"\nbenchmark = 'HS300'\nfreq = 'd'\n\n# 第二步：选择主题，设置股票池\nuniverse = [",_.each(universe,function(e){__p+="'"+(null==(__t=e)?"":__t)+"', "}),__p+="]\n\ndef initialize(account):\n    # 第三步：调整股票权重，权重列表序号与股票池列表序号对应\n    account.weight = [",_.each(weights,function(e){__p+=(null==(__t=e)?"":__t)+", "}),__p+="]\n    account.weightmap = dict(zip(universe, account.weight))\n\ndef handle_data(account):\n    # 本策略将使用account的以下属性：\n    # account.referencePortfolioValue表示根据前收计算的当前持有证券市场价值与现金之和。\n    # account.universe表示当天，股票池中可以进行交易的证券池，剔除停牌退市等股票。\n    # account.referencePrice表示股票的参考价，一般使用的是上一日收盘价。\n    # account.valid_secpos字典，键为证券代码，值为虚拟账户中当前所持有该股票的数量。\n\n    c = account.referencePortfolioValue\n\n    # 计算调仓数量\n    change = {}\n    for stock in account.universe:\n        w = account.weightmap.get(stock, 0)\n        p = account.referencePrice[stock]\n        if not np.isnan(p):\n            change[stock] = int(c * w / p) - account.valid_secpos.get(stock, 0)\n\n    # 按先卖后买的顺序发出指令\n    for stock in sorted(change, key=change.get):\n        order(stock, change[stock])\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<li>\n    <a href="#" data-id="'+(null==(__t=id)?"":__t)+'" data-type="'+(null==(__t=type)?"":__t)+'">\n        <span class="name">'+__e(name)+'</span>\n        <span class="change '+(null==(__t=changeClass)?"":__t)+'">'+(null==(__t=changeText)?"":__t)+"</span>\n    </a>\n</li>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="modal-dialog">\n    <div class="modal-content">\n        <div class="modal-body">\n            <div class="step-body"></div>\n            <div class="public-body"></div>\n        </div>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(188)],r=function(e){return e}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="notifications">\n    <a href="help/changelog/" data-href="help/changelog/">近期更新: 优矿500万实盘量化大赛正式开始，点击查看详情</a>\n</div>\n<div class="welcome">\n    <div class="strategy-builder-go">\n        还不太懂如何写策略？用策略生成器，快速上手！\n        <button class="btn btn-primary btn-lg"><i class="fa fa-line-chart"></i>策略生成器</button>\n    </div>\n    <div class="features">\n        <div class="row">\n            <div class="col-md-4">\n                <div class="feature">\n                    <i class="fa fa-book"></i>\n                    <h3>Notebook</h3>\n                    <p>\n                        Strategy 模式：投资策略现场模拟<br>\n                        Code 模式：大数据分析、机器学习<br>\n                        Markdown 模式：丰富格式的文档<br>\n                        <a class="more" href="help/faq/#Notebook是干什么的" target="_blank">查看详情</a>\n                    </p>\n                </div>\n            </div>\n            <div class="col-md-4">\n                <div class="feature">\n                    <i class="fa fa-tasks"></i>\n                    <h3>Data</h3>\n                    <p>\n                        债券、股票、基金等海量金融数据<br>\n                        更有新闻情感等二次分析数据<br>\n                        让金融大数据唾手可得<br>\n                        <a class="more" href="help/faq/#如何获取数据" target="_blank">查看详情</a>\n                    </p>\n                </div>\n            </div>\n            <div class="col-md-4">\n                <div class="feature">\n                    <i class="fa fa-archive"></i>\n                    <h3>Library</h3>\n                    <p>\n                        从Notebook到Library<br>\n                        一键发布，轻松调用<br>\n                        打造定制化的私有开发库<br>\n                        <a class="more" href="help/faq/#Library是干什么的" target="_blank">查看详情</a>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(427),n(46),n(115),n(47),n(158),n(428),n(429),n(116),n(430),n(157),n(431),n(424),n(432),n(550),n(555),n(562),n(557),n(563),n(564)],r=function(e,t,n,i,r,o,a,s,l,c,u,d,h,p,f,m,g,v,y,b,_){return t.LayoutView.extend({className:"notebook-detail",template:_,regions:{cellList:".cells"},initialize:function(e){var n=a.toIPYNB(e.name),i=c.get("notebooks"),r=i.get(n);r?r.set("current",!0):(r=new d({name:n,current:!0}),i.add(r)),this.model=r,this.kernel=new u({notebook:this.model}),t.LayoutView.prototype.initialize.apply(this,arguments)},onRender:function(){var e,t=this;this.listenTo(this.model,"destroy",function(){t.model.get("current")&&o.Route.navigate("labs/",{trigger:!0})}),this.on("show",function(){t.handleKernelEvents(),t.listenTo(t.kernel,{idle:function(){if(s.isDocumentHidden()){var n=o.reqres.request("generateTitle",t.model.displayName());e=l(["[运行结束]",n])}}}),t.listenTo(t.model,{notFound:function(){var e=r.Alert({OK:"OK",title:"微核错误",content:"由于您的Notebook已被删除或者重命名, 无法启动微核."});e.$el.on("hidden.bs.modal",function(){o.Route.notFound(),e.$el.remove()})}}),t.handleTitleChange(),o.vent.trigger("title:reset",{title:t.model.displayName()}),t.menuController=new g({view:t}),o.vent.trigger("menu:reset",y),t.listenTo(o.vent,"toolbar:click",function(e){t.menuController[e]&&t.menuController[e]()}),o.vent.trigger("toolbar:reset",v),o.vent.trigger("belt:show"),t.listenTo(o.vent,"detail:cells:scroll:on",function(){t.cellList.$el.on("scroll",function(){o.vent.trigger("detail:cells:scroll")})}),t.listenTo(o.vent,"detail:cells:scroll:off",function(){t.cellList.$el.off("scroll")}),t.listenTo(o.vent,"notebook:save",function(e,n){t.save(e,n)}),t.share=new m({notebook:t}),o.body.find(".region-title").append(t.share.render().el),t.bindKey()}),this.listenTo(this.model,"sync",function(){t.autosave(),t.saving=!1}),$(window).on("beforeunload.save",function(){return t.save(),t.saving?"Notebook尚未保存":t.isBusy()?"Notebook正在运行，如果关闭会导致运行的输出丢失":void 0}).on("unload.disconnect",function(){t.kernel.disconnect()}),o.Route.blockRoute=function(e){if(t.isBusy()){var n=r.Confirm({title:"确认离开",content:"您有代码正在运行，离开后将会导致运行结果无法显示，是否确定离开？",positive:"确认",negtive:"取消",yes:function(){t.kernel.interrupt(),e()}});n.$el.on("hidden.bs.modal",function(){n.$el.remove()})}else e()},s.addListener("kernelBusy",function(n){o.reqres.request("generateTitle",t.model.displayName());n&&t.isBusy()?document.title="[正在运行]":(e&&e(),o.vent.trigger("title:reset",{title:t.model.displayName()}))}),this.on("destroy",function(){e&&e()})},onDestroy:function(){clearInterval(this.autosaveInterval),this.stopListening(),this.menuController.destroy(),n.unbind(e.map(b,function(e,t){return t}).join(", ")),this.kernel.destroy(),this.share.destroy(),this.model.get("fetched")?(this.list.destroy(),this.model.set("current",!1),this.save(!0)):(this.model.clear({silent:!0}),this.model.destroy()),o.statusVent.trigger("status",{status:"idle",reset:!0}),s.removeListener("kernelBusy"),$(window).off("beforeunload.save"),o.vent.trigger("belt:hide"),o.Route.blockRoute=null},handleKernelEvents:function(){var e=this;e.listenTo(o.vent,{"kernel:disconnected":function(t){if(!t){var n=r.Alert({OK:"OK",title:"网络错误",content:'请确保您的网络正常, 然后点击"OK"重新连接.'});n.$el.on("hidden.bs.modal",function(){n.$el.remove(),e.kernel.destroy(),e.kernel=new u({notebook:e.model}),e.kernel.restartSession()})}},"kernel:full":function(){var e=r.Alert({OK:"OK",title:"微核错误",content:"微核启动失败，您的微核个数已经达到5个上限，请在Notebook列表中关闭其他微核。"});e.$el.on("hidden.bs.modal",function(){e.destroy()})},kernel:function(t,n){switch(t){case"execute":e.kernel.execute(n);break;case"complete":e.kernel.complete(n);break;case"inspect":e.kernel.inspect(n)}}}),e.listenTo(e.kernel,{autorestart:function(){var e=r.Alert({OK:"OK",title:"微核错误",content:'由于您的Notebook运行内容占用内存过大或其他逻辑错误，微核已自动重启。<br/><a href="community/mall" target="_blank">用积分兑换大内存吧~</a>'});e.$el.on("hidden.bs.modal",function(){e.$el.remove()})},started:function(){e.getInitialState()}})},handleTitleChange:function(){var t=this;t.listenTo(o.vent,"title:change",function(n,i){n+=".ipynb";var r=t.model.validateTitle(n);return e.isNull(r)?void t.model.save({},{attrs:e.extend(t.model.toJSON(),{name:n}),success:function(){t.model.renameSession().done(function(){o.Route.navigate(t.model.appUrl(),{trigger:!1}),o.vent.trigger("title:reset",{title:t.model.displayName(),edit:!0}),i.hide()})},error:function(e,t){409===t.status&&i.error("Notebook已存在, 请尝试其它名字.")}}):void i.error(r)})},autosave:function(){clearInterval(this.autosaveInterval);var e=this;this.autosaveInterval=setInterval(function(){e.save()},18e4)},save:function(e,t){var n=this,r=this.list.collection.toJSON();return this.model.cellsChanged(r)?(this.saving=!0,this.model.setCells(r),e?void this.model.save({},function(){t&&t()}):(o.statusVent.trigger("status",{message:"正在保存"}),void i.forceLoginWithModal().done(function(){n.model.save({},{success:function(){t&&t(),o.statusVent.trigger("status",{message:"保存成功"})},error:function(){o.statusVent.trigger("status",{message:"保存失败"})}})}))):void(t&&t())},bindKey:function(){var t=this;n.filter=function(){return!0},t.listenTo(o.keyVent,"press",function(e){t.menuController[e]&&t.menuController[e]()}),e.each(b,function(e,t){n(t,function(){return o.keyVent.trigger("press",e),!1})})},render:function(){t.LayoutView.prototype.render.apply(this,arguments);var e=this,n=new h;return o.statusVent.trigger("status",{message:"载入Notebook"}),this.model.fetch().done(function(){e.model.set("fetched",!0),n.set(e.model.cells()),e.list=new f({collection:n}),e.cellList.show(e.list),e.list.children.findByIndex(0).on("focused",function(){}),e.list.focusChild(e.list.children.findByIndex(0)),e.kernel.start().done(function(){e.kernel.connect()}),o.notebookReqres.setHandler("busyCells",function(){return e.list.getBusyCells()}),o.notebookReqres.setHandler("notebookName",function(){return e.model.get("name")}),o.vent.trigger("notebook:loaded"),o.statusVent.trigger("status",{message:"Notebook载入成功"})}).fail(function(e){404===e.status&&o.Route.notFound()}),this},isBusy:function(){return this.list?this.list.hasBusyCell():!1},getInitialState:function(){var e=this;$.ajax({url:window.getapi("mercury","/api/kernels/isbusy?kernel_id="+this.kernel.kernelID)}).done(function(t){t=JSON.parse(t),t.busy&&(o.statusVent.trigger("status",{status:"busy"}),e.listenToOnce(e.kernel,"idle",function(){o.statusVent.trigger("status",{status:"idle"})}))})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){!function(t){function n(e,t){for(var n=e.length;n--;)if(e[n]===t)return n;return-1}function i(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function r(e){for(_ in x)x[_]=e[M[_]]}function o(e){var t,i,o,a,s,c;if(t=e.keyCode,-1==n(D,t)&&D.push(t),(93==t||224==t)&&(t=91),t in x){x[t]=!0;for(o in k)k[o]==t&&(l[o]=!0)}else if(r(e),l.filter.call(this,e)&&t in w)for(c=f(),a=0;a<w[t].length;a++)if(i=w[t][a],i.scope==c||"all"==i.scope){s=i.mods.length>0;for(o in x)(!x[o]&&n(i.mods,+o)>-1||x[o]&&-1==n(i.mods,+o))&&(s=!1);(0!=i.mods.length||x[16]||x[18]||x[17]||x[91])&&!s||i.method(e,i)===!1&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function a(e){var t,i=e.keyCode,r=n(D,i);if(r>=0&&D.splice(r,1),(93==i||224==i)&&(i=91),i in x){x[i]=!1;for(t in k)k[t]==i&&(l[t]=!1)}}function s(){for(_ in x)x[_]=!1;for(_ in k)l[_]=!1}function l(e,t,n){var i,r;i=g(e),void 0===n&&(n=t,t="all");for(var o=0;o<i.length;o++)r=[],e=i[o].split("+"),e.length>1&&(r=v(e),e=[e[e.length-1]]),e=e[0],e=T(e),e in w||(w[e]=[]),w[e].push({shortcut:i[o],scope:t,method:n,key:i[o],mods:r})}function c(e,t){var n,r,o,a,s,l=[];for(n=g(e),a=0;a<n.length;a++){if(r=n[a].split("+"),r.length>1&&(l=v(r),e=r[r.length-1]),e=T(e),void 0===t&&(t=f()),!w[e])return;for(o=0;o<w[e].length;o++)s=w[e][o],s.scope===t&&i(s.mods,l)&&(w[e][o]={})}}function u(e){return"string"==typeof e&&(e=T(e)),-1!=n(D,e)}function d(){return D.slice(0)}function h(e){var t=(e.target||e.srcElement).tagName;return!("INPUT"==t||"SELECT"==t||"TEXTAREA"==t)}function p(e){C=e||"all"}function f(){return C||"all"}function m(e){var t,n,i;for(t in w)for(n=w[t],i=0;i<n.length;)n[i].scope===e?n.splice(i,1):i++}function g(e){var t;return e=e.replace(/\s/g,""),t=e.split(","),""==t[t.length-1]&&(t[t.length-2]+=","),t}function v(e){for(var t=e.slice(0,e.length-1),n=0;n<t.length;n++)t[n]=k[t[n]];return t}function y(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,function(){n(window.event)})}function b(){var e=t.key;return t.key=$,e}var _,w={},x={16:!1,18:!1,17:!1,91:!1},C="all",k={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},S={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},T=function(e){return S[e]||e.toUpperCase().charCodeAt(0)},D=[];for(_=1;20>_;_++)S["f"+_]=111+_;var M={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};for(_ in k)l[_]=!1;y(document,"keydown",function(e){o(e)}),y(document,"keyup",a),y(window,"focus",s);var $=t.key;t.key=l,t.key.setScope=p,t.key.getScope=f,t.key.deleteScope=m,t.key.filter=h,t.key.isPressed=u,t.key.getPressedKeyCodes=d,t.key.noConflict=b,t.key.unbind=c,e.exports=l}(this)},function(e,t,n){"use strict";function i(e,t){if(!u["default"].isUndefined(document.addEventListener)&&!u["default"].isUndefined(document[s])){var n=$(document);n.on(l+"."+e,function(){t(document[s])})}}function r(e){if(!u["default"].isUndefined(document.addEventListener)&&!u["default"].isUndefined(document[s])){var t=$(document);t.off(l+"."+e)}}function o(){return document[s]}var a=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0}),t.addListener=i,t.removeListener=r,t.isDocumentHidden=o;var s,l,c=n(45),u=a(c);"undefined"!=typeof document.hidden?(s="hidden",l="visibilitychange"):"undefined"!=typeof document.mozHidden?(s="mozHidden",l="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(s="msHidden",l="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(s="webkitHidden",l="webkitvisibilitychange")},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){var t,n=arguments.length<=1||void 0===arguments[1]?500:arguments[1],i=0,r=e.length-1,o=function(e){document.title=e},a=function(){o(e[i]),i===r?i=0:i+=1},s=function l(){t=setTimeout(function(){a(),l()},n)};return s(),function(){clearTimeout(t)}},e.exports=t["default"]},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(189)],r=function(e,t,n,i){return t.Controller.extend({initialize:function(e){var t=this;this.sessionID=i(),this.notebook=e.notebook,this._msgMap={},this._msgQueue=[],this.sessionRestarting=!1,this.on("shutdown",function(){t.disconnect()})},onDestroy:function(){this.disconnect()},msgMap:function(e){return this._msgMap[e]=this._msgMap[e]||{},this._msgMap[e]},start:function(){var e=this;return this.notebook.startSession().done(function(t){e.kernelID=t.kernel.id,e.trigger("started")}).fail(function(e){490===e.status&&n.vent.trigger("kernel:full")})},restartSession:function(){if(!this.sessionRestarting){var t=this;this.sessionRestarting=!0,this.start().done(function(){t.connect().done(function(){e.each(t._msgQueue,function(e){t.channels[e.channel].send(e.msg)}),t._msgQueue=[],n.vent.trigger("kernel:restarted")})}).fail(function(){t._msgQueue=[]}).always(function(){t.sessionRestarting=!1})}},restart:function(){var e=this;return n.statusVent.trigger("status",{message:"正在重启微核"}),e.disconnect(),$.ajax({url:window.getapi("mercury","/api/kernels/"+this.kernelID+"/restart"),type:"POST"}).then(function(){n.statusVent.trigger("status",{message:"微核重启完毕",status:"idle",reset:!0}),n.vent.trigger("kernel:restarted"),e.connect()})},autoRestart:function(e){"restarting"===e&&(n.statusVent.trigger("status",{message:"正在重启微核"}),this.trigger("autorestart"),this.autoRestarting=!0),"starting"===e&&this.autoRestarting&&(n.statusVent.trigger("status",{message:"微核重启完毕"}),n.vent.trigger("kernel:restarted"),this.autoRestarting=!1)},connect:function(){var t=this,i=$.Deferred(),r=window.getapi("mercury","/api/kernels/"+this.kernelID).replace(/^http/,"ws"),o=!1,a={},s=function(e){e.target.send(t.sessionID+":"+document.cookie),e.target.defer.resolve()},l=function(e){o||(o=!0,e.wasClean||(t.disconnect(),n.statusVent.trigger("status",{message:"Websocket重连中"}),setTimeout(function(){t.connect()},1e3)))},c=function(e){o||(o=!0,e.wasClean||(t.disconnect(),n.vent.trigger("kernel:disconnected",!1)))};return n.statusVent.trigger("status",{message:"Websocket连接中"}),this.shellChannel=new WebSocket(r+"/shell"),this.stdinChannel=new WebSocket(r+"/stdin"),this.iopubChannel=new WebSocket(r+"/iopub"),a={shell:this.shellChannel,stdin:this.stdinChannel,iopub:this.iopubChannel},e.each(a,function(e){e.onclose=l,e.onopen=s,e.defer=$.Deferred()}),setTimeout(function(){e.each(a,function(e){e.onclose=c})},2e3),this.channels=a,this.shellChannel.onmessage=e.bind(this.onShellMessage,this),this.stdinChannel.onmessage=e.bind(this.onStdinMessage,this),this.iopubChannel.onmessage=e.bind(this.onIopubMessage,this),$.when(this.shellChannel.defer,this.stdinChannel.defer,this.iopubChannel.defer).done(function(){n.statusVent.trigger("status",{message:"Websocket已连接"}),i.resolve()}),this.startPulse(),window.k=this,i},connected:function(){return this.channels&&e.all(this.channels,function(e){return e&&1===e.readyState})},interrupt:function(){return $.ajax({url:window.getapi("mercury","/api/kernels/"+this.kernelID+"/interrupt"),type:"POST"}).done(function(){n.vent.trigger("kernel:interrupted")})},disconnect:function(){clearInterval(this.pulseInterval),e.each(this.channels,function(e){e.onclose=null,e.close(),e=null})},startPulse:function(){var t=this;this.pulseInterval=setInterval(function(){t.connected()&&e.each(t.channels,function(e,n){t.send(n,"pulse",{})})},6e4)},msg:function r(e,t,n){var r={header:{msg_id:i(),username:"username",session:this.sessionID,msg_type:e},metadata:n||{},content:t,parent_header:{}};return r},send:function(e,t,n,i){var r=this.msg(t,n,i);return this.connected()?(e=this.channels[e],e.send(JSON.stringify(r))):(this._msgQueue.push({channel:e,msg:JSON.stringify(r)}),this.restartSession()),r.header.msg_id},execute:function(t){var n,i={code:t.code,silent:!1,store_history:!0,user_variables:[],user_expressions:{},allow_stdin:!0};t.attrs&&e.extend(i,t.attrs),n=this.send("shell","execute_request",i),this.msgMap("executes")[n]=t.src},complete:function(e){var t={text:"",line:e.code,block:null,cursor_pos:e.cursor},n=this.send("shell","complete_request",t);this.msgMap("complete")[n]=e.src},inspect:function(e){var t={oname:e.token,detail_level:0},n=this.send("shell","object_info_request",t);
this.msgMap("inspect")[n]=e.src},onShellMessage:function(e){var t=JSON.parse(e.data),n=t.parent_header.msg_id;"complete_reply"===t.header.msg_type?this.onReply("complete",n,"completeReply",t):"object_info_reply"===t.header.msg_type?this.onReply("inspect",n,"inspectReply",t):"execute_reply"===t.header.msg_type&&this.onReply("executes",n,"executeReply",t)},onIopubMessage:function(t){var n=JSON.parse(t.data),i=["stream","display_data","pyout","pyerr"],r=n.parent_header.msg_id;return console.log("get io data",n),r||"status"!==n.header.msg_type?void(e.contains(i,n.header.msg_type)?this.onReply("executes",r,"output",n):"status"===n.header.msg_type?(this.onReply("executes",r,"status",n),this.trigger(n.content.execution_state)):"clear_output"===n.header.msg_type||"shutdown_reply"===n.header.msg_type&&("ok"!==n.content.status||n.content.restart||this.trigger("shutdown"))):void this.autoRestart(n.content.execution_state)},onStdinMessage:function(){},onReply:function(e,t,n,i){this.msgMap(e)[t]&&this.msgMap(e)[t].trigger(n,i)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(424)],r=function(e,t){return e.Collection.extend({model:t,addDefault:function(){return this.add({cell_type:"code","new":!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(160),n(47),n(433),n(424),n(401),n(549)],r=function(e,t,n,i,r,o,a,s){return n.extend({className:"cell-list",events:{"mousedown .cell":"mousedownCell","click .add-cell .add-default":"clickAddCell","click .add-cell .add-strategy":"clickAddStrategy"},childEvents:{move:function(e,t){this.moveChild(e,t)},save:function(){console.log("save")},destroy:function(e){e==this.focusedChild&&(this.focusedChild=null,this.focusNext(e)),0===this.collection.length&&i.menuVent.trigger("addCell")},next:function(e,t){t&&this.focusNext(e,t)},focusme:function(e){this.focusChild(e)}},childView:r,render:function(){t.CollectionView.prototype.render.apply(this,arguments);var e=$(s());return this.$el.prepend(e),0===this.collection.length&&this.collection.addDefault(),this},onRender:function(){var e=this;this.listenTo(i.vent,"mainNav:collapsed mainNav:expanded",function(){e.children.each(function(e){e.editor.refresh()})})},onDestroy:function(){this.stopListening()},focusNext:function(e,t){var n,i=this.$el.find(".cell"),r=i.index(e.$el);if(r+1>=i.length){if(t)return void t(e);r-=1}else r+=1;r=i.eq(r),r.length<1||(n=this.findChildByEl(r[0]),n&&(this.focusChild(n),setTimeout(function(){n.editor.focus()},10)))},clickAddCell:function(e){var t=$(e.currentTarget).parents(".add-cell"),n=this.$el.find(".cell").index(t.prev()),i=new o({cell_type:"code","new":!0});this.collection.add(i,{at:n+1})},clickAddStrategy:function(e){var t=this,n=new a;$(document.body).append(n.render().el),n.on("finish",function(n){var i=$(e.currentTarget).parents(".add-cell"),r=t.$el.find(".cell").index(i.prev()),a=new o({cell_type:"strategy","new":!0,input:n});t.collection.add(a,{at:r+1})})},moveChild:function(e,t){var n,i,r=this,o=function(e,t){return"up"==t?(e-=1,0>e?0:e):(e+=1,e>=r.collection.length?r.collection.length:e)},a=this.collection.indexOf(e.model),s=o(a,t),l=$([e.el,e.$el.next()[0]]);a!==s&&(n=this.collection.at(s),n=this.children.findByModel(n),i=this.collection.models[a],this.collection.models[a]=this.collection.models[s],this.collection.models[s]=i,i=e._index,e._index=n._index,n._index=i,"up"===t?n.$el.before(l):n.$el.next().after(l))},findChildByEl:function(e){var t=this.children.filter(function(t){return t.el===e});return t.length?t[0]:null},getBusyCells:function(){return this.children.filter(function(e){return e.busy})},hasBusyCell:function(){return!e.isEmpty(this.getBusyCells())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(115),n(161),n(434),n(544),n(548),n(549),n(171),n(175)],r=function(e,t,n,i,r,o){return t.extend({template:r,modelEvents:{"change:cell_type":"changeCellType"},controllers:n,initialize:function(){var e=this;this.on("run",function(){e.controller.run()}),this.on("runAndNext",function(){e.controller.runAndNext()}),this.on("runAndAdd",function(){e.controller.runAndAdd()}),this.on("render",function(){e.initHandle()}),t.prototype.initialize.apply(this,arguments),console.log("cell data",this.model.toJSON())},onShow:function(){var e=this,t=$(o());this.$el.after(t),this.model.get("new")&&(this.trigger("focusme",this),setTimeout(function(){e.editor.focus()},10),this.model.unset("new"))},initHandle:function(){var e=this,t=new i({cellType:this.model.get("cell_type")}).render();this.ui.code.prepend(t.el),this.bindUIElements(),t.on("typeChange",function(t){e.model.convert(t)}),t.listenTo(e.model,"change:cell_type",function(){t.trigger("changeType",e.model.get("cell_type"))}),t.on("delete",function(){e.deleteConfirm()}),t.on("foldCode",function(){e.foldCode()}),t.on("moveUp",function(){e.trigger("move","up")}),t.on("moveDown",function(){e.trigger("move","down")}),this.handle=t,this.trigger("render:handle"),t.toggleFoldCode(this.model.get("folded"))},deleteConfirm:function(){var t=this,n=new e.Confirm({title:"删除确认",content:"确定删除此单元吗?",yes:function(){t.model.destroy()}});n.$el.on("hidden.bs.modal",function(){n.destroy()})},refresh:function(){var e=this;setTimeout(function(){e.editor.refresh(),e.trigger("editorInited")},1)},showAddBtn:function(){this.$el.prev(".add-cell").addClass("show"),this.$el.next(".add-cell").addClass("show")},hideAddBtn:function(){this.$el.prev(".add-cell").removeClass("show"),this.$el.next(".add-cell").removeClass("show")},foldCode:function(){var e=this;this.model.get("folded")?(this.$el.find(".CodeMirror-scroll").velocity({height:this.$el.find(".CodeMirror-sizer").height()},{duration:200,easing:"easeOut",complete:function(){e.editor.refresh()}}),this.handle.toggleFoldCode(!1),this.model.set({folded:!1})):(this.$el.find(".CodeMirror-scroll").velocity({height:20},{duration:200,easing:"easeOut",complete:function(){e.editor.refresh()}}),this.handle.toggleFoldCode(!0),this.model.set({folded:!0}))},changeCellType:function(){this.initController(),this.trigger("switch"),this.clearResult(),this.editor.setOption("mode",this.model.getCMMode())},clearResult:function(){"markdown"!==this.model.get("cell_type")&&t.prototype.clearResult.apply(this,arguments)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(435),n(436),n(440)],r=function(e,t,n){return{markdown:e,code:t,heading:e,strategy:n,raw:e}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(177),n(89),n(193)],r=function(e,t){return e.extend({initialize:function(t){e.prototype.initialize.apply(this,arguments);var n=this;t.view.$el.on("dblclick",".result, .buffer",function(e){n.dblclickResult(e)})},dblclickResult:function(){this.view.ui.code.show(),this.view.ui.resultWrapper.hide(),this.noHandle=!1,this.view.editor.focus()},cmOptions:{extraKeys:{Enter:"newlineAndIndentContinueMarkdownList"}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(163),n(47),n(437),n(179),n(439)],r=function(e,t,n,i,r){return r.extend({initialize:function(t){r.prototype.initialize.apply(this,arguments);var i=this;this.eventArgs={isTab:!1,node:null},this.listenTo(this.view,{output:function(e){i.output(e)},executeReply:function(t){e.each(t.content.payload,function(e){i.payload(e,t)})},focus:function(){i.resetLogs()}}),this.listenTo(n.vent,{"kernel:full kernel:restarted kernel:restarted":function(){i.status({content:{execution_state:"idle",reset:!0}})},codehint:function(e){e.controller===i&&190===e.key?i.showDotHint(i.view.editor):i.eventArgs.isPop&&i.isRemovePop(i.view.editor)}})},onDestroy:function(){r.prototype.onDestroy.apply(this,arguments),n.body.off("click.destroyInspect")},run:function(e){return this.view.busy?void 0:(r.prototype.run.apply(this,arguments),e?void n.vent.trigger("kernel","execute",{code:e,src:this.view}):void n.vent.trigger("kernel","execute",{code:this.getCode(),src:this.view}))},output:function(e){if(this.view.model.addOutput(e),"stream"===e.msg_type&&"stdout"===e.content.name)this.view.appendResult(e.content.data).addClass("stream");else if("pyout"===e.msg_type)this.view.appendResult(e.content.data["text/html"]||e.content.data["text/plain"]).addClass("pyout");else if("display_data"===e.msg_type)this.view.appendResult(this.outputImage(e.content.data["image/png"]));else if("pyerr"===e.msg_type){var t=this.formatPyerr(e.content.traceback);this.view.appendResult(t,!0).addClass("pyerr")}this.view.model.get("collapsed")&&this.view.showResult()},resetLogs:function(){var t=this.view.model.get("outputs"),i=[];e.each(t,function(e){"stream"===e.output_type&&"stdout"===e.stream&&i.push(e.text)}),n.beltVent.trigger("flexo:log:reset",i)},isRemovePop:function(e){var t=e.getCursor(),n=e.getTokenAt(t);this.eventArgs.isPop&&(this.eventArgs.cur.line===t.line&&")"===n.string||this.eventArgs.cur.line!==t.line)&&this.removePop()},removePop:function(){this.eventArgs.isPop=!1,this.eventArgs.popover&&this.eventArgs.popover.destroy(),this.eventArgs.args="",this.eventArgs.docstring="",$(".inspect-tooltip").remove(),n.vent.trigger("detail:cells:scroll:off")},showDotHint:function(e){var n=e.getCursor(),i=e.getTokenAt(n);e.getTokenAt(t.Pos(n.line,i.start));this.removePop(),i.string&&i.string.trim()?this.showHint(e,n):0==i.start&&0==i.end?e.execCommand("indentMore"):e.execCommand("insertSoftTab")},cmOptions:function(){var e=this;return{extraKeys:{Tab:function(n){var i=n.getCursor(),r=n.getTokenAt(i);n.getTokenAt(t.Pos(i.line,r.start));"%"!==r.string&&(e.removePop(),r.string&&r.string.trim()?e.showHint(n,i):0==r.start&&0==r.end?n.execCommand("indentMore"):n.execCommand("insertSoftTab"))},"Ctrl-I":function(t){e.triggerPop(t)}}}},triggerPop:function(e){var t,i,r,o,a=this,s=e.getCursor(),l=e.getTokenAt(s);")"!==l.string&&(o=e.getRange({line:s.line,ch:0},{line:s.line,ch:l.start}),t=o.split(" "),i=t[t.length-1],(r=i.indexOf("("))>=0&&i.indexOf(")")<0&&(i=i.substr(0,r)),""===i&&(i=l.string),a.removePop(),n.vent.trigger("kernel","inspect",{token:i,src:a.view}),a.view.once("inspectReply",function(t){t.content.docstring&&"<no docstring>"!==t.content.docstring&&a.showPop(a.outdefString(t.content.definition),e.cursorCoords(s),s,t.content.docstring)}))},showHint:function(i,r){var o,a,s,l=this,c=null,u=null,d=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},h=function(){return i.getRange({line:r.line,ch:0},{line:r.line,ch:r.ch})},p=function(e,t){var n,i=e.length,r=t.length,o=Math.min(i,r);for(n=o;n>=0&&e.slice(i-n,i)!==t.slice(0,n);n--);return e.slice(0,i-n)+t},f=function(n){var r=i.getCursor(),a=i.getTokenAt(r),s=[],l=new RegExp("^"+d(p(u,a.string)),"i");return e.each(n.words,function(e){-1!==e.search(l)&&s.push(e)}),s.length?{list:s,from:t.Pos(r.line,o),to:t.Pos(r.line,a.end)}:{list:[]}};a=function(n,i,a){var d,h;return l.view.off("completeReply"),c?(s=f({words:c}),l.CMEvent(s,n,r),void i(s)):void l.view.once("completeReply",function(a){var p=a.content;if(l.eventArgs.data=a,c=[],u="","ok"===p.status&&!e.isEmpty(p.matches)){if(1===p.matches.length&&p.matches[0]===p.matched_text)return;u=p.matched_text,c=p.matches,d=r.ch-p.matched_text.length,h=r.ch,o=d,s={list:c,from:t.Pos(r.line,d),to:t.Pos(r.line,h)},l.CMEvent(s,n,r),i(s)}})},a.async=!0,n.vent.trigger("kernel","complete",{code:h(),corsor:r.ch,src:l.view}),i.showHint({hint:a,closeOnUnfocus:!0})},showPop:function(t,r,o,a){if(""!==t){var s=this;s.eventArgs.cur=o,s.eventArgs.isPop=!0,this.eventArgs.docstring=this.formatPyerr(a),this.eventArgs.args=t,s.eventArgs.popover=new i({content:t,pos:r,classes:"inspect-tooltip",docstring:a}).render(),n.vent.trigger("detail:cells:scroll:on"),n.vent.once("detail:cells:scroll",function(){s.eventArgs.isPop=!1,s.eventArgs.popover.destroy(),n.vent.trigger("detail:cells:scroll:off")}),n.body.on("click.destroyInspect",function(t){var i=t.target;s.eventArgs.isPop&&e.isEmpty(s.eventArgs.popover.$el.find(i))&&!s.eventArgs.popover.$el.is(i)&&(s.eventArgs.isPop=!1,s.eventArgs.popover.destroy(),n.body.off("click.destroyInspect"),n.vent.off("detail:cells:scroll"))})}},outdefString:function(e){var t=this.formatPyerr(e),n=t.indexOf("("),i=t.indexOf(")");return t.substr(n,i)},CMEvent:function(i,r,o){var a=this;t.on(i,"firstshow",function(e){console.log("firstshow"),$(".desc-hint").remove(),a.eventArgs.isTab=!0,a.eventArgs.node=e}),t.on(i,"select",function(e,t){console.log("select"),$(".desc-hint").remove(),a.eventArgs.isTab=!0,n.vent.trigger("kernel","inspect",{token:e,src:a.view}),a.view.once("inspectReply",function(e){if(e.content.docstring&&"<no docstring>"!==e.content.docstring){var t=e.content,n=a.formatPyerr(t.definition),i=a.formatPyerr(t.docstring),r=a.outputString(t.type_name,n,i);a.eventArgs.isTab=!1,a.eventArgs.args=a.outdefString(t.definition),a.eventArgs.docstring=i,a.showDescHint(a.eventArgs.node,r)}})}),t.on(i,"pick",function(n){console.log("pick"),$(".desc-hint").remove(),a.eventArgs.isTab=!1;var i=e.find(a.eventArgs.data.content.functions,function(e){return e===n});if(void 0!==i){var o=(r.getValue(),r.getCursor()),s=r.getTokenAt(o),l=t.Pos(o.line,s.start),c=t.Pos(o.line,s.end),u=n.split("."),d=u[u.length-1]+"()",h="",p=t.Pos(o.line,s.end+1);if(r.replaceRange(d,l,c),h=r.getValue(),r.setCursor(p),a.view.model.set("input",h),""===a.eventArgs.args)return void a.triggerPop(r);a.showPop(a.eventArgs.args,r.cursorCoords(o),r.getCursor(),a.eventArgs.docstring)}}),t.on(r,"endCompletion",function(e){console.log("endCompletion"),a.eventArgs.isTab=!1,$(".desc-hint").remove()})},outputString:function(e,t,n){return'<span  class="ansired">Type:       </span>'+e+'<br/><span  class="ansired">Definition:       </span>'+t+'<br/><span  class="ansired">Docstring:</span><br/>'+n},showDescHint:function(e,t){var n=$("<div>"),i=$(e).position().left+$(e).width()+10,r=$(e).position().top;50>r||(n.addClass("desc-hint").addClass("flexo-manual"),n.css({top:r,left:i}),n.append(t),$(".desc-hint").remove(),$("body").append(n))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(48),n(49),n(438)],r=function(e,t,n){return t.ItemView.extend({className:"popover bottom",template:!1,events:{"click .btn-more":"showMore"},initialize:function(e){t.ItemView.prototype.initialize.apply(this,arguments),this.content=e.content,this.title=e.title,this.pos=e.pos,this.docstring=e.docstring,this.classes=e.classes},render:function(){return t.ItemView.prototype.render.apply(this,arguments),this.$el.append(n({title:this.title,content:this.content,docstring:this.docstring})),this.classes&&this.$el.addClass(this.classes),this.$el.appendTo("body"),this.$el.find(".popover-content").css({"white-space":"pre"}),this.show(),this},show:function(){var e=this.$el.width(),t=$(window).width(),n=Math.max(this.pos.left-e/2,70);this.pos.left+e>t-100&&(n=t-e-30),this.$el.css({left:n,top:this.pos.top+20}).show(),this.$el.find(".arrow").css({left:this.pos.left-this.$el.offset().left}),this.$el.find(".more").hide()},showMore:function(e){this.$el.find(".more").show(),this.$el.find(".btn-more").hide(),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="arrow"></div>\n',title&&(__p+='\n<h3 class="popover-title">'+(null==(__t=title)?"":__t)+"</h3>\n"),__p+='\n<div class="popover-content">'+(null==(__t=content)?"":__t)+'</div>\n<a class="btn-more" href=""><i class="fa fa-plus"></i>参数详情</a>\n<div class="popover-content more">'+(null==(__t=docstring)?"":__t)+"</div>\n";return __p}},function(e,t,n){"use strict";!function(e){e(n(163))}(function(e){function t(e,t){this.cm=e,this.options=this.buildOptions(t),this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor(),this.startLen=this.cm.getLine(this.startPos.line).length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}function n(e){return"string"==typeof e?e:e.text}function i(e,t){function n(e,n){var r;r="string"!=typeof n?function(e){return n(e,t)}:i.hasOwnProperty(n)?i[n]:n,o[e]=r}var i={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},r=e.options.customKeys,o=r?{}:i;if(r)for(var a in r)r.hasOwnProperty(a)&&n(a,r[a]);var s=e.options.extraKeys;if(s)for(var a in s)s.hasOwnProperty(a)&&n(a,s[a]);return o}function r(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function o(t,o){this.completion=t,this.data=o,this.picked=!1;var l=this,c=t.cm,u=this.hints=document.createElement("ul");u.className="CodeMirror-hints",this.selectedHint=o.selectedHint||0;for(var d=o.list,h=0;h<d.length;++h){var p=u.appendChild(document.createElement("li")),f=d[h],m=a+(h!=this.selectedHint?"":" "+s);null!=f.className&&(m=f.className+" "+m),p.className=m,f.render?f.render(p,o,f):p.appendChild(document.createTextNode(f.displayText||n(f))),p.hintId=h}var g=c.cursorCoords(t.options.alignWithWord?o.from:null),v=g.left,y=g.bottom,b=!0;u.style.left=v+"px",u.style.top=y+"px";var _=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),w=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(t.options.container||document.body).appendChild(u);var x=u.getBoundingClientRect(),C=x.bottom-w;if(C>0){var k=x.bottom-x.top,S=g.top-(g.bottom-x.top);if(S-k>0)u.style.top=(y=g.top-k)+"px",b=!1;else if(k>w){u.style.height=w-5+"px",u.style.top=(y=g.bottom-x.top)+"px";var T=c.getCursor();o.from.ch!=T.ch&&(g=c.cursorCoords(T),u.style.left=(v=g.left)+"px",x=u.getBoundingClientRect())}}var D=x.right-_;if(D>0&&(x.right-x.left>_&&(u.style.width=_-5+"px",D-=x.right-x.left-_),u.style.left=(v=g.left-D)+"px"),c.addKeyMap(this.keyMap=i(t,{moveFocus:function(e,t){l.changeActive(l.selectedHint+e,t)},setFocus:function(e){l.changeActive(e)},menuSize:function(){return l.screenAmount()},length:d.length,close:function(){t.close()},pick:function(){l.pick()},data:o})),t.options.closeOnUnfocus){var M;c.on("blur",this.onBlur=function(){M=setTimeout(function(){t.close()},100)}),c.on("focus",this.onFocus=function(){clearTimeout(M)})}var $=c.getScrollInfo();return c.on("scroll",this.onScroll=function(){var e=c.getScrollInfo(),n=c.getWrapperElement().getBoundingClientRect(),i=y+$.top-e.top,r=i-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return b||(r+=u.offsetHeight),r<=n.top||r>=n.bottom?t.close():(u.style.top=i+"px",void(u.style.left=v+$.left-e.left+"px"))}),e.on(u,"dblclick",function(e){var t=r(u,e.target||e.srcElement);t&&null!=t.hintId&&(l.changeActive(t.hintId),l.pick())}),e.on(u,"click",function(e){var n=r(u,e.target||e.srcElement);n&&null!=n.hintId&&(l.changeActive(n.hintId),t.options.completeOnSingleClick&&l.pick())}),e.on(u,"mousedown",function(){setTimeout(function(){c.focus()},20)}),e.signal(o,"select",d[0],u.firstChild),!0}var a="CodeMirror-hint",s="CodeMirror-hint-active";e.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var i={hint:t};if(n)for(var r in n)i[r]=n[r];return e.showHint(i)},e.defineExtension("showHint",function(n){if(!(this.listSelections().length>1||this.somethingSelected())){this.state.completionActive&&this.state.completionActive.close();var i=this.state.completionActive=new t(this,n);i.options.hint&&(e.signal(this,"startCompletion",this),i.update(!0))}});var l=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},c=window.cancelAnimationFrame||clearTimeout;t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&e.signal(this.data,"close"),this.widget&&this.widget.close(),e.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,i){var r=t.list[i];r.hint?r.hint(this.cm,t,r):this.cm.replaceRange(n(r),r.from||t.from,r.to||t.to,"complete"),e.signal(t,"pick",r),this.close()},cursorActivity:function(){this.debounce&&(c(this.debounce),this.debounce=0);var e=this.cm.getCursor(),t=this.cm.getLine(e.line);if(e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1)))this.close();else{var n=this;this.debounce=l(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(e){if(null!=this.tick)if(this.options.hint.async){var t=++this.tick,n=this;this.options.hint(this.cm,function(i){n.tick==t&&n.finishUpdate(i,e)},this.options)}else this.finishUpdate(this.options.hint(this.cm,this.options),e)},finishUpdate:function(t,n){this.data&&e.signal(this.data,"update"),t&&this.data&&e.cmpPos(t.from,this.data.from)&&(t=null),this.data=t;var i=this.widget&&this.widget.picked||n&&this.options.completeSingle;this.widget&&this.widget.close(),t&&t.list.length&&(i&&1==t.list.length?this.pick(t,0):(this.widget=new o(this,t),e.signal(this.data,"firstshow",this.widget.hints),e.signal(t,"shown")))},buildOptions:function(e){var t=this.cm.options.hintOptions,n={};for(var i in u)n[i]=u[i];if(t)for(var i in t)void 0!==t[i]&&(n[i]=t[i]);if(e)for(var i in e)void 0!==e[i]&&(n[i]=e[i]);return n}},o.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var e=this.completion.cm;this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,n){if(t>=this.data.list.length?t=n?this.data.list.length-1:0:0>t&&(t=n?0:this.data.list.length-1),this.selectedHint!=t){var i=this.hints.childNodes[this.selectedHint];i.className=i.className.replace(" "+s,""),i=this.hints.childNodes[this.selectedHint=t],i.className+=" "+s,i.offsetTop<this.hints.scrollTop?this.hints.scrollTop=i.offsetTop-3:i.offsetTop+i.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=i.offsetTop+i.offsetHeight-this.hints.clientHeight+3),e.signal(this.data,"select",this.data.list[this.selectedHint],i)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},e.registerHelper("hint","auto",function(t,n){var i,r=t.getHelpers(t.getCursor(),"hint");if(r.length)for(var o=0;o<r.length;o++){var a=r[o](t,n);if(a&&a.list.length)return a}else if(i=t.getHelper(t.getCursor(),"hintWords")){if(i)return e.hint.fromList(t,{words:i})}else if(e.hint.anyword)return e.hint.anyword(t,n)}),e.registerHelper("hint","fromList",function(t,n){var i=t.getCursor(),r=t.getTokenAt(i),o=e.Pos(i.line,r.end);if(r.string&&/\w/.test(r.string[r.string.length-1]))var a=r.string,s=e.Pos(i.line,r.start);else var a="",s=o;for(var l=[],c=0;c<n.words.length;c++){var u=n.words[c];u.slice(0,a.length)==a&&l.push(u)}return l.length?{list:l,from:s,to:o}:void 0}),e.commands.autocomplete=e.showHint;var u={hint:e.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!1,container:null,customKeys:null,extraKeys:null};e.defineOption("hintOptions",null)})},function(e,t,n){var i,r;i=[n(45),n(115),n(182),n(47),n(116),n(181),n(436),n(441),n(446),n(447),n(448),n(450),n(183)],r=function(e,t,n,i,r,o,a,s,l,c,u,d){return a.extend({initialize:function(){a.prototype.initialize.apply(this,arguments),o.prototype.initialize.apply(this,arguments);var e=this;this.listenTo(this.view,{"render:handle switch":function(){e.view.editor&&""==e.view.editor.getValue()&&e.view.editor.setValue(l)},"result:show":function(){$(window).trigger("resize")}})},value:function(){var e=a.prototype.value.apply(this,arguments);return e||l},onDestroy:function(){a.prototype.onDestroy.apply(this,arguments),this.view.handle.$el.find(".strategy-help").remove(),this.stopListening()},run:function(){this.view.busy||(o.prototype.run.apply(this,arguments),i.vent.trigger("kernel","execute",{code:this.getCode(),src:this.view,attrs:{strategy:!0,cell:this.view.model.get("id"),notebook:i.notebookReqres.request("notebookName")}}),this.chart=null,this.performance=null,this.trading_days=null,this.updateStarted=!1)},savedOut:function(){o.prototype.savedOut.apply(this,arguments),this.contest(),this.showDetailBtn()},output:function(e){var t,n=this;return"display_data"!==e.msg_type?(("stream"===e.msg_type||"pyerr"===e.msg_type)&&a.prototype.output.apply(this,arguments),void("pyout"===e.msg_type&&(this.view.model.addOutput(e),this.view.model.set("has_detail",!0),this.showDetailBtn()))):(this.view.model.get("collapsed")&&(this.view.showResult(),this.listenToOnce(this.view,"result:show",function(){n.chart&&$(window).trigger("resize")})),t=e.content.data,this.performance=t,void(t.trading_days&&!this.chart?(this.trading_days=t.trading_days,this.initBrief(),this.showDetailBtn(),this.initChart(),this.contest()):(this.updateChartData(),this.updateBrief())))},initChart:function(){var t,n=this.trading_days,i={};return e.each(n,function(e,t){i[e]=null}),i={cumulative_return:i,benchmark_cumulative_return:i},t=o.prototype.outputChart.call(this,i),this.chart=t.highcharts(),t},updateChartData:e.throttle(function(){var t=this.performance.cumulative_return,n=this.performance.benchmark_cumulative_return;this.chart&&(e.each(this.trading_days,function(i,r){t[i]=e.isUndefined(t[i])?null:t[i],n[i]=e.isUndefined(n[i])?null:n[i]}),t=e.map(t,function(e,t){return[parseInt(t),e]}).sort(function(e,t){return e[0]-t[0]}),n=e.map(n,function(e,t){return[parseInt(t),e]}).sort(function(e,t){return e[0]-t[0]}),this.chart.series[0].setData(t,!1,!1,!1),this.chart.series[1].setData(n,!1,!1,!1),this.chart.redraw())},150),buildChart:function(e,t){o.prototype.buildChart.apply(this,[e,t,!0])},outputChart:function(){var e=o.prototype.outputChart.apply(this,arguments);return this.listenTo(i.vent,"mainNav:collapsed mainNav:expanded",function(){e.highcharts().reflow()}),e},initBrief:function(){this.briefWrapper=$('<ul class="brief-list"></ul>');var e=this.view.appendResult(this.briefWrapper);this.view.ui.result.prepend(e)},updateBrief:function(){var e=this.buildBrief(this.performance);this.briefWrapper.html(e.html())},buildBrief:o.prototype.buildBrief,outputBrief:o.prototype.outputBrief,contest:function(){this.startContest()},startContest:function(){var e=this;this.view.ui.result.find(".brief-list").after(c()),this.view.ui.result.off("click.contest").on("click.contest",".start-contest-btn",function(){var n=new t({title:"参加大赛",content:""}),i=new u({code:e.getCode()});n.$el.addClass("start-contest-modal"),n.body.append(i.render().el),n.$el.on("shown.bs.modal",function(){i.trigger("show")}).on("hidden.bs.modal",function(){i.destroy(),n.destroy()}).on("click",".submit",function(e){var t=$(e.currentTarget);t.button("loading"),i.submit().done(function(){n.hide()}).always(function(){t.button("reset")})})}),this.view.ui.result.off("click.trade").on("click.trade",".start-trade-menu",function(n){var i=new t({title:"模拟交易",content:""}),r=new s({code:e.getCode()});i.$el.addClass("start-trade-modal"),i.body.append(r.render().el),i.$el.on("shown.bs.modal",function(){r.trigger("show")}).on("hidden.bs.modal",function(){r.destroy(),i.destroy()}).on("click",".submit",function(e){var t=$(e.currentTarget);t.button("loading"),r.submit().done(function(){i.hide()}).always(function(){t.button("reset")})}),n.preventDefault()})},showDetailBtn:function(){var e,n=this;this.view.ui.result.find(".brief-list").after('<a class="detail-btn" href="#">回测详情</a>'),this.view.ui.result.off("click.detail").on("click.detail",".detail-btn",function(i){var r=$(i.currentTarget),o=new d({cell:n.view.model}),a=function(){clearTimeout(e),r.off("hidden.bs.popover"),r.popover("destroy"),r.popover({title:"",content:"请运行策略, 在成功后查看",placement:"bottom auto",container:"body",trigger:"manual"}),r.popover("show"),e=setTimeout(function(){r.one("hidden.bs.popover",function(){r.popover("destroy")}),r.popover("hide")},2e3)};n.hasOutput()?o.model.settings().done(function(){var e=new t({title:"",content:"",autoRemove:!0,backdrop:"static"});e.$el.addClass("strategy-detail-modal"),e.body.append(o.render().$el),e.$el.on("shown.bs.modal",function(){o.triggerMethod("show")}).on("hidden.bs.modal",function(){o.destroy()})}).fail(function(){a()}):a(),n.once("run:start",function(){r.popover("destroy")}),i.preventDefault()})},hasOutput:function(){var t=!1;return e.each(this.view.model.get("outputs"),function(e){"pyout"===e.output_type&&(t=!0)}),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(442),n(445)],r=function(e,t,n,i){return t.ItemView.extend({className:"start-trade",template:i,events:{"keyup .naming input":"checkName"},initialize:function(e){e=e||{},this.code=e.code},checkCode:function(){var t,n=this.code,i=/^capital_base\s*=\s*([^#]*)/gim,r=i.exec(n);return!r||r.length<1?null:(t=+r[1],e.isNaN(t)?!1:!0)},onRender:function(){var e=this,t=this.$el.find(".btn,.error-msg");this.submitBtn=t.filter(".submit"),this.errorMsg=t.filter(".error-msg"),this.on("show",function(){e.$el.parent().next().append(t),e.$el.find("input").focus()})},submit:function(){var t=this,i=this.$el.find(".naming"),r=i.find("input");return this.submitBtn.button("loading"),$.ajax({url:e.result(new n,"url"),type:"POST",data:JSON.stringify({name:r.val(),code:this.code}),timeout:31e3,contentType:"application/json"}).always(function(){t.submitBtn.button("reset")}).fail(function(e,n){409==e.status&&i.addClass("has-error").find(".help-block.error").text("该策略已存在."),400===e.status&&(-1!==e.responseText.search("invalid capital")?t.errorMsg.text("创建模拟交易失败，请确保capital_base为一个常量."):-1!==e.responseText.search("capital base")?t.errorMsg.text("capital_base的范围不应超过小数点前20位、小数点后2位"):-1!==e.responseText.search("invalid code")?t.errorMsg.text("创建模拟交易失败，策略代码异常."):-1!==e.responseText.search("too long")?i.addClass("has-error").find(".help-block.error").text("名称过长."):-1!==e.responseText.search("minute freq")&&t.errorMsg.text("日内策略暂不支持模拟交易功能.")),(504===e.status||"timeout"===n)&&t.errorMsg.text("创建模拟交易超时, 请稍后重试."),590===e.status&&t.errorMsg.text("创建模拟交易失败, 当前模拟交易中策略个数已达到最高限制."),502===e.status&&t.errorMsg.text("服务暂时不可用, 请稍后再试.")})},reset:function(){this.$el.find(".list-group-item").removeClass("has-error").find(".help-block.error").text(""),this.errorMsg.text("")},checkName:function(e){var t=$(e.currentTarget);t.val()?this.submitBtn.removeAttr("disabled"):this.submitBtn.attr("disabled","")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(443)],r=function(e,t,n){return t.Collection.extend({model:n,url:window.getapi("mercury_trade","/strategy"),comparator:function(e,t){var n=e.get("status"),i=t.get("status");return n===i?t.get("start_time")-e.get("start_time"):n-i},initialize:function(e,t){var n=this;this.query=t&&t.query||{},this.on("change:status",function(e){n.query.status&&e.get("status")!=n.query.status&&n.remove(e),n.sort()})},fetch:function(n){return this.trigger("sync:before"),n=n||{},n.data=n.data||{},e.extend(n.data,this.query),t.Collection.prototype.fetch.apply(this,[n])}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(76),n(444)],r=function(e,t,n){return t.NestedModel.extend({defaults:{fund:null},urlRoot:window.getapi("mercury_trade","/strategy"),appUrl:function(){return"trade/strategy/"+this.id},parse:function(e){return 200===e.code?e.data:e||{}},getStatus:function(){return n.statusMap[this.get("status")]},getStatusClass:function(){return n.statusClassMap[this.get("status")]},getContest:function(){return n.isContestMap[this.get("is_contest")];
},getContestClass:function(){return n.isContestClassMap[this.get("is_contest")]},terminate:function(){var e=this;return $.ajax({url:this.url(),type:"POST",data:JSON.stringify({action:"stop"}),contentType:"application/json"}).done(function(){e.set("end_time",(new Date).getTime()),e.set("status",3)})},details:function(e,t){return $.ajax({url:this.url()+"/"+e,data:t||{}})},goFund:function(){var e=this;return $.ajax({url:window.getapi("mercury_trade","/fundstrategy"),data:JSON.stringify({strategy_id:this.id}),type:"POST",contentType:"application/json"}).done(function(){e.set("fund",1)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return{statusMap:{0:"启动中",1:"正常",2:"异常",3:"终止",4:"回测中",5:"回测错误",6:"回测超时"},statusClassMap:{0:"init",1:"run",2:"error",3:"term",4:"run",5:"error",6:"error"},isContestMap:{0:"未参赛",1:"参赛中",2:"停止参赛"},isContestClassMap:{0:"",1:"in-contest",2:"stop-contest"}}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="list-group">\n    <div class="list-group-item naming">\n        <label class="control-label" for="trade-name-field">策略名称</label>\n        <input id="trade-name-field" class="form-control" name="trade-name" type="text">\n        <div class="help-block error"></div>\n        <div class="help-block">模拟交易中将忽略策略代码中的start、end、csvs、stock_base、slippage、commission参数设置。</div>\n        <div class="help-block">模拟交易中，capital_base中的5%金额将被冻结无法用于交易，用于保障合规性检查。</div>\n    </div>\n</div>\n<div class="error-msg"></div>\n<button class="btn btn-primary submit" data-loading-text="创建中" disabled>开始模拟</button>\n';return __p}},function(e,t){e.exports="start = '2014-01-01'                       # 回测起始时间\r\nend = '2015-01-01'                         # 回测结束时间\r\nbenchmark = 'HS300'                        # 策略参考标准\r\nuniverse = ['000001.XSHE', '600000.XSHG']  # 证券池，支持股票和基金\r\ncapital_base = 100000                      # 起始资金\r\nfreq = 'd'                                 # 策略类型，'d'表示日间策略使用日线回测，'m'表示日内策略使用分钟线回测\r\nrefresh_rate = 1                           # 调仓频率，表示执行handle_data的时间间隔，若freq = 'd'时间间隔的单位为交易日，若freq = 'm'时间间隔为分钟\r\n\r\ndef initialize(account):                   # 初始化虚拟账户状态\r\n    pass\r\n\r\ndef handle_data(account):                  # 每个交易日的买入卖出指令\r\n    return\r\n"},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="btn-group start-trade-btn">\n    <button class="btn btn-primary start-contest-btn">参加大赛</button>\n    <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-expanded="false">\n        <span class="caret"></span>\n        <span class="sr-only">更多</span>\n    </button>\n    <ul class="dropdown-menu" role="menu">\n        <li><a href="#" class="start-trade-menu">模拟交易</a></li>\n    </ul>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(441),n(449)],r=function(e,t){return e.extend({className:"start-contest",template:t,submit:function(){var e=this,t=this.$el.find(".naming"),n=t.find("input");return this.submitBtn.button("loading"),$.ajax({url:window.getapi("mercury_trade","/contest"),type:"POST",data:JSON.stringify({name:n.val(),code:this.code,nb_name:$(".region-title .title").text()+".ipynb"}),timeout:31e3,contentType:"application/json"}).always(function(){e.submitBtn.button("reset")}).fail(function(n,i){409==n.status&&t.addClass("has-error").find(".help-block.error").text("该策略已存在."),400===n.status&&(-1!==n.responseText.search("invalid capital")?e.errorMsg.text("参赛交易失败，请确保capital_base为一个常量"):-1!==n.responseText.search("capital base")?e.errorMsg.text("capital_base的范围不应超过小数点前20位、小数点后2位"):-1!==n.responseText.search("invalid code")?e.errorMsg.text("参赛失败，策略代码异常."):-1!==n.responseText.search("invalid name")?e.errorMsg.text('策略名称不能包含"<>&;".'):-1!==n.responseText.search("too long")?t.addClass("has-error").find(".help-block.error").text("名称过长."):-1!==n.responseText.search("minute freq")&&e.errorMsg.text("日内策略暂不支持模拟交易功能.")),(504===n.status||"timeout"===i)&&e.errorMsg.text("参赛超时, 请稍后重试."),590===n.status&&e.errorMsg.text("参赛失败，当前模拟交易个数已达到最高限制，可以删除模拟交易中的策略后继续创建"),502===n.status&&e.errorMsg.text("服务暂时不可用, 请稍后再试.")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="list-group">\n    <div class="list-group-item naming">\n        <label class="control-label" for="trade-name-field">策略名称</label>\n        <input id="trade-name-field" class="form-control" name="trade-name" type="text">\n        <div class="help-block error"></div>\n        <div class="help-block">注意事项：</div>\n        <ol>\n            <li>确认参赛后，本平台将统一设置全局变量参数进行三年回测，作为您参赛的回测成绩，参数设置情况为：\n                <p>\n                    start = \'2012-08-01\' <br>\n                    end = \'2015-08-01\' <br>\n                    benchmark = \'HS300\' <br>\n                    capital_base = 1000000 <br>\n                    csvs = [] <br>\n                    security_base = {} <br>\n                    commission = Commission(buycost=0.0008, sellcost=0.0018)  # 佣金万八 <br>\n                    slippage = Slippage() <br>\n                </p>\n            </li>\n            <li>提交参赛后，您当前策略所在的Notebook会被后台用于执行该策略的回测，从而处于无法运行的状态，当您提交的策略回测结束后，Notebook可以正常使用；</li>\n            <li>确认参赛后，您可以在模拟交易页面查看您的参赛策略模拟盘表现；</li>\n            <li>模拟盘中将capital_base值设置为100万，capital_base中的5%金额将被冻结无法用于交易，用于保障合规性检查；</li>\n            <li>模拟盘中将忽略策略代码中的start、end、csvs、stock_base、slippage、commission参数设置。</li>\n        </ol>\n    </div>\n</div>\n<div class="error-msg"></div>\n<button class="btn btn-primary submit" data-loading-text="创建中" disabled>确认参赛</button>\n';return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a),l=n(47),c=(i(l),n(451)),u=i(c),d=n(452),h=i(d),p=n(453),f=i(p);t["default"]=s["default"].ItemView.extend({className:"clearfix",template:h["default"],events:{'shown.bs.tab a[data-toggle="tab"]':"shownTab"},initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.model=new u["default"]({id:e.cell.get("id"),cell:e.cell}),this.initTab=e.tab||"overview",this.tabs={}},setupTabs:function(){var e=this,t=this.model.get("id");this.$el.find(".nav li a").each(function(n,i){var r=i.href.split("#")[1],o=r+("-"+t);e.$el.find(".tab-content ."+r).attr("id",o),i.href="#"+o,$(i).attr("data-toggle","tab")})},onRender:function(){this.setupTabs()},onDestroy:function(){o["default"].invoke(this.tabs,"destroy")},shownTab:function(e){var t,n,i,r,o=$(e.target);n=o.attr("href").split("-")[0].replace("#",""),e.relatedTarget&&(t=$(e.relatedTarget),t=t.attr("href").split("-")[0].replace("#",""),this.tabs[t].triggerMethod("tabHide")),i=this.$el.find(".tab-content ."+n),this.tabs[n]?this.tabs[n].triggerMethod("tabShow"):(r=new f["default"][n]({model:this.model}),i.append(r.render().el),r.triggerMethod("show"),r.triggerMethod("tabShow"),this.tabs[n]=r),this.initTab=null},onShow:function(){this.$el.find('.nav a[href*="#'+this.initTab+'"]').tab("show")}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(48),s=i(a),l=n(47),c=i(l);t["default"]=s["default"].Model.extend({url:function(e){var t=encodeURIComponent(c["default"].notebookReqres.request("notebookName"));return window.getapi("mercury_trade","/backtest/"+e+"/"+t+"/")},indicator:function(e){return $.ajax({url:this.url("indicator")+this.id+("/"+e)})},order:function(){return $.ajax({url:this.url("order")+this.id})},position:function(){return $.ajax({url:this.url("position")+this.id})},benchmark:function(){var e=o["default"].filter(this.get("cell").get("outputs"),function(e){return"pyout"===e.output_type});e=e[0],e=e.text.replace(/^'(.*)'$/,function(e,t){return t});try{e=JSON.parse(e)}catch(t){return null}return e},settings:function(){return $.ajax({url:this.url("config")+this.id})},logs:function u(){var u=o["default"].filter(this.get("cell").get("outputs"),function(e){return"stream"===e.output_type});return o["default"].map(u,function(e){return e.text})}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<span class="close" data-dismiss="modal">&times;</span>\n\n<div class="side">\n    <ul class="nav nav-pills nav-stacked">\n        <li><a href="#overview">策略概览</a></li>\n        <li><a href="#order">调仓记录</a></li>\n        <li><a href="#position">持仓记录</a></li>\n        <li class="divide"></li>\n        <li><a href="#returns">收益率</a></li>\n        <li><a href="#alpha">阿尔法</a></li>\n        <li><a href="#beta">贝塔</a></li>\n        <li><a href="#sharpe">夏普比率</a></li>\n        <li><a href="#volatility">收益波动率</a></li>\n        <li><a href="#ir">信息比率</a></li>\n        <li><a href="#max_drawdown">最大回撤</a></li>\n        <li class="divide"></li>\n        <li><a href="#log">日志</a></li>\n        <li><a href="#settings">配置</a></li>\n    </ul>\n</div>\n<div class="tab-content">\n    <div class="tab-pane overview"></div>\n    <div class="tab-pane log"></div>\n    <div class="tab-pane order"></div>\n    <div class="tab-pane position"></div>\n    <div class="tab-pane returns"></div>\n    <div class="tab-pane alpha"></div>\n    <div class="tab-pane beta"></div>\n    <div class="tab-pane sharpe"></div>\n    <div class="tab-pane volatility"></div>\n    <div class="tab-pane ir"></div>\n    <div class="tab-pane max_drawdown"></div>\n    <div class="tab-pane settings"></div>\n</div>\n';return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(454),s=i(a),l=n(455),c=i(l),u=n(457),d=i(u),h=n(533),p=i(h),f=n(539),m=i(f),g=n(541),v=i(g),y=n(542),b=i(y),_={overview:s["default"],log:c["default"],settings:m["default"],position:d["default"],order:p["default"]},w={returns:"收益率",alpha:"Alpha",beta:"Beta",ir:"Information Ratio",sharpe:"Sharpe Ratio",volatility:"Volatility",max_drawdown:"Max Drawdown"};o["default"].each(["alpha","beta","ir","sharpe","volatility","max_drawdown"],function(e){_[e]=b["default"].extend({name:e,format:"0.000",description:w[e]})}),_.returns=b["default"].extend({name:"returns",initialize:function(){arguments.length<=0||void 0===arguments[0]?{}:arguments[0];b["default"].prototype.initialize.apply(this,arguments),this.description=w.returns,this.tpl=v["default"]}}),t["default"]=_,e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=i(r),a=n(181),s=i(a);t["default"]=o["default"].ItemView.extend({className:"overview-content notebook-detail",template:!1,initialize:function(e){this.model=e.model},render:function(){o["default"].ItemView.prototype.render.apply(this);var e=this.model.benchmark(),t=s["default"].prototype.buildBrief(e);this.$el.append(t);var n=$('<div class="chart"></div>');return s["default"].prototype.buildChart(e,n,!0),this.$el.append(n),this.chart=n.highcharts(),this},onShow:function(){this.chart.reflow()}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a),l=n(456),c=i(l);t["default"]=s["default"].ItemView.extend({className:"log-content",template:c["default"],ui:{logs:".logs"},initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.logs=e.model.logs()},onRender:function(){var e=this;e.$el.append(),o["default"].each(this.logs,function(t){e.ui.logs.append('<div class="log-item">'+t+"</div>")}),o["default"].isEmpty(this.logs)&&e.$el.append('<div class="log-item">此策略没有日志</div>')}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="logs"></div>\n';return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(48),s=(i(a),n(49)),l=i(s);n(458),n(461),n(462),n(463);var c=n(464),u=i(c),d=n(465),h=i(d),p=n(466),f=i(p),m=n(528),g=i(m),v=n(529),y=i(v),b=n(530),_=i(b),w=n(531),x=i(w),C=n(532),k=i(C);n(527),t["default"]=l["default"].ItemView.extend({className:"position-content",template:k["default"],events:{"click .expand-all":"clickExpandAll","click .collapse-all":"clickCollapseAll","click .slick-group":"clickSlickGroup"},behaviors:{GridFilter:{behaviorClass:f["default"]},GridSort:{behaviorClass:g["default"],sortCol:"date",dateColClass:"position-time"},GridDownload:{behaviorClass:y["default"],columns:x["default"]}},initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.position=e.model.position()},prepareData:function(e){var t=[],n={},i=0;o["default"].each(e,function(e){var r=0,a=function(e){return{date:e.date,formatedDate:e.date.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i}),id:i++,symbol:null,amount:null,cost:null,"P/L":null,close:null,value:null,placeholder:!0}};if(n[e.date]=e.summary,o["default"].isEmpty(e.position)||o["default"].each(e.position,function(n){n.date=e.date,n.formatedDate=e.date.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i}),n.id=i++,n.close=n.value/n.amount,r+=n.cost,t.push(n)}),0===e.holding_number||e.holding_number>e.position.length){var s=a(e);0===e.holding_number?s.onlyForGroup=!0:s.__meta={selectable:!1,focusable:!1,columns:{0:{colspan:"*",formatter:function(e,t){return"达到10万条记录限制, 更多数据请于code单元中打印bt查看."}}}},t.push(s),n[e.date].omitted=!0}n[e.date].cost=r,n[e.date].cash=e.cash,n[e.date].holding_number=e.holding_number}),this.groupData=t,this.groupMeta=n},prepareGroupItemMetadata:function(){var e=this,t=new Slick.Data.GroupItemMetadataProvider;return t.getGroupRowMetadata=function(t){var n=0,i=0,r=0;return e.groupMeta[t.value].omitted?(n=e.groupMeta[t.value].position_value,i=e.groupMeta[t.value]["P/L"],r=e.groupMeta[t.value].holding_number):t.rows&&!o["default"].isEmpty(t.rows)&&(o["default"].each(t.rows,function(e){n+=e.value,i+=e["P/L"]}),r=t.rows.length),n+=e.groupMeta[t.value].cash,{selectable:!1,focusable:!1,cssClasses:"slick-group",columns:{0:{colspan:5,formatter:function(){var e=t.collapsed?"fa-chevron-right":"fa-chevron-down",n=t.value.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i});return'<i class="fa slick-group-toggle '+e+'"></i><span class="date">'+n+"</span> 共 "+r+" 只证券"}},5:{formatter:function(){return u["default"](n).format("0,0.00")}},6:{formatter:function(){return'<span class="'+h["default"](i)+'">'+u["default"](i).format("0,0.00")+"</span>"}}}}},t.getDummyRowMetadata=function(e){return{selectable:!1,focusable:!1,cssClasses:"slick-group-dummy",columns:[{formatter:function(){return""}},{formatter:function(){return e.title}},{formatter:function(){return"--"}},{formatter:function(){return"--"}},{formatter:function(){return"--"}},{formatter:function(){return u["default"](e.value).format("0,0.00")}},{formatter:function(){return"--"}}]}},t},prepareGrid:function(){var e,t=this.prepareGroupItemMetadata(),n=new Slick.Data.DataView({groupItemMetadataProvider:t}),i=this.$el.find(".slick");this.dataView=n,i.css({height:"500px",width:"100%"}),e=new Slick.Grid(i,n,_["default"],{headerRowHeight:31,rowHeight:31,forceFitColumns:!0,enableColumnReorder:!1,enableTextSelectionOnCells:!0,sortIndicatorAsc:"fa fa-caret-up",sortIndicatorDesc:"fa fa-caret-down"}),e.registerPlugin(t),n.onRowCountChanged.subscribe(function(t,n){e.updateRowCount(),e.render()}),n.onRowsChanged.subscribe(function(t,n){e.invalidateRows(n.rows),e.render()}),this.grid=e},onShow:function(){var e=this;this.prepareGrid(),this.position.done(function(t){e.prepareData(t),e.$el.find(".loading").hide(),e.dataView.beginUpdate(),e.dataView.setItems(e.groupData),e.dataView.setGrouping({getter:"date",dummyRows:[function(t){return{title:"现金",value:e.groupMeta[t.value].cash}}],collapsed:!0}),e.dataView.endUpdate(),e.triggerMethod("grid:ready"),e.grid.setColumns(e.grid.getColumns())})},clickExpandAll:function(e){this.dataView.expandAllGroups(),e.preventDefault()},clickCollapseAll:function(e){this.dataView.collapseAllGroups(),e.preventDefault()},clickSlickGroup:function(e){var t=$(e.currentTarget);$(e.target).hasClass("slick-group-toggle")||t.find(".slick-group-toggle").trigger("click")}}),e.exports=t["default"]},function(e,t,n){n(459),n(460),function(e){function t(){var e=!1,t=!1;this.stopPropagation=function(){e=!0},this.isPropagationStopped=function(){return e},this.stopImmediatePropagation=function(){t=!0},this.isImmediatePropagationStopped=function(){return t}}function n(){var e=[];this.subscribe=function(t){e.push(t)},this.unsubscribe=function(t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},this.notify=function(n,i,r){i=i||new t,r=r||this;for(var o,a=0;a<e.length&&!i.isPropagationStopped()&&!i.isImmediatePropagationStopped();a++)o=e[a].call(r,i,n);return o}}function i(){var e=[];this.subscribe=function(t,n){return e.push({event:t,handler:n}),t.subscribe(n),this},this.unsubscribe=function(t,n){for(var i=e.length;i--;)if(e[i].event===t&&e[i].handler===n)return e.splice(i,1),void t.unsubscribe(n);return this},this.unsubscribeAll=function(){for(var t=e.length;t--;)e[t].event.unsubscribe(e[t].handler);return e=[],this}}function r(e,t,n,i){void 0===n&&void 0===i&&(n=e,i=t),this.fromRow=Math.min(e,n),this.fromCell=Math.min(t,i),this.toRow=Math.max(e,n),this.toCell=Math.max(t,i),this.isSingleRow=function(){return this.fromRow==this.toRow},this.isSingleCell=function(){return this.fromRow==this.toRow&&this.fromCell==this.toCell},this.contains=function(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell},this.toString=function(){return this.isSingleCell()?"("+this.fromRow+":"+this.fromCell+")":"("+this.fromRow+":"+this.fromCell+" - "+this.toRow+":"+this.toCell+")"}}function o(){this.__nonDataRow=!0}function a(){this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=null}function s(){this.__groupTotals=!0,this.group=null,this.initialized=!1}function l(){this.__groupDummy=!0,this.group=null,this.initialized=!1}function c(){var e=null;this.isActive=function(t){return t?e===t:null!==e},this.activate=function(t){if(t!==e){if(null!==e)throw"SlickGrid.EditorLock.activate: an editController is still active, can't activate another editController";if(!t.commitCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .commitCurrentEdit()";if(!t.cancelCurrentEdit)throw"SlickGrid.EditorLock.activate: editController must implement .cancelCurrentEdit()";e=t}},this.deactivate=function(t){if(e!==t)throw"SlickGrid.EditorLock.deactivate: specified editController is not the currently active one";e=null},this.commitCurrentEdit=function(){return e?e.commitCurrentEdit():!0},this.cancelCurrentEdit=function(){return e?e.cancelCurrentEdit():!0}}e.extend(!0,window,{Slick:{Event:n,EventData:t,EventHandler:i,Range:r,NonDataRow:o,Group:a,GroupTotals:s,GroupDummy:l,EditorLock:c,GlobalEditorLock:new c}}),a.prototype=new o,a.prototype.equals=function(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title},s.prototype=new o,l.prototype=new o}(jQuery)},function(e,t){!function(e){e.fn.drag=function(t,n,i){var r="string"==typeof t?t:"",o=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drag")&&(r="drag"+r),i=(t==o?n:i)||{},o?this.bind(r,i,o):this.trigger(r)};var t=e.event,n=t.special,i=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,i.datakey),r=t.data||{};n.related+=1,e.each(i.defaults,function(e,t){void 0!==r[e]&&(n[e]=r[e])})},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var n=e.extend({related:0},i.defaults);e.data(this,i.datakey,n),t.add(this,"touchstart mousedown",i.init,n),this.attachEvent&&this.attachEvent("ondragstart",i.dontstart)}},teardown:function(){var n=e.data(this,i.datakey)||{};n.related||(e.removeData(this,i.datakey),t.remove(this,"touchstart mousedown",i.init),i.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",i.dontstart))},init:function(r){if(!i.touched){var o,a=r.data;if(!(0!=r.which&&a.which>0&&r.which!=a.which)&&!e(r.target).is(a.not)&&(!a.handle||e(r.target).closest(a.handle,r.currentTarget).length)&&(i.touched="touchstart"==r.type?this:null,a.propagates=1,a.mousedown=this,a.interactions=[i.interaction(this,a)],a.target=r.target,a.pageX=r.pageX,a.pageY=r.pageY,a.dragging=null,o=i.hijack(r,"draginit",a),a.propagates))return o=i.flatten(o),o&&o.length&&(a.interactions=[],e.each(o,function(){a.interactions.push(i.interaction(this,a))})),a.propagates=a.interactions.length,a.drop!==!1&&n.drop&&n.drop.handler(r,a),i.textselect(!1),i.touched?t.add(i.touched,"touchmove touchend",i.handler,a):t.add(document,"mousemove mouseup",i.handler,a),!i.touched||a.live?!1:void 0}},interaction:function(t,n){var r=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new i.callback,droppable:[],offset:r}},handler:function(r){var o=r.data;switch(r.type){case!o.dragging&&"touchmove":r.preventDefault();case!o.dragging&&"mousemove":if(Math.pow(r.pageX-o.pageX,2)+Math.pow(r.pageY-o.pageY,2)<Math.pow(o.distance,2))break;r.target=o.target,i.hijack(r,"dragstart",o),o.propagates&&(o.dragging=!0);case"touchmove":r.preventDefault();case"mousemove":if(o.dragging){if(i.hijack(r,"drag",o),o.propagates){o.drop!==!1&&n.drop&&n.drop.handler(r,o);break}r.type="mouseup"}case"touchend":case"mouseup":default:i.touched?t.remove(i.touched,"touchmove touchend",i.handler):t.remove(document,"mousemove mouseup",i.handler),o.dragging&&(o.drop!==!1&&n.drop&&n.drop.handler(r,o),i.hijack(r,"dragend",o)),i.textselect(!0),o.click===!1&&o.dragging&&e.data(o.mousedown,"suppress.click",(new Date).getTime()+5),o.dragging=i.touched=!1}},hijack:function(n,r,o,a,s){if(o){var l,c,u,d={event:n.originalEvent,type:n.type},h=r.indexOf("drop")?"drag":"drop",p=a||0,f=isNaN(a)?o.interactions.length:a;n.type=r,n.originalEvent=null,o.results=[];do if(c=o.interactions[p]){if("dragend"!==r&&c.cancelled)continue;u=i.properties(n,o,c),c.results=[],e(s||c[h]||o.droppable).each(function(a,s){return u.target=s,n.isPropagationStopped=function(){return!1},l=s?t.dispatch.call(s,n,u):null,l===!1?("drag"==h&&(c.cancelled=!0,o.propagates-=1),"drop"==r&&(c[h][a]=null)):"dropinit"==r&&c.droppable.push(i.element(l)||s),"dragstart"==r&&(c.proxy=e(i.element(l)||c.drag)[0]),c.results.push(l),delete n.result,"dropinit"!==r?l:void 0}),o.results[p]=i.flatten(c.results),"dropinit"==r&&(c.droppable=i.flatten(c.droppable)),"dragstart"!=r||c.cancelled||u.update()}while(++p<f);return n.type=d.type,n.originalEvent=d.event,i.flatten(o.results)}},properties:function(e,t,n){var r=n.callback;return r.drag=n.drag,r.proxy=n.proxy||n.drag,r.startX=t.pageX,r.startY=t.pageY,r.deltaX=e.pageX-t.pageX,r.deltaY=e.pageY-t.pageY,r.originalX=n.offset.left,r.originalY=n.offset.top,r.offsetX=r.originalX+r.deltaX,r.offsetY=r.originalY+r.deltaY,r.drop=i.flatten((n.drop||[]).slice()),r.available=i.flatten((n.droppable||[]).slice()),r},element:function(e){return e&&(e.jquery||1==e.nodeType)?e:void 0},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?i.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",i.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};i.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var r=t.dispatch;t.dispatch=function(t){return e.data(this,"suppress."+t.type)-(new Date).getTime()>0?void e.removeData(this,"suppress."+t.type):r.apply(this,arguments)};var o=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var i=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;i&&e.each(o.props,function(e,n){t[n]=i[n]})}return t}};n.draginit=n.dragstart=n.dragend=i}(jQuery)},function(e,t){!function(e){e.fn.drop=function(t,n,i){var r="string"==typeof t?t:"",o=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==r.indexOf("drop")&&(r="drop"+r),i=(t==o?n:i)||{},o?this.bind(r,i,o):this.trigger(r)},e.drop=function(t){t=t||{},i.multi=t.multi===!0?1/0:t.multi===!1?1:isNaN(t.multi)?i.multi:t.multi,i.delay=t.delay||i.delay,i.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:i.tolerance,i.mode=t.mode||i.mode||"intersect"};var t=e.event,n=t.special,i=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){var n=e.data(this,i.datakey);n.related+=1},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var t={related:0,active:[],anyactive:0,winner:0,location:{}};e.data(this,i.datakey,t),i.targets.push(this)}},teardown:function(){var t=e.data(this,i.datakey)||{};if(!t.related){e.removeData(this,i.datakey);var n=this;i.targets=e.grep(i.targets,function(e){return e!==n})}},handler:function(t,r){var o;if(r)switch(t.type){case"mousedown":case"touchstart":o=e(i.targets),"string"==typeof r.drop&&(o=o.filter(r.drop)),o.each(function(){var t=e.data(this,i.datakey);t.active=[],t.anyactive=0,t.winner=0}),r.droppable=o,n.drag.hijack(t,"dropinit",r);break;case"mousemove":case"touchmove":i.event=t,i.timer||i.tolerate(r);break;case"mouseup":case"touchend":i.timer=clearTimeout(i.timer),r.propagates&&(n.drag.hijack(t,"drop",r),n.drag.hijack(t,"dropend",r))}},locate:function(t,n){var r=e.data(t,i.datakey),o=e(t),a=o.offset()||{},s=o.outerHeight(),l=o.outerWidth(),c={elem:t,width:l,height:s,top:a.top,left:a.left,right:a.left+l,bottom:a.top+s};return r&&(r.location=c,r.index=n,r.elem=t),c},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(t){var r,o,a,s,l,c,u,d,h=0,p=t.interactions.length,f=[i.event.pageX,i.event.pageY],m=i.tolerance||i.modes[i.mode];do if(d=t.interactions[h]){if(!d)return;d.drop=[],l=[],c=d.droppable.length,m&&(a=i.locate(d.proxy)),r=0;do if(u=d.droppable[r]){if(s=e.data(u,i.datakey),o=s.location,!o)continue;s.winner=m?m.call(i,i.event,a,o):i.contains(o,f)?1:0,l.push(s)}while(++r<c);l.sort(i.sort),r=0;do(s=l[r])&&(s.winner&&d.drop.length<i.multi?(s.active[h]||s.anyactive||(n.drag.hijack(i.event,"dropstart",t,h,s.elem)[0]!==!1?(s.active[h]=1,s.anyactive+=1):s.winner=0),s.winner&&d.drop.push(s.elem)):s.active[h]&&1==s.anyactive&&(n.drag.hijack(i.event,"dropend",t,h,s.elem),s.active[h]=0,s.anyactive-=1));while(++r<c)}while(++h<p);i.last&&f[0]==i.last.pageX&&f[1]==i.last.pageY?delete i.timer:i.timer=setTimeout(function(){i.tolerate(t)},i.delay),i.last=i.event}};n.dropinit=n.dropstart=n.dropend=i}(jQuery)},function(module,exports){if("undefined"==typeof jQuery)throw"SlickGrid requires jquery module to be loaded";if(!jQuery.fn.drag)throw"SlickGrid requires jquery.event.drag module to be loaded";if("undefined"==typeof Slick)throw"slick.core.js not loaded";!function($){function SlickGrid(container,data,columns,options){function init(){if($container=$(container),$container.length<1)throw new Error("SlickGrid requires a valid container, "+container+" does not exist in the DOM.");maxSupportedCssHeight=maxSupportedCssHeight||getMaxSupportedCssHeight(),scrollbarDimensions=scrollbarDimensions||measureScrollbar(),options=$.extend({},defaults,options),validateAndEnforceOptions(),columnDefaults.width=options.defaultColumnWidth,columnsById={};for(var e=0;e<columns.length;e++){var t=columns[e]=$.extend({},columnDefaults,columns[e]);columnsById[t.id]=e,t.minWidth&&t.width<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&t.width>t.maxWidth&&(t.width=t.maxWidth)}if(options.enableColumnReorder&&!$.fn.sortable)throw new Error("SlickGrid's 'enableColumnReorder = true' option requires jquery-ui.sortable module to be loaded");editController={commitCurrentEdit:commitCurrentEdit,cancelCurrentEdit:cancelCurrentEdit},$container.empty().css("overflow","hidden").css("outline",0).addClass(uid).addClass("ui-widget"),/relative|absolute|fixed/.test($container.css("position"))||$container.css("position","relative"),$focusSink=$("<div tabIndex='0' hideFocus style='position:fixed;width:0;height:0;top:0;left:0;outline:0;'></div>").appendTo($container),$headerScroller=$("<div class='slick-header ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headers=$("<div class='slick-header-columns' style='left:-1000px' />").appendTo($headerScroller),$headers.width(getHeadersWidth()),$headerRowScroller=$("<div class='slick-headerrow ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$headerRow=$("<div class='slick-headerrow-columns' />").appendTo($headerRowScroller),$headerRowSpacer=$("<div style='display:block;height:1px;position:absolute;top:0;left:0;'></div>").css("width",getCanvasWidth()+scrollbarDimensions.width+"px").appendTo($headerRowScroller),$topPanelScroller=$("<div class='slick-top-panel-scroller ui-state-default' style='overflow:hidden;position:relative;' />").appendTo($container),$topPanel=$("<div class='slick-top-panel' style='width:10000px' />").appendTo($topPanelScroller),options.showTopPanel||$topPanelScroller.hide(),options.showHeaderRow||$headerRowScroller.hide(),$viewport=$("<div class='slick-viewport' style='width:100%;overflow:auto;outline:0;position:relative;;'>").appendTo($container),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),$canvas=$("<div class='grid-canvas' />").appendTo($viewport),$focusSink2=$focusSink.clone().appendTo($container),options.explicitInitialization||finishInitialization()}function finishInitialization(){initialized||(initialized=!0,viewportW=parseFloat($.css($container[0],"width",!0)),measureCellPaddingAndBorder(),disableSelection($headers),options.enableTextSelectionOnCells||$viewport.bind("selectstart.ui",function(e){return $(e.target).is("input,textarea")}),updateColumnCaches(),createColumnHeaders(),setupColumnSort(),createCssRules(),resizeCanvas(),bindAncestorScrollEvents(),$container.bind("resize.slickgrid",resizeCanvas),$viewport.bind("scroll",handleScroll),$headerScroller.bind("contextmenu",handleHeaderContextMenu).bind("click",handleHeaderClick).delegate(".slick-header-column","mouseenter",handleHeaderMouseEnter).delegate(".slick-header-column","mouseleave",handleHeaderMouseLeave),$headerRowScroller.bind("scroll",handleHeaderRowScroll),$focusSink.add($focusSink2).bind("keydown",handleKeyDown),$canvas.bind("keydown",handleKeyDown).bind("click",handleClick).bind("dblclick",handleDblClick).bind("contextmenu",handleContextMenu).bind("draginit",handleDragInit).bind("dragstart",{distance:3},handleDragStart).bind("drag",handleDrag).bind("dragend",handleDragEnd).delegate(".slick-cell","mouseenter",handleMouseEnter).delegate(".slick-cell","mouseleave",handleMouseLeave),navigator.userAgent.toLowerCase().match(/webkit/)&&navigator.userAgent.toLowerCase().match(/macintosh/)&&$canvas.bind("mousewheel",handleMouseWheel))}function registerPlugin(e){plugins.unshift(e),e.init(self)}function unregisterPlugin(e){
for(var t=plugins.length;t>=0;t--)if(plugins[t]===e){plugins[t].destroy&&plugins[t].destroy(),plugins.splice(t,1);break}}function setSelectionModel(e){selectionModel&&(selectionModel.onSelectedRangesChanged.unsubscribe(handleSelectedRangesChanged),selectionModel.destroy&&selectionModel.destroy()),selectionModel=e,selectionModel&&(selectionModel.init(self),selectionModel.onSelectedRangesChanged.subscribe(handleSelectedRangesChanged))}function getSelectionModel(){return selectionModel}function getCanvasNode(){return $canvas[0]}function measureScrollbar(){var e=$("<div style='position:absolute; top:-10000px; left:-10000px; width:100px; height:100px; overflow:scroll;'></div>").appendTo("body"),t={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),t}function getHeadersWidth(){for(var e=0,t=0,n=columns.length;n>t;t++){var i=columns[t].width;e+=i}return e+=scrollbarDimensions.width,Math.max(e,viewportW)+1e3}function getCanvasWidth(){for(var e=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW,t=0,n=columns.length;n--;)t+=columns[n].width;return options.fullWidthRows?Math.max(t,e):t}function updateCanvasWidth(e){var t=canvasWidth;canvasWidth=getCanvasWidth(),canvasWidth!=t&&($canvas.width(canvasWidth),$headerRow.width(canvasWidth),$headers.width(getHeadersWidth()),viewportHasHScroll=canvasWidth>viewportW-scrollbarDimensions.width),$headerRowSpacer.width(canvasWidth+(viewportHasVScroll?scrollbarDimensions.width:0)),(canvasWidth!=t||e)&&applyColumnWidths()}function disableSelection(e){e&&e.jquery&&e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function getMaxSupportedCssHeight(){for(var e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,n=$("<div style='display:none' />").appendTo(document.body);;){var i=2*e;if(n.css("height",i),i>t||n.height()!==i)break;e=i}return n.remove(),e}function bindAncestorScrollEvents(){for(var e=$canvas[0];(e=e.parentNode)!=document.body&&null!=e;)if(e==$viewport[0]||e.scrollWidth!=e.clientWidth||e.scrollHeight!=e.clientHeight){var t=$(e);$boundAncestors=$boundAncestors?$boundAncestors.add(t):t,t.bind("scroll."+uid,handleActiveCellPositionChange)}}function unbindAncestorScrollEvents(){$boundAncestors&&($boundAncestors.unbind("scroll."+uid),$boundAncestors=null)}function updateColumnHeader(e,t,n){if(initialized){var i=getColumnIndex(e);if(null!=i){var r=columns[i],o=$headers.children().eq(i);o&&(void 0!==t&&(columns[i].name=t),void 0!==n&&(columns[i].toolTip=n),trigger(self.onBeforeHeaderCellDestroy,{node:o[0],column:r}),o.attr("title",n||"").children().eq(0).html(t),trigger(self.onHeaderCellRendered,{node:o[0],column:r}))}}}function getHeaderRow(){return $headerRow[0]}function getHeaderRowColumn(e){var t=getColumnIndex(e),n=$headerRow.children().eq(t);return n&&n[0]}function createColumnHeaders(){function e(){$(this).addClass("ui-state-hover")}function t(){$(this).removeClass("ui-state-hover")}$headers.find(".slick-header-column").each(function(){var e=$(this).data("column");e&&trigger(self.onBeforeHeaderCellDestroy,{node:this,column:e})}),$headers.empty(),$headers.width(getHeadersWidth()),$headerRow.find(".slick-headerrow-column").each(function(){var e=$(this).data("column");e&&trigger(self.onBeforeHeaderRowCellDestroy,{node:this,column:e})}),$headerRow.empty();for(var n=0;n<columns.length;n++){var i=columns[n],r=$("<div class='ui-state-default slick-header-column' />").html("<span class='slick-column-name'>"+i.name+"</span>").width(i.width-headerColumnWidthDiff).attr("id",""+uid+i.id).attr("title",i.toolTip||"").data("column",i).addClass(i.headerCssClass||"").appendTo($headers);if((options.enableColumnReorder||i.sortable)&&r.on("mouseenter",e).on("mouseleave",t),i.sortable&&(r.addClass("slick-header-sortable"),r.append("<span class='slick-sort-indicator' />")),trigger(self.onHeaderCellRendered,{node:r[0],column:i}),options.showHeaderRow){var o=$("<div class='ui-state-default slick-headerrow-column l"+n+" r"+n+"'></div>").data("column",i).appendTo($headerRow);trigger(self.onHeaderRowCellRendered,{node:o[0],column:i})}}setSortColumns(sortColumns),setupColumnResize(),options.enableColumnReorder&&setupColumnReorder()}function setupColumnSort(){$headers.click(function(e){if(e.metaKey=e.metaKey||e.ctrlKey,!$(e.target).hasClass("slick-resizable-handle")){var t=$(e.target).closest(".slick-header-column");if(t.length){var n=t.data("column");if(n.sortable){if(!getEditorLock().commitCurrentEdit())return;for(var i=null,r=0;r<sortColumns.length;r++)if(sortColumns[r].columnId==n.id){i=sortColumns[r],i.sortAsc=!i.sortAsc;break}e.metaKey&&options.multiColumnSort?i&&sortColumns.splice(r,1):((e.shiftKey||e.metaKey)&&options.multiColumnSort||(sortColumns=[]),i?0==sortColumns.length&&sortColumns.push(i):(i={columnId:n.id,sortAsc:n.defaultSortAsc},sortColumns.push(i))),setSortColumns(sortColumns),options.multiColumnSort?trigger(self.onSort,{multiColumnSort:!0,sortCols:$.map(sortColumns,function(e){return{sortCol:columns[getColumnIndex(e.columnId)],sortAsc:e.sortAsc}})},e):trigger(self.onSort,{multiColumnSort:!1,sortCol:n,sortAsc:i.sortAsc},e)}}}})}function setupColumnReorder(){$headers.filter(":ui-sortable").sortable("destroy"),$headers.sortable({containment:"parent",distance:3,axis:"x",cursor:"default",tolerance:"intersection",helper:"clone",placeholder:"slick-sortable-placeholder ui-state-default slick-header-column",start:function(e,t){t.placeholder.width(t.helper.outerWidth()-headerColumnWidthDiff),$(t.helper).addClass("slick-header-column-active")},beforeStop:function(e,t){$(t.helper).removeClass("slick-header-column-active")},stop:function(e){if(!getEditorLock().commitCurrentEdit())return void $(this).sortable("cancel");for(var t=$headers.sortable("toArray"),n=[],i=0;i<t.length;i++)n.push(columns[getColumnIndex(t[i].replace(uid,""))]);setColumns(n),trigger(self.onColumnsReordered,{}),e.stopPropagation(),setupColumnResize()}})}function setupColumnResize(){var e,t,n,i,r,o,a,s,l;r=$headers.children(),r.find(".slick-resizable-handle").remove(),r.each(function(e,t){columns[e].resizable&&(void 0===s&&(s=e),l=e)}),void 0!==s&&r.each(function(c,u){s>c||options.forceFitColumns&&c>=l||(e=$(u),$("<div class='slick-resizable-handle' />").appendTo(u).bind("dragstart",function(e,s){if(!getEditorLock().commitCurrentEdit())return!1;i=e.pageX,$(this).parent().addClass("slick-header-column-active");var l=null,u=null;if(r.each(function(e,t){columns[e].previousWidth=$(t).outerWidth()}),options.forceFitColumns)for(l=0,u=0,t=c+1;t<r.length;t++)n=columns[t],n.resizable&&(null!==u&&(n.maxWidth?u+=n.maxWidth-n.previousWidth:u=null),l+=n.previousWidth-Math.max(n.minWidth||0,absoluteColumnMinWidth));var d=0,h=0;for(t=0;c>=t;t++)n=columns[t],n.resizable&&(null!==h&&(n.maxWidth?h+=n.maxWidth-n.previousWidth:h=null),d+=n.previousWidth-Math.max(n.minWidth||0,absoluteColumnMinWidth));null===l&&(l=1e5),null===d&&(d=1e5),null===u&&(u=1e5),null===h&&(h=1e5),a=i+Math.min(l,h),o=i-Math.min(d,u)}).bind("drag",function(e,s){var l,u,d=Math.min(a,Math.max(o,e.pageX))-i;if(0>d){for(u=d,t=c;t>=0;t--)n=columns[t],n.resizable&&(l=Math.max(n.minWidth||0,absoluteColumnMinWidth),u&&n.previousWidth+u<l?(u+=n.previousWidth-l,n.width=l):(n.width=n.previousWidth+u,u=0));if(options.forceFitColumns)for(u=-d,t=c+1;t<r.length;t++)n=columns[t],n.resizable&&(u&&n.maxWidth&&n.maxWidth-n.previousWidth<u?(u-=n.maxWidth-n.previousWidth,n.width=n.maxWidth):(n.width=n.previousWidth+u,u=0))}else{for(u=d,t=c;t>=0;t--)n=columns[t],n.resizable&&(u&&n.maxWidth&&n.maxWidth-n.previousWidth<u?(u-=n.maxWidth-n.previousWidth,n.width=n.maxWidth):(n.width=n.previousWidth+u,u=0));if(options.forceFitColumns)for(u=-d,t=c+1;t<r.length;t++)n=columns[t],n.resizable&&(l=Math.max(n.minWidth||0,absoluteColumnMinWidth),u&&n.previousWidth+u<l?(u+=n.previousWidth-l,n.width=l):(n.width=n.previousWidth+u,u=0))}applyColumnHeaderWidths(),options.syncColumnCellResize&&applyColumnWidths()}).bind("dragend",function(e,i){var o;for($(this).parent().removeClass("slick-header-column-active"),t=0;t<r.length;t++)n=columns[t],o=$(r[t]).outerWidth(),n.previousWidth!==o&&n.rerenderOnResize&&invalidateAllRows();updateCanvasWidth(!0),render(),trigger(self.onColumnsResized,{})}))})}function getVBoxDelta(e){var t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],n=0;return $.each(t,function(t,i){n+=parseFloat(e.css(i))||0}),n}function measureCellPaddingAndBorder(){var e,t=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];e=$("<div class='ui-state-default slick-header-column' style='visibility:hidden'>-</div>").appendTo($headers),headerColumnWidthDiff=headerColumnHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&($.each(t,function(t,n){headerColumnWidthDiff+=parseFloat(e.css(n))||0}),$.each(n,function(t,n){headerColumnHeightDiff+=parseFloat(e.css(n))||0})),e.remove();var i=$("<div class='slick-row' />").appendTo($canvas);e=$("<div class='slick-cell' id='' style='visibility:hidden'>-</div>").appendTo(i),cellWidthDiff=cellHeightDiff=0,"border-box"!=e.css("box-sizing")&&"border-box"!=e.css("-moz-box-sizing")&&"border-box"!=e.css("-webkit-box-sizing")&&($.each(t,function(t,n){cellWidthDiff+=parseFloat(e.css(n))||0}),$.each(n,function(t,n){cellHeightDiff+=parseFloat(e.css(n))||0})),i.remove(),absoluteColumnMinWidth=Math.max(headerColumnWidthDiff,cellWidthDiff)}function createCssRules(){$style=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));for(var e=options.rowHeight-cellHeightDiff,t=["."+uid+" .slick-header-column { left: 1000px; }","."+uid+" .slick-top-panel { height:"+options.topPanelHeight+"px; }","."+uid+" .slick-headerrow-columns { height:"+options.headerRowHeight+"px; }","."+uid+" .slick-cell { height:"+e+"px; }","."+uid+" .slick-row { height:"+options.rowHeight+"px; }"],n=0;n<columns.length;n++)t.push("."+uid+" .l"+n+" { }"),t.push("."+uid+" .r"+n+" { }");$style[0].styleSheet?$style[0].styleSheet.cssText=t.join(" "):$style[0].appendChild(document.createTextNode(t.join(" ")))}function getColumnCssRules(e){if(!stylesheet){for(var t=document.styleSheets,n=0;n<t.length;n++)if((t[n].ownerNode||t[n].owningElement)==$style[0]){stylesheet=t[n];break}if(!stylesheet)throw new Error("Cannot find stylesheet.");columnCssRulesL=[],columnCssRulesR=[];for(var i,r,o=stylesheet.cssRules||stylesheet.rules,n=0;n<o.length;n++){var a=o[n].selectorText;(i=/\.l\d+/.exec(a))?(r=parseInt(i[0].substr(2,i[0].length-2),10),columnCssRulesL[r]=o[n]):(i=/\.r\d+/.exec(a))&&(r=parseInt(i[0].substr(2,i[0].length-2),10),columnCssRulesR[r]=o[n])}}return{left:columnCssRulesL[e],right:columnCssRulesR[e]}}function removeCssRules(){$style.remove(),stylesheet=null}function destroy(){getEditorLock().cancelCurrentEdit(),trigger(self.onBeforeDestroy,{});for(var e=plugins.length;e--;)unregisterPlugin(plugins[e]);options.enableColumnReorder&&$headers.filter(":ui-sortable").sortable("destroy"),unbindAncestorScrollEvents(),$container.unbind(".slickgrid"),removeCssRules(),$canvas.unbind("draginit dragstart dragend drag"),$container.empty().removeClass(uid)}function trigger(e,t,n){return n=n||new Slick.EventData,t=t||{},t.grid=self,e.notify(t,n,self)}function getEditorLock(){return options.editorLock}function getEditController(){return editController}function getColumnIndex(e){return columnsById[e]}function autosizeColumns(){var e,t,n,i=[],r=0,o=0,a=viewportHasVScroll?viewportW-scrollbarDimensions.width:viewportW;for(e=0;e<columns.length;e++)t=columns[e],i.push(t.width),o+=t.width,t.resizable&&(r+=t.width-Math.max(t.minWidth,absoluteColumnMinWidth));for(n=o;o>a&&r;){var s=(o-a)/r;for(e=0;e<columns.length&&o>a;e++){t=columns[e];var l=i[e];if(!(!t.resizable||l<=t.minWidth||absoluteColumnMinWidth>=l)){var c=Math.max(t.minWidth,absoluteColumnMinWidth),u=Math.floor(s*(l-c))||1;u=Math.min(u,l-c),o-=u,r-=u,i[e]-=u}}if(o>=n)break;n=o}for(n=o;a>o;){var d=a/o;for(e=0;e<columns.length&&a>o;e++){t=columns[e];var h,p=i[e];h=!t.resizable||t.maxWidth<=p?0:Math.min(Math.floor(d*p)-p,t.maxWidth-p||1e6)||1,o+=h,i[e]+=h}if(n>=o)break;n=o}var f=!1;for(e=0;e<columns.length;e++)columns[e].rerenderOnResize&&columns[e].width!=i[e]&&(f=!0),columns[e].width=i[e];applyColumnHeaderWidths(),updateCanvasWidth(!0),f&&(invalidateAllRows(),render())}function applyColumnHeaderWidths(){if(initialized){for(var e,t=0,n=$headers.children(),i=n.length;i>t;t++)e=$(n[t]),e.width()!==columns[t].width-headerColumnWidthDiff&&e.width(columns[t].width-headerColumnWidthDiff);updateColumnCaches()}}function applyColumnWidths(){for(var e,t,n=0,i=0;i<columns.length;i++)e=columns[i].width,t=getColumnCssRules(i),t.left.style.left=n+"px",t.right.style.right=canvasWidth-n-e+"px",n+=columns[i].width}function setSortColumn(e,t){setSortColumns([{columnId:e,sortAsc:t}])}function setSortColumns(e){sortColumns=e;var t=$headers.children();t.removeClass("slick-header-column-sorted").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc "+options.sortIndicatorAsc+" "+options.sortIndicatorDesc),$.each(sortColumns,function(e,n){null==n.sortAsc&&(n.sortAsc=!0);var i=getColumnIndex(n.columnId);null!=i&&t.eq(i).addClass("slick-header-column-sorted").find(".slick-sort-indicator").addClass(n.sortAsc?"slick-sort-indicator-asc "+options.sortIndicatorAsc:"slick-sort-indicator-desc "+options.sortIndicatorDesc)})}function getSortColumns(){return sortColumns}function handleSelectedRangesChanged(e,t){selectedRows=[];for(var n={},i=0;i<t.length;i++)for(var r=t[i].fromRow;r<=t[i].toRow;r++){n[r]||(selectedRows.push(r),n[r]={});for(var o=t[i].fromCell;o<=t[i].toCell;o++)canCellBeSelected(r,o)&&(n[r][columns[o].id]=options.selectedCellCssClass)}setCellCssStyles(options.selectedCellCssClass,n),trigger(self.onSelectedRowsChanged,{rows:getSelectedRows()},e)}function getColumns(){return columns}function updateColumnCaches(){columnPosLeft=[],columnPosRight=[];for(var e=0,t=0,n=columns.length;n>t;t++)columnPosLeft[t]=e,columnPosRight[t]=e+columns[t].width,e+=columns[t].width}function setColumns(e){columns=e,columnsById={};for(var t=0;t<columns.length;t++){var n=columns[t]=$.extend({},columnDefaults,columns[t]);columnsById[n.id]=t,n.minWidth&&n.width<n.minWidth&&(n.width=n.minWidth),n.maxWidth&&n.width>n.maxWidth&&(n.width=n.maxWidth)}updateColumnCaches(),initialized&&(invalidateAllRows(),createColumnHeaders(),removeCssRules(),createCssRules(),resizeCanvas(),applyColumnWidths(),handleScroll())}function getOptions(){return options}function setOptions(e){getEditorLock().commitCurrentEdit()&&(makeActiveCellNormal(),options.enableAddRow!==e.enableAddRow&&invalidateRow(getDataLength()),options=$.extend(options,e),validateAndEnforceOptions(),$viewport.css("overflow-y",options.autoHeight?"hidden":"auto"),render())}function validateAndEnforceOptions(){options.autoHeight&&(options.leaveSpaceForNewRows=!1)}function setData(e,t){data=e,invalidateAllRows(),updateRowCount(),t&&scrollTo(0)}function getData(){return data}function getDataLength(){return data.getLength?data.getLength():data.length}function getDataLengthIncludingAddNew(){return getDataLength()+(options.enableAddRow?1:0)}function getDataItem(e){return data.getItem?data.getItem(e):data[e]}function getTopPanel(){return $topPanel[0]}function setTopPanelVisibility(e){options.showTopPanel!=e&&(options.showTopPanel=e,e?$topPanelScroller.slideDown("fast",resizeCanvas):$topPanelScroller.slideUp("fast",resizeCanvas))}function setHeaderRowVisibility(e){options.showHeaderRow!=e&&(options.showHeaderRow=e,e?$headerRowScroller.slideDown("fast",resizeCanvas):$headerRowScroller.slideUp("fast",resizeCanvas))}function getContainerNode(){return $container.get(0)}function getRowTop(e){return options.rowHeight*e-offset}function getRowFromPosition(e){return Math.floor((e+offset)/options.rowHeight)}function scrollTo(e){e=Math.max(e,0),e=Math.min(e,th-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0));var t=offset;page=Math.min(n-1,Math.floor(e/ph)),offset=Math.round(page*cj);var i=e-offset;if(offset!=t){var r=getVisibleRange(i);cleanupRows(r),updateRowPositions()}prevScrollTop!=i&&(vScrollDir=i+offset>prevScrollTop+t?1:-1,$viewport[0].scrollTop=lastRenderedScrollTop=scrollTop=prevScrollTop=i,trigger(self.onViewportChanged,{}))}function defaultFormatter(e,t,n,i,r){return null==n?"":(n+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function getFormatter(e,t){var n=data.getItemMetadata&&data.getItemMetadata(e),i=n&&n.columns&&(n.columns[t.id]||n.columns[getColumnIndex(t.id)]);return i&&i.formatter||n&&n.formatter||t.formatter||options.formatterFactory&&options.formatterFactory.getFormatter(t)||options.defaultFormatter}function getEditor(e,t){var n=columns[t],i=data.getItemMetadata&&data.getItemMetadata(e),r=i&&i.columns;return r&&r[n.id]&&void 0!==r[n.id].editor?r[n.id].editor:r&&r[t]&&void 0!==r[t].editor?r[t].editor:n.editor||options.editorFactory&&options.editorFactory.getEditor(n)}function getDataItemValueForColumn(e,t){return options.dataItemColumnValueExtractor?options.dataItemColumnValueExtractor(e,t):e[t.field]}function appendRowHtml(e,t,n,i){var r=getDataItem(t),o=i>t&&!r,a="slick-row"+(o?" loading":"")+(t===activeRow?" active":"")+(t%2==1?" odd":" even");r||(a+=" "+options.addNewRowCssClass);var s=data.getItemMetadata&&data.getItemMetadata(t);s&&s.cssClasses&&(a+=" "+s.cssClasses),e.push("<div class='ui-widget-content "+a+"' style='top:"+getRowTop(t)+"px'>");for(var l,c,u=0,d=columns.length;d>u;u++){if(c=columns[u],l=1,s&&s.columns){var h=s.columns[c.id]||s.columns[u];l=h&&h.colspan||1,"*"===l&&(l=d-u)}if(columnPosRight[Math.min(d-1,u+l-1)]>n.leftPx){if(columnPosLeft[u]>n.rightPx)break;appendCellHtml(e,t,u,l,r)}l>1&&(u+=l-1)}e.push("</div>")}function appendCellHtml(e,t,n,i,r){var o=columns[n],a="slick-cell l"+n+" r"+Math.min(columns.length-1,n+i-1)+(o.cssClass?" "+o.cssClass:"");t===activeRow&&n===activeCell&&(a+=" active");for(var s in cellCssClasses)cellCssClasses[s][t]&&cellCssClasses[s][t][o.id]&&(a+=" "+cellCssClasses[s][t][o.id]);if(e.push("<div class='"+a+"'>"),r){var l=getDataItemValueForColumn(r,o);e.push(getFormatter(t,o)(t,n,l,o,r))}e.push("</div>"),rowsCache[t].cellRenderQueue.push(n),rowsCache[t].cellColSpans[n]=i}function cleanupRows(e){for(var t in rowsCache)(t=parseInt(t,10))!==activeRow&&(t<e.top||t>e.bottom)&&removeRowFromCache(t)}function invalidate(){updateRowCount(),invalidateAllRows(),render()}function invalidateAllRows(){currentEditor&&makeActiveCellNormal();for(var e in rowsCache)removeRowFromCache(e)}function removeRowFromCache(e){var t=rowsCache[e];t&&(rowNodeFromLastMouseWheelEvent==t.rowNode?(t.rowNode.style.display="none",zombieRowNodeFromLastMouseWheelEvent=rowNodeFromLastMouseWheelEvent):$canvas[0].removeChild(t.rowNode),delete rowsCache[e],delete postProcessedRows[e],renderedRows--,counter_rows_removed++)}function invalidateRows(e){var t,n;if(e&&e.length)for(vScrollDir=0,t=0,n=e.length;n>t;t++)currentEditor&&activeRow===e[t]&&makeActiveCellNormal(),rowsCache[e[t]]&&removeRowFromCache(e[t])}function invalidateRow(e){invalidateRows([e])}function updateCell(e,t){var n=getCellNode(e,t);if(n){var i=columns[t],r=getDataItem(e);currentEditor&&activeRow===e&&activeCell===t?currentEditor.loadValue(r):(n.innerHTML=r?getFormatter(e,i)(e,t,getDataItemValueForColumn(r,i),i,r):"",invalidatePostProcessingResults(e))}}function updateRow(e){var t=rowsCache[e];if(t){ensureCellNodesInRowsCache(e);var n=getDataItem(e);for(var i in t.cellNodesByColumnIdx)if(t.cellNodesByColumnIdx.hasOwnProperty(i)){i=0|i;var r=columns[i],o=t.cellNodesByColumnIdx[i];e===activeRow&&i===activeCell&&currentEditor?currentEditor.loadValue(n):n?o.innerHTML=getFormatter(e,r)(e,i,getDataItemValueForColumn(n,r),r,n):o.innerHTML=""}invalidatePostProcessingResults(e)}}function getViewportHeight(){return parseFloat($.css($container[0],"height",!0))-parseFloat($.css($container[0],"paddingTop",!0))-parseFloat($.css($container[0],"paddingBottom",!0))-parseFloat($.css($headerScroller[0],"height"))-getVBoxDelta($headerScroller)-(options.showTopPanel?options.topPanelHeight+getVBoxDelta($topPanelScroller):0)-(options.showHeaderRow?options.headerRowHeight+getVBoxDelta($headerRowScroller):0)}function resizeCanvas(){initialized&&(viewportH=options.autoHeight?options.rowHeight*getDataLengthIncludingAddNew():getViewportHeight(),numVisibleRows=Math.ceil(viewportH/options.rowHeight),viewportW=parseFloat($.css($container[0],"width",!0)),options.autoHeight||$viewport.height(viewportH),options.forceFitColumns&&autosizeColumns(),updateRowCount(),handleScroll(),lastRenderedScrollLeft=-1,render())}function updateRowCount(){if(initialized){var e=getDataLengthIncludingAddNew(),t=e+(options.leaveSpaceForNewRows?numVisibleRows-1:0),i=viewportHasVScroll;viewportHasVScroll=!options.autoHeight&&t*options.rowHeight>viewportH,makeActiveCellNormal();var r=e-1;for(var o in rowsCache)o>=r&&removeRowFromCache(o);activeCellNode&&activeRow>r&&resetActiveCell();var a=h;th=Math.max(options.rowHeight*t,viewportH-scrollbarDimensions.height),maxSupportedCssHeight>th?(h=ph=th,n=1,cj=0):(h=maxSupportedCssHeight,ph=h/100,n=Math.floor(th/ph),cj=(th-h)/(n-1)),h!==a&&($canvas.css("height",h),scrollTop=$viewport[0].scrollTop);var s=th-viewportH>=scrollTop+offset;0==th||0==scrollTop?page=offset=0:scrollTo(s?scrollTop+offset:th-viewportH),h!=a&&options.autoHeight&&resizeCanvas(),options.forceFitColumns&&i!=viewportHasVScroll&&autosizeColumns(),updateCanvasWidth(!1)}}function getVisibleRange(e,t){return null==e&&(e=scrollTop),null==t&&(t=scrollLeft),{top:getRowFromPosition(e),bottom:getRowFromPosition(e+viewportH)+1,leftPx:t,rightPx:t+viewportW}}function getRenderedRange(e,t){var n=getVisibleRange(e,t),i=Math.round(viewportH/options.rowHeight),r=3;return-1==vScrollDir?(n.top-=i,n.bottom+=r):1==vScrollDir?(n.top-=r,n.bottom+=i):(n.top-=r,n.bottom+=r),n.top=Math.max(0,n.top),n.bottom=Math.min(getDataLengthIncludingAddNew()-1,n.bottom),n.leftPx-=viewportW,n.rightPx+=viewportW,n.leftPx=Math.max(0,n.leftPx),n.rightPx=Math.min(canvasWidth,n.rightPx),n}function ensureCellNodesInRowsCache(e){var t=rowsCache[e];if(t&&t.cellRenderQueue.length)for(var n=t.rowNode.lastChild;t.cellRenderQueue.length;){var i=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[i]=n,n=n.previousSibling}}function cleanUpCells(e,t){var n=0,i=rowsCache[t],r=[];for(var o in i.cellNodesByColumnIdx)if(i.cellNodesByColumnIdx.hasOwnProperty(o)){o=0|o;var a=i.cellColSpans[o];(columnPosLeft[o]>e.rightPx||columnPosRight[Math.min(columns.length-1,o+a-1)]<e.leftPx)&&(t!=activeRow||o!=activeCell)&&r.push(o)}for(var s;null!=(s=r.pop());)i.rowNode.removeChild(i.cellNodesByColumnIdx[s]),delete i.cellColSpans[s],delete i.cellNodesByColumnIdx[s],postProcessedRows[t]&&delete postProcessedRows[t][s],n++}function cleanUpAndRenderCells(e){for(var t,n,i,r=[],o=[],a=0,s=e.top,l=e.bottom;l>=s;s++)if(t=rowsCache[s]){ensureCellNodesInRowsCache(s),cleanUpCells(e,s),n=0;var c=data.getItemMetadata&&data.getItemMetadata(s);c=c&&c.columns;for(var u=getDataItem(s),d=0,h=columns.length;h>d&&!(columnPosLeft[d]>e.rightPx);d++)if(null==(i=t.cellColSpans[d])){if(i=1,c){var p=c[columns[d].id]||c[d];i=p&&p.colspan||1,"*"===i&&(i=h-d)}columnPosRight[Math.min(h-1,d+i-1)]>e.leftPx&&(appendCellHtml(r,s,d,i,u),n++),d+=i>1?i-1:0}else d+=i>1?i-1:0;n&&(a+=n,o.push(s))}if(r.length){var f=document.createElement("div");f.innerHTML=r.join("");for(var m,g;null!=(m=o.pop());){t=rowsCache[m];for(var v;null!=(v=t.cellRenderQueue.pop());)g=f.lastChild,t.rowNode.appendChild(g),t.cellNodesByColumnIdx[v]=g}}}function renderRows(e){for(var t=$canvas[0],n=[],i=[],r=!1,o=getDataLength(),a=e.top,s=e.bottom;s>=a;a++)rowsCache[a]||(renderedRows++,i.push(a),rowsCache[a]={rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]},appendRowHtml(n,a,e,o),activeCellNode&&activeRow===a&&(r=!0),counter_rows_rendered++);if(i.length){var l=document.createElement("div");l.innerHTML=n.join("");for(var a=0,s=i.length;s>a;a++)rowsCache[i[a]].rowNode=t.appendChild(l.firstChild);r&&(activeCellNode=getCellNode(activeRow,activeCell))}}function startPostProcessing(){options.enableAsyncPostRender&&(clearTimeout(h_postrender),h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}function invalidatePostProcessingResults(e){delete postProcessedRows[e],postProcessFromRow=Math.min(postProcessFromRow,e),postProcessToRow=Math.max(postProcessToRow,e),startPostProcessing()}function updateRowPositions(){for(var e in rowsCache)rowsCache[e].rowNode.style.top=getRowTop(e)+"px"}function render(){if(initialized){var e=getVisibleRange(),t=getRenderedRange();cleanupRows(t),lastRenderedScrollLeft!=scrollLeft&&cleanUpAndRenderCells(t),renderRows(t),postProcessFromRow=e.top,postProcessToRow=Math.min(getDataLengthIncludingAddNew()-1,e.bottom),startPostProcessing(),lastRenderedScrollTop=scrollTop,lastRenderedScrollLeft=scrollLeft,h_render=null}}function handleHeaderRowScroll(){var e=$headerRowScroller[0].scrollLeft;e!=$viewport[0].scrollLeft&&($viewport[0].scrollLeft=e)}function handleScroll(){scrollTop=$viewport[0].scrollTop,scrollLeft=$viewport[0].scrollLeft;var e=Math.abs(scrollTop-prevScrollTop),t=Math.abs(scrollLeft-prevScrollLeft);if(t&&(prevScrollLeft=scrollLeft,$headerScroller[0].scrollLeft=scrollLeft,$topPanelScroller[0].scrollLeft=scrollLeft,$headerRowScroller[0].scrollLeft=scrollLeft),e)if(vScrollDir=scrollTop>prevScrollTop?1:-1,prevScrollTop=scrollTop,viewportH>e)scrollTo(scrollTop+offset);else{var i=offset;page=h==viewportH?0:Math.min(n-1,Math.floor(scrollTop*((th-viewportH)/(h-viewportH))*(1/ph))),offset=Math.round(page*cj),i!=offset&&invalidateAllRows()}(t||e)&&(h_render&&clearTimeout(h_render),(Math.abs(lastRenderedScrollTop-scrollTop)>20||Math.abs(lastRenderedScrollLeft-scrollLeft)>20)&&(options.forceSyncScrolling||Math.abs(lastRenderedScrollTop-scrollTop)<viewportH&&Math.abs(lastRenderedScrollLeft-scrollLeft)<viewportW?render():h_render=setTimeout(render,50),trigger(self.onViewportChanged,{}))),trigger(self.onScroll,{scrollLeft:scrollLeft,scrollTop:scrollTop})}function asyncPostProcessRows(){for(var e=getDataLength();postProcessToRow>=postProcessFromRow;){var t=vScrollDir>=0?postProcessFromRow++:postProcessToRow--,n=rowsCache[t];if(n&&!(t>=e)){postProcessedRows[t]||(postProcessedRows[t]={}),ensureCellNodesInRowsCache(t);for(var i in n.cellNodesByColumnIdx)if(n.cellNodesByColumnIdx.hasOwnProperty(i)){i=0|i;var r=columns[i];if(r.asyncPostRender&&!postProcessedRows[t][i]){var o=n.cellNodesByColumnIdx[i];o&&r.asyncPostRender(o,t,getDataItem(t),r),postProcessedRows[t][i]=!0}}return void(h_postrender=setTimeout(asyncPostProcessRows,options.asyncPostRenderDelay))}}}function updateCellCssStylesOnRenderedRows(e,t){var n,i,r,o;for(var a in rowsCache){if(o=t&&t[a],r=e&&e[a],o)for(i in o)r&&o[i]==r[i]||(n=getCellNode(a,getColumnIndex(i)),n&&$(n).removeClass(o[i]));if(r)for(i in r)o&&o[i]==r[i]||(n=getCellNode(a,getColumnIndex(i)),n&&$(n).addClass(r[i]))}}function addCellCssStyles(e,t){if(cellCssClasses[e])throw"addCellCssStyles: cell CSS hash with key '"+e+"' already exists.";cellCssClasses[e]=t,updateCellCssStylesOnRenderedRows(t,null),trigger(self.onCellCssStylesChanged,{key:e,hash:t})}function removeCellCssStyles(e){cellCssClasses[e]&&(updateCellCssStylesOnRenderedRows(null,cellCssClasses[e]),delete cellCssClasses[e],trigger(self.onCellCssStylesChanged,{key:e,hash:null}))}function setCellCssStyles(e,t){var n=cellCssClasses[e];cellCssClasses[e]=t,updateCellCssStylesOnRenderedRows(t,n),trigger(self.onCellCssStylesChanged,{key:e,hash:t})}function getCellCssStyles(e){return cellCssClasses[e]}function flashCell(e,t,n){function i(e){e&&setTimeout(function(){r.queue(function(){r.toggleClass(options.cellFlashingCssClass).dequeue(),i(e-1)})},n)}if(n=n||100,rowsCache[e]){var r=$(getCellNode(e,t));i(4)}}function handleMouseWheel(e){var t=$(e.target).closest(".slick-row")[0];t!=rowNodeFromLastMouseWheelEvent&&(zombieRowNodeFromLastMouseWheelEvent&&zombieRowNodeFromLastMouseWheelEvent!=t&&($canvas[0].removeChild(zombieRowNodeFromLastMouseWheelEvent),zombieRowNodeFromLastMouseWheelEvent=null),rowNodeFromLastMouseWheelEvent=t)}function handleDragInit(e,t){var n=getCellFromEvent(e);if(!n||!cellExists(n.row,n.cell))return!1;var i=trigger(self.onDragInit,t,e);return e.isImmediatePropagationStopped()?i:!1}function handleDragStart(e,t){var n=getCellFromEvent(e);if(!n||!cellExists(n.row,n.cell))return!1;var i=trigger(self.onDragStart,t,e);return e.isImmediatePropagationStopped()?i:!1}function handleDrag(e,t){return trigger(self.onDrag,t,e)}function handleDragEnd(e,t){trigger(self.onDragEnd,t,e)}function handleKeyDown(e){trigger(self.onKeyDown,{row:activeRow,cell:activeCell},e);var t=e.isImmediatePropagationStopped();if(!t)if(e.shiftKey||e.altKey||e.ctrlKey)9!=e.which||!e.shiftKey||e.ctrlKey||e.altKey||(t=navigatePrev());else if(27==e.which){if(!getEditorLock().isActive())return;cancelEditAndSetFocus()}else 34==e.which?(navigatePageDown(),t=!0):33==e.which?(navigatePageUp(),t=!0):37==e.which?t=navigateLeft():39==e.which?t=navigateRight():38==e.which?t=navigateUp():40==e.which?t=navigateDown():9==e.which?t=navigateNext():13==e.which&&(options.editable&&(currentEditor?activeRow===getDataLength()?navigateDown():commitEditAndSetFocus():getEditorLock().commitCurrentEdit()&&makeActiveCellEditable()),t=!0);if(t){e.stopPropagation(),e.preventDefault();try{e.originalEvent.keyCode=0}catch(n){}}}function handleClick(e){currentEditor||(e.target!=document.activeElement||$(e.target).hasClass("slick-cell"))&&setFocus();var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onClick,{row:t.row,cell:t.cell},e),e.isImmediatePropagationStopped()||activeCell==t.cell&&activeRow==t.row||!canCellBeActive(t.row,t.cell)||(!getEditorLock().isActive()||getEditorLock().commitCurrentEdit())&&(scrollRowIntoView(t.row,!1),setActiveCellInternal(getCellNode(t.row,t.cell))))}function handleContextMenu(e){var t=$(e.target).closest(".slick-cell",$canvas);0!==t.length&&(activeCellNode!==t[0]||null===currentEditor)&&trigger(self.onContextMenu,{},e)}function handleDblClick(e){var t=getCellFromEvent(e);!t||null!==currentEditor&&activeRow==t.row&&activeCell==t.cell||(trigger(self.onDblClick,{row:t.row,cell:t.cell},e),e.isImmediatePropagationStopped()||options.editable&&gotoCell(t.row,t.cell,!0))}function handleHeaderMouseEnter(e){trigger(self.onHeaderMouseEnter,{column:$(this).data("column")},e)}function handleHeaderMouseLeave(e){trigger(self.onHeaderMouseLeave,{column:$(this).data("column")},e)}function handleHeaderContextMenu(e){var t=$(e.target).closest(".slick-header-column",".slick-header-columns"),n=t&&t.data("column");trigger(self.onHeaderContextMenu,{column:n},e)}function handleHeaderClick(e){var t=$(e.target).closest(".slick-header-column",".slick-header-columns"),n=t&&t.data("column");n&&trigger(self.onHeaderClick,{column:n},e)}function handleMouseEnter(e){trigger(self.onMouseEnter,{},e)}function handleMouseLeave(e){trigger(self.onMouseLeave,{},e)}function cellExists(e,t){return!(0>e||e>=getDataLength()||0>t||t>=columns.length)}function getCellFromPoint(e,t){for(var n=getRowFromPosition(t),i=0,r=0,o=0;o<columns.length&&e>r;o++)r+=columns[o].width,i++;return 0>i&&(i=0),{row:n,cell:i-1}}function getCellFromNode(e){var t=/l\d+/.exec(e.className);if(!t)throw"getCellFromNode: cannot get cell - "+e.className;return parseInt(t[0].substr(1,t[0].length-1),10)}function getRowFromNode(e){for(var t in rowsCache)if(rowsCache[t].rowNode===e)return 0|t;return null}function getCellFromEvent(e){var t=$(e.target).closest(".slick-cell",$canvas);if(!t.length)return null;var n=getRowFromNode(t[0].parentNode),i=getCellFromNode(t[0]);return null==n||null==i?null:{row:n,cell:i}}function getCellNodeBox(e,t){if(!cellExists(e,t))return null;for(var n=getRowTop(e),i=n+options.rowHeight-1,r=0,o=0;t>o;o++)r+=columns[o].width;
var a=r+columns[t].width;return{top:n,left:r,bottom:i,right:a}}function resetActiveCell(){setActiveCellInternal(null,!1)}function setFocus(){-1==tabbingDirection?$focusSink[0].focus():$focusSink2[0].focus()}function scrollCellIntoView(e,t,n){scrollRowIntoView(e,n);var i=getColspan(e,t),r=columnPosLeft[t],o=columnPosRight[t+(i>1?i-1:0)],a=scrollLeft+viewportW;scrollLeft>r?($viewport.scrollLeft(r),handleScroll(),render()):o>a&&($viewport.scrollLeft(Math.min(r,o-$viewport[0].clientWidth)),handleScroll(),render())}function setActiveCellInternal(e,t){null!==activeCellNode&&(makeActiveCellNormal(),$(activeCellNode).removeClass("active"),rowsCache[activeRow]&&$(rowsCache[activeRow].rowNode).removeClass("active"));var n=activeCellNode!==e;activeCellNode=e,null!=activeCellNode?(activeRow=getRowFromNode(activeCellNode.parentNode),activeCell=activePosX=getCellFromNode(activeCellNode),null==t&&(t=activeRow==getDataLength()||options.autoEdit),$(activeCellNode).addClass("active"),$(rowsCache[activeRow].rowNode).addClass("active"),options.editable&&t&&isCellPotentiallyEditable(activeRow,activeCell)&&(clearTimeout(h_editorLoader),options.asyncEditorLoading?h_editorLoader=setTimeout(function(){makeActiveCellEditable()},options.asyncEditorLoadDelay):makeActiveCellEditable())):activeRow=activeCell=null,n&&trigger(self.onActiveCellChanged,getActiveCell())}function clearTextSelection(){if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}else if(window.getSelection){var t=window.getSelection();t&&t.removeAllRanges&&t.removeAllRanges()}}function isCellPotentiallyEditable(e,t){var n=getDataLength();return n>e&&!getDataItem(e)?!1:columns[t].cannotTriggerInsert&&e>=n?!1:getEditor(e,t)?!0:!1}function makeActiveCellNormal(){if(currentEditor){if(trigger(self.onBeforeCellEditorDestroy,{editor:currentEditor}),currentEditor.destroy(),currentEditor=null,activeCellNode){var e=getDataItem(activeRow);if($(activeCellNode).removeClass("editable invalid"),e){var t=columns[activeCell],n=getFormatter(activeRow,t);activeCellNode.innerHTML=n(activeRow,activeCell,getDataItemValueForColumn(e,t),t,e),invalidatePostProcessingResults(activeRow)}}navigator.userAgent.toLowerCase().match(/msie/)&&clearTextSelection(),getEditorLock().deactivate(editController)}}function makeActiveCellEditable(e){if(activeCellNode){if(!options.editable)throw"Grid : makeActiveCellEditable : should never get called when options.editable is false";if(clearTimeout(h_editorLoader),isCellPotentiallyEditable(activeRow,activeCell)){var t=columns[activeCell],n=getDataItem(activeRow);if(trigger(self.onBeforeEditCell,{row:activeRow,cell:activeCell,item:n,column:t})===!1)return void setFocus();getEditorLock().activate(editController),$(activeCellNode).addClass("editable"),e||(activeCellNode.innerHTML=""),currentEditor=new(e||getEditor(activeRow,activeCell))({grid:self,gridPosition:absBox($container[0]),position:absBox(activeCellNode),container:activeCellNode,column:t,item:n||{},commitChanges:commitEditAndSetFocus,cancelChanges:cancelEditAndSetFocus}),n&&currentEditor.loadValue(n),serializedEditorValue=currentEditor.serializeValue(),currentEditor.position&&handleActiveCellPositionChange()}}}function commitEditAndSetFocus(){getEditorLock().commitCurrentEdit()&&(setFocus(),options.autoEdit&&navigateDown())}function cancelEditAndSetFocus(){getEditorLock().cancelCurrentEdit()&&setFocus()}function absBox(e){var t={top:e.offsetTop,left:e.offsetLeft,bottom:0,right:0,width:$(e).outerWidth(),height:$(e).outerHeight(),visible:!0};t.bottom=t.top+t.height,t.right=t.left+t.width;for(var n=e.offsetParent;(e=e.parentNode)!=document.body;)t.visible&&e.scrollHeight!=e.offsetHeight&&"visible"!=$(e).css("overflowY")&&(t.visible=t.bottom>e.scrollTop&&t.top<e.scrollTop+e.clientHeight),t.visible&&e.scrollWidth!=e.offsetWidth&&"visible"!=$(e).css("overflowX")&&(t.visible=t.right>e.scrollLeft&&t.left<e.scrollLeft+e.clientWidth),t.left-=e.scrollLeft,t.top-=e.scrollTop,e===n&&(t.left+=e.offsetLeft,t.top+=e.offsetTop,n=e.offsetParent),t.bottom=t.top+t.height,t.right=t.left+t.width;return t}function getActiveCellPosition(){return absBox(activeCellNode)}function getGridPosition(){return absBox($container[0])}function handleActiveCellPositionChange(){if(activeCellNode&&(trigger(self.onActiveCellPositionChanged,{}),currentEditor)){var e=getActiveCellPosition();currentEditor.show&&currentEditor.hide&&(e.visible?currentEditor.show():currentEditor.hide()),currentEditor.position&&currentEditor.position(e)}}function getCellEditor(){return currentEditor}function getActiveCell(){return activeCellNode?{row:activeRow,cell:activeCell}:null}function getActiveCellNode(){return activeCellNode}function scrollRowIntoView(e,t){var n=e*options.rowHeight,i=(e+1)*options.rowHeight-viewportH+(viewportHasHScroll?scrollbarDimensions.height:0);(e+1)*options.rowHeight>scrollTop+viewportH+offset?(scrollTo(t?n:i),render()):e*options.rowHeight<scrollTop+offset&&(scrollTo(t?i:n),render())}function scrollRowToTop(e){scrollTo(e*options.rowHeight),render()}function scrollPage(e){var t=e*numVisibleRows;if(scrollTo((getRowFromPosition(scrollTop)+t)*options.rowHeight),render(),options.enableCellNavigation&&null!=activeRow){var n=activeRow+t,i=getDataLengthIncludingAddNew();n>=i&&(n=i-1),0>n&&(n=0);for(var r=0,o=null,a=activePosX;activePosX>=r;)canCellBeActive(n,r)&&(o=r),r+=getColspan(n,r);null!==o?(setActiveCellInternal(getCellNode(n,o)),activePosX=a):resetActiveCell()}}function navigatePageDown(){scrollPage(1)}function navigatePageUp(){scrollPage(-1)}function getColspan(e,t){var n=data.getItemMetadata&&data.getItemMetadata(e);if(!n||!n.columns)return 1;var i=n.columns[columns[t].id]||n.columns[t],r=i&&i.colspan;return r="*"===r?columns.length-t:r||1}function findFirstFocusableCell(e){for(var t=0;t<columns.length;){if(canCellBeActive(e,t))return t;t+=getColspan(e,t)}return null}function findLastFocusableCell(e){for(var t=0,n=null;t<columns.length;)canCellBeActive(e,t)&&(n=t),t+=getColspan(e,t);return n}function gotoRight(e,t,n){if(t>=columns.length)return null;do t+=getColspan(e,t);while(t<columns.length&&!canCellBeActive(e,t));return t<columns.length?{row:e,cell:t,posX:t}:null}function gotoLeft(e,t,n){if(0>=t)return null;var i=findFirstFocusableCell(e);if(null===i||i>=t)return null;for(var r,o={row:e,cell:i,posX:i};;){if(r=gotoRight(o.row,o.cell,o.posX),!r)return null;if(r.cell>=t)return o;o=r}}function gotoDown(e,t,n){for(var i,r=getDataLengthIncludingAddNew();;){if(++e>=r)return null;for(i=t=0;n>=t;)i=t,t+=getColspan(e,t);if(canCellBeActive(e,i))return{row:e,cell:i,posX:n}}}function gotoUp(e,t,n){for(var i;;){if(--e<0)return null;for(i=t=0;n>=t;)i=t,t+=getColspan(e,t);if(canCellBeActive(e,i))return{row:e,cell:i,posX:n}}}function gotoNext(e,t,n){if(null==e&&null==t&&(e=t=n=0,canCellBeActive(e,t)))return{row:e,cell:t,posX:t};var i=gotoRight(e,t,n);if(i)return i;for(var r=null,o=getDataLengthIncludingAddNew();++e<o;)if(r=findFirstFocusableCell(e),null!==r)return{row:e,cell:r,posX:r};return null}function gotoPrev(e,t,n){if(null==e&&null==t&&(e=getDataLengthIncludingAddNew()-1,t=n=columns.length-1,canCellBeActive(e,t)))return{row:e,cell:t,posX:t};for(var i,r;!i&&!(i=gotoLeft(e,t,n));){if(--e<0)return null;t=0,r=findLastFocusableCell(e),null!==r&&(i={row:e,cell:r,posX:r})}return i}function navigateRight(){return navigate("right")}function navigateLeft(){return navigate("left")}function navigateDown(){return navigate("down")}function navigateUp(){return navigate("up")}function navigateNext(){return navigate("next")}function navigatePrev(){return navigate("prev")}function navigate(e){if(!options.enableCellNavigation)return!1;if(!activeCellNode&&"prev"!=e&&"next"!=e)return!1;if(!getEditorLock().commitCurrentEdit())return!0;setFocus();var t={up:-1,down:1,left:-1,right:1,prev:-1,next:1};tabbingDirection=t[e];var n={up:gotoUp,down:gotoDown,left:gotoLeft,right:gotoRight,prev:gotoPrev,next:gotoNext},i=n[e],r=i(activeRow,activeCell,activePosX);if(r){var o=r.row==getDataLength();return scrollCellIntoView(r.row,r.cell,!o),setActiveCellInternal(getCellNode(r.row,r.cell)),activePosX=r.posX,!0}return setActiveCellInternal(getCellNode(activeRow,activeCell)),!1}function getCellNode(e,t){return rowsCache[e]?(ensureCellNodesInRowsCache(e),rowsCache[e].cellNodesByColumnIdx[t]):null}function setActiveCell(e,t){initialized&&(e>getDataLength()||0>e||t>=columns.length||0>t||options.enableCellNavigation&&(scrollCellIntoView(e,t,!1),setActiveCellInternal(getCellNode(e,t),!1)))}function canCellBeActive(e,t){if(!options.enableCellNavigation||e>=getDataLengthIncludingAddNew()||0>e||t>=columns.length||0>t)return!1;var n=data.getItemMetadata&&data.getItemMetadata(e);if(n&&"boolean"==typeof n.focusable)return n.focusable;var i=n&&n.columns;return i&&i[columns[t].id]&&"boolean"==typeof i[columns[t].id].focusable?i[columns[t].id].focusable:i&&i[t]&&"boolean"==typeof i[t].focusable?i[t].focusable:columns[t].focusable}function canCellBeSelected(e,t){if(e>=getDataLength()||0>e||t>=columns.length||0>t)return!1;var n=data.getItemMetadata&&data.getItemMetadata(e);if(n&&"boolean"==typeof n.selectable)return n.selectable;var i=n&&n.columns&&(n.columns[columns[t].id]||n.columns[t]);return i&&"boolean"==typeof i.selectable?i.selectable:columns[t].selectable}function gotoCell(e,t,n){if(initialized&&canCellBeActive(e,t)&&getEditorLock().commitCurrentEdit()){scrollCellIntoView(e,t,!1);var i=getCellNode(e,t);setActiveCellInternal(i,n||e===getDataLength()||options.autoEdit),currentEditor||setFocus()}}function commitCurrentEdit(){var e=getDataItem(activeRow),t=columns[activeCell];if(currentEditor){if(currentEditor.isValueChanged()){var n=currentEditor.validate();if(n.valid){if(activeRow<getDataLength()){var i={row:activeRow,cell:activeCell,editor:currentEditor,serializedValue:currentEditor.serializeValue(),prevSerializedValue:serializedEditorValue,execute:function(){this.editor.applyValue(e,this.serializedValue),updateRow(this.row),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:e})},undo:function(){this.editor.applyValue(e,this.prevSerializedValue),updateRow(this.row),trigger(self.onCellChange,{row:activeRow,cell:activeCell,item:e})}};options.editCommandHandler?(makeActiveCellNormal(),options.editCommandHandler(e,t,i)):(i.execute(),makeActiveCellNormal())}else{var r={};currentEditor.applyValue(r,currentEditor.serializeValue()),makeActiveCellNormal(),trigger(self.onAddNewRow,{item:r,column:t})}return!getEditorLock().isActive()}return $(activeCellNode).removeClass("invalid"),$(activeCellNode).width(),$(activeCellNode).addClass("invalid"),trigger(self.onValidationError,{editor:currentEditor,cellNode:activeCellNode,validationResults:n,row:activeRow,cell:activeCell,column:t}),currentEditor.focus(),!1}makeActiveCellNormal()}return!0}function cancelCurrentEdit(){return makeActiveCellNormal(),!0}function rowsToRanges(e){for(var t=[],n=columns.length-1,i=0;i<e.length;i++)t.push(new Slick.Range(e[i],0,e[i],n));return t}function getSelectedRows(){if(!selectionModel)throw"Selection model is not set";return selectedRows}function setSelectedRows(e){if(!selectionModel)throw"Selection model is not set";selectionModel.setSelectedRanges(rowsToRanges(e))}var defaults={explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,enableCellNavigation:!0,enableColumnReorder:!0,asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,autoHeight:!1,editorLock:Slick.GlobalEditorLock,showHeaderRow:!1,headerRowHeight:25,showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",selectedCellCssClass:"selected",multiSelect:!0,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,fullWidthRows:!1,multiColumnSort:!1,defaultFormatter:defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",sortIndicatorAsc:"",sortIndicatorDesc:""},columnDefaults={name:"",resizable:!0,sortable:!1,minWidth:30,rerenderOnResize:!1,headerCssClass:null,defaultSortAsc:!0,focusable:!0,selectable:!0},th,h,ph,n,cj,page=0,offset=0,vScrollDir=1,initialized=!1,$container,uid="slickgrid_"+Math.round(1e6*Math.random()),self=this,$focusSink,$focusSink2,$headerScroller,$headers,$headerRow,$headerRowScroller,$headerRowSpacer,$topPanelScroller,$topPanel,$viewport,$canvas,$style,$boundAncestors,stylesheet,columnCssRulesL,columnCssRulesR,viewportH,viewportW,canvasWidth,viewportHasHScroll,viewportHasVScroll,headerColumnWidthDiff=0,headerColumnHeightDiff=0,cellWidthDiff=0,cellHeightDiff=0,absoluteColumnMinWidth,tabbingDirection=1,activePosX,activeRow,activeCell,activeCellNode=null,currentEditor=null,serializedEditorValue,editController,rowsCache={},renderedRows=0,numVisibleRows,prevScrollTop=0,scrollTop=0,lastRenderedScrollTop=0,lastRenderedScrollLeft=0,prevScrollLeft=0,scrollLeft=0,selectionModel,selectedRows=[],plugins=[],cellCssClasses={},columnsById={},sortColumns=[],columnPosLeft=[],columnPosRight=[],h_editorLoader=null,h_render=null,h_postrender=null,postProcessedRows={},postProcessToRow=null,postProcessFromRow=null,counter_rows_rendered=0,counter_rows_removed=0,rowNodeFromLastMouseWheelEvent,zombieRowNodeFromLastMouseWheelEvent;this.debug=function(){var e="";e+="\ncounter_rows_rendered:  "+counter_rows_rendered,e+="\ncounter_rows_removed:  "+counter_rows_removed,e+="\nrenderedRows:  "+renderedRows,e+="\nnumVisibleRows:  "+numVisibleRows,e+="\nmaxSupportedCssHeight:  "+maxSupportedCssHeight,e+="\nn(umber of pages):  "+n,e+="\n(current) page:  "+page,e+="\npage height (ph):  "+ph,e+="\nvScrollDir:  "+vScrollDir,alert(e)},this.eval=function(expr){return eval(expr)},$.extend(this,{slickGridVersion:"2.1",onScroll:new Slick.Event,onSort:new Slick.Event,onHeaderMouseEnter:new Slick.Event,onHeaderMouseLeave:new Slick.Event,onHeaderContextMenu:new Slick.Event,onHeaderClick:new Slick.Event,onHeaderCellRendered:new Slick.Event,onBeforeHeaderCellDestroy:new Slick.Event,onHeaderRowCellRendered:new Slick.Event,onBeforeHeaderRowCellDestroy:new Slick.Event,onMouseEnter:new Slick.Event,onMouseLeave:new Slick.Event,onClick:new Slick.Event,onDblClick:new Slick.Event,onContextMenu:new Slick.Event,onKeyDown:new Slick.Event,onAddNewRow:new Slick.Event,onValidationError:new Slick.Event,onViewportChanged:new Slick.Event,onColumnsReordered:new Slick.Event,onColumnsResized:new Slick.Event,onCellChange:new Slick.Event,onBeforeEditCell:new Slick.Event,onBeforeCellEditorDestroy:new Slick.Event,onBeforeDestroy:new Slick.Event,onActiveCellChanged:new Slick.Event,onActiveCellPositionChanged:new Slick.Event,onDragInit:new Slick.Event,onDragStart:new Slick.Event,onDrag:new Slick.Event,onDragEnd:new Slick.Event,onSelectedRowsChanged:new Slick.Event,onCellCssStylesChanged:new Slick.Event,registerPlugin:registerPlugin,unregisterPlugin:unregisterPlugin,getColumns:getColumns,setColumns:setColumns,getColumnIndex:getColumnIndex,updateColumnHeader:updateColumnHeader,setSortColumn:setSortColumn,setSortColumns:setSortColumns,getSortColumns:getSortColumns,autosizeColumns:autosizeColumns,getOptions:getOptions,setOptions:setOptions,getData:getData,getDataLength:getDataLength,getDataItem:getDataItem,setData:setData,getSelectionModel:getSelectionModel,setSelectionModel:setSelectionModel,getSelectedRows:getSelectedRows,setSelectedRows:setSelectedRows,getContainerNode:getContainerNode,render:render,invalidate:invalidate,invalidateRow:invalidateRow,invalidateRows:invalidateRows,invalidateAllRows:invalidateAllRows,updateCell:updateCell,updateRow:updateRow,getViewport:getVisibleRange,getRenderedRange:getRenderedRange,resizeCanvas:resizeCanvas,updateRowCount:updateRowCount,scrollRowIntoView:scrollRowIntoView,scrollRowToTop:scrollRowToTop,scrollCellIntoView:scrollCellIntoView,getCanvasNode:getCanvasNode,focus:setFocus,getCellFromPoint:getCellFromPoint,getCellFromEvent:getCellFromEvent,getActiveCell:getActiveCell,setActiveCell:setActiveCell,getActiveCellNode:getActiveCellNode,getActiveCellPosition:getActiveCellPosition,resetActiveCell:resetActiveCell,editActiveCell:makeActiveCellEditable,getCellEditor:getCellEditor,getCellNode:getCellNode,getCellNodeBox:getCellNodeBox,canCellBeSelected:canCellBeSelected,canCellBeActive:canCellBeActive,navigatePrev:navigatePrev,navigateNext:navigateNext,navigateUp:navigateUp,navigateDown:navigateDown,navigateLeft:navigateLeft,navigateRight:navigateRight,navigatePageUp:navigatePageUp,navigatePageDown:navigatePageDown,gotoCell:gotoCell,getTopPanel:getTopPanel,setTopPanelVisibility:setTopPanelVisibility,setHeaderRowVisibility:setHeaderRowVisibility,getHeaderRow:getHeaderRow,getHeaderRowColumn:getHeaderRowColumn,getGridPosition:getGridPosition,flashCell:flashCell,addCellCssStyles:addCellCssStyles,setCellCssStyles:setCellCssStyles,removeCellCssStyles:removeCellCssStyles,getCellCssStyles:getCellCssStyles,init:finishInitialization,destroy:destroy,getEditorLock:getEditorLock,getEditController:getEditController}),init()}$.extend(!0,window,{Slick:{Grid:SlickGrid}});var scrollbarDimensions,maxSupportedCssHeight}(jQuery)},function(e,t){!function(e){function t(t){function n(){_e=!0}function i(){_e=!1,ie()}function r(e){xe=e}function o(e){le=e}function a(e){e=e||0;for(var t,n=e,i=fe.length;i>n;n++){if(t=fe[n][pe],void 0===t)throw"Each data element must implement a unique 'id' property";ge[t]=n}}function s(){for(var e,t=0,n=fe.length;n>t;t++)if(e=fe[t][pe],void 0===e||ge[e]!==t)throw"Each data element must implement a unique 'id' property"}function l(){return fe}function c(e,t){void 0!==t&&(pe=t),fe=ke=e,ge={},a(),s(),ie()}function u(e){void 0!=e.pageSize&&(Ae=e.pageSize,Re=Ae?Math.min(Re,Math.max(0,Math.ceil(Ie/Ae)-1)):0),void 0!=e.pageNum&&(Re=Math.min(e.pageNum,Math.max(0,Math.ceil(Ie/Ae)-1))),Ne.notify(d(),null,de),ie()}function d(){var e=Ae?Math.max(1,Math.ceil(Ie/Ae)):1;return{pageSize:Ae,pageNum:Re,totalRows:Ie,totalPages:e}}function h(e,t){we=t,se=e,ae=null,t===!1&&fe.reverse(),fe.sort(e),t===!1&&fe.reverse(),ge={},a(),ie()}function p(e,t){we=t,ae=e,se=null;var n=Object.prototype.toString;Object.prototype.toString="function"==typeof e?e:function(){return this[e]},t===!1&&fe.reverse(),fe.sort(),Object.prototype.toString=n,t===!1&&fe.reverse(),ge={},a(),ie()}function f(){se?h(se,we):ae&&p(ae,we)}function m(e){ye=e,t.inlineFilters&&(ce=K(),ue=J()),ie()}function g(){return De}function v(n){t.groupItemMetadataProvider||(t.groupItemMetadataProvider=new Slick.Data.GroupItemMetadataProvider),Me=[],$e=[],n=n||[],De=n instanceof Array?n:[n];for(var i=0;i<De.length;i++){var r=De[i]=e.extend(!0,{},Te,De[i]);r.getterIsAFn="function"==typeof r.getter,r.compiledAccumulators=[];for(var o=r.aggregators.length;o--;)r.compiledAccumulators[o]=X(r.aggregators[o]);$e[i]={}}ie()}function y(e,t,n){return null==e?void v([]):void v({getter:e,formatter:t,comparer:n})}function b(e,t){if(!De.length)throw new Error("At least one grouping must be specified before calling setAggregators().");De[0].aggregators=e,De[0].aggregateCollapsed=t,v(De)}function _(e){return fe[e]}function w(e){return ge[e]}function x(){if(!ve){ve={};for(var e=0,t=me.length;t>e;e++)ve[me[e][pe]]=e}}function C(e){return x(),ve[e]}function k(e){return fe[ge[e]]}function S(e){var t=[];x();for(var n=0,i=e.length;i>n;n++){var r=ve[e[n]];null!=r&&(t[t.length]=r)}return t}function T(e){for(var t=[],n=0,i=e.length;i>n;n++)e[n]<me.length&&(t[t.length]=me[e[n]][pe]);return t}function D(e,t){if(void 0===ge[e]||e!==t[pe])throw"Invalid or non-matching id";fe[ge[e]]=t,be||(be={}),be[e]=!0,ie()}function M(e,t){fe.splice(e,0,t),a(e),ie()}function $(e){fe.push(e),a(fe.length-1),ie()}function L(e){var t=ge[e];if(void 0===t)throw"Invalid id";delete ge[e],fe.splice(t,1),a(t),ie()}function A(){return me.length}function R(e){var t=me[e];if(t&&t.__group&&t.totals&&!t.totals.initialized){var n=De[t.level];n.displayTotalsRow||(z(t.totals),t.title=n.formatter?n.formatter(t):t.value)}else t&&t.__groupTotals&&!t.initialized&&z(t);return t}function I(e){var n=me[e];return void 0===n?null:n.__group?t.groupItemMetadataProvider.getGroupRowMetadata(n):n.__groupDummy?t.groupItemMetadataProvider.getDummyRowMetadata(n):n.__groupTotals?t.groupItemMetadataProvider.getTotalsRowMetadata(n):n.__meta?n.__meta:null}function j(e,t){if(null==e)for(var n=0;n<De.length;n++)$e[n]={},De[n].collapsed=t;else $e[e]={},De[e].collapsed=t;ie()}function E(e){j(e,!0)}function N(e){j(e,!1)}function P(e,t,n){$e[e][t]=De[e].collapsed^n,ie()}function O(e){var t=Array.prototype.slice.call(arguments),n=t[0];1==t.length&&-1!=n.indexOf(Le)?P(n.split(Le).length-1,n,!0):P(t.length-1,t.join(Le),!0)}function V(e){var t=Array.prototype.slice.call(arguments),n=t[0];1==t.length&&-1!=n.indexOf(Le)?P(n.split(Le).length-1,n,!1):P(t.length-1,t.join(Le),!1)}function F(){return Me}function H(e,t){for(var n,i,r,o=[],a={},s=t?t.level+1:0,l=De[s],c=0,u=l.predefinedValues.length;u>c;c++)i=l.predefinedValues[c],n=a[i],n||(n=new Slick.Group,n.value=i,n.level=s,n.groupingKey=(t?t.groupingKey+Le:"")+i,o[o.length]=n,a[i]=n);for(var c=0,u=e.length;u>c;c++)r=e[c],i=l.getterIsAFn?l.getter(r):r[l.getter],n=a[i],n||(n=new Slick.Group,n.value=i,n.level=s,n.groupingKey=(t?t.groupingKey+Le:"")+i,o[o.length]=n,a[i]=n),n.rows[n.count++]=r;if(s<De.length-1)for(var c=0;c<o.length;c++)n=o[c],n.groups=H(n.rows,n);return o.sort(De[s].comparer),o}function z(e){var t,n=e.group,i=De[n.level],r=n.level==De.length,o=i.aggregators.length;if(!r&&i.aggregateChildGroups)for(var a=n.groups.length;a--;)n.groups[a].initialized||z(n.groups[a]);for(;o--;)t=i.aggregators[o],t.init(),!r&&i.aggregateChildGroups?i.compiledAccumulators[o].call(t,n.groups):i.compiledAccumulators[o].call(t,n.rows),t.storeResult(e);e.initialized=!0}function B(e){var t=De[e.level],n=new Slick.GroupTotals;n.group=e,e.totals=n,t.lazyTotalsCalculation||z(n)}function W(e,t){t=t||0;for(var n,i=De[t],r=i.collapsed,o=$e[t],a=e.length;a--;)n=e[a],(!n.collapsed||i.aggregateCollapsed)&&(n.groups&&W(n.groups,t+1),i.aggregators.length&&(i.aggregateEmpty||n.rows.length||n.groups&&n.groups.length)&&B(n),n.collapsed=r^o[n.groupingKey],n.title=i.formatter?i.formatter(n):n.value)}function U(t){var n,i,r=De[t.level];t.dummy=[];for(var o=0,a=r.dummyRows.length;a>o;o++)n=new Slick.GroupDummy,i=r.dummyRows[o],"function"==typeof i&&(i=i(t)),e.extend(n,i),n.group=t,t.dummy.push(n)}function q(e,t){t=t||0;for(var n,i=De[t],r=i.collapsed,o=$e[t],a=e.length;a--;)n=e[a],n.collapsed||(n.groups&&q(n.groups,t+1),i.dummyRows.length&&(n.rows.length||n.groups&&n.groups.length)&&U(n),n.collapsed=r^o[n.groupingKey],n.title=i.formatter?i.formatter(n):n.value)}function G(e,t){t=t||0;for(var n,i,r=De[t],o=[],a=0,s=0,l=e.length;l>s;s++){if(i=e[s],o[a++]=i,!i.collapsed){if(i.dummy)for(var c=0;c<i.dummy.length;c++)o[a++]=i.dummy[c];n=i.groups?G(i.groups,t+1):i.rows;for(var u=0,d=n.length;d>u;u++)n[u].onlyForGroup||(o[a++]=n[u])}i.totals&&r.displayTotalsRow&&(!i.collapsed||r.aggregateCollapsed)&&(o[a++]=i.totals)}return o}function Y(e){var t=/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/,n=e.toString().match(t);return{params:n[1].split(","),body:n[2]}}function X(e){var t=Y(e.accumulate),n=new Function("_items","for (var "+t.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+t.params[0]+" = _items[_i]; "+t.body+"}");return n.displayName=n.name="compiledAccumulatorLoop",n}function K(){var e=Y(ye),t=e.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,t),n=n.replace(/\$item\$/gi,e.params[0]),n=n.replace(/\$args\$/gi,e.params[1]);var i=new Function("_items,_args",n);return i.displayName=i.name="compiledFilter",i}function J(){var e=Y(ye),t=e.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,t),n=n.replace(/\$item\$/gi,e.params[0]),n=n.replace(/\$args\$/gi,e.params[1]);var i=new Function("_items,_args,_cache",n);return i.displayName=i.name="compiledFilterWithCaching",i}function Z(e,t){for(var n=[],i=0,r=0,o=e.length;o>r;r++)ye(e[r],t)&&(n[i++]=e[r]);return n}function Q(e,t,n){for(var i,r=[],o=0,a=0,s=e.length;s>a;a++)i=e[a],n[a]?r[o++]=i:ye(i,t)&&(r[o++]=i,n[a]=!0);return r}function ee(e){if(ye){var n=t.inlineFilters?ce:Z,i=t.inlineFilters?ue:Q;xe.isFilterNarrowing?ke=n(ke,le):xe.isFilterExpanding?ke=i(e,le,Se):xe.isFilterUnchanged||(ke=n(e,le))}else ke=Ae?e:e.concat();var r;return Ae?(ke.length<Re*Ae&&(Re=Math.floor(ke.length/Ae)),r=ke.slice(Ae*Re,Ae*Re+Ae)):r=ke,{totalRows:ke.length,rows:r}}function te(e,t){var n,i,r,o=[],a=0,s=t.length;xe&&xe.ignoreDiffsBefore&&(a=Math.max(0,Math.min(t.length,xe.ignoreDiffsBefore))),xe&&xe.ignoreDiffsAfter&&(s=Math.min(t.length,Math.max(0,xe.ignoreDiffsAfter)));for(var l=a,c=e.length;s>l;l++)l>=c?o[o.length]=l:(n=t[l],i=e[l],(De.length&&(r=n.__nonDataRow||i.__nonDataRow)&&n.__group!==i.__group||n.__group&&!n.equals(i)||r&&(n.__groupTotals||i.__groupTotals)||n[pe]!=i[pe]||be&&be[n[pe]])&&(o[o.length]=l));return o}function ne(e){ve=null,(xe.isFilterNarrowing!=Ce.isFilterNarrowing||xe.isFilterExpanding!=Ce.isFilterExpanding)&&(Se=[]);var t=ee(e);Ie=t.totalRows;var n=t.rows;Me=[],De.length&&(Me=H(n),Me.length&&(W(Me),q(Me),n=G(Me)));var i=te(me,n);return me=n,i}function ie(){if(!_e){var e=me.length,t=Ie,n=ne(fe,ye);Ae&&Re*Ae>Ie&&(Re=Math.max(0,Math.ceil(Ie/Ae)-1),n=ne(fe,ye)),be=null,Ce=xe,xe={},t!=Ie&&Ne.notify(d(),null,de),e!=me.length&&je.notify({previous:e,current:me.length},null,de),n.length>0&&Ee.notify({rows:n},null,de)}}function re(t,n,i){function r(e){l.join(",")!=e.join(",")&&(l=e,c.notify({grid:t,ids:l},new Slick.EventData,s))}function o(){if(l.length>0){a=!0;var e=s.mapIdsToRows(l);n||r(s.mapRowsToIds(e)),t.setSelectedRows(e),a=!1}}var a,s=this,l=s.mapRowsToIds(t.getSelectedRows()),c=new Slick.Event;return t.onSelectedRowsChanged.subscribe(function(n,o){if(!a){var c=s.mapRowsToIds(t.getSelectedRows());if(i&&t.getOptions().multiSelect){var u=e.grep(l,function(e){return void 0===s.getRowById(e)});r(u.concat(c))}else r(c)}}),this.onRowsChanged.subscribe(o),this.onRowCountChanged.subscribe(o),c}function oe(e,t){function n(e){r={};for(var t in e){var n=me[t][pe];r[n]=e[t]}}function i(){if(r){o=!0,x();var n={};for(var i in r){var a=ve[i];void 0!=a&&(n[a]=r[i])}e.setCellCssStyles(t,n),o=!1}}var r,o;n(e.getCellCssStyles(t)),e.onCellCssStylesChanged.subscribe(function(e,i){o||t==i.key&&i.hash&&n(i.hash)}),this.onRowsChanged.subscribe(i),this.onRowCountChanged.subscribe(i)}var ae,se,le,ce,ue,de=this,he={groupItemMetadataProvider:null,inlineFilters:!1},pe="id",fe=[],me=[],ge={},ve=null,ye=null,be=null,_e=!1,we=!0,xe={},Ce={},ke=[],Se=[],Te={getter:null,formatter:null,comparer:function(e,t){return e.value-t.value},predefinedValues:[],aggregators:[],dummyRows:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},De=[],Me=[],$e=[],Le=":|:",Ae=0,Re=0,Ie=0,je=new Slick.Event,Ee=new Slick.Event,Ne=new Slick.Event;t=e.extend(!0,{},he,t),e.extend(this,{beginUpdate:n,endUpdate:i,setPagingOptions:u,getPagingInfo:d,getItems:l,setItems:c,setFilter:m,sort:h,fastSort:p,reSort:f,setGrouping:v,getGrouping:g,groupBy:y,setAggregators:b,collapseAllGroups:E,expandAllGroups:N,collapseGroup:O,expandGroup:V,getGroups:F,getIdxById:w,getRowById:C,getItemById:k,getItemByIdx:_,mapRowsToIds:T,mapIdsToRows:S,setRefreshHints:r,setFilterArgs:o,refresh:ie,updateItem:D,insertItem:M,addItem:$,deleteItem:L,syncGridSelection:re,syncGridCellCssStyles:oe,getFilteredAndPagedItems:ee,getLength:A,getItem:R,getItemMetadata:I,onRowCountChanged:je,onRowsChanged:Ee,onPagingInfoChanged:Ne})}function n(e){this.field_=e,this.init=function(){this.count_=0,this.nonNullCount_=0,this.sum_=0},this.accumulate=function(e){var t=e[this.field_];this.count_++,null!=t&&""!==t&&NaN!==t&&(this.nonNullCount_++,this.sum_+=parseFloat(t))},this.storeResult=function(e){e.avg||(e.avg={}),0!=this.nonNullCount_&&(e.avg[this.field_]=this.sum_/this.nonNullCount_)}}function i(e){this.field_=e,this.init=function(){this.min_=null},this.accumulate=function(e){var t=e[this.field_];null!=t&&""!==t&&NaN!==t&&(null==this.min_||t<this.min_)&&(this.min_=t)},this.storeResult=function(e){e.min||(e.min={}),e.min[this.field_]=this.min_}}function r(e){this.field_=e,this.init=function(){this.max_=null},this.accumulate=function(e){var t=e[this.field_];null!=t&&""!==t&&NaN!==t&&(null==this.max_||t>this.max_)&&(this.max_=t)},this.storeResult=function(e){e.max||(e.max={}),e.max[this.field_]=this.max_}}function o(e){this.field_=e,this.init=function(){this.sum_=null},this.accumulate=function(e){var t=e[this.field_];null!=t&&""!==t&&NaN!==t&&(this.sum_+=parseFloat(t))},this.storeResult=function(e){e.sum||(e.sum={}),e.sum[this.field_]=this.sum_}}e.extend(!0,window,{Slick:{Data:{DataView:t,Aggregators:{Avg:n,Min:i,Max:r,Sum:o}}}})}(jQuery)},function(e,t){!function(e){function t(t){function n(e,n,i,r,o){if(!t.enableExpandCollapse)return o.title;var a=15*o.level+"px";return"<span class='"+t.toggleCssClass+" "+(o.collapsed?t.toggleCollapsedCssClass:t.toggleExpandedCssClass)+"' style='margin-left:"+a+"'></span><span class='"+t.groupTitleCssClass+"' level='"+o.level+"'>"+o.title+"</span>"}function i(e,t,n,i,r){return i.groupTotalsFormatter&&i.groupTotalsFormatter(r,i)||""}function r(e){u=e,u.onClick.subscribe(a),u.onKeyDown.subscribe(s)}function o(){u&&(u.onClick.unsubscribe(a),u.onKeyDown.unsubscribe(s))}function a(n,i){var r=this.getDataItem(i.row);if(r&&r instanceof Slick.Group&&e(n.target).hasClass(t.toggleCssClass)){var o=u.getRenderedRange();this.getData().setRefreshHints({ignoreDiffsBefore:o.top,ignoreDiffsAfter:o.bottom+1}),r.collapsed?this.getData().expandGroup(r.groupingKey):this.getData().collapseGroup(r.groupingKey),n.stopImmediatePropagation(),n.preventDefault()}}function s(n,i){if(t.enableExpandCollapse&&n.which==e.ui.keyCode.SPACE){var r=this.getActiveCell();if(r){var o=this.getDataItem(r.row);if(o&&o instanceof Slick.Group){var a=u.getRenderedRange();this.getData().setRefreshHints({ignoreDiffsBefore:a.top,ignoreDiffsAfter:a.bottom}),o.collapsed?this.getData().expandGroup(o.groupingKey):this.getData().collapseGroup(o.groupingKey),n.stopImmediatePropagation(),n.preventDefault()}}}}function l(e){return{selectable:!1,focusable:t.groupFocusable,cssClasses:t.groupCssClass,columns:{0:{colspan:"*",formatter:t.groupFormatter,editor:null}}}}function c(e){return{selectable:!1,focusable:t.totalsFocusable,cssClasses:t.totalsCssClass,formatter:t.totalsFormatter,editor:null}}var u,d={groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:n,totalsFormatter:i};return t=e.extend(!0,{},d,t),{init:r,destroy:o,getGroupRowMetadata:l,getTotalsRowMetadata:c}}e.extend(!0,window,{Slick:{Data:{GroupItemMetadataProvider:t}}})}(jQuery)},function(e,t,n){var i,r;(function(){function n(e){this._value=e}function o(e,t,n,i){var r,o,a=Math.pow(10,t);return o=(n(e*a)/a).toFixed(t),
i&&(r=new RegExp("0{1,"+i+"}$"),o=o.replace(r,"")),o}function a(e,t,n){var i;return i=t.indexOf("$")>-1?l(e,t,n):t.indexOf("%")>-1?c(e,t,n):t.indexOf(":")>-1?u(e,t):h(e._value,t,n)}function s(e,t){var n,i,r,o,a,s=t,l=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=!1;if(t.indexOf(":")>-1)e._value=d(t);else if(t===_)e._value=0;else{for("."!==y[b].delimiters.decimal&&(t=t.replace(/\./g,"").replace(y[b].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+y[b].abbreviations.thousand+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+y[b].abbreviations.million+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+y[b].abbreviations.billion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+y[b].abbreviations.trillion+"(?:\\)|(\\"+y[b].currency.symbol+")?(?:\\))?)?$"),a=0;a<=l.length&&!(c=t.indexOf(l[a])>-1?Math.pow(1024,a+1):!1);a++);e._value=(c?c:1)*(s.match(n)?Math.pow(10,3):1)*(s.match(i)?Math.pow(10,6):1)*(s.match(r)?Math.pow(10,9):1)*(s.match(o)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=c?Math.ceil(e._value):e._value}return e._value}function l(e,t,n){var i,r,o=t.indexOf("$"),a=t.indexOf("("),s=t.indexOf("-"),l="";return t.indexOf(" $")>-1?(l=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(l=" ",t=t.replace("$ ","")):t=t.replace("$",""),r=h(e._value,t,n),1>=o?r.indexOf("(")>-1||r.indexOf("-")>-1?(r=r.split(""),i=1,(a>o||s>o)&&(i=0),r.splice(i,0,y[b].currency.symbol+l),r=r.join("")):r=y[b].currency.symbol+l+r:r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,l+y[b].currency.symbol),r=r.join("")):r=r+l+y[b].currency.symbol,r}function c(e,t,n){var i,r="",o=100*e._value;return t.indexOf(" %")>-1?(r=" ",t=t.replace(" %","")):t=t.replace("%",""),i=h(o,t,n),i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,r+"%"),i=i.join("")):i=i+r+"%",i}function u(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),i=Math.round(e._value-60*t*60-60*n);return t+":"+(10>n?"0"+n:n)+":"+(10>i?"0"+i:i)}function d(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function h(e,t,n){var i,r,a,s,l,c,u=!1,d=!1,h=!1,p="",f=!1,m=!1,g=!1,v=!1,w=!1,x="",C="",k=Math.abs(e),S=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T="",D=!1;if(0===e&&null!==_)return _;if(t.indexOf("(")>-1?(u=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(d=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(f=t.indexOf("aK")>=0,m=t.indexOf("aM")>=0,g=t.indexOf("aB")>=0,v=t.indexOf("aT")>=0,w=f||m||g||v,t.indexOf(" a")>-1?(p=" ",t=t.replace(" a","")):t=t.replace("a",""),k>=Math.pow(10,12)&&!w||v?(p+=y[b].abbreviations.trillion,e/=Math.pow(10,12)):k<Math.pow(10,12)&&k>=Math.pow(10,9)&&!w||g?(p+=y[b].abbreviations.billion,e/=Math.pow(10,9)):k<Math.pow(10,9)&&k>=Math.pow(10,6)&&!w||m?(p+=y[b].abbreviations.million,e/=Math.pow(10,6)):(k<Math.pow(10,6)&&k>=Math.pow(10,3)&&!w||f)&&(p+=y[b].abbreviations.thousand,e/=Math.pow(10,3))),t.indexOf("b")>-1)for(t.indexOf(" b")>-1?(x=" ",t=t.replace(" b","")):t=t.replace("b",""),a=0;a<=S.length;a++)if(i=Math.pow(1024,a),r=Math.pow(1024,a+1),e>=i&&r>e){x+=S[a],i>0&&(e/=i);break}return t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(C=" ",t=t.replace(" o","")):t=t.replace("o",""),C+=y[b].ordinal(e)),t.indexOf("[.]")>-1&&(h=!0,t=t.replace("[.]",".")),s=e.toString().split(".")[0],l=t.split(".")[1],c=t.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),T=o(e,l[0].length+l[1].length,n,l[1].length)):T=o(e,l.length,n),s=T.split(".")[0],T=T.split(".")[1].length?y[b].delimiters.decimal+T.split(".")[1]:"",h&&0===Number(T.slice(1))&&(T="")):s=o(e,null,n),s.indexOf("-")>-1&&(s=s.slice(1),D=!0),c>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+y[b].delimiters.thousands)),0===t.indexOf(".")&&(s=""),(u&&D?"(":"")+(!u&&D?"-":"")+(!D&&d?"+":"")+s+T+(C?C:"")+(p?p:"")+(x?x:"")+(u&&D?")":"")}function p(e,t){y[e]=t}function f(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function m(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var n=f(e),i=f(t);return n>i?n:i},-(1/0))}var g,v="1.5.3",y={},b="en",_=null,w="0,0",x="undefined"!=typeof e&&e.exports;g=function(e){return g.isNumeral(e)?e=e.value():0===e||"undefined"==typeof e?e=0:Number(e)||(e=g.fn.unformat(e)),new n(Number(e))},g.version=v,g.isNumeral=function(e){return e instanceof n},g.language=function(e,t){if(!e)return b;if(e&&!t){if(!y[e])throw new Error("Unknown language : "+e);b=e}return(t||!y[e])&&p(e,t),g},g.languageData=function(e){if(!e)return y[b];if(!y[e])throw new Error("Unknown language : "+e);return y[e]},g.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),g.zeroFormat=function(e){_="string"==typeof e?e:null},g.defaultFormat=function(e){w="string"==typeof e?e:"0.0"},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,i,r=this.length>>>0,o=!1;for(1<arguments.length&&(i=t,o=!0),n=0;r>n;++n)this.hasOwnProperty(n)&&(o?i=e(i,this[n],n,this):(i=this[n],o=!0));if(!o)throw new TypeError("Reduce of empty array with no initial value");return i}),g.fn=n.prototype={clone:function(){return g(this)},format:function(e,t){return a(this,e?e:w,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:s(this,e?e:w)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t,i,r){return e+n*t}var n=m.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t,i,r){return e-n*t}var n=m.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t,n,i){var r=m(e,t);return e*r*(t*r)/(r*r)}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t,n,i){var r=m(e,t);return e*r/(t*r)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(g(this._value).subtract(e).value())}},x&&(e.exports=g),"undefined"==typeof ender&&(this.numeral=g),i=[],r=function(){return g}.apply(t,i),!(void 0!==r&&(e.exports=r))}).call(this)},function(e,t,n){var i;i=function(){return function(e){return e>0?"change-up":0>e?"change-down":""}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a),l=n(47),c=i(l),u=n(467),d=i(u);n(527),t["default"]=s["default"].Behavior.extend({events:{"click .clear-filters":"clearAllFilters"},initialize:function(){var e=(arguments.length<=0||void 0===arguments[0]?{}:arguments[0],this);this.listenTo(this.view,"grid:ready",function(){e.initFilters()}),this.activeFilters={},this.view.noFilter=!0},destroy:function(){return s["default"].Behavior.prototype.destroy.call(this),o["default"].invoke(this.filters,"destroy"),this},initFilters:function(){var e=this,t=this.view.grid,n=new Slick.EventHandler;this.view.$el.find(".slick-header-columns").on("click",".filter-button:not(.disabled)",o["default"].bind(this.clickFilterButton,this)).on("click",".filter-button.disabled",function(e){e.stopPropagation()}),n.subscribe(t.onHeaderCellRendered,function(t,n){e.renderButton(n.node)}),this.view.dataView.setFilter(o["default"].bind(this.dataViewFilter,this)),this.filters={}},renderButton:function(e){var t=this,n=$('<span class="filter-button"><i class="fa fa-filter"></i></span>'),i=$('<div class="filter-list"></div>'),r=$(e).data("column"),a=this.buildFilter(r);return n.appendTo(e),o["default"].isEmpty(a)?(n.addClass("disabled"),t.initDisabledFilterBtn(n),n):(i.append(o["default"].map(a,function(e){return e.el})),n.popover({title:"",content:i,html:!0,trigger:"manual",placement:"bottom",container:"body",template:'<div class="popover dropdown-menu slick-header-filter"><h3 class="popover-title"></h3><div class="popover-content"></div><h3 class="popover-footer"><a class="reset" href="#">清除</a></h3></div>'}),n.one("show.bs.popover",function(){o["default"].invoke(a,"render")}),n.data("bs.popover").tip().on("click",function(e){e.stopPropagation()}).on("click",".reset",function(e){o["default"].invoke(a,"reset"),e.preventDefault()}),o["default"].each(a,function(e,i){t.listenTo(e,"change",function(){t.activeFilters[i]=e,t.updateFilters(),n.addClass("has-filter"),t.showResetAll()}),t.listenTo(e,"reset",function(){t.activeFilters[i]=null,n.removeClass("has-filter"),o["default"].every(o["default"].values(t.activeFilters),o["default"].isNull)&&(t.hideResetAll(),t.view.noFilter=!0,window.a=t.view),t.updateFilters()})}),n)},dataViewFilter:function(e,t){var n=this,i=[];return o["default"].isEmpty(this.filters)||o["default"].isEmpty(this.activeFilters)||!t?!0:(o["default"].each(t,function(r,a){var s=n.filters[a];o["default"].isNull(e[a])?i.push(!1):i.push(s.verify(e[a],t[a]))}),o["default"].every(i,Boolean))},updateFilters:function(){var e={};o["default"].each(this.activeFilters,function(t,n){o["default"].isNull(t)||(e[n]=t.getValue())}),o["default"].isEmpty(e)?e=null:this.view.noFilter=!1,this.view.dataView.setFilterArgs(e),this.view.dataView.refresh()},buildFilter:function(e){var t,n=this,i={};return o["default"].isString(e.filter)?(t=new d["default"][e.filter](o["default"].extend({dataView:this.view.dataView,field:e.field},e.filterOptions)),t.shouldBeDisbaled()||(this.filters[e.field]=t,i[e.field]=this.filters[e.field])):o["default"].each(e.filter,function(r,a){t=new d["default"][r](o["default"].extend({dataView:n.view.dataView,field:a},e.filterOptions&&e.filterOptions[a])),t.shouldBeDisbaled()||(n.filters[a]=t,i[a]=n.filters[a])}),i},initDisabledFilterBtn:function(e){e.attr("title","此列不需要筛选").tooltip({trigger:"hover",container:"body"})},clickFilterButton:function(e){e.stopPropagation();var t=$(e.currentTarget),n=t.offset();n.top+=t.height(),t.one("hide.bs.popover",function(){t.removeClass("active"),c["default"].body.off("click.slickFilter")}),t.hasClass("active")?t.popover("hide"):(this.view.$el.find(".filter-button.active").popover("hide"),t.addClass("active"),t.popover("show"),this.posPopover(t,t.data("bs.popover").tip())),c["default"].body.on("click.slickFilter",function(e){var n=$(e.target);n.parents(".popover,.ui-datepicker").length||n.is(".ui-datepicker-prev, .ui-datepicker-next")||(t.popover("hide"),c["default"].body.off("click.slickFilter"))})},posPopover:function(e,t){var n=e.offset(),i=e.width(),r=t.width(),o=$(window).width(),a=50;n.top+=e.height(),n.left+r>o-a&&(n.left-=r-i),t.css(n)},showResetAll:function(){this.$el.find(".clear-filters").css("visibility","visible")},hideResetAll:function(){this.$el.find(".clear-filters").css("visibility","hidden")},clearAllFilters:function(){o["default"].invoke(this.filters,"reset")}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(468),o=i(r),a=n(473),s=i(a),l=n(474),c=i(l),u=n(513),d=i(u);t["default"]={select:o["default"],checkbox:s["default"],range:c["default"],dateRange:d["default"]},e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r);n(469);var a=n(472),s=i(a);t["default"]=s["default"].extend({className:"select-filter",template:!1,events:{"change select":"changeSelect"},initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];s["default"].prototype.initialize.apply(this,arguments);var t,n=this,i=this.dataView.getItems(),r={};o["default"].each(i,function(e){t=e[n.field],t&&(r[t.toString()]=t)}),this.optionMap=r,this.multiple=e.multiple,this._defaultValue=[],this._value=[]},shouldBeDisbaled:function(){var e=0;return o["default"].each(this.optionMap,function(){return e+=1,2===e?!1:!0}),1===e?!0:!1},onRender:function(){var e=(this.dataView.getItems(),[]),t=this.optionMap,n=$('<select placeholder="选择证券..."></select>');o["default"].each(t,function(t,n){e.push({text:n})}),this.optionMap=t,this.multiple&&n.attr("multiple",""),this.$el.append(n),this.select=n,n.selectize({options:e,valueField:"text"})},changeSelect:function(){var e=this;this._value=o["default"].map(this.select.val(),function(t){return e.optionMap[t]}),this.trigger("_change")},getValue:function(){return this._value||[]},verify:function(e,t){return o["default"].isEmpty(t)?!0:o["default"].include(t,e)},reset:function(){if(this.$el.find("select")[0]){var e=this.$el.find("select")[0].selectize;this.$el.find("select").val(""),e.clear(),e.refreshItems()}this._value=[],this.trigger("reset")}}),e.exports=t["default"]},function(e,t,n){var i,r,o;!function(a,s){r=[n(77),n(470),n(471)],i=s,o="function"==typeof i?i.apply(t,r):i,!(void 0!==o&&(e.exports=o))}(this,function(e,t,n){"use strict";var i=function(e,t){if("string"!=typeof t||t.length){var n="string"==typeof t?new RegExp(t,"i"):t,i=function(e){var t=0;if(3===e.nodeType){var r=e.data.search(n);if(r>=0&&e.data.length>0){var o=e.data.match(n),a=document.createElement("span");a.className="highlight";var s=e.splitText(r),l=(s.splitText(o[0].length),s.cloneNode(!0));a.appendChild(l),s.parentNode.replaceChild(a,s),t=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var c=0;c<e.childNodes.length;++c)c+=i(e.childNodes[c]);return t};return e.each(function(){i(this)})}},r=function(){};r.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[e]:(this._events=this._events||{},void(e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)))},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},r.mixin=function(e){for(var t=["on","off","trigger"],n=0;n<t.length;n++)e.prototype[t[n]]=r.prototype[t[n]]};var o=/Mac/.test(navigator.userAgent),a=65,s=13,l=27,c=37,u=38,d=80,h=39,p=40,f=78,m=8,g=46,v=16,y=o?91:17,b=o?18:17,_=9,w=1,x=2,C=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("form").validity,k=function(e){return"undefined"!=typeof e},S=function(e){return"undefined"==typeof e||null===e?null:"boolean"==typeof e?e?"1":"0":e+""},T=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},D=function(e){return(e+"").replace(/\$/g,"$$$$")},M={};M.before=function(e,t,n){var i=e[t];e[t]=function(){return n.apply(e,arguments),i.apply(e,arguments)}},M.after=function(e,t,n){var i=e[t];e[t]=function(){var t=i.apply(e,arguments);return n.apply(e,arguments),t}};var $=function(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}},L=function(e,t){var n;return function(){var i=this,r=arguments;window.clearTimeout(n),n=window.setTimeout(function(){e.apply(i,r)},t)}},A=function(e,t,n){var i,r=e.trigger,o={};e.trigger=function(){var n=arguments[0];return-1===t.indexOf(n)?r.apply(e,arguments):void(o[n]=arguments)},n.apply(e,[]),e.trigger=r;for(i in o)o.hasOwnProperty(i)&&r.apply(e,o[i])},R=function(e,t,n,i){e.on(t,n,function(t){for(var n=t.target;n&&n.parentNode!==e[0];)n=n.parentNode;return t.currentTarget=n,i.apply(this,[t])})},I=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var n=document.selection.createRange(),i=document.selection.createRange().text.length;n.moveStart("character",-e.value.length),t.start=n.text.length-i,t.length=i}return t},j=function(e,t,n){var i,r,o={};if(n)for(i=0,r=n.length;r>i;i++)o[n[i]]=e.css(n[i]);else o=e.css();t.css(o)},E=function(t,n){if(!t)return 0;var i=e("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");j(n,i,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var r=i.width();return i.remove(),r},N=function(e){var t=null,n=function(n,i){var r,o,a,s,l,c,u,d;n=n||window.event||{},i=i||{},n.metaKey||n.altKey||(i.force||e.data("grow")!==!1)&&(r=e.val(),n.type&&"keydown"===n.type.toLowerCase()&&(o=n.keyCode,a=o>=97&&122>=o||o>=65&&90>=o||o>=48&&57>=o||32===o,o===g||o===m?(d=I(e[0]),d.length?r=r.substring(0,d.start)+r.substring(d.start+d.length):o===m&&d.start?r=r.substring(0,d.start-1)+r.substring(d.start+1):o===g&&"undefined"!=typeof d.start&&(r=r.substring(0,d.start)+r.substring(d.start+1))):a&&(c=n.shiftKey,u=String.fromCharCode(n.keyCode),u=c?u.toUpperCase():u.toLowerCase(),r+=u)),s=e.attr("placeholder"),!r&&s&&(r=s),l=E(r,e)+4,l!==t&&(t=l,e.width(l),e.triggerHandler("resize")))};e.on("keydown keyup update blur",n),n()},P=function(n,i){var r,o,a,s,l=this;s=n[0],s.selectize=l;var c=window.getComputedStyle&&window.getComputedStyle(s,null);if(a=c?c.getPropertyValue("direction"):s.currentStyle&&s.currentStyle.direction,a=a||n.parents("[dir]:first").attr("dir")||"",e.extend(l,{order:0,settings:i,$input:n,tabIndex:n.attr("tabindex")||"",tagType:"select"===s.tagName.toLowerCase()?w:x,rtl:/rtl/i.test(a),eventNS:".selectize"+ ++P.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:n.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===i.loadThrottle?l.onSearchChange:L(l.onSearchChange,i.loadThrottle)}),l.sifter=new t(this.options,{diacritics:i.diacritics}),l.settings.options){for(r=0,o=l.settings.options.length;o>r;r++)l.registerOption(l.settings.options[r]);delete l.settings.options}if(l.settings.optgroups){for(r=0,o=l.settings.optgroups.length;o>r;r++)l.registerOptionGroup(l.settings.optgroups[r]);delete l.settings.optgroups}l.settings.mode=l.settings.mode||(1===l.settings.maxItems?"single":"multi"),"boolean"!=typeof l.settings.hideSelected&&(l.settings.hideSelected="multi"===l.settings.mode),l.initializePlugins(l.settings.plugins),l.setupCallbacks(),l.setupTemplates(),l.setup()};return r.mixin(P),n.mixin(P),e.extend(P.prototype,{setup:function(){var t,n,i,r,a,s,l,c,u,d=this,h=d.settings,p=d.eventNS,f=e(window),m=e(document),g=d.$input;if(l=d.settings.mode,c=g.attr("class")||"",t=e("<div>").addClass(h.wrapperClass).addClass(c).addClass(l),n=e("<div>").addClass(h.inputClass).addClass("items").appendTo(t),i=e('<input type="text" autocomplete="off" />').appendTo(n).attr("tabindex",g.is(":disabled")?"-1":d.tabIndex),s=e(h.dropdownParent||t),r=e("<div>").addClass(h.dropdownClass).addClass(l).hide().appendTo(s),a=e("<div>").addClass(h.dropdownContentClass).appendTo(r),d.settings.copyClassesToDropdown&&r.addClass(c),t.css({width:g[0].style.width}),d.plugins.names.length&&(u="plugin-"+d.plugins.names.join(" plugin-"),t.addClass(u),r.addClass(u)),(null===h.maxItems||h.maxItems>1)&&d.tagType===w&&g.attr("multiple","multiple"),d.settings.placeholder&&i.attr("placeholder",h.placeholder),!d.settings.splitOn&&d.settings.delimiter){var _=d.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");d.settings.splitOn=new RegExp("\\s*"+_+"+\\s*")}g.attr("autocorrect")&&i.attr("autocorrect",g.attr("autocorrect")),g.attr("autocapitalize")&&i.attr("autocapitalize",g.attr("autocapitalize")),d.$wrapper=t,d.$control=n,d.$control_input=i,d.$dropdown=r,d.$dropdown_content=a,r.on("mouseenter","[data-selectable]",function(){return d.onOptionHover.apply(d,arguments)}),r.on("mousedown click","[data-selectable]",function(){return d.onOptionSelect.apply(d,arguments)}),R(n,"mousedown","*:not(input)",function(){return d.onItemSelect.apply(d,arguments)}),N(i),n.on({mousedown:function(){return d.onMouseDown.apply(d,arguments)},click:function(){return d.onClick.apply(d,arguments)}}),i.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return d.onKeyDown.apply(d,arguments)},keyup:function(){return d.onKeyUp.apply(d,arguments)},keypress:function(){return d.onKeyPress.apply(d,arguments)},resize:function(){d.positionDropdown.apply(d,[])},blur:function(){return d.onBlur.apply(d,arguments)},focus:function(){return d.ignoreBlur=!1,d.onFocus.apply(d,arguments)},paste:function(){return d.onPaste.apply(d,arguments)}}),m.on("keydown"+p,function(e){d.isCmdDown=e[o?"metaKey":"ctrlKey"],d.isCtrlDown=e[o?"altKey":"ctrlKey"],d.isShiftDown=e.shiftKey}),m.on("keyup"+p,function(e){e.keyCode===b&&(d.isCtrlDown=!1),e.keyCode===v&&(d.isShiftDown=!1),e.keyCode===y&&(d.isCmdDown=!1)}),m.on("mousedown"+p,function(e){if(d.isFocused){if(e.target===d.$dropdown[0]||e.target.parentNode===d.$dropdown[0])return!1;d.$control.has(e.target).length||e.target===d.$control[0]||d.blur(e.target)}}),f.on(["scroll"+p,"resize"+p].join(" "),function(){d.isOpen&&d.positionDropdown.apply(d,arguments)}),f.on("mousemove"+p,function(){d.ignoreHover=!1}),this.revertSettings={$children:g.children().detach(),tabindex:g.attr("tabindex")},g.attr("tabindex",-1).hide().after(d.$wrapper),e.isArray(h.items)&&(d.setValue(h.items),delete h.items),C&&g.on("invalid"+p,function(e){e.preventDefault(),d.isInvalid=!0,d.refreshState()}),d.updateOriginalInput(),d.refreshItems(),d.refreshState(),d.updatePlaceholder(),d.isSetup=!0,g.is(":disabled")&&d.disable(),d.on("change",this.onChange),g.data("selectize",d),g.addClass("selectized"),d.trigger("initialize"),h.preload===!0&&d.onSearchChange("")},setupTemplates:function(){var t=this,n=t.settings.labelField,i=t.settings.optgroupLabelField,r={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[i])+"</div>"},option:function(e,t){return'<div class="option">'+t(e[n])+"</div>"},item:function(e,t){return'<div class="item">'+t(e[n])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};t.settings.render=e.extend({},r,t.settings.render)},setupCallbacks:function(){var e,t,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in n)n.hasOwnProperty(e)&&(t=this.settings[n[e]],t&&this.on(e,t))},onClick:function(e){var t=this;t.isFocused||(t.focus(),e.preventDefault())},onMouseDown:function(t){var n=this,i=t.isDefaultPrevented();e(t.target);if(n.isFocused){if(t.target!==n.$control_input[0])return"single"===n.settings.mode?n.isOpen?n.close():n.open():i||n.setActiveItem(null),!1}else i||window.setTimeout(function(){n.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(t){var n=this;n.isFull()||n.isInputHidden||n.isLocked?t.preventDefault():n.settings.splitOn&&setTimeout(function(){for(var t=e.trim(n.$control_input.val()||"").split(n.settings.splitOn),i=0,r=t.length;r>i;i++)n.createItem(t[i])},0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0},onKeyDown:function(e){var t=(e.target===this.$control_input[0],this);if(t.isLocked)return void(e.keyCode!==_&&e.preventDefault());switch(e.keyCode){case a:if(t.isCmdDown)return void t.selectAll();break;case l:return void(t.isOpen&&(e.preventDefault(),e.stopPropagation(),t.close()));case f:if(!e.ctrlKey||e.altKey)break;case p:if(!t.isOpen&&t.hasOptions)t.open();else if(t.$activeOption){t.ignoreHover=!0;var n=t.getAdjacentOption(t.$activeOption,1);n.length&&t.setActiveOption(n,!0,!0)}return void e.preventDefault();case d:if(!e.ctrlKey||e.altKey)break;case u:if(t.$activeOption){t.ignoreHover=!0;var i=t.getAdjacentOption(t.$activeOption,-1);i.length&&t.setActiveOption(i,!0,!0)}return void e.preventDefault();case s:return void(t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),e.preventDefault()));case c:return void t.advanceSelection(-1,e);case h:return void t.advanceSelection(1,e);case _:return t.settings.selectOnTab&&t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),t.isFull()||e.preventDefault()),void(t.settings.create&&t.createItem()&&e.preventDefault());case m:case g:return void t.deleteSelection(e)}return!t.isFull()&&!t.isInputHidden||(o?e.metaKey:e.ctrlKey)?void 0:void e.preventDefault()},onKeyUp:function(e){var t=this;if(t.isLocked)return e&&e.preventDefault();var n=t.$control_input.val()||"";t.lastValue!==n&&(t.lastValue=n,t.onSearchChange(n),t.refreshOptions(),t.trigger("type",n))},onSearchChange:function(e){var t=this,n=t.settings.load;n&&(t.loadedSearches.hasOwnProperty(e)||(t.loadedSearches[e]=!0,t.load(function(i){n.apply(t,[e,i])})))},onFocus:function(e){var t=this,n=t.isFocused;return t.isDisabled?(t.blur(),e&&e.preventDefault(),!1):void(t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.onSearchChange(""),n||t.trigger("focus"),t.$activeItems.length||(t.showInput(),t.setActiveItem(null),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState()))},onBlur:function(e,t){var n=this;if(n.isFocused&&(n.isFocused=!1,!n.ignoreFocus)){if(!n.ignoreBlur&&document.activeElement===n.$dropdown_content[0])return n.ignoreBlur=!0,void n.onFocus(e);var i=function(){n.close(),n.setTextboxValue(""),n.setActiveItem(null),n.setActiveOption(null),n.setCaret(n.items.length),n.refreshState(),(t||document.body).focus(),n.ignoreFocus=!1,n.trigger("blur")};n.ignoreFocus=!0,n.settings.create&&n.settings.createOnBlur?n.createItem(null,!1,i):i()}},onOptionHover:function(e){this.ignoreHover||this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(t){var n,i,r=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),i=e(t.currentTarget),i.hasClass("create")?r.createItem(null,function(){r.settings.closeAfterSelect&&r.close()}):(n=i.attr("data-value"),"undefined"!=typeof n&&(r.lastQuery=null,r.setTextboxValue(""),r.addItem(n),r.settings.closeAfterSelect?r.close():!r.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&r.setActiveOption(r.getOption(n))))},onItemSelect:function(e){var t=this;t.isLocked||"multi"===t.settings.mode&&(e.preventDefault(),t.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,n=t.$wrapper.addClass(t.settings.loadingClass);t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||n.removeClass(t.settings.loadingClass),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input,n=t.val()!==e;n&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return this.tagType===w&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e,t){var n=t?[]:["change"];A(this,n,function(){this.clear(t),this.addItems(e,t)})},setActiveItem:function(t,n){var i,r,o,a,s,l,c,u,d=this;if("single"!==d.settings.mode){if(t=e(t),!t.length)return e(d.$activeItems).removeClass("active"),d.$activeItems=[],void(d.isFocused&&d.showInput());if(i=n&&n.type.toLowerCase(),"mousedown"===i&&d.isShiftDown&&d.$activeItems.length){for(u=d.$control.children(".active:last"),a=Array.prototype.indexOf.apply(d.$control[0].childNodes,[u[0]]),s=Array.prototype.indexOf.apply(d.$control[0].childNodes,[t[0]]),a>s&&(c=a,a=s,s=c),r=a;s>=r;r++)l=d.$control[0].childNodes[r],-1===d.$activeItems.indexOf(l)&&(e(l).addClass("active"),d.$activeItems.push(l));n.preventDefault()}else"mousedown"===i&&d.isCtrlDown||"keydown"===i&&this.isShiftDown?t.hasClass("active")?(o=d.$activeItems.indexOf(t[0]),d.$activeItems.splice(o,1),t.removeClass("active")):d.$activeItems.push(t.addClass("active")[0]):(e(d.$activeItems).removeClass("active"),d.$activeItems=[t.addClass("active")[0]]);d.hideInput(),this.isFocused||d.focus()}},setActiveOption:function(t,n,i){var r,o,a,s,l,c=this;c.$activeOption&&c.$activeOption.removeClass("active"),c.$activeOption=null,t=e(t),t.length&&(c.$activeOption=t.addClass("active"),(n||!k(n))&&(r=c.$dropdown_content.height(),o=c.$activeOption.outerHeight(!0),n=c.$dropdown_content.scrollTop()||0,a=c.$activeOption.offset().top-c.$dropdown_content.offset().top+n,s=a,l=a-r+o,a+o>r+n?c.$dropdown_content.stop().animate({scrollTop:l},i?c.settings.scrollDuration:0):n>a&&c.$dropdown_content.stop().animate({scrollTop:s},i?c.settings.scrollDuration:0)))},selectAll:function(){var e=this;"single"!==e.settings.mode&&(e.$activeItems=Array.prototype.slice.apply(e.$control.children(":not(input)").addClass("active")),e.$activeItems.length&&(e.hideInput(),e.close()),e.focus())},hideInput:function(){var e=this;e.setTextboxValue(""),e.$control_input.css({opacity:0,position:"absolute",left:e.rtl?1e4:-1e4}),e.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0))},blur:function(e){this.$control_input[0].blur(),this.onBlur(null,e)},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return"string"==typeof t&&(t=[{field:t}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t}},search:function(t){var n,i,r,o=this,a=o.settings,s=this.getSearchOptions();if(a.score&&(r=o.settings.score.apply(this,[t]),"function"!=typeof r))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==o.lastQuery?(o.lastQuery=t,i=o.sifter.search(t,e.extend(s,{score:r})),o.currentResults=i):i=e.extend(!0,{},o.currentResults),a.hideSelected)for(n=i.items.length-1;n>=0;n--)-1!==o.items.indexOf(S(i.items[n].id))&&i.items.splice(n,1);return i},refreshOptions:function(t){var n,r,o,a,s,l,c,u,d,h,p,f,m,g,v,y;"undefined"==typeof t&&(t=!0);var b=this,_=e.trim(b.$control_input.val()),w=b.search(_),x=b.$dropdown_content,C=b.$activeOption&&S(b.$activeOption.attr("data-value"));for(a=w.items.length,"number"==typeof b.settings.maxOptions&&(a=Math.min(a,b.settings.maxOptions)),s={},l=[],n=0;a>n;n++)for(c=b.options[w.items[n].id],u=b.render("option",c),d=c[b.settings.optgroupField]||"",h=e.isArray(d)?d:[d],r=0,o=h&&h.length;o>r;r++)d=h[r],b.optgroups.hasOwnProperty(d)||(d=""),s.hasOwnProperty(d)||(s[d]=[],l.push(d)),s[d].push(u);for(this.settings.lockOptgroupOrder&&l.sort(function(e,t){var n=b.optgroups[e].$order||0,i=b.optgroups[t].$order||0;return n-i}),p=[],n=0,a=l.length;a>n;n++)d=l[n],b.optgroups.hasOwnProperty(d)&&s[d].length?(f=b.render("optgroup_header",b.optgroups[d])||"",f+=s[d].join(""),p.push(b.render("optgroup",e.extend({},b.optgroups[d],{html:f})))):p.push(s[d].join(""));if(x.html(p.join("")),b.settings.highlight&&w.query.length&&w.tokens.length)for(n=0,a=w.tokens.length;a>n;n++)i(x,w.tokens[n].regex);if(!b.settings.hideSelected)for(n=0,a=b.items.length;a>n;n++)b.getOption(b.items[n]).addClass("selected");m=b.canCreate(_),
m&&(x.prepend(b.render("option_create",{input:_})),y=e(x[0].childNodes[0])),b.hasOptions=w.items.length>0||m,b.hasOptions?(w.items.length>0?(v=C&&b.getOption(C),v&&v.length?g=v:"single"===b.settings.mode&&b.items.length&&(g=b.getOption(b.items[0])),g&&g.length||(g=y&&!b.settings.addPrecedence?b.getAdjacentOption(y,1):x.find("[data-selectable]:first"))):g=y,b.setActiveOption(g),t&&!b.isOpen&&b.open()):(b.setActiveOption(null),t&&b.isOpen&&b.close())},addOption:function(t){var n,i,r,o=this;if(e.isArray(t))for(n=0,i=t.length;i>n;n++)o.addOption(t[n]);else(r=o.registerOption(t))&&(o.userOptions[r]=!0,o.lastQuery=null,o.trigger("option_add",r,t))},registerOption:function(e){var t=S(e[this.settings.valueField]);return!t||this.options.hasOwnProperty(t)?!1:(e.$order=e.$order||++this.order,this.options[t]=e,t)},registerOptionGroup:function(e){var t=S(e[this.settings.optgroupValueField]);return t?(e.$order=e.$order||++this.order,this.optgroups[t]=e,t):!1},addOptionGroup:function(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)},removeOptionGroup:function(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.renderCache={},this.trigger("optgroup_remove",e))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(t,n){var i,r,o,a,s,l,c,u=this;if(t=S(t),o=S(n[u.settings.valueField]),null!==t&&u.options.hasOwnProperty(t)){if("string"!=typeof o)throw new Error("Value must be set in option data");c=u.options[t].$order,o!==t&&(delete u.options[t],a=u.items.indexOf(t),-1!==a&&u.items.splice(a,1,o)),n.$order=n.$order||c,u.options[o]=n,s=u.renderCache.item,l=u.renderCache.option,s&&(delete s[t],delete s[o]),l&&(delete l[t],delete l[o]),-1!==u.items.indexOf(o)&&(i=u.getItem(t),r=e(u.render("item",n)),i.hasClass("active")&&r.addClass("active"),i.replaceWith(r)),u.lastQuery=null,u.isOpen&&u.refreshOptions(!1)}},removeOption:function(e,t){var n=this;e=S(e);var i=n.renderCache.item,r=n.renderCache.option;i&&delete i[e],r&&delete r[e],delete n.userOptions[e],delete n.options[e],n.lastQuery=null,n.trigger("option_remove",e),n.removeItem(e,t)},clearOptions:function(){var e=this;e.loadedSearches={},e.userOptions={},e.renderCache={},e.options=e.sifter.items={},e.lastQuery=null,e.trigger("option_clear"),e.clear()},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,n){var i=this.$dropdown.find("[data-selectable]"),r=i.index(t)+n;return r>=0&&r<i.length?i.eq(r):e()},getElementWithValue:function(t,n){if(t=S(t),"undefined"!=typeof t&&null!==t)for(var i=0,r=n.length;r>i;i++)if(n[i].getAttribute("data-value")===t)return e(n[i]);return e()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(t,n){for(var i=e.isArray(t)?t:[t],r=0,o=i.length;o>r;r++)this.isPending=o-1>r,this.addItem(i[r],n)},addItem:function(t,n){var i=n?[]:["change"];A(this,i,function(){var i,r,o,a,s,l=this,c=l.settings.mode;return t=S(t),-1!==l.items.indexOf(t)?void("single"===c&&l.close()):void(l.options.hasOwnProperty(t)&&("single"===c&&l.clear(n),"multi"===c&&l.isFull()||(i=e(l.render("item",l.options[t])),s=l.isFull(),l.items.splice(l.caretPos,0,t),l.insertAtCaret(i),(!l.isPending||!s&&l.isFull())&&l.refreshState(),l.isSetup&&(o=l.$dropdown_content.find("[data-selectable]"),l.isPending||(r=l.getOption(t),a=l.getAdjacentOption(r,1).attr("data-value"),l.refreshOptions(l.isFocused&&"single"!==c),a&&l.setActiveOption(l.getOption(a))),!o.length||l.isFull()?l.close():l.positionDropdown(),l.updatePlaceholder(),l.trigger("item_add",t,i),l.updateOriginalInput({silent:n})))))})},removeItem:function(e,t){var n,i,r,o=this;n="object"==typeof e?e:o.getItem(e),e=S(n.attr("data-value")),i=o.items.indexOf(e),-1!==i&&(n.remove(),n.hasClass("active")&&(r=o.$activeItems.indexOf(n[0]),o.$activeItems.splice(r,1)),o.items.splice(i,1),o.lastQuery=null,!o.settings.persist&&o.userOptions.hasOwnProperty(e)&&o.removeOption(e,t),i<o.caretPos&&o.setCaret(o.caretPos-1),o.refreshState(),o.updatePlaceholder(),o.updateOriginalInput({silent:t}),o.positionDropdown(),o.trigger("item_remove",e,n))},createItem:function(t,n){var i=this,r=i.caretPos;t=t||e.trim(i.$control_input.val()||"");var o=arguments[arguments.length-1];if("function"!=typeof o&&(o=function(){}),"boolean"!=typeof n&&(n=!0),!i.canCreate(t))return o(),!1;i.lock();var a="function"==typeof i.settings.create?this.settings.create:function(e){var t={};return t[i.settings.labelField]=e,t[i.settings.valueField]=e,t},s=$(function(e){if(i.unlock(),!e||"object"!=typeof e)return o();var t=S(e[i.settings.valueField]);return"string"!=typeof t?o():(i.setTextboxValue(""),i.addOption(e),i.setCaret(r),i.addItem(t),i.refreshOptions(n&&"single"!==i.settings.mode),void o(e))}),l=a.apply(this,[t,s]);return"undefined"!=typeof l&&s(l),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){var e,t=this;t.isRequired&&(t.items.length&&(t.isInvalid=!1),t.$control_input.prop("required",e)),t.refreshClasses()},refreshClasses:function(){var t=this,n=t.isFull(),i=t.isLocked;t.$wrapper.toggleClass("rtl",t.rtl),t.$control.toggleClass("focus",t.isFocused).toggleClass("disabled",t.isDisabled).toggleClass("required",t.isRequired).toggleClass("invalid",t.isInvalid).toggleClass("locked",i).toggleClass("full",n).toggleClass("not-full",!n).toggleClass("input-active",t.isFocused&&!t.isInputHidden).toggleClass("dropdown-active",t.isOpen).toggleClass("has-options",!e.isEmptyObject(t.options)).toggleClass("has-items",t.items.length>0),t.$control_input.data("grow",!n&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(e){var t,n,i,r,o=this;if(e=e||{},o.tagType===w){for(i=[],t=0,n=o.items.length;n>t;t++)r=o.options[o.items[t]][o.settings.labelField]||"",i.push('<option value="'+T(o.items[t])+'" selected="selected">'+T(r)+"</option>");i.length||this.$input.attr("multiple")||i.push('<option value="" selected="selected"></option>'),o.$input.html(i.join(""))}else o.$input.val(o.getValue()),o.$input.attr("value",o.$input.val());o.isSetup&&(e.silent||o.trigger("change",o.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})}},open:function(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.focus(),e.isOpen=!0,e.refreshState(),e.$dropdown.css({visibility:"hidden",display:"block"}),e.positionDropdown(),e.$dropdown.css({visibility:"visible"}),e.trigger("dropdown_open",e.$dropdown))},close:function(){var e=this,t=e.isOpen;"single"===e.settings.mode&&e.items.length&&e.hideInput(),e.isOpen=!1,e.$dropdown.hide(),e.setActiveOption(null),e.refreshState(),t&&e.trigger("dropdown_close",e.$dropdown)},positionDropdown:function(){var e=this.$control,t="body"===this.settings.dropdownParent?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},clear:function(e){var t=this;t.items.length&&(t.$control.children(":not(input)").remove(),t.items=[],t.lastQuery=null,t.setCaret(0),t.setActiveItem(null),t.updatePlaceholder(),t.updateOriginalInput({silent:e}),t.refreshState(),t.showInput(),t.trigger("clear"))},insertAtCaret:function(t){var n=Math.min(this.caretPos,this.items.length);0===n?this.$control.prepend(t):e(this.$control[0].childNodes[n]).before(t),this.setCaret(n+1)},deleteSelection:function(t){var n,i,r,o,a,s,l,c,u,d=this;if(r=t&&t.keyCode===m?-1:1,o=I(d.$control_input[0]),d.$activeOption&&!d.settings.hideSelected&&(l=d.getAdjacentOption(d.$activeOption,-1).attr("data-value")),a=[],d.$activeItems.length){for(u=d.$control.children(".active:"+(r>0?"last":"first")),s=d.$control.children(":not(input)").index(u),r>0&&s++,n=0,i=d.$activeItems.length;i>n;n++)a.push(e(d.$activeItems[n]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(d.isFocused||"single"===d.settings.mode)&&d.items.length&&(0>r&&0===o.start&&0===o.length?a.push(d.items[d.caretPos-1]):r>0&&o.start===d.$control_input.val().length&&a.push(d.items[d.caretPos]));if(!a.length||"function"==typeof d.settings.onDelete&&d.settings.onDelete.apply(d,[a])===!1)return!1;for("undefined"!=typeof s&&d.setCaret(s);a.length;)d.removeItem(a.pop());return d.showInput(),d.positionDropdown(),d.refreshOptions(!0),l&&(c=d.getOption(l),c.length&&d.setActiveOption(c)),!0},advanceSelection:function(e,t){var n,i,r,o,a,s,l=this;0!==e&&(l.rtl&&(e*=-1),n=e>0?"last":"first",i=I(l.$control_input[0]),l.isFocused&&!l.isInputHidden?(o=l.$control_input.val().length,a=0>e?0===i.start&&0===i.length:i.start===o,a&&!o&&l.advanceCaret(e,t)):(s=l.$control.children(".active:"+n),s.length&&(r=l.$control.children(":not(input)").index(s),l.setActiveItem(null),l.setCaret(e>0?r+1:r))))},advanceCaret:function(e,t){var n,i,r=this;0!==e&&(n=e>0?"next":"prev",r.isShiftDown?(i=r.$control_input[n](),i.length&&(r.hideInput(),r.setActiveItem(i),t&&t.preventDefault())):r.setCaret(r.caretPos+e))},setCaret:function(t){var n=this;if(t="single"===n.settings.mode?n.items.length:Math.max(0,Math.min(n.items.length,t)),!n.isPending){var i,r,o,a;for(o=n.$control.children(":not(input)"),i=0,r=o.length;r>i;i++)a=e(o[i]).detach(),t>i?n.$control_input.before(a):n.$control.append(a)}n.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var e=this;e.$input.prop("disabled",!0),e.$control_input.prop("disabled",!0).prop("tabindex",-1),e.isDisabled=!0,e.lock()},enable:function(){var e=this;e.$input.prop("disabled",!1),e.$control_input.prop("disabled",!1).prop("tabindex",e.tabIndex),e.isDisabled=!1,e.unlock()},destroy:function(){var t=this,n=t.eventNS,i=t.revertSettings;t.trigger("destroy"),t.off(),t.$wrapper.remove(),t.$dropdown.remove(),t.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),t.$control_input.removeData("grow"),t.$input.removeData("selectize"),e(window).off(n),e(document).off(n),e(document.body).off(n),delete t.$input[0].selectize},render:function(e,t){var n,i,r="",o=!1,a=this,s=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return("option"===e||"item"===e)&&(n=S(t[a.settings.valueField]),o=!!n),o&&(k(a.renderCache[e])||(a.renderCache[e]={}),a.renderCache[e].hasOwnProperty(n))?a.renderCache[e][n]:(r=a.settings.render[e].apply(this,[t,T]),("option"===e||"option_create"===e)&&(r=r.replace(s,"<$1 data-selectable")),"optgroup"===e&&(i=t[a.settings.optgroupValueField]||"",r=r.replace(s,'<$1 data-group="'+D(T(i))+'"')),("option"===e||"item"===e)&&(r=r.replace(s,'<$1 data-value="'+D(T(n||""))+'"')),o&&(a.renderCache[e][n]=r),r)},clearCache:function(e){var t=this;"undefined"==typeof e?t.renderCache={}:delete t.renderCache[e]},canCreate:function(e){var t=this;if(!t.settings.create)return!1;var n=t.settings.createFilter;return e.length&&("function"!=typeof n||n.apply(t,[e]))&&("string"!=typeof n||new RegExp(n).test(e))&&(!(n instanceof RegExp)||n.test(e))}}),P.count=0,P.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},e.fn.selectize=function(t){var n=e.fn.selectize.defaults,i=e.extend({},n,t),r=i.dataAttr,o=i.labelField,a=i.valueField,s=i.optgroupField,l=i.optgroupLabelField,c=i.optgroupValueField,u=function(t,n){var s,l,c,u,d=t.attr(r);if(d)for(n.options=JSON.parse(d),s=0,l=n.options.length;l>s;s++)n.items.push(n.options[s][a]);else{var h=e.trim(t.val()||"");if(!i.allowEmptyOption&&!h.length)return;for(c=h.split(i.delimiter),s=0,l=c.length;l>s;s++)u={},u[o]=c[s],u[a]=c[s],n.options.push(u);n.items=c}},d=function(t,n){var u,d,h,p,f=n.options,m={},g=function(e){var t=r&&e.attr(r);return"string"==typeof t&&t.length?JSON.parse(t):null},v=function(t,r){t=e(t);var l=S(t.attr("value"));if(l||i.allowEmptyOption)if(m.hasOwnProperty(l)){if(r){var c=m[l][s];c?e.isArray(c)?c.push(r):m[l][s]=[c,r]:m[l][s]=r}}else{var u=g(t)||{};u[o]=u[o]||t.text(),u[a]=u[a]||l,u[s]=u[s]||r,m[l]=u,f.push(u),t.is(":selected")&&n.items.push(l)}},y=function(t){var i,r,o,a,s;for(t=e(t),o=t.attr("label"),o&&(a=g(t)||{},a[l]=o,a[c]=o,n.optgroups.push(a)),s=e("option",t),i=0,r=s.length;r>i;i++)v(s[i],o)};for(n.maxItems=t.attr("multiple")?null:1,p=t.children(),u=0,d=p.length;d>u;u++)h=p[u].tagName.toLowerCase(),"optgroup"===h?y(p[u]):"option"===h&&v(p[u])};return this.each(function(){if(!this.selectize){var r,o=e(this),a=this.tagName.toLowerCase(),s=o.attr("placeholder")||o.attr("data-placeholder");s||i.allowEmptyOption||(s=o.children('option[value=""]').text());var l={placeholder:s,options:[],optgroups:[],items:[]};"select"===a?d(o,l):u(o,l),r=new P(o,e.extend(!0,{},n,l,t))}})},e.fn.selectize.defaults=P.defaults,e.fn.selectize.support={validity:C},P.define("drag_drop",function(t){if(!e.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var n=this;n.lock=function(){var e=n.lock;return function(){var t=n.$control.data("sortable");return t&&t.disable(),e.apply(n,arguments)}}(),n.unlock=function(){var e=n.unlock;return function(){var t=n.$control.data("sortable");return t&&t.enable(),e.apply(n,arguments)}}(),n.setup=function(){var t=n.setup;return function(){t.apply(this,arguments);var i=n.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:n.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),i.css({overflow:"visible"})},stop:function(){i.css({overflow:"hidden"});var t=n.$activeItems?n.$activeItems.slice():null,r=[];i.children("[data-value]").each(function(){r.push(e(this).attr("data-value"))}),n.setValue(r),n.setActiveItem(t)}})}}()}}),P.define("dropdown_header",function(t){var n=this;t=e.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a></div></div>'}},t),n.setup=function(){var i=n.setup;return function(){i.apply(n,arguments),n.$dropdown_header=e(t.html(t)),n.$dropdown.prepend(n.$dropdown_header)}}()}),P.define("optgroup_columns",function(t){var n=this;t=e.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,n){var i=t.closest("[data-group]").find("[data-selectable]"),r=i.index(t)+n;return r>=0&&r<i.length?i.eq(r):e()},this.onKeyDown=function(){var e=n.onKeyDown;return function(t){var i,r,o,a;return!this.isOpen||t.keyCode!==c&&t.keyCode!==h?e.apply(this,arguments):(n.ignoreHover=!0,a=this.$activeOption.closest("[data-group]"),i=a.find("[data-selectable]").index(this.$activeOption),a=t.keyCode===c?a.prev("[data-group]"):a.next("[data-group]"),o=a.find("[data-selectable]"),r=o.eq(Math.min(o.length-1,i)),void(r.length&&this.setActiveOption(r)))}}();var i=function(){var e,t=i.width,n=document;return"undefined"==typeof t&&(e=n.createElement("div"),e.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,n.body.appendChild(e),t=i.width=e.offsetWidth-e.clientWidth,n.body.removeChild(e)),t},r=function(){var r,o,a,s,l,c,u;if(u=e("[data-group]",n.$dropdown_content),o=u.length,o&&n.$dropdown_content.width()){if(t.equalizeHeight){for(a=0,r=0;o>r;r++)a=Math.max(a,u.eq(r).height());u.css({height:a})}t.equalizeWidth&&(c=n.$dropdown_content.innerWidth()-i(),s=Math.round(c/o),u.css({width:s}),o>1&&(l=c-s*(o-1),u.eq(o-1).css({width:l})))}};(t.equalizeHeight||t.equalizeWidth)&&(M.after(this,"positionDropdown",r),M.after(this,"refreshOptions",r))}),P.define("remove_button",function(t){if("single"!==this.settings.mode){t=e.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);var n=this,i='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+T(t.title)+'">'+t.label+"</a>",r=function(e,t){var n=e.search(/(<\/[^>]+>\s*)$/);return e.substring(0,n)+t+e.substring(n)};this.setup=function(){var o=n.setup;return function(){if(t.append){var a=n.settings.render.item;n.settings.render.item=function(e){return r(a.apply(this,arguments),i)}}o.apply(this,arguments),this.$control.on("click","."+t.className,function(t){if(t.preventDefault(),!n.isLocked){var i=e(t.currentTarget).parent();n.setActiveItem(i),n.deleteSelection()&&n.setCaret(n.items.length)}})}}()}}),P.define("restore_on_backspace",function(e){var t=this;e.text=e.text||function(e){return e[this.settings.labelField]},this.onKeyDown=function(){var n=t.onKeyDown;return function(t){var i,r;return t.keyCode===m&&""===this.$control_input.val()&&!this.$activeItems.length&&(i=this.caretPos-1,i>=0&&i<this.items.length)?(r=this.options[this.items[i]],this.deleteSelection(t)&&(this.setTextboxValue(e.text.apply(this,[r])),this.refreshOptions(!0)),void t.preventDefault()):n.apply(this,arguments)}}()}),P})},function(e,t,n){var i,r;!function(o,a){i=a,r="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==r&&(e.exports=r))}(this,function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){if(e=i(String(e||"").toLowerCase()),!e||!e.length)return[];var t,n,o,s,l=[],c=e.split(/ +/);for(t=0,n=c.length;n>t;t++){if(o=r(c[t]),this.settings.diacritics)for(s in a)a.hasOwnProperty(s)&&(o=o.replace(new RegExp(s,"g"),a[s]));l.push({string:c[t],regex:new RegExp(o,"i")})}return l},e.prototype.iterator=function(e,t){var n;n=o(e)?Array.prototype.forEach||function(e){for(var t=0,n=this.length;n>t;t++)e(this[t],t,this)}:function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)},n.apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var n,i,r,o;n=this,e=n.prepareSearch(e,t),r=e.tokens,i=e.options.fields,o=r.length;var a=function(e,t){var n,i;return e?(e=String(e||""),i=e.search(t.regex),-1===i?0:(n=t.string.length/e.length,0===i&&(n+=.5),n)):0},s=function(){var e=i.length;return e?1===e?function(e,t){return a(t[i[0]],e)}:function(t,n){for(var r=0,o=0;e>r;r++)o+=a(n[i[r]],t);return o/e}:function(){return 0}}();return o?1===o?function(e){return s(r[0],e)}:"and"===e.options.conjunction?function(e){for(var t,n=0,i=0;o>n;n++){if(t=s(r[n],e),0>=t)return 0;i+=t}return i/o}:function(e){for(var t=0,n=0;o>t;t++)n+=s(r[t],e);return n/o}:function(){return 0}},e.prototype.getSortFunction=function(e,n){var i,r,o,a,s,l,c,u,d,h,p;if(o=this,e=o.prepareSearch(e,n),p=!e.query&&n.sort_empty||n.sort,d=function(e,t){return"$score"===e?t.score:o.items[t.id][e]},s=[],p)for(i=0,r=p.length;r>i;i++)(e.query||"$score"!==p[i].field)&&s.push(p[i]);if(e.query){for(h=!0,i=0,r=s.length;r>i;i++)if("$score"===s[i].field){h=!1;break}h&&s.unshift({field:"$score",direction:"desc"})}else for(i=0,r=s.length;r>i;i++)if("$score"===s[i].field){s.splice(i,1);break}for(u=[],i=0,r=s.length;r>i;i++)u.push("desc"===s[i].direction?-1:1);return l=s.length,l?1===l?(a=s[0].field,c=u[0],function(e,n){return c*t(d(a,e),d(a,n))}):function(e,n){var i,r,o;for(i=0;l>i;i++)if(o=s[i].field,r=u[i]*t(d(o,e),d(o,n)))return r;return 0}:null},e.prototype.prepareSearch=function(e,t){if("object"==typeof e)return e;t=n({},t);var i=t.fields,r=t.sort,a=t.sort_empty;return i&&!o(i)&&(t.fields=[i]),r&&!o(r)&&(t.sort=[r]),a&&!o(a)&&(t.sort_empty=[a]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,t){var n,i,r,o,a=this;return i=this.prepareSearch(e,t),t=i.options,e=i.query,o=t.score||a.getScoreFunction(i),e.length?a.iterator(a.items,function(e,r){n=o(e),(t.filter===!1||n>0)&&i.items.push({score:n,id:r})}):a.iterator(a.items,function(e,t){i.items.push({score:1,id:t})}),r=a.getSortFunction(i,t),r&&i.items.sort(r),i.total=i.items.length,"number"==typeof t.limit&&(i.items=i.items.slice(0,t.limit)),i};var t=function(e,t){return"number"==typeof e&&"number"==typeof t?e>t?1:t>e?-1:0:(e=s(String(e||"")),t=s(String(t||"")),e>t?1:t>e?-1:0)},n=function(e,t){var n,i,r,o;for(n=1,i=arguments.length;i>n;n++)if(o=arguments[n])for(r in o)o.hasOwnProperty(r)&&(e[r]=o[r]);return e},i=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},r=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},o=Array.isArray||"undefined"!=typeof $&&$.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a={a:"[aÀÁÂÃÄÅàáâãäåĀāąĄ]",c:"[cÇçćĆčČ]",d:"[dđĐďĎð]",e:"[eÈÉÊËèéêëěĚĒēęĘ]",i:"[iÌÍÎÏìíîïĪī]",l:"[lłŁ]",n:"[nÑñňŇńŃ]",o:"[oÒÓÔÕÕÖØòóôõöøŌō]",r:"[rřŘ]",s:"[sŠšśŚ]",t:"[tťŤ]",u:"[uÙÚÛÜùúûüůŮŪū]",y:"[yŸÿýÝ]",z:"[zŽžżŻźŹ]"},s=function(){var e,t,n,i,r="",o={};for(n in a)if(a.hasOwnProperty(n))for(i=a[n].substring(2,a[n].length-1),r+=i,e=0,t=i.length;t>e;e++)o[i.charAt(e)]=n;var s=new RegExp("["+r+"]","g");return function(e){return e.replace(s,function(e){return o[e]}).toLowerCase()}}();return e})},function(e,t,n){var i,r;!function(o,a){i=a,r="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==r&&(e.exports=r))}(this,function(){var e={};e.mixin=function(e){e.plugins={},e.prototype.initializePlugins=function(e){var n,i,r,o=this,a=[];if(o.plugins={names:[],settings:{},requested:{},loaded:{}},t.isArray(e))for(n=0,i=e.length;i>n;n++)"string"==typeof e[n]?a.push(e[n]):(o.plugins.settings[e[n].name]=e[n].options,a.push(e[n].name));else if(e)for(r in e)e.hasOwnProperty(r)&&(o.plugins.settings[r]=e[r],a.push(r));for(;a.length;)o.require(a.shift())},e.prototype.loadPlugin=function(t){var n=this,i=n.plugins,r=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');i.requested[t]=!0,i.loaded[t]=r.fn.apply(n,[n.plugins.settings[t]||{}]),i.names.push(t)},e.prototype.require=function(e){var t=this,n=t.plugins;if(!t.plugins.loaded.hasOwnProperty(e)){if(n.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');t.loadPlugin(e)}return n.loaded[e]},e.define=function(t,n){e.plugins[t]={name:t,fn:n}}};var t={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}};return e})},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a);t["default"]=s["default"].ItemView.extend({initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this;this.dataView=e.dataView,this.field=e.field,this.title=e.title||null,this._defaultValue=null,this.on("_change",function(){t.isDefault()?t.trigger("reset"):t.trigger("change")})},render:function(){return this.title&&this.$el.append('<h4 class="filter-item-title">'+this.title+"</h4>"),s["default"].ItemView.prototype.render.apply(this,arguments),this},isDefault:function(){return o["default"].isEqual(this._defaultValue,this.getValue())}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(472),s=i(a);t["default"]=s["default"].extend({className:"checkbox-filter",events:{"change input":"changeInput","click .checkbox-item":"clickCheckboxItem"},template:!1,initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];s["default"].prototype.initialize.apply(this,arguments);var t,n=this,i=this.dataView.getItems(),r=[],a={};this.optionFormatter=e.optionFormatter||function(e){return e},o["default"].each(i,function(e){t=e[n.field],t&&(a[t.toString()]=t)}),o["default"].each(a,function(e,t){r.push(t)}),this._defaultValue=o["default"].values(a),this._value=o["default"].clone(n._defaultValue),this.optionMap=a,this._value=[]},shouldBeDisbaled:function(){return 1===this._defaultValue.length?!0:!1},onRender:function(){var e=this,t=o["default"].keys(this.optionMap);this.$el.append(o["default"].map(t,function(t){return'<div class="checkbox-item"><input type="checkbox" value="'+t+'" checked><label class="checkbox-name">'+e.optionFormatter(t)+"</label></div>"}).join(""))},getValue:function(){return this._value},changeInput:function(){var e=this;this._value=o["default"].map(this.$el.find("input:checked"),function(t){return e.optionMap[t.value]}),this.trigger("_change")},clickCheckboxItem:function(e){$(e.target).is("input")||$(e.currentTarget).find("input").trigger("click")},verify:function(e,t){return o["default"].include(t,e)},reset:function(){this.$el.find("input").prop("checked",!0),this._value=o["default"].clone(this._defaultValue),this.trigger("reset")}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(475)["default"],r=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=n(45),a=r(o),s=n(464),l=r(s),c=n(472),u=r(c);t["default"]=u["default"].extend({className:"range-filter",template:!1,initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];u["default"].prototype.initialize.apply(this,arguments),this.numberFormatter=e.numberFormatter||function(e){return l["default"](e).format("0,0.00")},this._defaultValue=this.getMaxAndMin(this.dataView.getItems()),this._value=a["default"].clone(this.defaultMinAndMax)},shouldBeDisbaled:function(){return this._defaultValue[0]===this._defaultValue[1]},onRender:function(){var e,t=this,n=$('<div class="range-filter-slider"></div>'),r=$('<div class="range-filter-result"><span class="min"></span> - <span class="max"></span></div>'),o=r.find(".min"),s=r.find(".max"),l=this._defaultValue;e=function(e,n){o.text(t.numberFormatter(e)),s.text(t.numberFormatter(n)),t._value=[e,n]},this.setMinMax=e,e.apply(void 0,i(l)),this.$el.append(n),this.$el.append(r),n.slider({range:!0,min:l[0],max:l[1],values:a["default"].clone(l),step:.1,slide:function(t,n){e.apply(void 0,i(n.values))},stop:function(e,n){t.trigger("_change")}}),this.slider=n},getMaxAndMin:function(e){var t=this.field,n=e[0][t],i=e[0][t];return a["default"].each(e,function(e){e[t]>n&&(n=e[t]||0),e[t]<=i&&(i=e[t]||0)}),[i,n]},getValue:function(){return this._value},verify:function(e,t){return e>=t[0]&&e<=t[1]},reset:function(){this.slider&&(this.slider.slider("values",a["default"].clone(this._defaultValue)),this.setMinMax.apply(this,i(this._value))),this._value=a["default"].clone(this._defaultValue),this.trigger("reset")}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(476)["default"];t["default"]=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return i(e)},t.__esModule=!0},function(e,t,n){e.exports={"default":n(477),__esModule:!0}},function(e,t,n){n(478),n(502),e.exports=n(486).Array.from},function(e,t,n){"use strict";var i=n(479)(!0);n(482)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var i=n(480),r=n(481);e.exports=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),c=s.length;return 0>l||l>=c?e?"":void 0:(o=s.charCodeAt(l),55296>o||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):(o-55296<<10)+(a-56320)+65536)}}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";var i=n(483),r=n(484),o=n(489),a=n(490),s=n(495),l=n(496),c=n(497),u=n(498),d=n(491).getProto,h=n(499)("iterator"),p=!([].keys&&"next"in[].keys()),f="@@iterator",m="keys",g="values",v=function(){return this};e.exports=function(e,t,n,y,b,_,w){c(n,t,y);var x,C,k=function(e){if(!p&&e in M)return M[e];switch(e){case m:return function(){return new n(this,e)};case g:return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",T=b==g,D=!1,M=e.prototype,$=M[h]||M[f]||b&&M[b],L=$||k(b);if($){var A=d(L.call(new e));u(A,S,!0),!i&&s(M,f)&&a(A,h,v),T&&$.name!==g&&(D=!0,L=function(){return $.call(this)})}if(i&&!w||!p&&!D&&M[h]||a(M,h,L),l[t]=L,l[S]=v,b)if(x={values:T?L:k(g),keys:_?L:k(m),entries:T?k("entries"):L},w)for(C in x)C in M||o(M,C,x[C]);else r(r.P+r.F*(p||D),t,x);return x}},function(e,t){e.exports=!0},function(e,t,n){var i=n(485),r=n(486),o=n(487),a="prototype",s=function(e,t,n){var l,c,u,d=e&s.F,h=e&s.G,p=e&s.S,f=e&s.P,m=e&s.B,g=e&s.W,v=h?r:r[t]||(r[t]={}),y=h?i:p?i[t]:(i[t]||{})[a];h&&(n=t);for(l in n)c=!d&&y&&l in y,c&&l in v||(u=c?y[l]:n[l],v[l]=h&&"function"!=typeof y[l]?n[l]:m&&c?o(u,i):g&&y[l]==u?function(e){var t=function(t){return this instanceof e?new e(t):e(t)};return t[a]=e[a],t}(u):f&&"function"==typeof u?o(Function.call,u):u,f&&((v[a]||(v[a]={}))[l]=u))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,e.exports=s},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){var n=e.exports={version:"1.2.6"};"number"==typeof __e&&(__e=n)},function(e,t,n){var i=n(488);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){e.exports=n(490)},function(e,t,n){var i=n(491),r=n(492);e.exports=n(493)?function(e,t,n){return i.setDesc(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports=!n(494)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports={}},function(e,t,n){"use strict";var i=n(491),r=n(492),o=n(498),a={};n(490)(a,n(499)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i.create(a,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var i=n(491).setDesc,r=n(495),o=n(499)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){var i=n(500)("wks"),r=n(501),o=n(485).Symbol;e.exports=function(e){return i[e]||(i[e]=o&&o[e]||(o||r)("Symbol."+e))}},function(e,t,n){var i=n(485),r="__core-js_shared__",o=i[r]||(i[r]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36));
}},function(e,t,n){"use strict";var i=n(487),r=n(484),o=n(503),a=n(504),s=n(507),l=n(508),c=n(509);r(r.S+r.F*!n(512)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,u,d=o(e),h="function"==typeof this?this:Array,p=arguments,f=p.length,m=f>1?p[1]:void 0,g=void 0!==m,v=0,y=c(d);if(g&&(m=i(m,f>2?p[2]:void 0,2)),void 0==y||h==Array&&s(y))for(t=l(d.length),n=new h(t);t>v;v++)n[v]=g?m(d[v],v):d[v];else for(u=y.call(d),n=new h;!(r=u.next()).done;v++)n[v]=g?a(u,m,[r.value,v],!0):r.value;return n.length=v,n}})},function(e,t,n){var i=n(481);e.exports=function(e){return Object(i(e))}},function(e,t,n){var i=n(505);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(o){var a=e["return"];throw void 0!==a&&i(a.call(e)),o}}},function(e,t,n){var i=n(506);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var i=n(496),r=n(499)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},function(e,t,n){var i=n(480),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){var i=n(510),r=n(499)("iterator"),o=n(496);e.exports=n(486).getIteratorMethod=function(e){return void 0!=e?e[r]||e["@@iterator"]||o[i(e)]:void 0}},function(e,t,n){var i=n(511),r=n(499)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=(t=Object(e))[r])?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(499)("iterator"),r=!1;try{var o=[7][i]();o["return"]=function(){r=!0},Array.from(o,function(){throw 2})}catch(a){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){n=!0},o[i]=function(){return a},e(o)}catch(s){}return n}},function(e,t,n){"use strict";var i=n(514)["default"],r=n(475)["default"],o=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var a=n(45),s=o(a),l=n(472),c=o(l);t["default"]=c["default"].extend({className:"date-range-filter",template:!1,initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=this;c["default"].prototype.initialize.apply(this,arguments),this.dateFormatter=e.dateFormatter||function(e){return e},this.dateUnformatter=e.dateUnformatter||function(e){return e},this._defaultValue=s["default"].map(this.getMinAndMax(this.dataView.getItems()),function(e){return t.dateFormatter(e)}),this._value=s["default"].clone(this._defaultValue)},shouldBeDisbaled:function(){return this._defaultValue[0]===this._defaultValue[1]},onRender:function(){var e=this,t=i(e._defaultValue,2),n=t[0],o=t[1],a=$('<input type="text" class="start-date" name="min">'),s=$('<input type="text" class="end-date" name="max">'),l=function(e){return e&&e.match(/\d{4}-\d{2}-\d{2}/)?!0:!1},c=function(e,t){return e&&t&&t>=e};this.startDateEl=a,this.endDateEl=s,this.$el.append(a).append(" - ").append(s),this.$el.find(".start-date, .end-date").datepicker({dateFormat:"yy-mm-dd",minDate:new Date(n),maxDate:new Date(o),defaultDate:new Date(n),changeYear:!0,changeMonth:!0}),a.val(n),s.val(o),this.$el.on("input change","input",function(t){var n=$(t.currentTarget),i=n.val();l(i)&&("min"===n.attr("name")?e._value[0]=i:e._value[1]=i,c.apply(void 0,r(e._value))&&e.trigger("_change"))})},onDestroy:function(){this.$el.find(".start-date, .end-date").datepicker("destroy")},getMinAndMax:function(e){var t=this.field,n=e[0][t],i=e[0][t];return s["default"].each(e,function(e){e[t]>i&&(i=e[t]),e[t]<=n&&(n=e[t])}),[n,i]},getValue:function(){var e=this;return s["default"].map(e._value,function(t){return e.dateUnformatter(t)})},verify:function(e,t){var n=!1,i=!1;return t[0]&&(n=e>=t[0]),t[1]&&(i=e<=t[1]),n&&i},reset:function(){this.startDateEl&&(this.startDateEl.val(this._defaultValue[0]),this.endDateEl.val(this._defaultValue[1])),this._value=s["default"].clone(this._defaultValue),this.trigger("reset")}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(515)["default"],r=n(524)["default"];t["default"]=function(){function e(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,l=i(e);!(r=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(c){o=!0,a=c}finally{try{!r&&l["return"]&&l["return"]()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(r(Object(t)))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t.__esModule=!0},function(e,t,n){e.exports={"default":n(516),__esModule:!0}},function(e,t,n){n(517),n(478),e.exports=n(523)},function(e,t,n){n(518);var i=n(496);i.NodeList=i.HTMLCollection=i.Array},function(e,t,n){"use strict";var i=n(519),r=n(520),o=n(496),a=n(521);e.exports=n(482)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):"keys"==t?r(0,n):"values"==t?r(0,e[n]):r(0,[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var i=n(522),r=n(481);e.exports=function(e){return i(r(e))}},function(e,t,n){var i=n(511);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){var i=n(505),r=n(509);e.exports=n(486).getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},function(e,t,n){e.exports={"default":n(525),__esModule:!0}},function(e,t,n){n(517),n(478),e.exports=n(526)},function(e,t,n){var i=n(510),r=n(499)("iterator"),o=n(496);e.exports=n(486).isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||o.hasOwnProperty(i(t))}},function(e,t){"use strict";$.fn.popover.Constructor.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a);t["default"]=s["default"].Behavior.extend({defaults:{sortDir:!0},initialize:function(){var e=this;this.listenTo(this.view,"grid:ready",function(){e.initSort(),e.initDateSort()})},initSort:function(){var e,t=this,n=this.view.grid,i=this.view.dataView,r=this.options.fallback,a=function(e,n){return o["default"].isNull(e[r])?t.sortDir?1:-1:o["default"].isNull(n[r])?t.sortDir?-1:1:e[r]==n[r]?0:e[r]>n[r]?1:-1},s=function(n,i){var r=n[t.sortCol.field],s=i[t.sortCol.field];return o["default"].isNull(r)?t.sortDir?1:-1:o["default"].isNull(s)?t.sortDir?-1:1:r==s?t.sortCol.subSort?(e=t.sortCol.subSort,r=n[e],s=i[e],r==s?a(n,i):r>s?1:-1):a(n,i):r>s?1:-1};n.onSort.subscribe(function(e,n){t.sortCol=n.sortCol,t.sortDir=n.sortAsc?!0:!1,i.sort(s,n.sortAsc)})},initDateSort:function(){var e=this,t="asc",n=$('<i class="sort-indicator fa fa-caret-up"></i>'),i=this.view.grid,r=this.view.dataView,o=new Slick.EventHandler;o.subscribe(i.onHeaderCellRendered,function(){e.view.$el.find("."+e.options.dateColClass+" .slick-column-name").after(n)}),this.view.$el.on("click","."+this.options.dateColClass+".slick-header-column",function(e){"desc"===t?(n.removeClass("fa-caret-down").addClass("fa-caret-up"),t="asc"):(n.removeClass("fa-caret-up").addClass("fa-caret-down"),t="desc");var o=r.getGrouping()[0];o.comparer=function(e,n){return"desc"===t?n.value-e.value:e.value-n.value},r.sort(function(e,t){return e.date==t.date?0:e.date>t.date?1:-1},"desc"===t?!1:!0),i.setSortColumns([])})}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a);t["default"]=s["default"].Behavior.extend({events:{"click .download":"clickDownload"},clickDownload:function(e){e.preventDefault();var t,n=($(e.currentTarget),this.view.dataView),i=n.getFilteredAndPagedItems(n.getItems()),r=this.options.columns,a=[o["default"].pluck(r,"name").join(",")];o["default"].each(i.rows,function(e){e.placeholder||a.push(o["default"].map(r,function(t){var n;return n=t.formatter?t.formatter(e[t.field],t,e):e[t.field],o["default"].isString(n)?'"'+n+'"':n}).join(","))}),t=a.join("\n");var s=document.createElement("a");s.href=URL.createObjectURL(new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8"})),s.download="data.csv",s.click()}}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(464),s=i(a),l=n(465),c=i(l),u=[{name:"日期",field:"date",id:"date",formatter:function(e,t,n,i,r){return r.symbol?"":n},plainFormatter:function(e,t,n,i,r){return n.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i})},cssClass:"position-time",headerCssClass:"position-time",sortable:!1,filter:"dateRange",filterOptions:{dateFormatter:function(e){return e.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i})},dateUnformatter:function(e){return e.replace(/-/g,"")}}},{name:"证券代码",field:"symbol",id:"symbol",filter:"select",filterOptions:{multiple:!0}},{name:"持仓数量",field:"amount",id:"amount",formatter:function(e,t,n){return s["default"](n).format("0,0")},cssClass:"align-right",filter:"range",filterOptions:{numberFormatter:function(e){return s["default"](e).format("0,0")}}},{name:"持仓均价",id:"cost",field:"cost",formatter:function(e,t,n,i){return s["default"](n).format("0,0.00")},cssClass:"align-right",filter:"range"},{name:"收盘价格",id:"close",field:"close",formatter:function(e,t,n,i){return s["default"](n).format("0,0.00")},cssClass:"align-right",filter:"range"},{name:"头寸",field:"value",id:"value",formatter:function(e,t,n){return s["default"](n).format("0,0.00")},cssClass:"align-right",filter:"range"},{name:"浮动盈亏",field:"P/L",id:"P/L",formatter:function(e,t,n){return'<span class="'+c["default"](n)+'">'+s["default"](n).format("0,0.00")+"</span>"},plainFormatter:function(e,t,n){return s["default"](n).format("0,0.00")},cssClass:"align-right",filter:"range"}];o["default"].each(u,function(e){e.resizable=!0,e.sortable=o["default"].isUndefined(e.sortable)?!0:e.sortable}),t["default"]=u,e.exports=t["default"]},function(e,t,n){"use strict";function i(e,t,n){return e.toFixed(2)}var r=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=n(45),a=r(o),s=[{name:"日期",field:"date",formatter:function(e,t,n){return e.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i})}},{name:"证券代码",field:"symbol"},{name:"持仓数量",field:"amount"},{name:"持仓均价",field:"cost",tofix:!0},{name:"收盘价格",field:"close",tofix:!0},{name:"头寸",field:"value",tofix:!0},{name:"浮动盈亏",field:"P/L",tofix:!0}];a["default"].each(s,function(e){e.tofix&&(e.formatter=i)}),t["default"]=s,e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="tools">\n    <a href="#" class="expand-all">展开全部</a>\n    <a href="#" class="collapse-all">收起全部</a>\n    <a href="#" class="download">导出</a>\n</div>\n<button class="btn btn-link clear-filters">清除筛选</button>\n<div class="slick"></div>\n<span class="loading spinner spinner-primary"></span>\n';return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(48),s=(i(a),n(49)),l=i(s);n(458),n(461),n(462),n(463);var c=n(464),u=i(c),d=n(466),h=i(d),p=n(528),f=i(p),m=n(529),g=i(m),v=n(534),y=i(v),b=n(535),_=i(b),w=n(536),x=i(w),C=n(538),k=i(C),S=n(537),T=i(S);t["default"]=l["default"].ItemView.extend({className:"order-content",template:y["default"],events:{"click .expand-all":"clickExpandAll","click .collapse-all":"clickCollapseAll","click .slick-group":"clickSlickGroup","mouseenter .state":"mouseenterState","mouseleave .state":"mouseleaveState"},behaviors:{GridFilter:{behaviorClass:h["default"]},GridSort:{behaviorClass:f["default"],sortCol:"date",fallback:"symbol",dateColClass:"order-time"},GridDownload:{behaviorClass:g["default"],columns:k["default"]}},initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.order=e.model.order()},prepareData:function(e){var t=[],n={},i=0,r=function(e){return{date:e.date,formatedDate:e.date.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i}),id:i++,symbol:null,direction:null,order_amount:null,filled_amount:null,price:null,transact_price:null,filled_price:null,commission:null,state:null,placeholder:!0}};o["default"].each(e,function(e){if(n[e.date]=e.summary,o["default"].isEmpty(e.order)||o["default"].each(e.order,function(n){o["default"].extend(n,{date:e.date,formatedDate:e.date.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i}),id:i++,filled_price:n.transact_price*n.filled_amount,commission:n.commission*n.filled_amount}),t.push(n)}),0===e.summary.trade_count||e.summary.trade_count>e.order.length){var a=r(e);0===e.summary.trade_count?a.onlyForGroup=!0:(a.__meta={selectable:!1,focusable:!1,columns:{0:{colspan:"*",formatter:function(e,t){return"达到10万条记录限制, 更多数据请于code单元中打印bt查看."}}}},t.push(a),e.summary.omitted=!0)}}),this.groupData=t,this.groupMeta=n},prepareGroupItemMetadata:function(){var e=this,t=new Slick.Data.GroupItemMetadataProvider;return t.getGroupRowMetadata=function(t){return{selectable:!1,focusable:!1,cssClasses:"slick-group",columns:{0:{colspan:"*",formatter:function(n,i){var r=t.collapsed?"fa-chevron-right":"fa-chevron-down",a=t.value.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i}),s=e.groupMeta[t.value],l=0,c=0,d=0;return s.omitted&&e.noFilter?(l=s.sell,c=s.buy,d=s.trade_count):t.rows&&!o["default"].isEmpty(t.rows)&&(o["default"].each(t.rows,function(e){1===e.direction&&(c+=e.filled_price),-1===e.direction&&(l+=e.filled_price)}),d=t.rows.length),_["default"](o["default"].extend({collapsed:r,date:a},{buy:u["default"](c).format("0,0.00"),sell:u["default"](l).format("0,0.00"),trade_count:d}))}}}}},t},prepareGrid:function(){var e,t=this,n=this.prepareGroupItemMetadata(),i=new Slick.Data.DataView({groupItemMetadataProvider:n}),r=this.$el.find(".slick");this.dataView=i,r.css({height:"500px",width:"100%"}),e=new Slick.Grid(r,i,x["default"],{headerRowHeight:31,rowHeight:31,forceFitColumns:!0,enableColumnReorder:!1,enableTextSelectionOnCells:!0,sortIndicatorAsc:"fa fa-caret-up",sortIndicatorDesc:"fa fa-caret-down"}),e.registerPlugin(n),i.onRowCountChanged.subscribe(function(t,n){e.updateRowCount(),e.render()}),i.onRowsChanged.subscribe(function(t,n){e.invalidateRows(n.rows),e.render()}),e.onScroll.subscribe(function(e,n){t.$el.find(".state").tooltip("destroy")}),this.grid=e},onShow:function(){var e=this;this.prepareGrid(),this.order.done(function(t){e.prepareData(t),e.$el.find(".loading").hide(),e.dataView.beginUpdate(),e.dataView.setItems(e.groupData),e.dataView.setGrouping({getter:"date",collapsed:!0}),e.dataView.endUpdate(),e.triggerMethod("grid:ready"),e.grid.setColumns(e.grid.getColumns())})},clickExpandAll:function(e){this.dataView.expandAllGroups(),e.preventDefault()},clickCollapseAll:function(e){this.dataView.collapseAllGroups(),e.preventDefault()},clickSlickGroup:function(e){var t=$(e.currentTarget);$(e.target).hasClass("slick-group-toggle")||t.find(".slick-group-toggle").trigger("click")},mouseenterState:function(e){var t=$(e.currentTarget),n=t.data("state"),i=T["default"][n].description;t.tooltip({title:i,trigger:"manual",container:"body"}),t.tooltip("show"),t.data("tooltip-inited",!0)},mouseleaveState:function(e){var t=$(e.currentTarget);t.data("tooltip-inited")&&(t.tooltip("hide"),t.one("hidden.bs.tooltip",function(){t.tooltip("destroy"),t.data("tooltip-inited",!1)}))}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="tools">\n    <a href="#" class="expand-all">展开全部</a>\n    <a href="#" class="collapse-all">收起全部</a>\n    <a href="#" class="download">导出</a>\n</div>\n<button class="btn btn-link clear-filters">清除筛选</button>\n<div class="slick"></div>\n<span class="loading spinner spinner-primary"></span>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<div class="align-left">\n    <i class="fa '+(null==(__t=collapsed)?"":__t)+' slick-group-toggle"></i>\n    <span class="date">'+(null==(__t=date)?"":__t)+"</span>\n    ","0.00"!==buy&&(__p+='\n    <span class="change-up">买 '+(null==(__t=buy)?"":__t)+", </span>\n    "),__p+="\n    ","0.00"!==sell&&(__p+='\n    <span class="change-down">卖 '+(null==(__t=sell)?"":__t)+", </span>\n    "),__p+="\n    共 "+(null==(__t=trade_count)?"":__t)+" 个订单\n</div>\n";return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(464),s=i(a),l=n(537),c=i(l),u=[{name:"下单/成交时间",field:"date",id:"date",formatter:function(e,t,n,i,r){return(r.order_time.split(" ")[1]||"--")+" / "+(r.filled_time.split(" ")[1]||"--")},plainFormatter:function(e,t,n,i,r){return(r.order_time||"--")+" / "+(r.filled_time||"--")},minWidth:140,maxWidth:140,cssClass:"order-time",headerCssClass:"order-time",sortable:!1,filter:"dateRange",filterOptions:{dateFormatter:function(e){return e.replace(/(\d{4})(\d{2})(\d{2})/,function(e,t,n,i){return t+"-"+n+"-"+i})},dateUnformatter:function(e){return e.replace(/-/g,"")}}},{name:"证券代码",field:"symbol",id:"symbol",maxWidth:120,minWidth:120,filter:"select",filterOptions:{multiple:!0}},{name:"买/卖",field:"direction",id:"direction",formatter:function(e,t,n){return 1===n?'<span class="change-up">买入</span>':-1===n?'<span class="change-down">卖出</span>':"--"},plainFormatter:function(e,t,n){return 1===n?"买入":-1===n?"卖出":"--"},minWidth:85,maxWidth:85,filter:"checkbox",filterOptions:{option:[1,-1],optionFormatter:function(e){return 1==e?"买入":-1==e?"卖出":"--"}}},{name:"下单/成交数量(股)",field:"order_amount",id:"order_amount",formatter:function(e,t,n,i,r){var o=s["default"](n).format("0,0"),a=s["default"](r.filled_amount).format("0,0");return o+" / "+a},cssClass:"align-right",minWidth:150,subSort:"filled_amount",filter:{order_amount:"range",filled_amount:"range"},filterOptions:{order_amount:{title:"下单数量",numberFormatter:function(e){return s["default"](e).format("0,0")}},filled_amount:{title:"成交数量",numberFormatter:function(e){return s["default"](e).format("0,0")}}}},{name:"下单/成交价格",id:"price",field:"price",formatter:function(e,t,n,i,r){var o,a;return o="market"===r.type?"市价":s["default"](n).format("0,0.00"),a=s["default"](r.transact_price).format("0,0.00"),o+" / "+a},cssClass:"align-right",minWidth:150,subSort:"transact_price",filter:{type:"checkbox",price:"range",transact_price:"range"},filterOptions:{type:{title:"下单价格",option:["market"],optionFormatter:function(e){return{market:"市价",limit:"限价"}[e]}},transact_price:{title:"成交价格"}}},{name:"成交额",field:"filled_price",id:"filled_price",formatter:function(e,t,n){return s["default"](n).format("0,0.00")},cssClass:"align-right",minWidth:120,maxWidth:120,filter:"range"},{name:"佣金",field:"commission",id:"commission",formatter:function(e,t,n){return s["default"](Math.abs(n)).format("0,0.00")},cssClass:"align-right",minWidth:95,maxWidth:95,filter:"range"},{name:"订单状态",field:"state",id:"state",formatter:function(e,t,n){return c["default"][n]?'<span data-state="'+n+'" class="state">'+c["default"][n].name+"</span>":'<span data-state="Error" class="state">错误</span>'},plainFormatter:function(e,t,n){return c["default"][n]?c["default"][n].name:"错误"},filter:"checkbox",filterOptions:{optionFormatter:function(e){return c["default"][e].name}},minWidth:95}];o["default"].each(u,function(e){e.resizable=!0,e.sortable=o["default"].isUndefined(e.sortable)?!0:e.sortable}),t["default"]=u,e.exports=t["default"]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={AllMake:{name:"全部成交",description:"下达的订单全部成交"},UnMake:{name:"未成交",description:"下达的订单由于当天交易量不足、可用现金不足等原因，全部未成交"},PartMake:{name:"部分成交",description:"下达的订单由于当天交易量不足、可用现金不足等原因，部分成交"},Discard:{name:"丢弃",description:"下单数量为0，做丢弃处理"},NotIncluded:{name:"异常",description:"该证券代码错误，或者未在股票池中定义"},Suspended:{name:"停牌",description:"该证券当天停牌，无法交易"},UpLimit:{name:"涨停",description:"该证券当天一字涨停，无法买入"},DownLimit:{name:"跌停",description:"该证券当天一字跌停，无法卖出"},Error:{name:"错误",description:"未知错误"}},e.exports=t["default"]},function(e,t,n){"use strict";function i(e,t,n){return e.toFixed(2)}var r=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var o=n(45),a=r(o),s=n(537),l=r(s),c=[{name:"下单/成交时间",field:"date",formatter:function(e,t,n){return(n.order_time||"--")+" / "+(n.filled_time||"--")}},{name:"证券代码",field:"symbol"},{name:"买/卖",field:"direction",formatter:function(e){return 1===e?"买入":-1===e?"卖出":"--"}},{name:"下单数量(股)",field:"order_amount"},{name:"成交数量(股)",field:"filled_amount"},{name:"下单价格",field:"price",tofix:!0},{name:"成交价格",field:"transact_price",tofix:!0},{name:"成交额",field:"filled_price",tofix:!0},{name:"佣金",field:"commission",tofix:!0},{name:"订单状态",field:"state",formatter:function(e){return l["default"][e]?l["default"][e].name:"错误"}}];a["default"].each(c,function(e){e.tofix&&(e.formatter=i)}),t["default"]=c,e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(49),o=i(r),a=n(540),s=i(a);t["default"]=o["default"].ItemView.extend({className:"settings-content notebook-detail",template:!1,initialize:function(e){this.settings=e.model.settings()},onRender:function(){var e=this;this.settings.done(function(t){e.$el.html(s["default"](t))})}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="<dl>\n    <dt>回测区间：</dt><dd>"+(null==(__t=start_bt_time)?"":__t)+" 至 "+(null==(__t=end_bt_time)?"":__t)+"</dd>\n    <dt>初始资金：</dt><dd>￥"+(null==(__t=_T.formatDigit(capital_base,"0,0"))?"":__t)+"</dd>\n    <dt>交易频率：</dt><dd>"+(null==(__t="d"===freq?"日间":"日内")?"":__t)+"</dd>\n    <dt>运行开始时间：</dt><dd>"+(null==(__t=_T.formatDatetime(start_run_time,"YYYY-MM-DD HH:mm:ss"))?"":__t)+"</dd>\n    <dt>运行结束时间：</dt><dd>"+(null==(__t=_T.formatDatetime(end_run_time,"YYYY-MM-DD HH:mm:ss"))?"":__t)+"</dd>\n</dl>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj){__p+='<div class="table-description">过去n个月（包含本月）的 '+(null==(__t=description)?"":__t)+'</div>\n<table class="table">\n    <thead>\n        <tr>\n            <th rowspan="2" class="rowspan-th colspan-th">日期</th>\n            <th colspan="3" class="colspan-th">1个月</th>\n            <th colspan="3" class="colspan-th">3个月</th>\n            <th colspan="3" class="colspan-th">6个月</th>\n            <th colspan="3" class="colspan-th">12个月</th>\n        </tr>\n        <tr>\n            <th>策略</th>\n            <th>基准</th>\n            <th class="colspan-bound">超额</th>\n            <th>策略</th>\n            <th>基准</th>\n            <th class="colspan-bound">超额</th>\n            <th>策略</th>\n            <th>基准</th>\n            <th class="colspan-bound">超额</th>\n            <th>策略</th>\n            <th>基准</th>\n            <th class="colspan-bound">超额</th>\n        </tr>\n    </thead>\n    <tbody>\n        ';var NA='<span class="NA">--</span>';__p+="\n        ";var format=function(e){__p+="\n        ",__p+=_.isUndefined(e)?"\n        "+(null==(__t=NA)?"":__t)+"\n        ":'\n        <span class="'+(null==(__t=_T.updown(e))?"":__t)+'">'+(null==(__t=_T.formatDigit(e,"0.00%"))?"":__t)+"</span>\n        ",__p+="\n        "};__p+="\n        ";var row=function(e){__p+="\n        ",e?(__p+="\n        <td>",format(e.st_return),__p+="</td>\n        <td>",format(e.bm_return),__p+="</td>\n        <td>",format(e.excess_return),__p+="</td>\n        "):__p+="\n        <td>"+(null==(__t=NA)?"":__t)+"</td>\n        <td>"+(null==(__t=NA)?"":__t)+"</td>\n        <td>"+(null==(__t=NA)?"":__t)+"</td>\n        ",__p+="\n        "};__p+="\n        ",_.each(data,function(e,t){__p+="\n        <tr>\n            <td>"+(null==(__t=t.replace(/(\d{4})(\d{2})/,function(e,t,n){return t+"/"+n}))?"":__t)+"</td>\n            <td>",format(e.monthly.st_return),__p+="</td>\n            <td>",format(e.monthly.bm_return),__p+="</td>\n            <td>",format(e.monthly.excess_return),__p+="</td>\n            ",row(e.quarter),__p+="\n            ",row(e.semiannual),__p+="\n            ",row(e.annual),__p+="\n        </tr>\n        "}),__p+="\n    </tbody>\n</table>\n"}return __p}},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a),l=n(543),c=i(l);t["default"]=s["default"].ItemView.extend({template:!1,initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.className=this.name+"-content",this.data=e.model.indicator(this.name),this.tpl=c["default"]},onRender:function(){var e,t=this,n={},i=function(t){o["default"].each(e[t],function(e){var i=e.date;n[i]=n[i]||{},n[i][t]=e.value})};this.data.done(function(r){e=r,o["default"].each(o["default"].keys(e),i),t.renderTable(n)})},renderTable:function(e){this.$el.html(this.tpl({data:e,numberFormat:this.format,description:this.description})),this.$el.find("table").DataTable({ordering:!1,paging:!1,scrollY:500,searching:!1,info:!1,scrollCollapse:!0})}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj){__p+='<div class="table-description">过去n个月（包含本月）的 '+(null==(__t=description)?"":__t)+'</div>\n<table class="table">\n    <thead>\n        <th>日期</th>\n        <th>1个月</th>\n        <th>3个月</th>\n        <th>6个月</th>\n        <th>12个月</th>\n    </thead>\n    <tbody>\n        ';var NA='<span class="NA">--</span>';__p+="\n        ";var format=function(e){__p+="\n        ",__p+=_.isUndefined(e)?"\n        "+(null==(__t=NA)?"":__t)+"\n        ":"\n        "+(null==(__t=_T.formatDigit(e,numberFormat))?"":__t)+"\n        ",__p+="\n        "};__p+="\n        ",_.each(data,function(e,t){__p+="\n        <tr>\n            <td>"+(null==(__t=t.replace(/(\d{4})(\d{2})/,function(e,t,n){return t+"/"+n}))?"":__t)+"</td>\n            <td>",format(e.monthly),__p+="</td>\n            <td>",format(e.quarter),__p+="</td>\n            <td>",format(e.semiannual),__p+="</td>\n            <td>",format(e.annual),__p+="</td>\n        </tr>\n        "}),__p+="\n    </tbody>\n</table>\n"}return __p}},function(e,t,n){var i,r;i=[n(49),n(545),n(547)],r=function(e,t,n){return e.ItemView.extend({className:"handle",template:n,ui:{tools:".tools"},events:{"click [data-action]":"clickTool"},initialize:function(t){e.ItemView.prototype.initialize.apply(this,arguments),this.cellType=t.cellType},render:function(){var n=this;e.ItemView.prototype.render.apply(this,arguments);var i=new t({type:this.cellType}).render();return i.$el.addClass("tool"),this.$el.prepend(i.el),i.on("change",function(){n.trigger("typeChange",i.type)}),i.listenTo(this,"changeType",function(e){i.changeValue(e,!0)}),this},clickTool:function(e){var t=$(e.currentTarget).data("action");this.trigger(t)},toggleFoldCode:function(e){var t=this.$el.find(".fold-code");e?t.addClass("folded"):t.removeClass("folded")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(47),n(424),n(546)],r=function(e,t,n,i){return e.ItemView.extend({className:"type-switcher",ui:{name:".type-name",select:".type-select"},events:{"click .type-name":"clickTypeName","click .type-select li":"clickTypeSelectItem"},template:!1,initialize:function(t){e.ItemView.prototype.initialize.apply(this,arguments),this.type=t.type},render:function(){return e.ItemView.prototype.render.apply(this,arguments),this.$el.append(i({type:this.type,typeList:n.types})),this.bindUIElements(),this},onDestroy:function(){t.body.off("click.hideTypeSelect")},changeValue:function(e,t){this.type=e,t||this.trigger("change"),this.$el.empty(),this.render()},clickTypeName:function(e){var n=this;this.ui.select.show(),t.body.one("click.hideTypeSelect",function(){n.ui.select.hide()}),e.stopPropagation()},clickTypeSelectItem:function(e){var t=$(e.currentTarget),n=t.data("value");this.changeValue(n)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<span class="type-name">'+(null==(__t=type)?"":__t)+"<i class='fa fa-caret-down'></i></span>\n<ul class=\"type-select\">\n    ",_.each(typeList,function(e){__p+="\n    <li",e==type&&(__p+=' class="active"'),__p+=' data-value="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</li>\n    "}),__p+="\n</ul>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="tools">\n    <span class="tool fold-code fa fa-chevron-up" data-action="foldCode" data-toggle="tooltip" data-placement="bottom" title="Fold code"></span>\n    <span class="tool delete-cell glyphicon glyphicon-trash" data-action="delete" data-toggle="tooltip" data-placement="bottom" title="删除"></span>\n    <span class="tool move">\n        <i class="up fa fa-arrow-up" data-action="moveUp"></i><i class="down fa fa-arrow-down" data-action="moveDown"></i>\n    </span>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="code">\n    <div class="input-wrapper">\n        <div class="input"></div>\n    </div>\n</div>\n<div class="result-wrapper">\n    <div class="result"></div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="add-cell">\n    <div class="line"></div>\n    <div class="btn-group">\n        <button class="btn btn-air-primary btn-small add-default">\n            <span class="fa fa-plus"></span> 单元\n        </button>\n        <button class="btn btn-air-primary btn-small add-strategy">\n            <span class="fa fa-line-chart"></span> 策略\n        </button>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(551),n(552),n(554)],r=function(e,t,n,i,r,o){return t.ItemView.extend({className:"share-btn",template:o,events:{"click .dropdown-menu":"click","click .cancel":"clickCancel","click .submit":"clickSubmit","show.bs.dropdown .dropdown":"showDropdown"},ui:{dropdown:".dropdown-toggle",form:".create-share",msg:".msg"},initialize:function(e){this.notebook=e.notebook},getAllImage:function(){var t=$.Deferred(),n=[];return this.notebook.$el.find(".cell-code .result img,.result:visible svg").each(function(e,t){t=$(t),t.is("img")?n.push(t.attr("src")):t.is("svg")&&n.push(i(t[0]))}),0===n.length?t.resolve([]):$.when.apply($,n).done(function(){var n=[];e.each(arguments,function(e){n.push(e)}),t.resolve(n)}),t},getAllText:function(){var e="";return this.notebook.$el.find(".cell-markdown .result:visible, .cell-markdown .buffer:visible").each(function(t,n){e+=n.textContent}),e.replace(/\s/g,"")},renderForm:function(){var e=this,t=e.notebook.model.displayName();-1!==t.search(/^untitled/i)&&(t=""),this.getAllImage().done(function(n){e.form=new r({images:n,title:t,notebookName:e.notebook.model.get("name"),summary:e.getAllText()}),e.ui.form.empty(),e.ui.form.append(e.form.render().$el)}),e.ui.dropdown.attr("data-loading-text",'<i class="fa fa-check"></i>分享成功')},toggleDropdown:function(){this.ui.dropdown.dropdown("toggle")},click:function(e){e.stopPropagation()},clickCancel:function(e){this.toggleDropdown()},showDropdown:function(){
this.renderForm(),this.msg(""),this.$el.find("button").button("reset")},msg:function(e){this.ui.msg.text(e)},clickSubmit:function(t){var i=this,r=$(t.currentTarget);r.button("loading"),n.vent.trigger("notebook:save",!1,function(){i.form.submit().done(function(){r.button("reset"),i.toggleDropdown(),i.ui.dropdown.button("loading"),setTimeout(function(){i.ui.dropdown.button("reset")},2e3)}).fail(function(t){e.isNull(t)||i.msg("Share failed, try later.")}).always(function(){r.button("reset")})})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i;i=function(){return function(e){var t=$.Deferred(),n=function(e){return window.btoa(unescape(encodeURIComponent(e)))},i=(new XMLSerializer).serializeToString(e),r=document.createElement("canvas"),o=r.getContext("2d"),a=new Image;return r.width=e.getClientRects()[0].width,r.height=e.getClientRects()[0].height,a.src="data:image/svg+xml;base64,"+n(i),a.onload=function(){o.drawImage(a,0,0),t.resolve(r.toDataURL("image/png"))},t}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i,r;i=[n(45),n(49),n(553)],r=function(e,t,n){return t.ItemView.extend({className:"craete-share-form",template:n,events:{"click .image-selector-item":"clickImageItem","keyup input":"changeInput"},ui:{images:".image-selector"},initialize:function(e){this.images=e.images,this.title=e.title,this.notebookName=e.notebookName,this.summary=e.summary||""},onRender:function(){var t,n=this,i=e.template('<div class="image-selector-item"><div class="thumb"><img src="<%= url %>"></div></div>');this.$el.find("#share-form-title").val(this.title),this.$el.find("#share-form-desc").val(this.summary.substr(0,200)),e.isEmpty(this.images)?this.$el.find(".image-selector").parent().parent().hide():(e.each(this.images,function(e){n.ui.images.append(i({url:e}))}),t=this.ui.images.find(".image-selector-item:first"),t.addClass("active"))},clickImageItem:function(e){var t=$(e.currentTarget);t.addClass("active").siblings().removeClass("active")},changeInput:function(e){var t=$(e.currentTarget),n=t.parents(".form-group");n.hasClass("has-error")&&this.validate()},fieldError:function(e,t){e.parents(".form-group").addClass("has-error"),e.next(".help-block").text(t)},clearError:function(e){e.parents(".form-group").removeClass("has-error"),e.next(".help-block").text("")},validate:function(){var e=this.$el.find("#share-form-title");if(!e.val())return this.fieldError(e,"标题不能为空"),!1;if(e.val().length>100)return this.fieldError(e,"标题长度不能超过100个字符"),!1;this.clearError(e);var t=this.$el.find("#share-form-desc");return t.val().length>200?(this.fieldError(t,"描述不能多于200个字符"),!1):(this.clearError(t),!0)},submit:function(){var e={};return this.validate()?(e.title=this.$el.find("#share-form-title").val(),e.summary=this.$el.find("#share-form-desc").val(),e.thumbnail=this.$el.find(".image-selector-item.active .thumb img").attr("src")||"",e.notebook_name=this.notebookName,$.ajax({url:window.getapi("mercury_community","/thread"),type:"POST",data:JSON.stringify(e),headers:{"content-type":"application/json"}})):$.Deferred().reject(null)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<form class="form-horizontal">\n    <div class="form-group">\n        <label class="col-sm-2 control-label" for="share-form-title">标题</label>\n        <div class="col-sm-10">\n            <input type="text" class="form-control" id="share-form-title">\n            <div class="help-block"></div>\n        </div>\n    </div>\n    <div class="form-group">\n        <label class="col-sm-2 control-label" for="share-form-desc">摘要</label>\n        <div class="col-sm-10">\n            <textarea class="form-control" id="share-form-desc"></textarea>\n            <div class="help-block"></div>\n        </div>\n    </div>\n    <div class="form-group">\n        <label class="col-sm-2 control-label">图表</label>\n        <div class="col-sm-10">\n            <div class="image-selector"></div>\n        </div>\n    </div>\n</form>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="dropdown dropdown-box">\n    <button class="btn btn-link dropdown-toggle" href="#" data-toggle="dropdown">\n        <i class="fa fa-share-alt"></i>分享到社区\n    </button>\n    <div class="dropdown-menu">\n        <div class="dropdown-box-body create-share"></div>\n        <div class="btns">\n            <button class="cancel btn btn-link">取消</button>\n            <button class="submit btn btn-primary" data-loading-text="分享中...">确定</button>\n        </div>\n        <div class="msg"></div>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(47),n(116),n(556),n(286),n(157),n(557),n(424),n(558)],r=function(e,t,n,i,r,o,a,s,l,c,u){return t.Controller.extend({initialize:function(e){this.view=e.view,this.bindEvents()},onDestroy:function(){this.stopListening()},bindEvents:function(){var t=this,n=[],r=function o(r){e.each(r,function(r){r.items&&o(r.items),t[r.action]&&!e.contains(n,r.action)&&(t.listenTo(i.menuVent,r.action,e.bind(t[r.action],t)),n.push(r.action))})};e.each(l,function(e){r(e.items)})},save:function(){this.view.save()},download:function(e){var t;"ipython"===e?(t=window.getapi("mercury","/files/"+encodeURIComponent(this.view.model.get("name"))),a(t)):"python"===e&&(t=window.getapi("mercury","/nbconvert/python/"+encodeURIComponent(this.view.model.get("name"))+"?download=true"),a(t))},publishLibrary:function(){var t=this,n="";this.view.save(!1,function(){var i=t.view.model.cells();e.each(i,function(e,t){e.cell_type&&"code"===e.cell_type&&(n+=e.input,t!==i.length-1&&(n+="\n"))}),new u({code:n,name:t.view.model.displayName()}).render()})},restartKernel:function(){var e=this,t=n.Confirm({title:"重启微核确认",content:"重启微核后，您本次Notebook的运行信息将被清空。是否继续重启？",yes:function(){e.view.kernel.restart()}});t.$el.on("hidden.bs.modal",function(){t.destroy()})},interrupt:function(){this.view.kernel.interrupt()},runCell:function(){this.view.list.focusedChild.trigger("run")},runAndNext:function(){this.view.list.focusedChild.trigger("runAndNext")},runAndAdd:function(){this.view.list.focusedChild.trigger("runAndAdd")},runAll:function(){var e=this;this.view.list.$el.find(".cell").each(function(t,n){var i=e.view.list.children.filter(function(e){return e.el===n})[0];i&&(i.trigger("run"),0===t&&e.view.list.focusChild(i,!0))})},runAbove:function(){var e=this,t=this.view.list.focusedChild.el,n=this.view.list.$el.find(".cell").index(t);this.view.list.$el.find(".cell").each(function(t,i){if(!(t>=n)){var r=e.view.list.children.filter(function(e){return e.el===i})[0];r&&(r.trigger("run"),0===t&&e.view.list.focusChild(r,!0))}})},runBelow:function(){var e=this,t=this.view.list.focusedChild.el,n=this.view.list.$el.find(".cell").index(t);this.view.list.$el.find(".cell").each(function(t,i){if(!(n>=t)){var r=e.view.list.children.filter(function(e){return e.el===i})[0];r&&(r.trigger("run"),t===n+1&&e.view.list.focusChild(r,!0))}})},toggle:function(e){if("output"===e){var t=this.view.list.focusedChild.$el.find(".result-toggler");this.view.list.focusedChild.toggleResult(t)}else"input"===e&&this.view.list.focusedChild.foldCode()},clear:function(e){"output"===e&&this.view.list.focusedChild.clearResult()},changeType:function(e){this.view.list.focusedChild.model.convert(e)},copy:function(){var t=this,i=e.template('复制出的Notebook是: <a href="#" data-href="<%= url %>"><%= name %></a>');this.view.model.copy().then(function(e){var r=e.name,o=n.Alert({title:"Copy "+t.view.model.get("name"),content:i({name:r,url:new s({name:e.name}).appUrl()})});o.$el.on("click","a",function(){o.hide()}).on("bs.hidden.modal",function(){o.$el.remove()})})},deleteCell:function(){this.view.list.focusedChild.deleteConfirm()},cutCell:function(){var e=this.view.list.focusedChild;o.push(e.model.toJSON()),this.view.list.collection.remove(e.model)},copyCell:function(){var e=this.view.list.focusedChild,t=e.model.toJSON();o.push(t)},pasteCell:function(){var e=this.view.list.focusedChild,t=this.view.list.$el.find(".cell"),n=t.index(e.el)+1,i=o.pop();i&&this.view.list.collection.add(new c(i),{at:n})},addCell:function(){var e,t=new c({cell_type:"code","new":!0}),n=this.view.list.focusedChild;e=n?this.view.list.$el.find(".cell").index(n.el)+1:0,this.view.list.collection.add(t,{at:e})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(47)],r=function(e,t){return t.module("Clipboard",function(t){var n=null;t.isEmpty=function(){return e.isNull(n)},t.push=function(e){n=e},t.pop=function(){return n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(302),n(424)],r=function(e,t,n){var i=[{title:"文件",items:[{title:"保存",action:"save",shortcut:"ctrl+s"},{title:"复制",action:"copy"},{title:"另存为Library",action:"publishLibrary"},{title:"下载",items:[{title:"Notebook(.nb)",action:"download",param:"ipython"},{title:"Python(.py)",action:"download",param:"python"}]}]},{title:"编辑",items:[{title:"复制单元",action:"copyCell"},{title:"剪切单元",action:"cutCell"},{title:"粘贴单元",action:"pasteCell"},{title:"添加单元",action:"addCell"},{title:"删除单元",action:"deleteCell"}]},{title:"单元",items:[{title:"类型",items:e.map(n.types,function(e){return{title:t.capitalize(e),action:"changeType",param:e}})},{title:"输出",items:[{title:"显示/隐藏",action:"toggle",param:"output"},{title:"清除",action:"clear",param:"output"}]},{title:"输入",items:[{title:"显示/隐藏",action:"toggle",param:"input"}]}]},{title:"运行",items:[{title:"运行",action:"runCell",shortcut:"ctrl+enter"},{title:"运行并继续",action:"runAndNext",shortcut:"shift+enter"},{title:"运行并添加",action:"runAndAdd",shortcut:"alt+enter"},{divider:!0},{title:"运行全部",action:"runAll"},{title:"运行之后的单元",action:"runBelow"},{title:"运行之前的单元",action:"runAbove"},{divider:!0},{title:"停止运行",action:"interrupt"}]},{title:"微核",items:[{title:"重启",action:"restartKernel"}]}];return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(559),n(292),n(560),n(561)],r=function(e,t,n,i,r,o,a){return t.ItemView.extend({template:!1,initialize:function(e){this.code=e.code,this.name=e.name},onRender:function(){var e,t=this,i=function(t){e.$el.find(".form-group").find(".help-block.error-msg").append(t).end().addClass("has-error")},a=function(){e.$el.find(".form-group").find(".help-block.error-msg").empty().end().removeClass("has-error")};e=new n({title:"创建Library"}),e.body.append(o()),e.footer.append(e.body.find(".footer-els")),this.input=e.$el.find('input[type="text"]'),this.input.val(this.name),e.$el.addClass("publish-library-modal"),e.$el.on("hidden.bs.modal",function(){e.destroy()}).on("keyup",".form-control",function(){a(),t.trigger("change:name")}).on("click",".btn-primary",function(){a();var e=t.input.val();return e?(new r).validateName(e)?void t.submit(e):void i(t.namingError()):void i("Library名称不能为空")}).on("click",".btn-danger",function(){t.submit(t.input.val(),!0)}),this.m=e,this.modalError=i},namingError:function(){var e=$(a());return e.on("click","a",function(t){e.find("ol").show(),t.preventDefault()}),e},submit:function(e,t){var n,i,o,a,s=this,l=new r,c=this.m.$el.find(".modal-footer .btn-primary"),u=c.prev(".confirm-msg");n=function(){u.html(""),c.button("reset").removeClass("btn-danger").addClass("btn-primary").html("创建")},i=function(){u.html("该Library已存在, 请尝试其它名称或替换"),c.button("reset"),setTimeout(function(){c.removeClass("btn-primary").addClass("btn-danger").html("确认替换")},0),s.off("change:name"),s.on("change:name",function(){n()})},o=function(){l.save({},{attrs:{code:s.code,name:e+".py"},success:function(){n(),s.m.hide()},error:function(e,t){400===t.status&&-1!==t.responseText.search(/invalid/i)&&s.codeError(),n()}})},c.attr("data-loading-text","处理中...").button("loading"),l.set("name",e+".py"),a=l.fetch(),a.done(function(){t?(l.unset("name"),o()):i()}).fail(function(e){404===e.status&&(l.unset("name"),o())})},codeError:function(){this.m.hide();var e=n.Alert({title:"创建Library失败",content:"您的代码中使用了我们不支持的属性。您可以通过运行全部单元，查看具体位置与内容。"});e.$el.on("hidden.bs.modal",function(){e.destroy()})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45)],r=function(e){var t=window.localStorage||{};return{get:function(n,i){return e.isUndefined(t[n])?i:t[n]},set:function(e,n){t[e]=n}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="form-group">\n    <div class="input-group">\n        <span class="input-group-addon">lib.</span>\n        <input class="text form-control" type="text" placeholder="Library名称">\n    </div>\n    <div class="help-block error-msg"></div>\n    <div class="help-block">\n        <ul>\n            <li>Markdown、Strategy两种单元模式将被忽略；</li>\n            <li>请确保Notebook中的Code单元可以在本平台正常运行。</li>\n            <li><a href="help/faq#Library是干什么的" target="_blank">Library帮助</a></li>\n        </ul>\n    </div>\n</div>\n<div class="confirm-msg footer-els"></div>\n<button class="btn btn-primary footer-els" data-loading-text="处理中...">创建</button>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="naming-error">\n    Library名称不符合<a href="#">命名规范</a>\n    <ol>\n        <li>Library名称只能是长度在20个字符以内</li>\n        <li>只包含数字, 字母或下划线, 并且不能以数字开头</li>\n        <li>不可以是python的保留字</li>\n    </ol>\n</div>\n';return __p}},function(e,t,n){var i;i=function(){return[[{icon:"outdent",action:"runAll",title:"运行全部"},{icon:"play",action:"runAndNext",title:"运行并继续"},{icon:"stop",action:"interrupt",title:"停止运行"}],[{icon:"plus",action:"addCell",title:"添加"},{icon:"copy",action:"copyCell",title:"复制"},{icon:"cut",action:"cutCell",title:"剪切"},{icon:"paste",action:"pasteCell",title:"粘贴"}],[{icon:"floppy-o",action:"save",title:"保存"},{icon:"repeat",action:"restartKernel",title:"重启微核"}]]}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t,n){var i;i=function(){return{"ctrl+enter":"runCell","alt+enter":"runAndAdd","shift+enter":"runAndNext","ctrl+s":"save"}}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="cells"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(116),n(287)],r=function(e,t,n,i,r){return t.ItemView.extend({template:!1,className:"data-detail",initialize:function(o){var a=this,s=i.get("datas"),l=s.get(o.name);l?l.set("current",!0):(l=new r({name:o.name,current:!0}),s.add(l)),this.model=l,t.ItemView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,{destroy:function(){a.model.get("current")&&n.Route.navigate("labs/",{trigger:!0})},"change:content":function(){a.$el.empty(),a.render()}}),this.model.fetch().done(function(){a.model.set("fetched",!0)}).fail(function(e){404===e.status?n.Route.notFound():500===e.status?(a.model.set("fetched",!0),a.render(),a.encodingError()):413===e.status&&(a.model.set("fetched",!0),a.render(),a.sizeError())}),n.vent.trigger("title:reset",{title:this.model.get("name"),editTitle:this.model.filename()}),this.listenTo(n.vent,"title:change",function(t,i){a.model.validateName(t)||(t+=a.model.extname()),a.model.save({},{attrs:e.extend(a.model.toJSON(),{name:t}),success:function(){n.Route.navigate(a.model.appUrl(),{trigger:!1}),n.vent.trigger("title:reset",{title:a.model.get("name"),editTitle:a.model.filename(),edit:!0}),i.hide()},error:function(e,t){409===t.status&&i.error("File exists. Try other name.")}})})},onDestroy:function(){this.stopListening(),this.model.get("fetched")?this.model.set("current",!1):(this.model.clear({silent:!0}),this.model.destroy())},onRender:function(){var t=this.model.get("content");t&&("table"===t.type?(this.$el.append('<p class="preview-intro">(预览前100行, GBK编码)</p>'),this.$el.append(this.tableFromCSV(t.data))):(this.$el.append('<p class="preview-intro">(GBK编码)</p>'),this.$el.append(e.template("<div><%- data %></div>")({data:t.data}))))},encodingError:function(){this.$el.append('<p class="preview-error">文件内容预览失败，可能是文件编码方式不支持导致，默认编码方式为GBK</p>')},sizeError:function(){this.$el.append('<p class="preview-error">文件内容预览失败，不能预览大小超过100M的文件</p>')},tableFromCSV:function(t){var n=function(t,n){return n=n||"td","<tr>"+e.map(t,function(e){return"<"+n+">"+e+"</"+n+">"}).join("")+"</tr>"},i='<table class="table table-striped table-bordered"><thead><%= thead %></thead><tbody><%= tbody %></tbody></table>',r="",o="";return e.each(t,function(e,t){0===t?r+=n(e,"th"):o+=n(e)}),e.template(i)({thead:r,tbody:o})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(47),n(116),n(162),n(292),n(175)],r=function(e,t,n,i,r,o){return t.ItemView.extend({template:!1,className:"library-detail",initialize:function(e){var r=this,a=e.name+".py",s=i.get("libraries"),l=s.get(a);l?l.set("current",!0):(l=new o({name:a,current:!0}),s.add(l)),this.model=l,t.ItemView.prototype.initialize.apply(this,arguments),this.listenTo(this.model,{destroy:function(){r.model.get("current")&&n.Route.navigate("labs/",{trigger:!0})},"change:content":function(){r.render()}}),this.model.fetch().done(function(){r.model.set("fetched",!0)}).fail(function(e){404===e.status?n.Route.notFound():500===e.status&&(r.render(),r.encodingError())}),n.vent.trigger("title:reset",{title:this.model.filename(),edit:!1})},onDestroy:function(){this.stopListening(),this.model.get("fetched")&&this.model.set("current",!1)},onRender:function(){var e,t=this.model.get("content");t&&(e=$('<div class="code"></div>'),this.$el.empty().append(e),this.editor=r(e[0],{value:t,readOnly:!0,mode:"python"}))},onShow:function(){this.editor&&this.editor.refresh()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(76)],r=function(e){return e.NestedModel.extend({defaults:{profile:{}},url:window.getapi("mercury_community","/profile"),initialize:function(){this.deferred=$.Deferred()},parse:function(e){return e.data||{}},fetch:function(){var t=this;return e.NestedModel.prototype.fetch.apply(this,arguments).done(function(){t.deferred.resolve()}).fail(function(){t.deferred.reject()})},guideDone:function(e){var t=$.Deferred();return this.get("profile.guide")===e&&t.resolve(),this.save({profile:{guide:e}},{success:function(){t.resolve()},error:function(){t.reject()}}),t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="filters">\n    <div class="filter-btns">\n\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(570),n(589),n(590)],r=function(e,t,n){return e.extend({initialize:function(i){e.prototype.initialize.apply(this,arguments),this.model=new t({id:i.id}),this.details=n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(464),n(115),n(47),n(84),n(465),n(443),n(571),n(586),n(587),n(588),n(175)],r=function(e,t,n,i,r,o,a,s,l,c,u,d){return t.ItemView.extend({className:"strategy-detail",template:c,events:{'shown.bs.tab a[data-toggle="tab"]':"shownTab","click .terminate":"clickTerminate","click .delete":"clickDelete"},ui:{summary:".summary",actions:".actions"},initialize:function(e){this.model=new s({id:e.id}),this.initTab=e.tab||"overview",this.tabs={},this.details=l,$(document.body).addClass("strategy-detail-white")},onDestroy:function(){$(document.body).removeClass("strategy-detail-white")},render:function(){var e=this;return this.model.fetch().done(function(){t.ItemView.prototype.render.apply(e),e.renderActions()}).fail(function(e){404===e.status&&r.Route.notFound()}),this},serializeData:function(){var e=this.model.toJSON();return e.statusStr=this.model.getStatus(),e.statusClassStr=this.model.getStatusClass(),e.isContestStr=this.model.getContest(),e.isContestClassStr=this.model.getContestClass(),e},onRender:function(){var t=this;r.vent.trigger("title",this.model.get("name")),this.model.details("summary").done(function(i){t.model.set(i),t.$el.find(".nav ."+t.initTab).tab("show"),t.ui.summary.empty().append(u({fund_return:n(i.fund_return).format("+0.00%"),fund_return_class:a(i.fund_return),daily_return:n(i.daily_return).format("+0.00%"),daily_return_class:a(i.daily_return),sharpe:e.isNull(i.sharpe)?"--":n(i.sharpe).format("0.00"),market_value:n(i.market_value).format("0,0.00"),current_cash:n(i.current_cash).format("0,0.00")}))})},renderActions:function(){var e=this.model.toJSON();e.statusStr=this.model.getStatus(),e.statusClassStr=this.model.getStatusClass(),e.isContestStr=this.model.getContest(),e.isContestClassStr=this.model.getContestClass(),this.ui.actions.empty().append(d(e))},shownTab:function(e){var t,n,i,o,a=$(e.target);n=a.attr("href").split("-")[2],e.relatedTarget&&(t=$(e.relatedTarget),t=t.attr("href").split("-")[2],this.tabs[t].triggerMethod("tabHide")),i=this.$el.find(".tab-content ."+n),this.tabs[n]?this.tabs[n].triggerMethod("tabShow"):(o=new this.details[n]({model:this.model}),i.append(o.render().el),o.triggerMethod("show"),o.triggerMethod("tabShow"),this.tabs[n]=o),r.Route.navigate(this.model.appUrl()+"/"+n,{trigger:!1,replace:this.initTab?!0:!1}),this.initTab=null},clickTerminate:function(e){var t=this,n=$(e.currentTarget),r=1==this.model.get("is_contest")?"确定终止此策略吗? 终止后，该策略将停止参赛。":"确定终止此策略吗?",o=i.Confirm({title:"终止确认",content:r,yes:function(){n.button("loading"),t.model.terminate().always(function(){n.button("reset"),t.renderActions()})}});o.$el.on("hidden.bs.modal",function(){o.destroy()}),e.preventDefault()},clickDelete:function(e){var t=this,n=$(e.currentTarget),o=i.Confirm({title:"删除确认",content:"确定删除此策略吗?",yes:function(){n.button("loading"),t.model.destroy({success:function(){n.button("reset"),r.Route.navigate("trade/strategies",{trigger:!0})},error:function(){n.button("reset")}})}});o.$el.on("hidden.bs.modal",function(){o.destroy()}),e.preventDefault()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(572),n(577),n(581),n(583),n(584)],r=function(e,t,n,i,r){return{overview:e,risk:t,log:n,code:i,settings:r}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(464),n(85),n(465),n(574),n(573),n(575),n(576),n(183),n(409),n(410)],r=function(e,t,n,i,r,o,a){var s=[{title:"证券代码",data:"tickerSymbol"},{title:"证券名称",data:"securityName"},{title:"持仓数量",data:"holdingQuantity"},{title:"市价",data:"marketPrice"},{title:"市值",data:"marketValue"},{title:"当日涨跌",data:"dailyReturn",render:function(e,t){if("display"===t){var i="<span class="+r(e)+">"+n(e).format("+0.00%")+"</span>";return i}return e}},{title:"权重",data:"weight",render:function(e,t){return"display"===t?n(e).format("0.00%"):e}}],l={order:[[6,"desc"]]},c=[{title:"证券代码",data:"ticker"},{title:"证券名称",data:"name",render:function(e,t){return"display"===t?e||"--":e}},{title:"买/卖",data:"side",render:function(e,t){return"display"===t?"BUY"===e?'<span class="change-up">买入</span>':'<span class="change-down">卖出</span>':e}},{title:"下单数量",data:"amount"},{title:"成交数量",data:"filled_amount",render:function(e,t){return"display"===t?e||"--":e}},{title:"下单时间",data:"place_time",render:function(e,t){return"display"===t?e?i(e).format("HH:mm:ss"):"--":e}},{title:"成交时间",data:"execution_time",render:function(e,t){return"display"===t?e?i(e,"HH:mm:ss").format("HH:mm:ss"):"--":e}},{title:"成交均价",data:"execution_avg_price",render:function(e,t){return"display"===t?e?n(e).format("0.00"):"--":e}},{title:"状态",data:"status",render:function(e,t,n){return"display"===t&&n.mark?e+'<span class="fa fa-exclamation-circle mark-tips" data-toggle="tooltip" data-placement="top" title="'+n.mark+'"></span>':e},width:"9em"}];return t.ItemView.extend({className:"detail-overview",template:a,initialize:function(e){this.model=e.model},events:{"draw.dt .order":function(){this.$el.find('[data-toggle="tooltip"]').tooltip({container:"body"})}},onRender:function(){Highcharts.setOptions({global:{useUTC:!1,timezoneOffset:-480}}),this.initDatepicker()},onShow:function(){var e=this;this.model.details("position").done(function(t){e.positionTable(t)}),this.model.details("order").done(function(t){e.orderTable(t)}),this.model.details("indicator_curve").done(function(t){e.returnsChart(t.cum_returns,t.index_returns),e.drawdownChart(t.max_drawdown)})},initDatepicker:function(){var t=this,n=this.$el.find(".position .date input"),r=this.$el.find(".order .date input"),o=this.$el.find(".date .input-group-addon");n.datepicker({dateFormat:"yy-mm-dd",minDate:new Date(this.model.get("create_time")),maxDate:new Date,changeYear:!0,changeMonth:!0,onSelect:function(){t.appendLoading("position"),t.model.details("position",{date:this.value}).done(function(e){t.positionTable(e)})}}).attr("placeholder",i().format("YYYY-MM-DD")),this.model.details("order",{calendar:1}).done(function(n){r.datepicker({dateFormat:"yy-mm-dd",minDate:new Date(t.model.get("create_time")),maxDate:new Date,changeYear:!0,changeMonth:!0,beforeShow:function(e,t){setTimeout(function(){t.dpDiv.append('<div class="tips">没有调仓的日期不可选</div>')},10)},beforeShowDay:function(t){return t=i(t).format("YYYYMMDD"),[e.include(n,t)]},onSelect:function(){t.appendLoading("order"),t.model.details("order",{date:this.value}).done(function(e){t.orderTable(e)})}}).attr("placeholder",i().format("YYYY-MM-DD"))}),o.on("click",function(e){var t=$(e.currentTarget);t.focus().prev().datepicker("show")})},onTabShow:function(){this.$el.find(".panel-body .chart").each(function(e,t){var n=$(t).highcharts();n&&n.reflow()}),this.positionDT&&this.positionDT.draw(),this.orderDT&&this.orderDT.draw()},clearLoading:function(e){this.$el.find("."+e+" .panel-body .loading").remove()},appendLoading:function(e){var t=$('<div class="loading"><span class="spinner primary"></span></div>'),n=this.$el.find("."+e+" .panel-body");n.append(t),t.height(n.height())},datatable:function(t,n,i){var r=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];return t.DataTable(e.extend({ordering:!0,dom:"tS",paging:!1,deferRender:!0,scrollY:368,data:n,columns:i,language:{emptyTable:"没有数据"}},r))},positionTable:function(e){this.clearLoading("position"),this.positionDT?(this.positionDT.rows().remove(),this.positionDT.rows.add(e).draw()):this.positionDT=this.datatable(this.$el.find(".position .panel-body").empty().append('<table class="table"></table>').find(".table"),e,s,l)},orderTable:function(e){this.clearLoading("order"),this.orderDT?(this.orderDT.rows().remove(),this.orderDT.rows.add(e).draw()):this.orderDT=this.datatable(this.$el.find(".order .panel-body").empty().append('<table class="table"></table>').find(".table"),e,c)},returnsChart:function(t,r){this.clearLoading("return"),this.$el.find(".return .panel-body").append('<div class="chart"></div>').find(".chart").highcharts(o.simpleChartOptions({plotOptions:{spline:{marker:{enabled:e.size(t)>1?!1:!0}}},yAxis:{title:{text:""},labels:{formatter:function(){return n(this.value).format("0.00%")}}},series:[{name:"策略",data:e.map(t,function(e,t){return[+i(t,"YYYYMMDD"),e-1]})},{name:"沪深300",data:e.map(r,function(e,t){return[+i(t,"YYYYMMDD"),e-1]})}]}))},drawdownChart:function(t){this.clearLoading("drawdown"),this.$el.find(".drawdown .panel-body").append('<div class="chart"></div>').find(".chart").highcharts(o.simpleChartOptions({plotOptions:{area:{marker:{enabled:e.size(t)>1?!1:!0}}},chart:{spacingTop:30,height:250,type:"area"},series:[{name:"回撤",data:e.map(t,function(e,t){return[+i(t,"YYYYMMDD"),e]})}]}))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="row">\n    <div class="col-md-6">\n        <div class="panel panel-default return">\n            <div class="panel-heading">累积收益率</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="col-md-6">\n        <div class="panel panel-default drawdown">\n            <div class="panel-heading">回撤走势</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="panel panel-default position">\n    <div class="panel-heading">\n        证券持仓\n        <div class="date">\n            <div class="input-group input-group-sm">\n                <input name="date" type="text" class="form-control" readonly>\n                <span class="input-group-addon">\n                    <i class="fa fa-calendar"></i>\n                </span>\n            </div>\n        </div>\n    </div>\n    <div class="panel-body">\n        <div class="loading">\n            <span class="spinner primary"></span>\n        </div>\n    </div>\n</div>\n<div class="panel panel-default order">\n    <div class="panel-heading">\n        调仓记录\n        <div class="date">\n            <div class="input-group input-group-sm">\n                <input name="date" type="text" class="form-control" readonly>\n                <span class="input-group-addon">\n                    <i class="fa fa-calendar"></i>\n                </span>\n            </div>\n        </div>\n    </div>\n    <div class="panel-body">\n        <div class="loading">\n            <span class="spinner primary"></span>\n        </div>\n    </div>\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(464)],r=function(e,t){return{simpleTootip:function(n){return function(){var i="<b>"+Highcharts.dateFormat("%Y-%m-%d",this.x)+"</b>",r=e.template('<br><span style="color:<%= color %>"><%= name %></span>: <%= y %>');return n=n||{},e.each(this.points,function(e){i+=r({name:e.series.name,color:e.series.color,y:t(e.y).format(n.yFormat||"0.00%")})}),i}},simpleChartOptions:function(n){var i=this;return e.defaults(n||{},{title:{text:""},credits:{enabled:!1},chart:{spacingTop:30,height:250,type:"spline"},legend:{enabled:!1},xAxis:{type:"datetime",dateTimeLabelFormats:{millisecond:"%m-%d",second:"%m-%d",minute:"%m-%d",hour:"%m-%d",day:"%m-%d",week:"%m-%d",month:"%Y-%m-%d",year:"%Y"},minPadding:.04,maxPadding:.04,minTickInterval:864e5},yAxis:{title:{text:""},labels:{formatter:function(){return t(this.value).format("0.00%")}}},tooltip:{shared:!0,formatter:i.simpleTootip()}})}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r,o;!function(a,s,l){!function(a){"use strict";r=[n(77)],i=a,o="function"==typeof i?i.apply(t,r):i,!(o!==l&&(e.exports=o))}(function(e){"use strict";function t(n){var i,r,o="a aa ai ao as b fn i m o s ",a={};e.each(n,function(e,s){i=e.match(/^([^A-Z]+?)([A-Z])/),i&&-1!==o.indexOf(i[1]+" ")&&(r=e.replace(i[0],i[2].toLowerCase()),a[r]=e,"o"===i[1]&&t(n[e]))}),n._hungarianMap=a}function n(i,r,o){i._hungarianMap||t(i);var a;e.each(r,function(t,s){a=i._hungarianMap[t],a===l||!o&&r[a]!==l||("o"===a.charAt(0)?(r[a]||(r[a]={}),e.extend(!0,r[a],r[t]),n(i[a],r[a],o)):r[a]=r[t])})}function i(e){var t=Ge.defaults.oLanguage,n=e.sZeroRecords;!e.sEmptyTable&&n&&"No data available in table"===t.sEmptyTable&&Ne(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&n&&"Loading..."===t.sLoadingRecords&&Ne(e,e,"sZeroRecords","sLoadingRecords"),e.sInfoThousands&&(e.sThousands=e.sInfoThousands);var i=e.sDecimal;i&&Ue(i)}function r(e){vt(e,"ordering","bSort"),vt(e,"orderMulti","bSortMulti"),vt(e,"orderClasses","bSortClasses"),vt(e,"orderCellsTop","bSortCellsTop"),vt(e,"order","aaSorting"),vt(e,"orderFixed","aaSortingFixed"),vt(e,"paging","bPaginate"),vt(e,"pagingType","sPaginationType"),vt(e,"pageLength","iDisplayLength"),vt(e,"searching","bFilter"),"boolean"==typeof e.sScrollX&&(e.sScrollX=e.sScrollX?"100%":"");var t=e.aoSearchCols;if(t)for(var i=0,r=t.length;r>i;i++)t[i]&&n(Ge.models.oSearch,t[i])}function o(t){vt(t,"orderable","bSortable"),vt(t,"orderData","aDataSort"),vt(t,"orderSequence","asSorting"),vt(t,"orderDataType","sortDataType");var n=t.aDataSort;n&&!e.isArray(n)&&(t.aDataSort=[n])}function c(t){var n=t.oBrowser,i=e("<div/>").css({position:"fixed",top:0,left:0,height:1,width:1,overflow:"hidden"
}).append(e("<div/>").css({position:"absolute",top:1,left:1,width:100,overflow:"scroll"}).append(e('<div class="test"/>').css({width:"100%",height:10}))).appendTo("body"),r=i.find(".test");n.bScrollOversize=100===r[0].offsetWidth,n.bScrollbarLeft=1!==Math.round(r.offset().left),n.bBounding=i[0].getBoundingClientRect().width?!0:!1,i.remove()}function u(e,t,n,i,r,o){var a,s=i,c=!1;for(n!==l&&(a=n,c=!0);s!==r;)e.hasOwnProperty(s)&&(a=c?t(a,e[s],s,e):e[s],c=!0,s+=o);return a}function d(t,n){var i=Ge.defaults.column,r=t.aoColumns.length,o=e.extend({},Ge.models.oColumn,i,{nTh:n?n:s.createElement("th"),sTitle:i.sTitle?i.sTitle:n?n.innerHTML:"",aDataSort:i.aDataSort?i.aDataSort:[r],mData:i.mData?i.mData:r,idx:r});t.aoColumns.push(o);var a=t.aoPreSearchCols;a[r]=e.extend({},Ge.models.oSearch,a[r]),h(t,r,e(n).data())}function h(t,i,r){var a=t.aoColumns[i],s=t.oClasses,c=e(a.nTh);if(!a.sWidthOrig){a.sWidthOrig=c.attr("width")||null;var u=(c.attr("style")||"").match(/width:\s*(\d+[pxem%]+)/);u&&(a.sWidthOrig=u[1])}r!==l&&null!==r&&(o(r),n(Ge.defaults.column,r),r.mDataProp===l||r.mData||(r.mData=r.mDataProp),r.sType&&(a._sManualType=r.sType),r.className&&!r.sClass&&(r.sClass=r.className),e.extend(a,r),Ne(a,r,"sWidth","sWidthOrig"),r.iDataSort!==l&&(a.aDataSort=[r.iDataSort]),Ne(a,r,"aDataSort"));var d=a.mData,h=D(d),p=a.mRender?D(a.mRender):null,f=function(e){return"string"==typeof e&&-1!==e.indexOf("@")};a._bAttrSrc=e.isPlainObject(d)&&(f(d.sort)||f(d.type)||f(d.filter)),a.fnGetData=function(e,t,n){var i=h(e,t,l,n);return p&&t?p(i,t,e,n):i},a.fnSetData=function(e,t,n){return M(d)(e,t,n)},"number"!=typeof d&&(t._rowReadObject=!0),t.oFeatures.bSort||(a.bSortable=!1,c.addClass(s.sSortableNone));var m=-1!==e.inArray("asc",a.asSorting),g=-1!==e.inArray("desc",a.asSorting);a.bSortable&&(m||g)?m&&!g?(a.sSortingClass=s.sSortableAsc,a.sSortingClassJUI=s.sSortJUIAscAllowed):!m&&g?(a.sSortingClass=s.sSortableDesc,a.sSortingClassJUI=s.sSortJUIDescAllowed):(a.sSortingClass=s.sSortable,a.sSortingClassJUI=s.sSortJUI):(a.sSortingClass=s.sSortableNone,a.sSortingClassJUI="")}function p(e){if(e.oFeatures.bAutoWidth!==!1){var t=e.aoColumns;ye(e);for(var n=0,i=t.length;i>n;n++)t[n].nTh.style.width=t[n].sWidth}var r=e.oScroll;(""!==r.sY||""!==r.sX)&&ge(e),Fe(e,null,"column-sizing",[e])}function f(e,t){var n=v(e,"bVisible");return"number"==typeof n[t]?n[t]:null}function m(t,n){var i=v(t,"bVisible"),r=e.inArray(n,i);return-1!==r?r:null}function g(e){return v(e,"bVisible").length}function v(t,n){var i=[];return e.map(t.aoColumns,function(e,t){e[n]&&i.push(t)}),i}function y(e){var t,n,i,r,o,a,s,c,u,d=e.aoColumns,h=e.aoData,p=Ge.ext.type.detect;for(t=0,n=d.length;n>t;t++)if(s=d[t],u=[],!s.sType&&s._sManualType)s.sType=s._sManualType;else if(!s.sType){for(i=0,r=p.length;r>i;i++){for(o=0,a=h.length;a>o&&(u[o]===l&&(u[o]=k(e,o,t,"type")),c=p[i](u[o],e),c||i===p.length-1)&&"html"!==c;o++);if(c){s.sType=c;break}}s.sType||(s.sType="string")}}function b(t,n,i,r){var o,a,s,c,u,h,p,f=t.aoColumns;if(n)for(o=n.length-1;o>=0;o--){p=n[o];var m=p.targets!==l?p.targets:p.aTargets;for(e.isArray(m)||(m=[m]),s=0,c=m.length;c>s;s++)if("number"==typeof m[s]&&m[s]>=0){for(;f.length<=m[s];)d(t);r(m[s],p)}else if("number"==typeof m[s]&&m[s]<0)r(f.length+m[s],p);else if("string"==typeof m[s])for(u=0,h=f.length;h>u;u++)("_all"==m[s]||e(f[u].nTh).hasClass(m[s]))&&r(u,p)}if(i)for(o=0,a=i.length;a>o;o++)r(o,i[o])}function _(t,n,i,r){var o=t.aoData.length,a=e.extend(!0,{},Ge.models.oRow,{src:i?"dom":"data",idx:o});a._aData=n,t.aoData.push(a);for(var s=t.aoColumns,c=0,u=s.length;u>c;c++)i&&S(t,o,c,k(t,o,c)),s[c].sType=null;t.aiDisplayMaster.push(o);var d=t.rowIdFn(n);return d!==l&&(t.aIds[d]=a),(i||!t.oFeatures.bDeferRender)&&j(t,o,i,r),o}function w(t,n){var i;return n instanceof e||(n=e(n)),n.map(function(e,n){return i=I(t,n),_(t,i.data,n,i.cells)})}function x(e,t){return t._DT_RowIndex!==l?t._DT_RowIndex:null}function C(t,n,i){return e.inArray(i,t.aoData[n].anCells)}function k(e,t,n,i){var r=e.iDraw,o=e.aoColumns[n],a=e.aoData[t]._aData,s=o.sDefaultContent,c=o.fnGetData(a,i,{settings:e,row:t,col:n});if(c===l)return e.iDrawError!=r&&null===s&&(Ee(e,0,"Requested unknown parameter "+("function"==typeof o.mData?"{function}":"'"+o.mData+"'")+" for row "+t,4),e.iDrawError=r),s;if(c!==a&&null!==c||null===s){if("function"==typeof c)return c.call(a)}else c=s;return null===c&&"display"==i?"":c}function S(e,t,n,i){var r=e.aoColumns[n],o=e.aoData[t]._aData;r.fnSetData(o,i,{settings:e,row:t,col:n})}function T(t){return e.map(t.match(/(\\.|[^\.])+/g)||[""],function(e){return e.replace(/\\./g,".")})}function D(t){if(e.isPlainObject(t)){var n={};return e.each(t,function(e,t){t&&(n[e]=D(t))}),function(e,t,i,r){var o=n[t]||n._;return o!==l?o(e,t,i,r):e}}if(null===t)return function(e){return e};if("function"==typeof t)return function(e,n,i,r){return t(e,n,i,r)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,n){return e[t]};var i=function(e,t,n){var r,o,a,s;if(""!==n)for(var c=T(n),u=0,d=c.length;d>u;u++){if(r=c[u].match(yt),o=c[u].match(bt),r){c[u]=c[u].replace(yt,""),""!==c[u]&&(e=e[c[u]]),a=[],c.splice(0,u+1),s=c.join(".");for(var h=0,p=e.length;p>h;h++)a.push(i(e[h],t,s));var f=r[0].substring(1,r[0].length-1);e=""===f?a:a.join(f);break}if(o)c[u]=c[u].replace(bt,""),e=e[c[u]]();else{if(null===e||e[c[u]]===l)return l;e=e[c[u]]}}return e};return function(e,n){return i(e,n,t)}}function M(t){if(e.isPlainObject(t))return M(t._);if(null===t)return function(){};if("function"==typeof t)return function(e,n,i){t(e,"set",n,i)};if("string"!=typeof t||-1===t.indexOf(".")&&-1===t.indexOf("[")&&-1===t.indexOf("("))return function(e,n){e[t]=n};var n=function(e,t,i){for(var r,o,a,s,c,u=T(i),d=u[u.length-1],h=0,p=u.length-1;p>h;h++){if(o=u[h].match(yt),a=u[h].match(bt),o){u[h]=u[h].replace(yt,""),e[u[h]]=[],r=u.slice(),r.splice(0,h+1),c=r.join(".");for(var f=0,m=t.length;m>f;f++)s={},n(s,t[f],c),e[u[h]].push(s);return}a&&(u[h]=u[h].replace(bt,""),e=e[u[h]](t)),(null===e[u[h]]||e[u[h]]===l)&&(e[u[h]]={}),e=e[u[h]]}d.match(bt)?e=e[d.replace(bt,"")](t):e[d.replace(yt,"")]=t};return function(e,i){return n(e,i,t)}}function $(e){return dt(e.aoData,"_aData")}function L(e){e.aoData.length=0,e.aiDisplayMaster.length=0,e.aiDisplay.length=0}function A(e,t,n){for(var i=-1,r=0,o=e.length;o>r;r++)e[r]==t?i=r:e[r]>t&&e[r]--;-1!=i&&n===l&&e.splice(i,1)}function R(e,t,n,i){var r,o,a=e.aoData[t],s=function(n,i){for(;n.childNodes.length;)n.removeChild(n.firstChild);n.innerHTML=k(e,t,i,"display")};if("dom"!==n&&(n&&"auto"!==n||"dom"!==a.src)){var c=a.anCells;if(c)if(i!==l)s(c[i],i);else for(r=0,o=c.length;o>r;r++)s(c[r],r)}else a._aData=I(e,a,i,i===l?l:a._aData).data;a._aSortData=null,a._aFilterData=null;var u=e.aoColumns;if(i!==l)u[i].sType=null;else{for(r=0,o=u.length;o>r;r++)u[r].sType=null;E(e,a)}}function I(t,n,i,r){var o,a,s,c=[],u=n.firstChild,d=0,h=t.aoColumns,p=t._rowReadObject;r=r||p?{}:[];var f=function(e,t){if("string"==typeof e){var n=e.indexOf("@");if(-1!==n){var i=e.substring(n+1),o=M(e);o(r,t.getAttribute(i))}}},m=function(t){if(i===l||i===d)if(a=h[d],s=e.trim(t.innerHTML),a&&a._bAttrSrc){var n=M(a.mData._);n(r,s),f(a.mData.sort,t),f(a.mData.type,t),f(a.mData.filter,t)}else p?(a._setter||(a._setter=M(a.mData)),a._setter(r,s)):r[d]=s;d++};if(u)for(;u;)o=u.nodeName.toUpperCase(),("TD"==o||"TH"==o)&&(m(u),c.push(u)),u=u.nextSibling;else{c=n.anCells;for(var g=0,v=c.length;v>g;g++)m(c[g])}var y=n.getAttribute("id");return y&&M(t.rowId)(r,y),{data:r,cells:c}}function j(e,t,n,i){var r,o,a,l,c,u=e.aoData[t],d=u._aData,h=[];if(null===u.nTr){for(r=n||s.createElement("tr"),u.nTr=r,u.anCells=h,r._DT_RowIndex=t,E(e,u),l=0,c=e.aoColumns.length;c>l;l++)a=e.aoColumns[l],o=n?i[l]:s.createElement(a.sCellType),h.push(o),(!n||a.mRender||a.mData!==l)&&(o.innerHTML=k(e,t,l,"display")),a.sClass&&(o.className+=" "+a.sClass),a.bVisible&&!n?r.appendChild(o):!a.bVisible&&n&&o.parentNode.removeChild(o),a.fnCreatedCell&&a.fnCreatedCell.call(e.oInstance,o,k(e,t,l),d,t,l);Fe(e,"aoRowCreatedCallback",null,[r,d,t])}u.nTr.setAttribute("role","row")}function E(t,n){var i=n.nTr,r=n._aData;if(i){var o=t.rowIdFn(r);if(o&&(i.id=o),r.DT_RowClass){var a=r.DT_RowClass.split(" ");n.__rowc=n.__rowc?gt(n.__rowc.concat(a)):a,e(i).removeClass(n.__rowc.join(" ")).addClass(r.DT_RowClass)}r.DT_RowAttr&&e(i).attr(r.DT_RowAttr),r.DT_RowData&&e(i).data(r.DT_RowData)}}function N(t){var n,i,r,o,a,s=t.nTHead,l=t.nTFoot,c=0===e("th, td",s).length,u=t.oClasses,d=t.aoColumns;for(c&&(o=e("<tr/>").appendTo(s)),n=0,i=d.length;i>n;n++)a=d[n],r=e(a.nTh).addClass(a.sClass),c&&r.appendTo(o),t.oFeatures.bSort&&(r.addClass(a.sSortingClass),a.bSortable!==!1&&(r.attr("tabindex",t.iTabIndex).attr("aria-controls",t.sTableId),$e(t,a.nTh,n))),a.sTitle!=r[0].innerHTML&&r.html(a.sTitle),ze(t,"header")(t,r,a,u);if(c&&H(t.aoHeader,s),e(s).find(">tr").attr("role","row"),e(s).find(">tr>th, >tr>td").addClass(u.sHeaderTH),e(l).find(">tr>th, >tr>td").addClass(u.sFooterTH),null!==l){var h=t.aoFooter[0];for(n=0,i=h.length;i>n;n++)a=d[n],a.nTf=h[n].cell,a.sClass&&e(a.nTf).addClass(a.sClass)}}function P(t,n,i){var r,o,a,s,c,u,d,h,p,f=[],m=[],g=t.aoColumns.length;if(n){for(i===l&&(i=!1),r=0,o=n.length;o>r;r++){for(f[r]=n[r].slice(),f[r].nTr=n[r].nTr,a=g-1;a>=0;a--)t.aoColumns[a].bVisible||i||f[r].splice(a,1);m.push([])}for(r=0,o=f.length;o>r;r++){if(d=f[r].nTr)for(;u=d.firstChild;)d.removeChild(u);for(a=0,s=f[r].length;s>a;a++)if(h=1,p=1,m[r][a]===l){for(d.appendChild(f[r][a].cell),m[r][a]=1;f[r+h]!==l&&f[r][a].cell==f[r+h][a].cell;)m[r+h][a]=1,h++;for(;f[r][a+p]!==l&&f[r][a].cell==f[r][a+p].cell;){for(c=0;h>c;c++)m[r+c][a+p]=1;p++}e(f[r][a].cell).attr("rowspan",h).attr("colspan",p)}}}}function O(t){var n=Fe(t,"aoPreDrawCallback","preDraw",[t]);if(-1!==e.inArray(!1,n))return void fe(t,!1);var i=[],r=0,o=t.asStripeClasses,a=o.length,s=(t.aoOpenRows.length,t.oLanguage),c=t.iInitDisplayStart,u="ssp"==Be(t),d=t.aiDisplay;t.bDrawing=!0,c!==l&&-1!==c&&(t._iDisplayStart=u?c:c>=t.fnRecordsDisplay()?0:c,t.iInitDisplayStart=-1);var h=t._iDisplayStart,p=t.fnDisplayEnd();if(t.bDeferLoading)t.bDeferLoading=!1,t.iDraw++,fe(t,!1);else if(u){if(!t.bDestroying&&!W(t))return}else t.iDraw++;if(0!==d.length)for(var f=u?0:h,m=u?t.aoData.length:p,v=f;m>v;v++){var y=d[v],b=t.aoData[y];null===b.nTr&&j(t,y);var _=b.nTr;if(0!==a){var w=o[r%a];b._sRowStripe!=w&&(e(_).removeClass(b._sRowStripe).addClass(w),b._sRowStripe=w)}Fe(t,"aoRowCallback",null,[_,b._aData,r,v]),i.push(_),r++}else{var x=s.sZeroRecords;1==t.iDraw&&"ajax"==Be(t)?x=s.sLoadingRecords:s.sEmptyTable&&0===t.fnRecordsTotal()&&(x=s.sEmptyTable),i[0]=e("<tr/>",{"class":a?o[0]:""}).append(e("<td />",{valign:"top",colSpan:g(t),"class":t.oClasses.sRowEmpty}).html(x))[0]}Fe(t,"aoHeaderCallback","header",[e(t.nTHead).children("tr")[0],$(t),h,p,d]),Fe(t,"aoFooterCallback","footer",[e(t.nTFoot).children("tr")[0],$(t),h,p,d]);var C=e(t.nTBody);C.children().detach(),C.append(e(i)),Fe(t,"aoDrawCallback","draw",[t]),t.bSorted=!1,t.bFiltered=!1,t.bDrawing=!1}function V(e,t){var n=e.oFeatures,i=n.bSort,r=n.bFilter;i&&Te(e),r?X(e,e.oPreviousSearch):e.aiDisplay=e.aiDisplayMaster.slice(),t!==!0&&(e._iDisplayStart=0),e._drawHold=t,O(e),e._drawHold=!1}function F(t){var n=t.oClasses,i=e(t.nTable),r=e("<div/>").insertBefore(i),o=t.oFeatures,a=e("<div/>",{id:t.sTableId+"_wrapper","class":n.sWrapper+(t.nTFoot?"":" "+n.sNoFooter)});t.nHolding=r[0],t.nTableWrapper=a[0],t.nTableReinsertBefore=t.nTable.nextSibling;for(var s,l,c,u,d,h,p=t.sDom.split(""),f=0;f<p.length;f++){if(s=null,l=p[f],"<"==l){if(c=e("<div/>")[0],u=p[f+1],"'"==u||'"'==u){for(d="",h=2;p[f+h]!=u;)d+=p[f+h],h++;if("H"==d?d=n.sJUIHeader:"F"==d&&(d=n.sJUIFooter),-1!=d.indexOf(".")){var m=d.split(".");c.id=m[0].substr(1,m[0].length-1),c.className=m[1]}else"#"==d.charAt(0)?c.id=d.substr(1,d.length-1):c.className=d;f+=h}a.append(c),a=e(c)}else if(">"==l)a=a.parent();else if("l"==l&&o.bPaginate&&o.bLengthChange)s=ue(t);else if("f"==l&&o.bFilter)s=Y(t);else if("r"==l&&o.bProcessing)s=pe(t);else if("t"==l)s=me(t);else if("i"==l&&o.bInfo)s=re(t);else if("p"==l&&o.bPaginate)s=de(t);else if(0!==Ge.ext.feature.length)for(var g=Ge.ext.feature,v=0,y=g.length;y>v;v++)if(l==g[v].cFeature){s=g[v].fnInit(t);break}if(s){var b=t.aanFeatures;b[l]||(b[l]=[]),b[l].push(s),a.append(s)}}r.replaceWith(a),t.nHolding=null}function H(t,n){var i,r,o,a,s,l,c,u,d,h,p,f=e(n).children("tr"),m=function(e,t,n){for(var i=e[t];i[n];)n++;return n};for(t.splice(0,t.length),o=0,l=f.length;l>o;o++)t.push([]);for(o=0,l=f.length;l>o;o++)for(i=f[o],u=0,r=i.firstChild;r;){if("TD"==r.nodeName.toUpperCase()||"TH"==r.nodeName.toUpperCase())for(d=1*r.getAttribute("colspan"),h=1*r.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,h=h&&0!==h&&1!==h?h:1,c=m(t,o,u),p=1===d?!0:!1,s=0;d>s;s++)for(a=0;h>a;a++)t[o+a][c+s]={cell:r,unique:p},t[o+a].nTr=i;r=r.nextSibling}}function z(e,t,n){var i=[];n||(n=e.aoHeader,t&&(n=[],H(n,t)));for(var r=0,o=n.length;o>r;r++)for(var a=0,s=n[r].length;s>a;a++)!n[r][a].unique||i[a]&&e.bSortCellsTop||(i[a]=n[r][a].cell);return i}function B(t,n,i){if(Fe(t,"aoServerParams","serverParams",[n]),n&&e.isArray(n)){var r={},o=/(.*?)\[\]$/;e.each(n,function(e,t){var n=t.name.match(o);if(n){var i=n[0];r[i]||(r[i]=[]),r[i].push(t.value)}else r[t.name]=t.value}),n=r}var a,s=t.ajax,l=t.oInstance,c=function(e){Fe(t,null,"xhr",[t,e,t.jqXHR]),i(e)};if(e.isPlainObject(s)&&s.data){a=s.data;var u=e.isFunction(a)?a(n,t):a;n=e.isFunction(a)&&u?u:e.extend(!0,n,u),delete s.data}var d={data:n,success:function(e){var n=e.error||e.sError;n&&Ee(t,0,n),t.json=e,c(e)},dataType:"json",cache:!1,type:t.sServerMethod,error:function(n,i,r){var o=Fe(t,null,"xhr",[t,null,t.jqXHR]);-1===e.inArray(!0,o)&&("parsererror"==i?Ee(t,0,"Invalid JSON response",1):4===n.readyState&&Ee(t,0,"Ajax error",7)),fe(t,!1)}};t.oAjaxData=n,Fe(t,null,"preXhr",[t,n]),t.fnServerData?t.fnServerData.call(l,t.sAjaxSource,e.map(n,function(e,t){return{name:t,value:e}}),c,t):t.sAjaxSource||"string"==typeof s?t.jqXHR=e.ajax(e.extend(d,{url:s||t.sAjaxSource})):e.isFunction(s)?t.jqXHR=s.call(l,n,c,t):(t.jqXHR=e.ajax(e.extend(d,s)),s.data=a)}function W(e){return e.bAjaxDataGet?(e.iDraw++,fe(e,!0),B(e,U(e),function(t){q(e,t)}),!1):!0}function U(t){var n,i,r,o,a=t.aoColumns,s=a.length,l=t.oFeatures,c=t.oPreviousSearch,u=t.aoPreSearchCols,d=[],h=Se(t),p=t._iDisplayStart,f=l.bPaginate!==!1?t._iDisplayLength:-1,m=function(e,t){d.push({name:e,value:t})};m("sEcho",t.iDraw),m("iColumns",s),m("sColumns",dt(a,"sName").join(",")),m("iDisplayStart",p),m("iDisplayLength",f);var g={draw:t.iDraw,columns:[],order:[],start:p,length:f,search:{value:c.sSearch,regex:c.bRegex}};for(n=0;s>n;n++)r=a[n],o=u[n],i="function"==typeof r.mData?"function":r.mData,g.columns.push({data:i,name:r.sName,searchable:r.bSearchable,orderable:r.bSortable,search:{value:o.sSearch,regex:o.bRegex}}),m("mDataProp_"+n,i),l.bFilter&&(m("sSearch_"+n,o.sSearch),m("bRegex_"+n,o.bRegex),m("bSearchable_"+n,r.bSearchable)),l.bSort&&m("bSortable_"+n,r.bSortable);l.bFilter&&(m("sSearch",c.sSearch),m("bRegex",c.bRegex)),l.bSort&&(e.each(h,function(e,t){g.order.push({column:t.col,dir:t.dir}),m("iSortCol_"+e,t.col),m("sSortDir_"+e,t.dir)}),m("iSortingCols",h.length));var v=Ge.ext.legacy.ajax;return null===v?t.sAjaxSource?d:g:v?d:g}function q(e,t){var n=function(e,n){return t[e]!==l?t[e]:t[n]},i=G(e,t),r=n("sEcho","draw"),o=n("iTotalRecords","recordsTotal"),a=n("iTotalDisplayRecords","recordsFiltered");if(r){if(1*r<e.iDraw)return;e.iDraw=1*r}L(e),e._iRecordsTotal=parseInt(o,10),e._iRecordsDisplay=parseInt(a,10);for(var s=0,c=i.length;c>s;s++)_(e,i[s]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,O(e),e._bInitComplete||le(e,t),e.bAjaxDataGet=!0,fe(e,!1)}function G(t,n){var i=e.isPlainObject(t.ajax)&&t.ajax.dataSrc!==l?t.ajax.dataSrc:t.sAjaxDataProp;return"data"===i?n.aaData||n[i]:""!==i?D(i)(n):n}function Y(t){var n=t.oClasses,i=t.sTableId,r=t.oLanguage,o=t.oPreviousSearch,a=t.aanFeatures,l='<input type="search" class="'+n.sFilterInput+'"/>',c=r.sSearch;c=c.match(/_INPUT_/)?c.replace("_INPUT_",l):c+l;var u=e("<div/>",{id:a.f?null:i+"_filter","class":n.sFilter}).append(e("<label/>").append(c)),d=function(){var e=(a.f,this.value?this.value:"");e!=o.sSearch&&(X(t,{sSearch:e,bRegex:o.bRegex,bSmart:o.bSmart,bCaseInsensitive:o.bCaseInsensitive}),t._iDisplayStart=0,O(t))},h=null!==t.searchDelay?t.searchDelay:"ssp"===Be(t)?400:0,p=e("input",u).val(o.sSearch).attr("placeholder",r.sSearchPlaceholder).bind("keyup.DT search.DT input.DT paste.DT cut.DT",h?be(d,h):d).bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}).attr("aria-controls",i);return e(t.nTable).on("search.dt.DT",function(e,n){if(t===n)try{p[0]!==s.activeElement&&p.val(o.sSearch)}catch(i){}}),u[0]}function X(e,t,n){var i=e.oPreviousSearch,r=e.aoPreSearchCols,o=function(e){i.sSearch=e.sSearch,i.bRegex=e.bRegex,i.bSmart=e.bSmart,i.bCaseInsensitive=e.bCaseInsensitive},a=function(e){return e.bEscapeRegex!==l?!e.bEscapeRegex:e.bRegex};if(y(e),"ssp"!=Be(e)){Z(e,t.sSearch,n,a(t),t.bSmart,t.bCaseInsensitive),o(t);for(var s=0;s<r.length;s++)J(e,r[s].sSearch,s,a(r[s]),r[s].bSmart,r[s].bCaseInsensitive);K(e)}else o(t);e.bFiltered=!0,Fe(e,null,"search",[e])}function K(e){for(var t,n,i=Ge.ext.search,r=e.aiDisplay,o=0,a=i.length;a>o;o++){for(var s=[],l=0,c=r.length;c>l;l++)n=r[l],t=e.aoData[n],i[o](e,t._aFilterData,n,t._aData,l)&&s.push(n);r.length=0,r.push.apply(r,s)}}function J(e,t,n,i,r,o){if(""!==t)for(var a,s=e.aiDisplay,l=Q(t,i,r,o),c=s.length-1;c>=0;c--)a=e.aoData[s[c]]._aFilterData[n],l.test(a)||s.splice(c,1)}function Z(e,t,n,i,r,o){var a,s,l,c=Q(t,i,r,o),u=e.oPreviousSearch.sSearch,d=e.aiDisplayMaster;if(0!==Ge.ext.search.length&&(n=!0),s=te(e),t.length<=0)e.aiDisplay=d.slice();else for((s||n||u.length>t.length||0!==t.indexOf(u)||e.bSorted)&&(e.aiDisplay=d.slice()),a=e.aiDisplay,l=a.length-1;l>=0;l--)c.test(e.aoData[a[l]]._sFilterRow)||a.splice(l,1)}function Q(t,n,i,r){if(t=n?t:ee(t),i){var o=e.map(t.match(/"[^"]+"|[^ ]+/g)||[""],function(e){if('"'===e.charAt(0)){var t=e.match(/^"(.*)"$/);e=t?t[1]:e}return e.replace('"',"")});t="^(?=.*?"+o.join(")(?=.*?")+").*$"}return new RegExp(t,r?"i":"")}function ee(e){return e.replace(it,"\\$1")}function te(e){var t,n,i,r,o,a,s,l,c=e.aoColumns,u=Ge.ext.type.search,d=!1;for(n=0,r=e.aoData.length;r>n;n++)if(l=e.aoData[n],!l._aFilterData){for(a=[],i=0,o=c.length;o>i;i++)t=c[i],t.bSearchable?(s=k(e,n,i,"filter"),u[t.sType]&&(s=u[t.sType](s)),null===s&&(s=""),"string"!=typeof s&&s.toString&&(s=s.toString())):s="",s.indexOf&&-1!==s.indexOf("&")&&(_t.innerHTML=s,s=wt?_t.textContent:_t.innerText),s.replace&&(s=s.replace(/[\r\n]/g,"")),a.push(s);l._aFilterData=a,l._sFilterRow=a.join("  "),d=!0}return d}function ne(e){return{search:e.sSearch,smart:e.bSmart,regex:e.bRegex,caseInsensitive:e.bCaseInsensitive}}function ie(e){return{sSearch:e.search,bSmart:e.smart,bRegex:e.regex,bCaseInsensitive:e.caseInsensitive}}function re(t){var n=t.sTableId,i=t.aanFeatures.i,r=e("<div/>",{"class":t.oClasses.sInfo,id:i?null:n+"_info"});return i||(t.aoDrawCallback.push({fn:oe,sName:"information"}),r.attr("role","status").attr("aria-live","polite"),e(t.nTable).attr("aria-describedby",n+"_info")),r[0]}function oe(t){var n=t.aanFeatures.i;if(0!==n.length){var i=t.oLanguage,r=t._iDisplayStart+1,o=t.fnDisplayEnd(),a=t.fnRecordsTotal(),s=t.fnRecordsDisplay(),l=s?i.sInfo:i.sInfoEmpty;s!==a&&(l+=" "+i.sInfoFiltered),l+=i.sInfoPostFix,l=ae(t,l);var c=i.fnInfoCallback;null!==c&&(l=c.call(t.oInstance,t,r,o,a,s,l)),e(n).html(l)}}function ae(e,t){var n=e.fnFormatNumber,i=e._iDisplayStart+1,r=e._iDisplayLength,o=e.fnRecordsDisplay(),a=-1===r;return t.replace(/_START_/g,n.call(e,i)).replace(/_END_/g,n.call(e,e.fnDisplayEnd())).replace(/_MAX_/g,n.call(e,e.fnRecordsTotal())).replace(/_TOTAL_/g,n.call(e,o)).replace(/_PAGE_/g,n.call(e,a?1:Math.ceil(i/r))).replace(/_PAGES_/g,n.call(e,a?1:Math.ceil(o/r)))}function se(e){var t,n,i,r=e.iInitDisplayStart,o=e.aoColumns,a=e.oFeatures,s=e.bDeferLoading;if(!e.bInitialised)return void setTimeout(function(){se(e)},200);for(F(e),N(e),P(e,e.aoHeader),P(e,e.aoFooter),fe(e,!0),a.bAutoWidth&&ye(e),t=0,n=o.length;n>t;t++)i=o[t],i.sWidth&&(i.nTh.style.width=Ce(i.sWidth));Fe(e,null,"preInit",[e]),V(e);var l=Be(e);("ssp"!=l||s)&&("ajax"==l?B(e,[],function(n){var i=G(e,n);for(t=0;t<i.length;t++)_(e,i[t]);e.iInitDisplayStart=r,V(e),fe(e,!1),le(e,n)},e):(fe(e,!1),le(e)))}function le(e,t){e._bInitComplete=!0,(t||e.oInit.aaData)&&p(e),Fe(e,"aoInitComplete","init",[e,t])}function ce(e,t){var n=parseInt(t,10);e._iDisplayLength=n,He(e),Fe(e,null,"length",[e,n])}function ue(t){for(var n=t.oClasses,i=t.sTableId,r=t.aLengthMenu,o=e.isArray(r[0]),a=o?r[0]:r,s=o?r[1]:r,l=e("<select/>",{name:i+"_length","aria-controls":i,"class":n.sLengthSelect}),c=0,u=a.length;u>c;c++)l[0][c]=new Option(s[c],a[c]);var d=e("<div><label/></div>").addClass(n.sLength);return t.aanFeatures.l||(d[0].id=i+"_length"),d.children().append(t.oLanguage.sLengthMenu.replace("_MENU_",l[0].outerHTML)),e("select",d).val(t._iDisplayLength).bind("change.DT",function(n){ce(t,e(this).val()),O(t)}),e(t.nTable).bind("length.dt.DT",function(n,i,r){t===i&&e("select",d).val(r)}),d[0]}function de(t){var n=t.sPaginationType,i=Ge.ext.pager[n],r="function"==typeof i,o=function(e){O(e)},a=e("<div/>").addClass(t.oClasses.sPaging+n)[0],s=t.aanFeatures;return r||i.fnInit(t,a,o),s.p||(a.id=t.sTableId+"_paginate",t.aoDrawCallback.push({fn:function(e){if(r){var t,n,a=e._iDisplayStart,l=e._iDisplayLength,c=e.fnRecordsDisplay(),u=-1===l,d=u?0:Math.ceil(a/l),h=u?1:Math.ceil(c/l),p=i(d,h);for(t=0,n=s.p.length;n>t;t++)ze(e,"pageButton")(e,s.p[t],t,p,d,h)}else i.fnUpdate(e,o)},sName:"pagination"})),a}function he(e,t,n){var i=e._iDisplayStart,r=e._iDisplayLength,o=e.fnRecordsDisplay();0===o||-1===r?i=0:"number"==typeof t?(i=t*r,i>o&&(i=0)):"first"==t?i=0:"previous"==t?(i=r>=0?i-r:0,0>i&&(i=0)):"next"==t?o>i+r&&(i+=r):"last"==t?i=Math.floor((o-1)/r)*r:Ee(e,0,"Unknown paging action: "+t,5);var a=e._iDisplayStart!==i;return e._iDisplayStart=i,a&&(Fe(e,null,"page",[e]),n&&O(e)),a}function pe(t){return e("<div/>",{id:t.aanFeatures.r?null:t.sTableId+"_processing","class":t.oClasses.sProcessing}).html(t.oLanguage.sProcessing).insertBefore(t.nTable)[0]}function fe(t,n){t.oFeatures.bProcessing&&e(t.aanFeatures.r).css("display",n?"block":"none"),Fe(t,null,"processing",[t,n])}function me(t){var n=e(t.nTable);n.attr("role","grid");var i=t.oScroll;if(""===i.sX&&""===i.sY)return t.nTable;var r=i.sX,o=i.sY,a=t.oClasses,s=n.children("caption"),l=s.length?s[0]._captionSide:null,c=e(n[0].cloneNode(!1)),u=e(n[0].cloneNode(!1)),d=n.children("tfoot"),h="<div/>",p=function(e){return e?Ce(e):null};i.sX&&"100%"===n.attr("width")&&n.removeAttr("width"),d.length||(d=null);var f=e(h,{"class":a.sScrollWrapper}).append(e(h,{"class":a.sScrollHead}).css({overflow:"hidden",position:"relative",border:0,width:r?p(r):"100%"}).append(e(h,{"class":a.sScrollHeadInner}).css({"box-sizing":"content-box",width:i.sXInner||"100%"}).append(c.removeAttr("id").css("margin-left",0).append("top"===l?s:null).append(n.children("thead"))))).append(e(h,{"class":a.sScrollBody}).css({position:"relative",overflow:"auto",width:p(r)}).append(n));d&&f.append(e(h,{"class":a.sScrollFoot}).css({overflow:"hidden",border:0,width:r?p(r):"100%"}).append(e(h,{"class":a.sScrollFootInner}).append(u.removeAttr("id").css("margin-left",0).append("bottom"===l?s:null).append(n.children("tfoot")))));var m=f.children(),g=m[0],v=m[1],y=d?m[2]:null;return r&&e(v).on("scroll.DT",function(e){var t=this.scrollLeft;g.scrollLeft=t,d&&(y.scrollLeft=t)}),e(v).css(o&&i.bCollapse?"max-height":"height",o),t.nScrollHead=g,t.nScrollBody=v,t.nScrollFoot=y,t.aoDrawCallback.push({fn:ge,sName:"scrolling"}),f[0]}function ge(t){var n,i,r,o,a,s,l,c,u,d=t.oScroll,h=d.sX,p=d.sXInner,m=d.sY,g=d.iBarWidth,v=e(t.nScrollHead),y=v[0].style,b=v.children("div"),_=b[0].style,w=b.children("table"),x=t.nScrollBody,C=e(x),k=x.style,S=e(t.nScrollFoot),T=S.children("div"),D=T.children("table"),M=e(t.nTHead),$=e(t.nTable),L=$[0],A=L.style,R=t.nTFoot?e(t.nTFoot):null,I=t.oBrowser,j=I.bScrollOversize,E=[],N=[],P=[],O=function(e){var t=e.style;t.paddingTop="0",t.paddingBottom="0",t.borderTopWidth="0",t.borderBottomWidth="0",t.height=0};$.children("thead, tfoot").remove(),a=M.clone().prependTo($),n=M.find("tr"),r=a.find("tr"),a.find("th, td").removeAttr("tabindex"),R&&(s=R.clone().prependTo($),i=R.find("tr"),o=s.find("tr")),h||(k.width="100%",v[0].style.width="100%"),e.each(z(t,a),function(e,n){l=f(t,e),n.style.width=t.aoColumns[l].sWidth}),R&&ve(function(e){e.style.width=""},o),u=$.outerWidth(),""===h?(A.width="100%",j&&($.find("tbody").height()>x.offsetHeight||"scroll"==C.css("overflow-y"))&&(A.width=Ce($.outerWidth()-g)),u=$.outerWidth()):""!==p&&(A.width=Ce(p),u=$.outerWidth()),ve(O,r),ve(function(t){P.push(t.innerHTML),E.push(Ce(e(t).css("width")))},r),ve(function(e,t){e.style.width=E[t]},n),e(r).height(0),R&&(ve(O,o),ve(function(t){N.push(Ce(e(t).css("width")))},o),ve(function(e,t){e.style.width=N[t]},i),e(o).height(0)),ve(function(e,t){e.innerHTML='<div class="dataTables_sizing" style="height:0;overflow:hidden;">'+P[t]+"</div>",e.style.width=E[t]},r),R&&ve(function(e,t){e.innerHTML="",e.style.width=N[t]},o),$.outerWidth()<u?(c=x.scrollHeight>x.offsetHeight||"scroll"==C.css("overflow-y")?u+g:u,j&&(x.scrollHeight>x.offsetHeight||"scroll"==C.css("overflow-y"))&&(A.width=Ce(c-g)),(""===h||""!==p)&&Ee(t,1,"Possible column misalignment",6)):c="100%",k.width=Ce(c),y.width=Ce(c),R&&(t.nScrollFoot.style.width=Ce(c)),m||j&&(k.height=Ce(L.offsetHeight+g));var V=$.outerWidth();w[0].style.width=Ce(V),_.width=Ce(V);var F=$.height()>x.clientHeight||"scroll"==C.css("overflow-y"),H="padding"+(I.bScrollbarLeft?"Left":"Right");_[H]=F?g+"px":"0px",R&&(D[0].style.width=Ce(V),T[0].style.width=Ce(V),T[0].style[H]=F?g+"px":"0px"),C.scroll(),!t.bSorted&&!t.bFiltered||t._drawHold||(x.scrollTop=0)}function ve(e,t,n){for(var i,r,o=0,a=0,s=t.length;s>a;){for(i=t[a].firstChild,r=n?n[a].firstChild:null;i;)1===i.nodeType&&(n?e(i,r,o):e(i,o),o++),i=i.nextSibling,r=n?r.nextSibling:null;a++}}function ye(t){var n,i,r,o,s,l=t.nTable,c=t.aoColumns,u=t.oScroll,d=u.sY,h=u.sX,f=u.sXInner,m=c.length,y=v(t,"bVisible"),b=e("th",t.nTHead),_=l.getAttribute("width"),w=l.parentNode,x=!1,C=t.oBrowser,k=C.bScrollOversize,S=l.style.width;for(S&&-1!==S.indexOf("%")&&(_=S),n=0;n<y.length;n++)i=c[y[n]],null!==i.sWidth&&(i.sWidth=_e(i.sWidthOrig,w),x=!0);if(k||!x&&!h&&!d&&m==g(t)&&m==b.length)for(n=0;m>n;n++)c[n].sWidth=Ce(b.eq(n).width());else{var T=e(l).clone().css("visibility","hidden").removeAttr("id");T.find("tbody tr").remove();var D=e("<tr/>").appendTo(T.find("tbody"));for(T.find("thead, tfoot").remove(),T.append(e(t.nTHead).clone()).append(e(t.nTFoot).clone()),T.find("tfoot th, tfoot td").css("width",""),b=z(t,T.find("thead")[0]),n=0;n<y.length;n++)i=c[y[n]],b[n].style.width=null!==i.sWidthOrig&&""!==i.sWidthOrig?Ce(i.sWidthOrig):"";if(t.aoData.length)for(n=0;n<y.length;n++)r=y[n],i=c[r],e(we(t,r)).clone(!1).append(i.sContentPadding).appendTo(D);var M=e("<div/>").css(h||d?{position:"absolute",top:0,left:0,height:1,right:0,overflow:"hidden"}:{}).append(T).appendTo(w);if(h&&f?T.width(f):h?(T.css("width","auto"),T.width()<w.clientWidth&&T.width(w.clientWidth)):d?T.width(w.clientWidth):_&&T.width(_),h){var $=0;for(n=0;n<y.length;n++)i=c[y[n]],s=C.bBounding?b[n].getBoundingClientRect().width:e(b[n]).outerWidth(),$+=null===i.sWidthOrig?s:parseInt(i.sWidth,10)+s-e(b[n]).width();T.width(Ce($)),l.style.width=Ce($)}for(n=0;n<y.length;n++)i=c[y[n]],o=e(b[n]).width(),o&&(i.sWidth=Ce(o));l.style.width=Ce(T.css("width")),M.remove()}if(_&&(l.style.width=Ce(_)),(_||h)&&!t._reszEvt){var L=function(){e(a).bind("resize.DT-"+t.sInstance,be(function(){p(t)}))};k?setTimeout(L,1e3):L(),t._reszEvt=!0}}function be(e,t){var n,i,r=t!==l?t:200;return function(){var t=this,o=+new Date,a=arguments;n&&n+r>o?(clearTimeout(i),i=setTimeout(function(){n=l,e.apply(t,a)},r)):(n=o,e.apply(t,a))}}function _e(t,n){if(!t)return 0;var i=e("<div/>").css("width",Ce(t)).appendTo(n||s.body),r=i[0].offsetWidth;return i.remove(),r}function we(t,n){var i=xe(t,n);if(0>i)return null;var r=t.aoData[i];return r.nTr?r.anCells[n]:e("<td/>").html(k(t,i,n,"display"))[0]}function xe(e,t){for(var n,i=-1,r=-1,o=0,a=e.aoData.length;a>o;o++)n=k(e,o,t,"display")+"",n=n.replace(xt,""),n.length>i&&(i=n.length,r=o);return r}function Ce(e){return null===e?"0px":"number"==typeof e?0>e?"0px":e+"px":e.match(/\d$/)?e+"px":e}function ke(){var t=Ge.__scrollbarWidth;if(t===l){var n=e("<p/>").css({position:"absolute",top:0,left:0,width:"100%",height:150,padding:0,overflow:"scroll",visibility:"hidden"}).appendTo("body");t=n[0].offsetWidth-n[0].clientWidth,Ge.__scrollbarWidth=t,n.remove()}return t}function Se(t){var n,i,r,o,a,s,c,u=[],d=t.aoColumns,h=t.aaSortingFixed,p=e.isPlainObject(h),f=[],m=function(t){t.length&&!e.isArray(t[0])?f.push(t):f.push.apply(f,t)};for(e.isArray(h)&&m(h),p&&h.pre&&m(h.pre),m(t.aaSorting),p&&h.post&&m(h.post),n=0;n<f.length;n++)for(c=f[n][0],o=d[c].aDataSort,i=0,r=o.length;r>i;i++)a=o[i],s=d[a].sType||"string",f[n]._idx===l&&(f[n]._idx=e.inArray(f[n][1],d[a].asSorting)),u.push({src:c,col:a,dir:f[n][1],index:f[n]._idx,type:s,formatter:Ge.ext.type.order[s+"-pre"]});return u}function Te(e){var t,n,i,r,o,a=[],s=Ge.ext.type.order,l=e.aoData,c=(e.aoColumns,0),u=e.aiDisplayMaster;for(y(e),o=Se(e),t=0,n=o.length;n>t;t++)r=o[t],r.formatter&&c++,Ae(e,r.col);if("ssp"!=Be(e)&&0!==o.length){for(t=0,i=u.length;i>t;t++)a[u[t]]=t;c===o.length?u.sort(function(e,t){var n,i,r,s,c,u=o.length,d=l[e]._aSortData,h=l[t]._aSortData;for(r=0;u>r;r++)if(c=o[r],n=d[c.col],i=h[c.col],s=i>n?-1:n>i?1:0,0!==s)return"asc"===c.dir?s:-s;return n=a[e],i=a[t],i>n?-1:n>i?1:0}):u.sort(function(e,t){var n,i,r,c,u,d,h=o.length,p=l[e]._aSortData,f=l[t]._aSortData;for(r=0;h>r;r++)if(u=o[r],n=p[u.col],i=f[u.col],d=s[u.type+"-"+u.dir]||s["string-"+u.dir],c=d(n,i),0!==c)return c;return n=a[e],i=a[t],i>n?-1:n>i?1:0})}e.bSorted=!0}function De(e){for(var t,n,i=e.aoColumns,r=Se(e),o=e.oLanguage.oAria,a=0,s=i.length;s>a;a++){var l=i[a],c=l.asSorting,u=l.sTitle.replace(/<.*?>/g,""),d=l.nTh;d.removeAttribute("aria-sort"),l.bSortable?(r.length>0&&r[0].col==a?(d.setAttribute("aria-sort","asc"==r[0].dir?"ascending":"descending"),n=c[r[0].index+1]||c[0]):n=c[0],t=u+("asc"===n?o.sSortAscending:o.sSortDescending)):t=u,d.setAttribute("aria-label",t)}}function Me(t,n,i,r){var o,a=t.aoColumns[n],s=t.aaSorting,c=a.asSorting,u=function(t,n){var i=t._idx;return i===l&&(i=e.inArray(t[1],c)),i+1<c.length?i+1:n?null:0};if("number"==typeof s[0]&&(s=t.aaSorting=[s]),i&&t.oFeatures.bSortMulti){var d=e.inArray(n,dt(s,"0"));-1!==d?(o=u(s[d],!0),null===o&&1===s.length&&(o=0),null===o?s.splice(d,1):(s[d][1]=c[o],s[d]._idx=o)):(s.push([n,c[0],0]),s[s.length-1]._idx=0)}else s.length&&s[0][0]==n?(o=u(s[0]),s.length=1,s[0][1]=c[o],s[0]._idx=o):(s.length=0,s.push([n,c[0]]),s[0]._idx=0);V(t),"function"==typeof r&&r(t)}function $e(e,t,n,i){var r=e.aoColumns[n];Oe(t,{},function(t){r.bSortable!==!1&&(e.oFeatures.bProcessing?(fe(e,!0),setTimeout(function(){Me(e,n,t.shiftKey,i),"ssp"!==Be(e)&&fe(e,!1)},0)):Me(e,n,t.shiftKey,i))})}function Le(t){var n,i,r,o=t.aLastSort,a=t.oClasses.sSortColumn,s=Se(t),l=t.oFeatures;if(l.bSort&&l.bSortClasses){for(n=0,i=o.length;i>n;n++)r=o[n].src,e(dt(t.aoData,"anCells",r)).removeClass(a+(2>n?n+1:3));for(n=0,i=s.length;i>n;n++)r=s[n].src,e(dt(t.aoData,"anCells",r)).addClass(a+(2>n?n+1:3))}t.aLastSort=s}function Ae(e,t){var n,i=e.aoColumns[t],r=Ge.ext.order[i.sSortDataType];r&&(n=r.call(e.oInstance,e,t,m(e,t)));for(var o,a,s=Ge.ext.type.order[i.sType+"-pre"],l=0,c=e.aoData.length;c>l;l++)o=e.aoData[l],o._aSortData||(o._aSortData=[]),(!o._aSortData[t]||r)&&(a=r?n[l]:k(e,l,t,"sort"),o._aSortData[t]=s?s(a):a)}function Re(t){if(t.oFeatures.bStateSave&&!t.bDestroying){var n={time:+new Date,start:t._iDisplayStart,length:t._iDisplayLength,
order:e.extend(!0,[],t.aaSorting),search:ne(t.oPreviousSearch),columns:e.map(t.aoColumns,function(e,n){return{visible:e.bVisible,search:ne(t.aoPreSearchCols[n])}})};Fe(t,"aoStateSaveParams","stateSaveParams",[t,n]),t.oSavedState=n,t.fnStateSaveCallback.call(t.oInstance,t,n)}}function Ie(t,n){var i,r,o=t.aoColumns;if(t.oFeatures.bStateSave){var a=t.fnStateLoadCallback.call(t.oInstance,t);if(a&&a.time){var s=Fe(t,"aoStateLoadParams","stateLoadParams",[t,a]);if(-1===e.inArray(!1,s)){var c=t.iStateDuration;if(!(c>0&&a.time<+new Date-1e3*c)&&o.length===a.columns.length){for(t.oLoadedState=e.extend(!0,{},a),a.start!==l&&(t._iDisplayStart=a.start,t.iInitDisplayStart=a.start),a.length!==l&&(t._iDisplayLength=a.length),a.order!==l&&(t.aaSorting=[],e.each(a.order,function(e,n){t.aaSorting.push(n[0]>=o.length?[0,n[1]]:n)})),a.search!==l&&e.extend(t.oPreviousSearch,ie(a.search)),i=0,r=a.columns.length;r>i;i++){var u=a.columns[i];u.visible!==l&&(o[i].bVisible=u.visible),u.search!==l&&e.extend(t.aoPreSearchCols[i],ie(u.search))}Fe(t,"aoStateLoaded","stateLoaded",[t,a])}}}}}function je(t){var n=Ge.settings,i=e.inArray(t,dt(n,"nTable"));return-1!==i?n[i]:null}function Ee(e,t,n,i){if(n="DataTables warning: "+(e?"table id="+e.sTableId+" - ":"")+n,i&&(n+=". For more information about this error, please see http://datatables.net/tn/"+i),t)a.console&&console.log&&console.log(n);else{var r=Ge.ext,o=r.sErrMode||r.errMode;if(e&&Fe(e,null,"error",[e,i,n]),"alert"==o)alert(n);else{if("throw"==o)throw new Error(n);"function"==typeof o&&o(e,i,n)}}}function Ne(t,n,i,r){return e.isArray(i)?void e.each(i,function(i,r){e.isArray(r)?Ne(t,n,r[0],r[1]):Ne(t,n,r)}):(r===l&&(r=i),void(n[i]!==l&&(t[r]=n[i])))}function Pe(t,n,i){var r;for(var o in n)n.hasOwnProperty(o)&&(r=n[o],e.isPlainObject(r)?(e.isPlainObject(t[o])||(t[o]={}),e.extend(!0,t[o],r)):i&&"data"!==o&&"aaData"!==o&&e.isArray(r)?t[o]=r.slice():t[o]=r);return t}function Oe(t,n,i){e(t).bind("click.DT",n,function(e){t.blur(),i(e)}).bind("keypress.DT",n,function(e){13===e.which&&(e.preventDefault(),i(e))}).bind("selectstart.DT",function(){return!1})}function Ve(e,t,n,i){n&&e[t].push({fn:n,sName:i})}function Fe(t,n,i,r){var o=[];if(n&&(o=e.map(t[n].slice().reverse(),function(e,n){return e.fn.apply(t.oInstance,r)})),null!==i){var a=e.Event(i+".dt");e(t.nTable).trigger(a,r),o.push(a.result)}return o}function He(e){var t=e._iDisplayStart,n=e.fnDisplayEnd(),i=e._iDisplayLength;t>=n&&(t=n-i),t-=t%i,(-1===i||0>t)&&(t=0),e._iDisplayStart=t}function ze(t,n){var i=t.renderer,r=Ge.ext.renderer[n];return e.isPlainObject(i)&&i[n]?r[i[n]]||r._:"string"==typeof i?r[i]||r._:r._}function Be(e){return e.oFeatures.bServerSide?"ssp":e.ajax||e.sAjaxSource?"ajax":"dom"}function We(e,t){var n=[],i=Ut.numbers_length,r=Math.floor(i/2);return i>=t?n=pt(0,t):r>=e?(n=pt(0,i-2),n.push("ellipsis"),n.push(t-1)):e>=t-1-r?(n=pt(t-(i-2),t),n.splice(0,0,"ellipsis"),n.splice(0,0,0)):(n=pt(e-r+2,e+r-1),n.push("ellipsis"),n.push(t-1),n.splice(0,0,"ellipsis"),n.splice(0,0,0)),n.DT_el="span",n}function Ue(t){e.each({num:function(e){return qt(e,t)},"num-fmt":function(e){return qt(e,t,rt)},"html-num":function(e){return qt(e,t,et)},"html-num-fmt":function(e){return qt(e,t,et,rt)}},function(e,n){Ye.type.order[e+t+"-pre"]=n,e.match(/^html\-/)&&(Ye.type.search[e+t]=Ye.type.search.html)})}function qe(e){return function(){var t=[je(this[Ge.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return Ge.ext.internal[e].apply(this,t)}}var Ge,Ye,Xe,Ke,Je,Ze={},Qe=/[\r\n]/g,et=/<.*?>/g,tt=/^[\w\+\-]/,nt=/[\w\+\-]$/,it=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"].join("|\\")+")","g"),rt=/[',$£€¥%\u2009\u202F\u20BD\u20a9\u20BArfk]/gi,ot=function(e){return e&&e!==!0&&"-"!==e?!1:!0},at=function(e){var t=parseInt(e,10);return!isNaN(t)&&isFinite(e)?t:null},st=function(e,t){return Ze[t]||(Ze[t]=new RegExp(ee(t),"g")),"string"==typeof e&&"."!==t?e.replace(/\./g,"").replace(Ze[t],"."):e},lt=function(e,t,n){var i="string"==typeof e;return ot(e)?!0:(t&&i&&(e=st(e,t)),n&&i&&(e=e.replace(rt,"")),!isNaN(parseFloat(e))&&isFinite(e))},ct=function(e){return ot(e)||"string"==typeof e},ut=function(e,t,n){if(ot(e))return!0;var i=ct(e);return i&&lt(mt(e),t,n)?!0:null},dt=function(e,t,n){var i=[],r=0,o=e.length;if(n!==l)for(;o>r;r++)e[r]&&e[r][t]&&i.push(e[r][t][n]);else for(;o>r;r++)e[r]&&i.push(e[r][t]);return i},ht=function(e,t,n,i){var r=[],o=0,a=t.length;if(i!==l)for(;a>o;o++)e[t[o]][n]&&r.push(e[t[o]][n][i]);else for(;a>o;o++)r.push(e[t[o]][n]);return r},pt=function(e,t){var n,i=[];t===l?(t=0,n=e):(n=t,t=e);for(var r=t;n>r;r++)i.push(r);return i},ft=function(e){for(var t=[],n=0,i=e.length;i>n;n++)e[n]&&t.push(e[n]);return t},mt=function(e){return e.replace(et,"")},gt=function(e){var t,n,i,r=[],o=e.length,a=0;e:for(n=0;o>n;n++){for(t=e[n],i=0;a>i;i++)if(r[i]===t)continue e;r.push(t),a++}return r},vt=function(e,t,n){e[t]!==l&&(e[n]=e[t])},yt=/\[.*?\]$/,bt=/\(\)$/,_t=e("<div>")[0],wt=_t.textContent!==l,xt=/<.*?>/g;Ge=function(t){this.$=function(e,t){return this.api(!0).$(e,t)},this._=function(e,t){return this.api(!0).rows(e,t).data()},this.api=function(e){return new Xe(e?je(this[Ye.iApiIndex]):this)},this.fnAddData=function(t,n){var i=this.api(!0),r=e.isArray(t)&&(e.isArray(t[0])||e.isPlainObject(t[0]))?i.rows.add(t):i.row.add(t);return(n===l||n)&&i.draw(),r.flatten().toArray()},this.fnAdjustColumnSizing=function(e){var t=this.api(!0).columns.adjust(),n=t.settings()[0],i=n.oScroll;e===l||e?t.draw(!1):(""!==i.sX||""!==i.sY)&&ge(n)},this.fnClearTable=function(e){var t=this.api(!0).clear();(e===l||e)&&t.draw()},this.fnClose=function(e){this.api(!0).row(e).child.hide()},this.fnDeleteRow=function(e,t,n){var i=this.api(!0),r=i.rows(e),o=r.settings()[0],a=o.aoData[r[0][0]];return r.remove(),t&&t.call(this,o,a),(n===l||n)&&i.draw(),a},this.fnDestroy=function(e){this.api(!0).destroy(e)},this.fnDraw=function(e){this.api(!0).draw(e)},this.fnFilter=function(e,t,n,i,r,o){var a=this.api(!0);null===t||t===l?a.search(e,n,i,o):a.column(t).search(e,n,i,o),a.draw()},this.fnGetData=function(e,t){var n=this.api(!0);if(e!==l){var i=e.nodeName?e.nodeName.toLowerCase():"";return t!==l||"td"==i||"th"==i?n.cell(e,t).data():n.row(e).data()||null}return n.data().toArray()},this.fnGetNodes=function(e){var t=this.api(!0);return e!==l?t.row(e).node():t.rows().nodes().flatten().toArray()},this.fnGetPosition=function(e){var t=this.api(!0),n=e.nodeName.toUpperCase();if("TR"==n)return t.row(e).index();if("TD"==n||"TH"==n){var i=t.cell(e).index();return[i.row,i.columnVisible,i.column]}return null},this.fnIsOpen=function(e){return this.api(!0).row(e).child.isShown()},this.fnOpen=function(e,t,n){return this.api(!0).row(e).child(t,n).show().child()[0]},this.fnPageChange=function(e,t){var n=this.api(!0).page(e);(t===l||t)&&n.draw(!1)},this.fnSetColumnVis=function(e,t,n){var i=this.api(!0).column(e).visible(t);(n===l||n)&&i.columns.adjust().draw()},this.fnSettings=function(){return je(this[Ye.iApiIndex])},this.fnSort=function(e){this.api(!0).order(e).draw()},this.fnSortListener=function(e,t,n){this.api(!0).order.listener(e,t,n)},this.fnUpdate=function(e,t,n,i,r){var o=this.api(!0);return n===l||null===n?o.row(t).data(e):o.cell(t,n).data(e),(r===l||r)&&o.columns.adjust(),(i===l||i)&&o.draw(),0},this.fnVersionCheck=Ye.fnVersionCheck;var a=this,s=t===l,u=this.length;s&&(t={}),this.oApi=this.internal=Ye.internal;for(var p in Ge.ext.internal)p&&(this[p]=qe(p));return this.each(function(){var p,f={},m=u>1?Pe(f,t,!0):t,g=0,v=this.getAttribute("id"),y=!1,x=Ge.defaults,C=e(this);if("table"!=this.nodeName.toLowerCase())return void Ee(null,0,"Non-table node initialisation ("+this.nodeName+")",2);r(x),o(x.column),n(x,x,!0),n(x.column,x.column,!0),n(x,e.extend(m,C.data()));var k=Ge.settings;for(g=0,p=k.length;p>g;g++){var S=k[g];if(S.nTable==this||S.nTHead.parentNode==this||S.nTFoot&&S.nTFoot.parentNode==this){var T=m.bRetrieve!==l?m.bRetrieve:x.bRetrieve,M=m.bDestroy!==l?m.bDestroy:x.bDestroy;if(s||T)return S.oInstance;if(M){S.oInstance.fnDestroy();break}return void Ee(S,0,"Cannot reinitialise DataTable",3)}if(S.sTableId==this.id){k.splice(g,1);break}}(null===v||""===v)&&(v="DataTables_Table_"+Ge.ext._unique++,this.id=v);var $=e.extend(!0,{},Ge.models.oSettings,{sDestroyWidth:C[0].style.width,sInstance:v,sTableId:v});$.nTable=this,$.oApi=a.internal,$.oInit=m,k.push($),$.oInstance=1===a.length?a:C.dataTable(),r(m),m.oLanguage&&i(m.oLanguage),m.aLengthMenu&&!m.iDisplayLength&&(m.iDisplayLength=e.isArray(m.aLengthMenu[0])?m.aLengthMenu[0][0]:m.aLengthMenu[0]),m=Pe(e.extend(!0,{},x),m),Ne($.oFeatures,m,["bPaginate","bLengthChange","bFilter","bSort","bSortMulti","bInfo","bProcessing","bAutoWidth","bSortClasses","bServerSide","bDeferRender"]),Ne($,m,["asStripeClasses","ajax","fnServerData","fnFormatNumber","sServerMethod","aaSorting","aaSortingFixed","aLengthMenu","sPaginationType","sAjaxSource","sAjaxDataProp","iStateDuration","sDom","bSortCellsTop","iTabIndex","fnStateLoadCallback","fnStateSaveCallback","renderer","searchDelay","rowId",["iCookieDuration","iStateDuration"],["oSearch","oPreviousSearch"],["aoSearchCols","aoPreSearchCols"],["iDisplayLength","_iDisplayLength"],["bJQueryUI","bJUI"]]),Ne($.oScroll,m,[["sScrollX","sX"],["sScrollXInner","sXInner"],["sScrollY","sY"],["bScrollCollapse","bCollapse"]]),Ne($.oLanguage,m,"fnInfoCallback"),Ve($,"aoDrawCallback",m.fnDrawCallback,"user"),Ve($,"aoServerParams",m.fnServerParams,"user"),Ve($,"aoStateSaveParams",m.fnStateSaveParams,"user"),Ve($,"aoStateLoadParams",m.fnStateLoadParams,"user"),Ve($,"aoStateLoaded",m.fnStateLoaded,"user"),Ve($,"aoRowCallback",m.fnRowCallback,"user"),Ve($,"aoRowCreatedCallback",m.fnCreatedRow,"user"),Ve($,"aoHeaderCallback",m.fnHeaderCallback,"user"),Ve($,"aoFooterCallback",m.fnFooterCallback,"user"),Ve($,"aoInitComplete",m.fnInitComplete,"user"),Ve($,"aoPreDrawCallback",m.fnPreDrawCallback,"user"),$.rowIdFn=D(m.rowId);var L=$.oClasses;if(m.bJQueryUI?(e.extend(L,Ge.ext.oJUIClasses,m.oClasses),m.sDom===x.sDom&&"lfrtip"===x.sDom&&($.sDom='<"H"lfr>t<"F"ip>'),$.renderer?e.isPlainObject($.renderer)&&!$.renderer.header&&($.renderer.header="jqueryui"):$.renderer="jqueryui"):e.extend(L,Ge.ext.classes,m.oClasses),C.addClass(L.sTable),(""!==$.oScroll.sX||""!==$.oScroll.sY)&&($.oScroll.iBarWidth=ke()),$.iInitDisplayStart===l&&($.iInitDisplayStart=m.iDisplayStart,$._iDisplayStart=m.iDisplayStart),null!==m.iDeferLoading){$.bDeferLoading=!0;var A=e.isArray(m.iDeferLoading);$._iRecordsDisplay=A?m.iDeferLoading[0]:m.iDeferLoading,$._iRecordsTotal=A?m.iDeferLoading[1]:m.iDeferLoading}var R=$.oLanguage;e.extend(!0,R,m.oLanguage),""!==R.sUrl&&(e.ajax({dataType:"json",url:R.sUrl,success:function(t){i(t),n(x.oLanguage,t),e.extend(!0,R,t),se($)},error:function(){se($)}}),y=!0),null===m.asStripeClasses&&($.asStripeClasses=[L.sStripeOdd,L.sStripeEven]);var j=$.asStripeClasses,E=C.children("tbody").find("tr").eq(0);-1!==e.inArray(!0,e.map(j,function(e,t){return E.hasClass(e)}))&&(e("tbody tr",this).removeClass(j.join(" ")),$.asDestroyStripes=j.slice());var N,P=[],O=this.getElementsByTagName("thead");if(0!==O.length&&(H($.aoHeader,O[0]),P=z($)),null===m.aoColumns)for(N=[],g=0,p=P.length;p>g;g++)N.push(null);else N=m.aoColumns;for(g=0,p=N.length;p>g;g++)d($,P?P[g]:null);if(b($,m.aoColumnDefs,N,function(e,t){h($,e,t)}),E.length){var V=function(e,t){return null!==e.getAttribute("data-"+t)?t:null};e.each(I($,E[0]).cells,function(e,t){var n=$.aoColumns[e];if(n.mData===e){var i=V(t,"sort")||V(t,"order"),r=V(t,"filter")||V(t,"search");(null!==i||null!==r)&&(n.mData={_:e+".display",sort:null!==i?e+".@data-"+i:l,type:null!==i?e+".@data-"+i:l,filter:null!==r?e+".@data-"+r:l},h($,e))}})}var F=$.oFeatures;if(m.bStateSave&&(F.bStateSave=!0,Ie($,m),Ve($,"aoDrawCallback",Re,"state_save")),m.aaSorting===l){var B=$.aaSorting;for(g=0,p=B.length;p>g;g++)B[g][1]=$.aoColumns[g].asSorting[0]}Le($),F.bSort&&Ve($,"aoDrawCallback",function(){if($.bSorted){var t=Se($),n={};e.each(t,function(e,t){n[t.src]=t.dir}),Fe($,null,"order",[$,t,n]),De($)}}),Ve($,"aoDrawCallback",function(){($.bSorted||"ssp"===Be($)||F.bDeferRender)&&Le($)},"sc"),c($);var W=C.children("caption").each(function(){this._captionSide=C.css("caption-side")}),U=C.children("thead");0===U.length&&(U=e("<thead/>").appendTo(this)),$.nTHead=U[0];var q=C.children("tbody");0===q.length&&(q=e("<tbody/>").appendTo(this)),$.nTBody=q[0];var G=C.children("tfoot");if(0===G.length&&W.length>0&&(""!==$.oScroll.sX||""!==$.oScroll.sY)&&(G=e("<tfoot/>").appendTo(this)),0===G.length||0===G.children().length?C.addClass(L.sNoFooter):G.length>0&&($.nTFoot=G[0],H($.aoFooter,$.nTFoot)),m.aaData)for(g=0;g<m.aaData.length;g++)_($,m.aaData[g]);else($.bDeferLoading||"dom"==Be($))&&w($,e($.nTBody).children("tr"));$.aiDisplay=$.aiDisplayMaster.slice(),$.bInitialised=!0,y===!1&&se($)}),a=null,this};var Ct=[],kt=Array.prototype,St=function(t){var n,i,r=Ge.settings,o=e.map(r,function(e,t){return e.nTable});return t?t.nTable&&t.oApi?[t]:t.nodeName&&"table"===t.nodeName.toLowerCase()?(n=e.inArray(t,o),-1!==n?[r[n]]:null):t&&"function"==typeof t.settings?t.settings().toArray():("string"==typeof t?i=e(t):t instanceof e&&(i=t),i?i.map(function(t){return n=e.inArray(this,o),-1!==n?r[n]:null}).toArray():void 0):[]};Xe=function(t,n){if(!(this instanceof Xe))return new Xe(t,n);var i=[],r=function(e){var t=St(e);t&&i.push.apply(i,t)};if(e.isArray(t))for(var o=0,a=t.length;a>o;o++)r(t[o]);else r(t);this.context=gt(i),n&&this.push.apply(this,n.toArray?n.toArray():n),this.selector={rows:null,cols:null,opts:null},Xe.extend(this,this,Ct)},Ge.Api=Xe,Xe.prototype={any:function(){return 0!==this.count()},concat:kt.concat,context:[],count:function(){return this.flatten().length},each:function(e){for(var t=0,n=this.length;n>t;t++)e.call(this,this[t],t,this);return this},eq:function(e){var t=this.context;return t.length>e?new Xe(t[e],this[e]):null},filter:function(e){var t=[];if(kt.filter)t=kt.filter.call(this,e,this);else for(var n=0,i=this.length;i>n;n++)e.call(this,this[n],n,this)&&t.push(this[n]);return new Xe(this.context,t)},flatten:function(){var e=[];return new Xe(this.context,e.concat.apply(e,this.toArray()))},join:kt.join,indexOf:kt.indexOf||function(e,t){for(var n=t||0,i=this.length;i>n;n++)if(this[n]===e)return n;return-1},iterator:function(e,t,n,i){var r,o,a,s,c,u,d,h,p=[],f=this.context,m=this.selector;for("string"==typeof e&&(i=n,n=t,t=e,e=!1),o=0,a=f.length;a>o;o++){var g=new Xe(f[o]);if("table"===t)r=n.call(g,f[o],o),r!==l&&p.push(r);else if("columns"===t||"rows"===t)r=n.call(g,f[o],this[o],o),r!==l&&p.push(r);else if("column"===t||"column-rows"===t||"row"===t||"cell"===t)for(d=this[o],"column-rows"===t&&(u=At(f[o],m.opts)),s=0,c=d.length;c>s;s++)h=d[s],r="cell"===t?n.call(g,f[o],h.row,h.column,o,s):n.call(g,f[o],h,o,s,u),r!==l&&p.push(r)}if(p.length||i){var v=new Xe(f,e?p.concat.apply([],p):p),y=v.selector;return y.rows=m.rows,y.cols=m.cols,y.opts=m.opts,v}return this},lastIndexOf:kt.lastIndexOf||function(e,t){return this.indexOf.apply(this.toArray.reverse(),arguments)},length:0,map:function(e){var t=[];if(kt.map)t=kt.map.call(this,e,this);else for(var n=0,i=this.length;i>n;n++)t.push(e.call(this,this[n],n));return new Xe(this.context,t)},pluck:function(e){return this.map(function(t){return t[e]})},pop:kt.pop,push:kt.push,reduce:kt.reduce||function(e,t){return u(this,e,t,0,this.length,1)},reduceRight:kt.reduceRight||function(e,t){return u(this,e,t,this.length-1,-1,-1)},reverse:kt.reverse,selector:null,shift:kt.shift,sort:kt.sort,splice:kt.splice,toArray:function(){return kt.slice.call(this)},to$:function(){return e(this)},toJQuery:function(){return e(this)},unique:function(){return new Xe(this.context,gt(this))},unshift:kt.unshift},Xe.extend=function(t,n,i){if(i.length&&n&&(n instanceof Xe||n.__dt_wrapper)){var r,o,a,s=function(e,t,n){return function(){var i=t.apply(e,arguments);return Xe.extend(i,i,n.methodExt),i}};for(r=0,o=i.length;o>r;r++)a=i[r],n[a.name]="function"==typeof a.val?s(t,a.val,a):e.isPlainObject(a.val)?{}:a.val,n[a.name].__dt_wrapper=!0,Xe.extend(t,n[a.name],a.propExt)}},Xe.register=Ke=function(t,n){if(e.isArray(t))for(var i=0,r=t.length;r>i;i++)Xe.register(t[i],n);else{var o,a,s,l,c=t.split("."),u=Ct,d=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n].name===t)return e[n];return null};for(o=0,a=c.length;a>o;o++){l=-1!==c[o].indexOf("()"),s=l?c[o].replace("()",""):c[o];var h=d(u,s);h||(h={name:s,val:{},methodExt:[],propExt:[]},u.push(h)),o===a-1?h.val=n:u=l?h.methodExt:h.propExt}}},Xe.registerPlural=Je=function(t,n,i){Xe.register(t,i),Xe.register(n,function(){var t=i.apply(this,arguments);return t===this?this:t instanceof Xe?t.length?e.isArray(t[0])?new Xe(t.context,t[0]):t[0]:l:t})};var Tt=function(t,n){if("number"==typeof t)return[n[t]];var i=e.map(n,function(e,t){return e.nTable});return e(i).filter(t).map(function(t){var r=e.inArray(this,i);return n[r]}).toArray()};Ke("tables()",function(e){return e?new Xe(Tt(e,this.context)):this}),Ke("table()",function(e){var t=this.tables(e),n=t.context;return n.length?new Xe(n[0]):t}),Je("tables().nodes()","table().node()",function(){return this.iterator("table",function(e){return e.nTable},1)}),Je("tables().body()","table().body()",function(){return this.iterator("table",function(e){return e.nTBody},1)}),Je("tables().header()","table().header()",function(){return this.iterator("table",function(e){return e.nTHead},1)}),Je("tables().footer()","table().footer()",function(){return this.iterator("table",function(e){return e.nTFoot},1)}),Je("tables().containers()","table().container()",function(){return this.iterator("table",function(e){return e.nTableWrapper},1)}),Ke("draw()",function(e){return this.iterator("table",function(t){"page"===e?O(t):("string"==typeof e&&(e="full-hold"===e?!1:!0),V(t,e===!1))})}),Ke("page()",function(e){return e===l?this.page.info().page:this.iterator("table",function(t){he(t,e)})}),Ke("page.info()",function(e){if(0===this.context.length)return l;var t=this.context[0],n=t._iDisplayStart,i=t._iDisplayLength,r=t.fnRecordsDisplay(),o=-1===i;return{page:o?0:Math.floor(n/i),pages:o?1:Math.ceil(r/i),start:n,end:t.fnDisplayEnd(),length:i,recordsTotal:t.fnRecordsTotal(),recordsDisplay:r,serverSide:"ssp"===Be(t)}}),Ke("page.len()",function(e){return e===l?0!==this.context.length?this.context[0]._iDisplayLength:l:this.iterator("table",function(t){ce(t,e)})});var Dt=function(e,t,n){if(n){var i=new Xe(e);i.one("draw",function(){n(i.ajax.json())})}if("ssp"==Be(e))V(e,t);else{fe(e,!0);var r=e.jqXHR;r&&4!==r.readyState&&r.abort(),B(e,[],function(n){L(e);for(var i=G(e,n),r=0,o=i.length;o>r;r++)_(e,i[r]);V(e,t),fe(e,!1)})}};Ke("ajax.json()",function(){var e=this.context;return e.length>0?e[0].json:void 0}),Ke("ajax.params()",function(){var e=this.context;return e.length>0?e[0].oAjaxData:void 0}),Ke("ajax.reload()",function(e,t){return this.iterator("table",function(n){Dt(n,t===!1,e)})}),Ke("ajax.url()",function(t){var n=this.context;return t===l?0===n.length?l:(n=n[0],n.ajax?e.isPlainObject(n.ajax)?n.ajax.url:n.ajax:n.sAjaxSource):this.iterator("table",function(n){e.isPlainObject(n.ajax)?n.ajax.url=t:n.ajax=t})}),Ke("ajax.url().load()",function(e,t){return this.iterator("table",function(n){Dt(n,t===!1,e)})});var Mt=function(t,n,i,r,o){var a,s,c,u,d,h,p=[],f=typeof n;for(n&&"string"!==f&&"function"!==f&&n.length!==l||(n=[n]),c=0,u=n.length;u>c;c++)for(s=n[c]&&n[c].split?n[c].split(","):[n[c]],d=0,h=s.length;h>d;d++)a=i("string"==typeof s[d]?e.trim(s[d]):s[d]),a&&a.length&&p.push.apply(p,a);var m=Ye.selector[t];if(m.length)for(c=0,u=m.length;u>c;c++)p=m[c](r,o,p);return p},$t=function(t){return t||(t={}),t.filter&&t.search===l&&(t.search=t.filter),e.extend({search:"none",order:"current",page:"all"},t)},Lt=function(e){for(var t=0,n=e.length;n>t;t++)if(e[t].length>0)return e[0]=e[t],e[0].length=1,e.length=1,e.context=[e.context[t]],e;return e.length=0,e},At=function(t,n){var i,r,o,a=[],s=t.aiDisplay,l=t.aiDisplayMaster,c=n.search,u=n.order,d=n.page;if("ssp"==Be(t))return"removed"===c?[]:pt(0,l.length);if("current"==d)for(i=t._iDisplayStart,r=t.fnDisplayEnd();r>i;i++)a.push(s[i]);else if("current"==u||"applied"==u)a="none"==c?l.slice():"applied"==c?s.slice():e.map(l,function(t,n){return-1===e.inArray(t,s)?t:null});else if("index"==u||"original"==u)for(i=0,r=t.aoData.length;r>i;i++)"none"==c?a.push(i):(o=e.inArray(i,s),(-1===o&&"removed"==c||o>=0&&"applied"==c)&&a.push(i));return a},Rt=function(t,n,i){var r=function(n){var r=at(n);if(null!==r&&!i)return[r];var o=At(t,i);if(null!==r&&-1!==e.inArray(r,o))return[r];if(!n)return o;if("function"==typeof n)return e.map(o,function(e){var i=t.aoData[e];return n(e,i._aData,i.nTr)?e:null});var a=ft(ht(t.aoData,o,"nTr"));if(n.nodeName&&-1!==e.inArray(n,a))return[n._DT_RowIndex];if("string"==typeof n&&"#"===n.charAt(0)){var s=t.aIds[n.replace(/^#/,"")];if(s!==l)return[s.idx]}return e(a).filter(n).map(function(){return this._DT_RowIndex}).toArray()};return Mt("row",n,r,t,i)};Ke("rows()",function(t,n){t===l?t="":e.isPlainObject(t)&&(n=t,t=""),n=$t(n);var i=this.iterator("table",function(e){return Rt(e,t,n)},1);return i.selector.rows=t,i.selector.opts=n,i}),Ke("rows().nodes()",function(){return this.iterator("row",function(e,t){return e.aoData[t].nTr||l},1)}),Ke("rows().data()",function(){return this.iterator(!0,"rows",function(e,t){return ht(e.aoData,t,"_aData")},1)}),Je("rows().cache()","row().cache()",function(e){return this.iterator("row",function(t,n){var i=t.aoData[n];return"search"===e?i._aFilterData:i._aSortData},1)}),Je("rows().invalidate()","row().invalidate()",function(e){return this.iterator("row",function(t,n){R(t,n,e)})}),Je("rows().indexes()","row().index()",function(){return this.iterator("row",function(e,t){return t},1)}),Je("rows().ids()","row().id()",function(e){for(var t=[],n=this.context,i=0,r=n.length;r>i;i++)for(var o=0,a=this[i].length;a>o;o++){var s=n[i].rowIdFn(n[i].aoData[this[i][o]]._aData);t.push((e===!0?"#":"")+s)}return new Xe(n,t)}),Je("rows().remove()","row().remove()",function(){var e=this;return this.iterator("row",function(t,n,i){var r=t.aoData;r.splice(n,1);for(var o=0,a=r.length;a>o;o++)null!==r[o].nTr&&(r[o].nTr._DT_RowIndex=o);A(t.aiDisplayMaster,n),A(t.aiDisplay,n),A(e[i],n,!1),He(t)}),this.iterator("table",function(e){for(var t=0,n=e.aoData.length;n>t;t++)e.aoData[t].idx=t}),this}),Ke("rows.add()",function(e){var t=this.iterator("table",function(t){var n,i,r,o=[];for(i=0,r=e.length;r>i;i++)n=e[i],n.nodeName&&"TR"===n.nodeName.toUpperCase()?o.push(w(t,n)[0]):o.push(_(t,n));return o},1),n=this.rows(-1);return n.pop(),n.push.apply(n,t.toArray()),n}),Ke("row()",function(e,t){return Lt(this.rows(e,t))}),Ke("row().data()",function(e){var t=this.context;return e===l?t.length&&this.length?t[0].aoData[this[0]]._aData:l:(t[0].aoData[this[0]]._aData=e,R(t[0],this[0],"data"),this)}),Ke("row().node()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]].nTr||null:null}),Ke("row.add()",function(t){t instanceof e&&t.length&&(t=t[0]);var n=this.iterator("table",function(e){return t.nodeName&&"TR"===t.nodeName.toUpperCase()?w(e,t)[0]:_(e,t)});return this.row(n[0])});var It=function(t,n,i,r){var o=[],a=function(n,i){if(e.isArray(n)||n instanceof e)for(var r=0,s=n.length;s>r;r++)a(n[r],i);else if(n.nodeName&&"tr"===n.nodeName.toLowerCase())o.push(n);else{var l=e("<tr><td/></tr>").addClass(i);e("td",l).addClass(i).html(n)[0].colSpan=g(t),o.push(l[0])}};a(i,r),n._details&&n._details.remove(),n._details=e(o),n._detailsShow&&n._details.insertAfter(n.nTr)},jt=function(e,t){var n=e.context;if(n.length){var i=n[0].aoData[t!==l?t:e[0]];i&&i._details&&(i._details.remove(),i._detailsShow=l,i._details=l)}},Et=function(e,t){var n=e.context;if(n.length&&e.length){var i=n[0].aoData[e[0]];i._details&&(i._detailsShow=t,t?i._details.insertAfter(i.nTr):i._details.detach(),Nt(n[0]))}},Nt=function(e){var t=new Xe(e),n=".dt.DT_details",i="draw"+n,r="column-visibility"+n,o="destroy"+n,a=e.aoData;t.off(i+" "+r+" "+o),dt(a,"_details").length>0&&(t.on(i,function(n,i){e===i&&t.rows({page:"current"}).eq(0).each(function(e){var t=a[e];t._detailsShow&&t._details.insertAfter(t.nTr)})}),t.on(r,function(t,n,i,r){if(e===n)for(var o,s=g(n),l=0,c=a.length;c>l;l++)o=a[l],o._details&&o._details.children("td[colspan]").attr("colspan",s)}),t.on(o,function(n,i){if(e===i)for(var r=0,o=a.length;o>r;r++)a[r]._details&&jt(t,r)}))},Pt="",Ot=Pt+"row().child",Vt=Ot+"()";Ke(Vt,function(e,t){var n=this.context;return e===l?n.length&&this.length?n[0].aoData[this[0]]._details:l:(e===!0?this.child.show():e===!1?jt(this):n.length&&this.length&&It(n[0],n[0].aoData[this[0]],e,t),this)}),Ke([Ot+".show()",Vt+".show()"],function(e){return Et(this,!0),this}),Ke([Ot+".hide()",Vt+".hide()"],function(){return Et(this,!1),this}),Ke([Ot+".remove()",Vt+".remove()"],function(){return jt(this),this}),Ke(Ot+".isShown()",function(){var e=this.context;return e.length&&this.length?e[0].aoData[this[0]]._detailsShow||!1:!1});var Ft=/^(.+):(name|visIdx|visible)$/,Ht=function(e,t,n,i,r){for(var o=[],a=0,s=r.length;s>a;a++)o.push(k(e,r[a],t));return o},zt=function(t,n,i){var r=t.aoColumns,o=dt(r,"sName"),a=dt(r,"nTh"),s=function(n){var s=at(n);if(""===n)return pt(r.length);if(null!==s)return[s>=0?s:r.length+s];if("function"==typeof n){var l=At(t,i);return e.map(r,function(e,i){return n(i,Ht(t,i,0,0,l),a[i])?i:null})}var c="string"==typeof n?n.match(Ft):"";if(!c)return e(a).filter(n).map(function(){return e.inArray(this,a)}).toArray();switch(c[2]){case"visIdx":case"visible":var u=parseInt(c[1],10);if(0>u){var d=e.map(r,function(e,t){return e.bVisible?t:null});return[d[d.length+u]]}return[f(t,u)];case"name":return e.map(o,function(e,t){return e===c[1]?t:null})}};return Mt("column",n,s,t,i)},Bt=function(t,n,i,r){var o,a,s,c,u=t.aoColumns,d=u[n],h=t.aoData;if(i===l)return d.bVisible;if(d.bVisible!==i){if(i){var f=e.inArray(!0,dt(u,"bVisible"),n+1);for(a=0,s=h.length;s>a;a++)c=h[a].nTr,o=h[a].anCells,c&&c.insertBefore(o[n],o[f]||null)}else e(dt(t.aoData,"anCells",n)).detach();d.bVisible=i,P(t,t.aoHeader),P(t,t.aoFooter),(r===l||r)&&(p(t),(t.oScroll.sX||t.oScroll.sY)&&ge(t)),Fe(t,null,"column-visibility",[t,n,i]),Re(t)}};Ke("columns()",function(t,n){t===l?t="":e.isPlainObject(t)&&(n=t,t=""),n=$t(n);var i=this.iterator("table",function(e){return zt(e,t,n)},1);return i.selector.cols=t,i.selector.opts=n,i}),Je("columns().header()","column().header()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTh},1)}),Je("columns().footer()","column().footer()",function(e,t){return this.iterator("column",function(e,t){return e.aoColumns[t].nTf},1)}),Je("columns().data()","column().data()",function(){return this.iterator("column-rows",Ht,1)}),Je("columns().dataSrc()","column().dataSrc()",function(){return this.iterator("column",function(e,t){return e.aoColumns[t].mData},1)}),Je("columns().cache()","column().cache()",function(e){return this.iterator("column-rows",function(t,n,i,r,o){return ht(t.aoData,o,"search"===e?"_aFilterData":"_aSortData",n)},1)}),Je("columns().nodes()","column().nodes()",function(){return this.iterator("column-rows",function(e,t,n,i,r){return ht(e.aoData,r,"anCells",t)},1)}),Je("columns().visible()","column().visible()",function(e,t){return this.iterator("column",function(n,i){return e===l?n.aoColumns[i].bVisible:void Bt(n,i,e,t)})}),Je("columns().indexes()","column().index()",function(e){return this.iterator("column",function(t,n){return"visible"===e?m(t,n):n},1)}),Ke("columns.adjust()",function(){return this.iterator("table",function(e){p(e)},1)}),Ke("column.index()",function(e,t){if(0!==this.context.length){var n=this.context[0];if("fromVisible"===e||"toData"===e)return f(n,t);if("fromData"===e||"toVisible"===e)return m(n,t)}}),Ke("column()",function(e,t){return Lt(this.columns(e,t))});var Wt=function(t,n,i){var r,o,a,s,c,u,d,h=t.aoData,p=At(t,i),f=ft(ht(h,p,"anCells")),m=e([].concat.apply([],f)),g=t.aoColumns.length,v=function(n){var i="function"==typeof n;if(null===n||n===l||i){for(o=[],a=0,s=p.length;s>a;a++)for(r=p[a],c=0;g>c;c++)u={row:r,column:c},i?(d=t.aoData[r],n(u,k(t,r,c),d.anCells?d.anCells[c]:null)&&o.push(u)):o.push(u);return o}return e.isPlainObject(n)?[n]:m.filter(n).map(function(t,n){return r=n.parentNode._DT_RowIndex,{row:r,column:e.inArray(n,h[r].anCells)}}).toArray()};return Mt("cell",n,v,t,i)};Ke("cells()",function(t,n,i){if(e.isPlainObject(t)&&(t.row===l?(i=t,t=null):(i=n,n=null)),e.isPlainObject(n)&&(i=n,n=null),null===n||n===l)return this.iterator("table",function(e){return Wt(e,t,$t(i))});var r,o,a,s,c,u=this.columns(n,i),d=this.rows(t,i),h=this.iterator("table",function(e,t){for(r=[],o=0,a=d[t].length;a>o;o++)for(s=0,c=u[t].length;c>s;s++)r.push({row:d[t][o],column:u[t][s]});return r},1);return e.extend(h.selector,{cols:n,rows:t,opts:i}),h}),Je("cells().nodes()","cell().node()",function(){return this.iterator("cell",function(e,t,n){var i=e.aoData[t].anCells;return i?i[n]:l},1)}),Ke("cells().data()",function(){return this.iterator("cell",function(e,t,n){return k(e,t,n)},1)}),Je("cells().cache()","cell().cache()",function(e){return e="search"===e?"_aFilterData":"_aSortData",this.iterator("cell",function(t,n,i){return t.aoData[n][e][i]},1)}),Je("cells().render()","cell().render()",function(e){return this.iterator("cell",function(t,n,i){return k(t,n,i,e)},1)}),Je("cells().indexes()","cell().index()",function(){return this.iterator("cell",function(e,t,n){return{row:t,column:n,columnVisible:m(e,n)}},1)}),Je("cells().invalidate()","cell().invalidate()",function(e){return this.iterator("cell",function(t,n,i){R(t,n,e,i)})}),Ke("cell()",function(e,t,n){return Lt(this.cells(e,t,n))}),Ke("cell().data()",function(e){var t=this.context,n=this[0];return e===l?t.length&&n.length?k(t[0],n[0].row,n[0].column):l:(S(t[0],n[0].row,n[0].column,e),R(t[0],n[0].row,"data",n[0].column),this)}),Ke("order()",function(t,n){var i=this.context;return t===l?0!==i.length?i[0].aaSorting:l:("number"==typeof t?t=[[t,n]]:e.isArray(t[0])||(t=Array.prototype.slice.call(arguments)),this.iterator("table",function(e){e.aaSorting=t.slice()}))}),Ke("order.listener()",function(e,t,n){return this.iterator("table",function(i){$e(i,e,t,n)})}),Ke(["columns().order()","column().order()"],function(t){var n=this;return this.iterator("table",function(i,r){var o=[];e.each(n[r],function(e,n){o.push([n,t])}),i.aaSorting=o})}),Ke("search()",function(t,n,i,r){var o=this.context;return t===l?0!==o.length?o[0].oPreviousSearch.sSearch:l:this.iterator("table",function(o){o.oFeatures.bFilter&&X(o,e.extend({},o.oPreviousSearch,{sSearch:t+"",bRegex:null===n?!1:n,bSmart:null===i?!0:i,bCaseInsensitive:null===r?!0:r}),1)})}),Je("columns().search()","column().search()",function(t,n,i,r){return this.iterator("column",function(o,a){var s=o.aoPreSearchCols;return t===l?s[a].sSearch:void(o.oFeatures.bFilter&&(e.extend(s[a],{sSearch:t+"",bRegex:null===n?!1:n,bSmart:null===i?!0:i,bCaseInsensitive:null===r?!0:r}),X(o,o.oPreviousSearch,1)))})}),Ke("state()",function(){return this.context.length?this.context[0].oSavedState:null}),Ke("state.clear()",function(){return this.iterator("table",function(e){e.fnStateSaveCallback.call(e.oInstance,e,{})})}),Ke("state.loaded()",function(){return this.context.length?this.context[0].oLoadedState:null}),Ke("state.save()",function(){return this.iterator("table",function(e){Re(e)})}),Ge.versionCheck=Ge.fnVersionCheck=function(e){for(var t,n,i=Ge.version.split("."),r=e.split("."),o=0,a=r.length;a>o;o++)if(t=parseInt(i[o],10)||0,n=parseInt(r[o],10)||0,t!==n)return t>n;return!0},Ge.isDataTable=Ge.fnIsDataTable=function(t){var n=e(t).get(0),i=!1;return e.each(Ge.settings,function(t,r){var o=r.nScrollHead?e("table",r.nScrollHead)[0]:null,a=r.nScrollFoot?e("table",r.nScrollFoot)[0]:null;(r.nTable===n||o===n||a===n)&&(i=!0)}),i},Ge.tables=Ge.fnTables=function(t){var n=!1;e.isPlainObject(t)&&(n=t.api,t=t.visible);var i=e.map(Ge.settings,function(n){return!t||t&&e(n.nTable).is(":visible")?n.nTable:void 0;
});return n?new Xe(i):i},Ge.util={throttle:be,escapeRegex:ee},Ge.camelToHungarian=n,Ke("$()",function(t,n){var i=this.rows(n).nodes(),r=e(i);return e([].concat(r.filter(t).toArray(),r.find(t).toArray()))}),e.each(["on","one","off"],function(t,n){Ke(n+"()",function(){var t=Array.prototype.slice.call(arguments);t[0].match(/\.dt\b/)||(t[0]+=".dt");var i=e(this.tables().nodes());return i[n].apply(i,t),this})}),Ke("clear()",function(){return this.iterator("table",function(e){L(e)})}),Ke("settings()",function(){return new Xe(this.context,this.context)}),Ke("init()",function(){var e=this.context;return e.length?e[0].oInit:null}),Ke("data()",function(){return this.iterator("table",function(e){return dt(e.aoData,"_aData")}).flatten()}),Ke("destroy()",function(t){return t=t||!1,this.iterator("table",function(n){var i,r=n.nTableWrapper.parentNode,o=n.oClasses,s=n.nTable,l=n.nTBody,c=n.nTHead,u=n.nTFoot,d=e(s),h=e(l),p=e(n.nTableWrapper),f=e.map(n.aoData,function(e){return e.nTr});n.bDestroying=!0,Fe(n,"aoDestroyCallback","destroy",[n]),t||new Xe(n).columns().visible(!0),p.unbind(".DT").find(":not(tbody *)").unbind(".DT"),e(a).unbind(".DT-"+n.sInstance),s!=c.parentNode&&(d.children("thead").detach(),d.append(c)),u&&s!=u.parentNode&&(d.children("tfoot").detach(),d.append(u)),n.aaSorting=[],n.aaSortingFixed=[],Le(n),e(f).removeClass(n.asStripeClasses.join(" ")),e("th, td",c).removeClass(o.sSortable+" "+o.sSortableAsc+" "+o.sSortableDesc+" "+o.sSortableNone),n.bJUI&&(e("th span."+o.sSortIcon+", td span."+o.sSortIcon,c).detach(),e("th, td",c).each(function(){var t=e("div."+o.sSortJUIWrapper,this);e(this).append(t.contents()),t.detach()})),h.children().detach(),h.append(f);var m=t?"remove":"detach";d[m](),p[m](),!t&&r&&(r.insertBefore(s,n.nTableReinsertBefore),d.css("width",n.sDestroyWidth).removeClass(o.sTable),i=n.asDestroyStripes.length,i&&h.children().each(function(t){e(this).addClass(n.asDestroyStripes[t%i])}));var g=e.inArray(n,Ge.settings);-1!==g&&Ge.settings.splice(g,1)})}),e.each(["column","row","cell"],function(e,t){Ke(t+"s().every()",function(e){return this.iterator(t,function(n,i,r,o,a){e.call(new Xe(n)[t](i,"cell"===t?r:l),i,r,o,a)})})}),Ke("i18n()",function(t,n,i){var r=this.context[0],o=D(t)(r.oLanguage);return o===l&&(o=n),i!==l&&e.isPlainObject(o)&&(o=o[i]!==l?o[i]:o._),o.replace("%d",i)}),Ge.version="1.10.8",Ge.settings=[],Ge.models={},Ge.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},Ge.models.oRow={nTr:null,anCells:null,_aData:[],_aSortData:null,_aFilterData:null,_sFilterRow:null,_sRowStripe:"",src:null,idx:-1},Ge.models.oColumn={idx:null,aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bVisible:null,_sManualType:null,_bAttrSrc:!1,fnCreatedCell:null,fnGetData:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},Ge.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:[],ajax:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollCollapse:!1,bServerSide:!1,bSort:!0,bSortMulti:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,this.oLanguage.sThousands)},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:null,fnServerParams:null,fnStateLoadCallback:function(e){try{return JSON.parse((-1===e.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+e.sInstance+"_"+location.pathname))}catch(t){}},fnStateLoadParams:null,fnStateLoaded:null,fnStateSaveCallback:function(e,t){try{(-1===e.iStateDuration?sessionStorage:localStorage).setItem("DataTables_"+e.sInstance+"_"+location.pathname,JSON.stringify(t))}catch(n){}},fnStateSaveParams:null,iStateDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iTabIndex:0,oClasses:{},oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sDecimal:"",sThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sSearchPlaceholder:"",sUrl:"",sZeroRecords:"No matching records found"},oSearch:e.extend({},Ge.models.oSearch),sAjaxDataProp:"data",sAjaxSource:null,sDom:"lfrtip",searchDelay:null,sPaginationType:"simple_numbers",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET",renderer:null,rowId:"DT_RowId"},t(Ge.defaults),Ge.defaults.column={aDataSort:null,iDataSort:-1,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bVisible:!0,fnCreatedCell:null,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},t(Ge.defaults.column),Ge.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortMulti:null,bSortClasses:null,bStateSave:null},oScroll:{bCollapse:null,iBarWidth:0,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1,bScrollbarLeft:!1,bBounding:!1},ajax:null,aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aIds:{},aoColumns:[],aoHeader:[],aoFooter:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:[],asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,searchDelay:null,sPaginationType:"two_button",iStateDuration:0,aoStateSave:[],aoStateLoad:[],oSavedState:null,oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,json:l,oAjaxData:l,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return"ssp"==Be(this)?1*this._iRecordsTotal:this.aiDisplayMaster.length},fnRecordsDisplay:function(){return"ssp"==Be(this)?1*this._iRecordsDisplay:this.aiDisplay.length},fnDisplayEnd:function(){var e=this._iDisplayLength,t=this._iDisplayStart,n=t+e,i=this.aiDisplay.length,r=this.oFeatures,o=r.bPaginate;return r.bServerSide?o===!1||-1===e?t+i:Math.min(t+e,this._iRecordsDisplay):!o||n>i||-1===e?i:n},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null,aLastSort:[],oPlugins:{},rowIdFn:null,rowId:null},Ge.ext=Ye={buttons:{},classes:{},errMode:"alert",feature:[],search:[],selector:{cell:[],column:[],row:[]},internal:{},legacy:{ajax:null},pager:{},renderer:{pageButton:{},header:{}},order:{},type:{detect:[],search:{},order:{}},_unique:0,fnVersionCheck:Ge.fnVersionCheck,iApiIndex:0,oJUIClasses:{},sVersion:Ge.version},e.extend(Ye,{afnFiltering:Ye.search,aTypes:Ye.type.detect,ofnSearch:Ye.type.search,oSort:Ye.type.order,afnSortData:Ye.order,aoFeatures:Ye.feature,oApi:Ye.internal,oStdClasses:Ye.classes,oPagination:Ye.pager}),e.extend(Ge.ext.classes,{sTable:"dataTable",sNoFooter:"no-footer",sPageButton:"paginate_button",sPageButtonActive:"current",sPageButtonDisabled:"disabled",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sFilterInput:"",sLengthSelect:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sHeaderTH:"",sFooterTH:"",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sJUIHeader:"",sJUIFooter:""}),function(){var t="";t="";var n=t+"ui-state-default",i=t+"css_right ui-icon ui-icon-",r=t+"fg-toolbar ui-toolbar ui-widget-header ui-helper-clearfix";e.extend(Ge.ext.oJUIClasses,Ge.ext.classes,{sPageButton:"fg-button ui-button "+n,sPageButtonActive:"ui-state-disabled",sPageButtonDisabled:"ui-state-disabled",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:n+" sorting_asc",sSortDesc:n+" sorting_desc",sSortable:n+" sorting",sSortableAsc:n+" sorting_asc_disabled",sSortableDesc:n+" sorting_desc_disabled",sSortableNone:n+" sorting_disabled",sSortJUIAsc:i+"triangle-1-n",sSortJUIDesc:i+"triangle-1-s",sSortJUI:i+"carat-2-n-s",sSortJUIAscAllowed:i+"carat-1-n",sSortJUIDescAllowed:i+"carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead "+n,sScrollFoot:"dataTables_scrollFoot "+n,sHeaderTH:n,sFooterTH:n,sJUIHeader:r+" ui-corner-tl ui-corner-tr",sJUIFooter:r+" ui-corner-bl ui-corner-br"})}();var Ut=Ge.ext.pager;e.extend(Ut,{simple:function(e,t){return["previous","next"]},full:function(e,t){return["first","previous","next","last"]},numbers:function(e,t){return[We(e,t)]},simple_numbers:function(e,t){return["previous",We(e,t),"next"]},full_numbers:function(e,t){return["first","previous",We(e,t),"next","last"]},_numbers:We,numbers_length:7}),e.extend(!0,Ge.ext.renderer,{pageButton:{_:function(t,n,i,r,o,a){var l,c,u,d=t.oClasses,h=t.oLanguage.oPaginate,p=0,f=function(n,r){var s,u,m,g,v=function(e){he(t,e.data.action,!0)};for(s=0,u=r.length;u>s;s++)if(g=r[s],e.isArray(g)){var y=e("<"+(g.DT_el||"div")+"/>").appendTo(n);f(y,g)}else{switch(l=null,c="",g){case"ellipsis":n.append('<span class="ellipsis">&#x2026;</span>');break;case"first":l=h.sFirst,c=g+(o>0?"":" "+d.sPageButtonDisabled);break;case"previous":l=h.sPrevious,c=g+(o>0?"":" "+d.sPageButtonDisabled);break;case"next":l=h.sNext,c=g+(a-1>o?"":" "+d.sPageButtonDisabled);break;case"last":l=h.sLast,c=g+(a-1>o?"":" "+d.sPageButtonDisabled);break;default:l=g+1,c=o===g?d.sPageButtonActive:""}null!==l&&(m=e("<a>",{"class":d.sPageButton+" "+c,"aria-controls":t.sTableId,"data-dt-idx":p,tabindex:t.iTabIndex,id:0===i&&"string"==typeof g?t.sTableId+"_"+g:null}).html(l).appendTo(n),Oe(m,{action:g},v),p++)}};try{u=e(n).find(s.activeElement).data("dt-idx")}catch(m){}f(e(n).empty(),r),u&&e(n).find("[data-dt-idx="+u+"]").focus()}}}),e.extend(Ge.ext.type.detect,[function(e,t){var n=t.oLanguage.sDecimal;return lt(e,n)?"num"+n:null},function(e,t){if(e&&!(e instanceof Date)&&(!tt.test(e)||!nt.test(e)))return null;var n=Date.parse(e);return null!==n&&!isNaN(n)||ot(e)?"date":null},function(e,t){var n=t.oLanguage.sDecimal;return lt(e,n,!0)?"num-fmt"+n:null},function(e,t){var n=t.oLanguage.sDecimal;return ut(e,n)?"html-num"+n:null},function(e,t){var n=t.oLanguage.sDecimal;return ut(e,n,!0)?"html-num-fmt"+n:null},function(e,t){return ot(e)||"string"==typeof e&&-1!==e.indexOf("<")?"html":null}]),e.extend(Ge.ext.type.search,{html:function(e){return ot(e)?e:"string"==typeof e?e.replace(Qe," ").replace(et,""):""},string:function(e){return ot(e)?e:"string"==typeof e?e.replace(Qe," "):e}});var qt=function(e,t,n,i){return 0===e||e&&"-"!==e?(t&&(e=st(e,t)),e.replace&&(n&&(e=e.replace(n,"")),i&&(e=e.replace(i,""))),1*e):-(1/0)};return e.extend(Ye.type.order,{"date-pre":function(e){return Date.parse(e)||0},"html-pre":function(e){return ot(e)?"":e.replace?e.replace(/<.*?>/g,"").toLowerCase():e+""},"string-pre":function(e){return ot(e)?"":"string"==typeof e?e.toLowerCase():e.toString?e.toString():""},"string-asc":function(e,t){return t>e?-1:e>t?1:0},"string-desc":function(e,t){return t>e?1:e>t?-1:0}}),Ue(""),e.extend(!0,Ge.ext.renderer,{header:{_:function(t,n,i,r){e(t.nTable).on("order.dt.DT",function(e,o,a,s){if(t===o){var l=i.idx;n.removeClass(i.sSortingClass+" "+r.sSortAsc+" "+r.sSortDesc).addClass("asc"==s[l]?r.sSortAsc:"desc"==s[l]?r.sSortDesc:i.sSortingClass)}})},jqueryui:function(t,n,i,r){e("<div/>").addClass(r.sSortJUIWrapper).append(n.contents()).append(e("<span/>").addClass(r.sSortIcon+" "+i.sSortingClassJUI)).appendTo(n),e(t.nTable).on("order.dt.DT",function(e,o,a,s){if(t===o){var l=i.idx;n.removeClass(r.sSortAsc+" "+r.sSortDesc).addClass("asc"==s[l]?r.sSortAsc:"desc"==s[l]?r.sSortDesc:i.sSortingClass),n.find("span."+r.sSortIcon).removeClass(r.sSortJUIAsc+" "+r.sSortJUIDesc+" "+r.sSortJUI+" "+r.sSortJUIAscAllowed+" "+r.sSortJUIDescAllowed).addClass("asc"==s[l]?r.sSortJUIAsc:"desc"==s[l]?r.sSortJUIDesc:i.sSortingClassJUI)}})}}}),Ge.render={number:function(e,t,n,i,r){return{display:function(o){if("number"!=typeof o&&"string"!=typeof o)return o;var a=0>o?"-":"";o=Math.abs(parseFloat(o));var s=parseInt(o,10),l=n?t+(o-s).toFixed(n).substring(2):"";return a+(i||"")+s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,e)+l+(r||"")}}}},e.extend(Ge.ext.internal,{_fnExternApiFunc:qe,_fnBuildAjax:B,_fnAjaxUpdate:W,_fnAjaxParameters:U,_fnAjaxUpdateDraw:q,_fnAjaxDataSrc:G,_fnAddColumn:d,_fnColumnOptions:h,_fnAdjustColumnSizing:p,_fnVisibleToColumnIndex:f,_fnColumnIndexToVisible:m,_fnVisbleColumns:g,_fnGetColumns:v,_fnColumnTypes:y,_fnApplyColumnDefs:b,_fnHungarianMap:t,_fnCamelToHungarian:n,_fnLanguageCompat:i,_fnBrowserDetect:c,_fnAddData:_,_fnAddTr:w,_fnNodeToDataIndex:x,_fnNodeToColumnIndex:C,_fnGetCellData:k,_fnSetCellData:S,_fnSplitObjNotation:T,_fnGetObjectDataFn:D,_fnSetObjectDataFn:M,_fnGetDataMaster:$,_fnClearTable:L,_fnDeleteIndex:A,_fnInvalidate:R,_fnGetRowElements:I,_fnCreateTr:j,_fnBuildHead:N,_fnDrawHead:P,_fnDraw:O,_fnReDraw:V,_fnAddOptionsHtml:F,_fnDetectHeader:H,_fnGetUniqueThs:z,_fnFeatureHtmlFilter:Y,_fnFilterComplete:X,_fnFilterCustom:K,_fnFilterColumn:J,_fnFilter:Z,_fnFilterCreateSearch:Q,_fnEscapeRegex:ee,_fnFilterData:te,_fnFeatureHtmlInfo:re,_fnUpdateInfo:oe,_fnInfoMacros:ae,_fnInitialise:se,_fnInitComplete:le,_fnLengthChange:ce,_fnFeatureHtmlLength:ue,_fnFeatureHtmlPaginate:de,_fnPageChange:he,_fnFeatureHtmlProcessing:pe,_fnProcessingDisplay:fe,_fnFeatureHtmlTable:me,_fnScrollDraw:ge,_fnApplyToChildren:ve,_fnCalculateColumnWidths:ye,_fnThrottle:be,_fnConvertToWidth:_e,_fnGetWidestNode:we,_fnGetMaxLenString:xe,_fnStringToCss:Ce,_fnScrollBarWidth:ke,_fnSortFlatten:Se,_fnSort:Te,_fnSortAria:De,_fnSortListener:Me,_fnSortAttachListener:$e,_fnSortingClasses:Le,_fnSortData:Ae,_fnSaveState:Re,_fnLoadState:Ie,_fnSettingsFromNode:je,_fnLog:Ee,_fnMap:Ne,_fnBindAction:Oe,_fnCallbackReg:Ve,_fnCallbackFire:Fe,_fnLengthOverflow:He,_fnRenderer:ze,_fnDataSource:Be,_fnRowAttributes:E,_fnCalculateEnd:function(){}}),e.fn.dataTable=Ge,e.fn.dataTableSettings=Ge.settings,e.fn.dataTableExt=Ge.ext,e.fn.DataTable=function(t){return e(this).dataTable(t).api()},e.each(Ge,function(t,n){e.fn.DataTable[t]=n}),e.fn.dataTable})}(window,document)},function(e,t,n){var i,r,o;!function(a,s,l){var c=function(e,t){"use strict";e.extend(!0,t.defaults,{dom:"<'row'<'col-sm-6'l><'col-sm-6'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-5'i><'col-sm-7'p>>",renderer:"bootstrap"}),e.extend(t.ext.classes,{sWrapper:"dataTables_wrapper form-inline dt-bootstrap",sFilterInput:"form-control input-sm",sLengthSelect:"form-control input-sm"}),t.ext.renderer.pageButton.bootstrap=function(n,i,r,o,a,s){var l,c,u=new t.Api(n),d=n.oClasses,h=n.oLanguage.oPaginate,p=function(t,i){var o,f,m,g,v=function(t){t.preventDefault(),e(t.currentTarget).hasClass("disabled")||u.page(t.data.action).draw(!1)};for(o=0,f=i.length;f>o;o++)if(g=i[o],e.isArray(g))p(t,g);else{switch(l="",c="",g){case"ellipsis":l="&hellip;",c="disabled";break;case"first":l=h.sFirst,c=g+(a>0?"":" disabled");break;case"previous":l=h.sPrevious,c=g+(a>0?"":" disabled");break;case"next":l=h.sNext,c=g+(s-1>a?"":" disabled");break;case"last":l=h.sLast,c=g+(s-1>a?"":" disabled");break;default:l=g+1,c=a===g?"active":""}l&&(m=e("<li>",{"class":d.sPageButton+" "+c,"aria-controls":n.sTableId,tabindex:n.iTabIndex,id:0===r&&"string"==typeof g?n.sTableId+"_"+g:null}).append(e("<a>",{href:"#"}).html(l)).appendTo(t),n.oApi._fnBindAction(m,{action:g},v))}};p(e(i).empty().html('<ul class="pagination"/>').children("ul"),o)},t.TableTools&&(e.extend(!0,t.TableTools.classes,{container:"DTTT btn-group",buttons:{normal:"btn btn-default",disabled:"disabled"},collection:{container:"DTTT_dropdown dropdown-menu",buttons:{normal:"",disabled:"disabled"}},print:{info:"DTTT_print_info"},select:{row:"active"}}),e.extend(!0,t.TableTools.DEFAULTS.oTags,{collection:{container:"ul",button:"li",liner:"a"}}))};r=[n(77),n(575)],i=c,o="function"==typeof i?i.apply(t,r):i,!(o!==l&&(e.exports=o))}(window,document)},function(e,t,n){var i,r;i=[n(45),n(49),n(85),n(464),n(574),n(578),n(579),n(580)],r=function(e,t,n,i,r,o,a,s){var l={alpha:{},beta:{},info_ratio:{},sharpe:{},volatility:{}},c={alpha:"阿尔法",beta:"贝塔",info_ratio:"信息比率",sharpe:"夏普比率",volatility:"收益波动率"};return t.ItemView.extend({className:"detail-risk",template:o,ui:{brief:".brief-wrapper dl"},initialize:function(e){this.model=e.model,this.details={current_date:"",current_alpha:0,current_beta:0,current_info_ratio:0,current_sharpe:0,current_volatility:0}},render:function(){var r=this,a={};return r.$el.append(o(r.details)),t.ItemView.prototype.render.apply(this,arguments),this.model.details("indicator_curve",{need:"all"}).done(function(t){r.details=t,e.each(r.details,function(t,n){e.isNumber(t)&&(r.details[n]=i(t).format("0.00")),-1!==n.search("current_")&&(a[n.replace("current_","")]=r.details[n])}),r.details.current_date=n(r.details.current_date,"YYYYMMDD").format("YYYY-MM-DD"),a.date=r.details.current_date,r.renderBrief(a),r.renderCharts()}),this},scrollFix:function(){var e=this,t=this.$el.find(".brief-wrapper"),n=$(".main"),i=function(){t=e.$el.find(".brief-wrapper"),t.height(t.find(".brief").outerHeight()),t.find(".brief").css({position:"fixed",top:$(".global-bar2").height(),left:0,width:$(".main > .trade").width()}).find("dl").width(t.width())},r=function(){t=e.$el.find(".brief-wrapper"),t.find(".brief").css({position:"static",width:"auto"})};n.on("scroll.strategy-risk",function(e){t.offset().top<=50?i():r()})},onDestroy:function(){$(".main").off("scroll.strategy-risk")},onTabShow:function(){this.scrollFix(),this.$el.find(".panel-body").each(function(e,t){var n=$(t).highcharts();n&&n.reflow()})},onTabHide:function(){$(".main").off("scroll.strategy-risk"),this.$el.find(".brief").css({position:"static",width:"auto"})},renderBrief:function(e){this.ui.brief.html(a(e))},renderCharts:function(){Highcharts.setOptions({global:{useUTC:!1,timezoneOffset:-480}});var t=this,o={},a=function(a,l,u){var d=t.$el.find("."+a+" .panel-body"),h="0.00";return d.empty(),e.every(l,function(t){return e.isNull(t)})?void d.append(s()):(e.any(l,function(e){return Math.abs(e)<.01&&e})&&(h="0.0000"),void d.highcharts(r.simpleChartOptions({plotOptions:{spline:{marker:{enabled:e.size(l)>1?!1:!0},point:{events:{mouseOver:function(){t.renderBrief(o[this.date])}}}}},chart:{spacingTop:30,height:200,type:"spline"},yAxis:{title:{text:""},labels:{formatter:function(){return i(this.value).format(h)}}},tooltip:{shared:!0,formatter:r.simpleTootip({yFormat:h})},series:[{name:c[a],data:e.map(l,function(e,t){return{x:+n(t,"YYYYMMDD"),y:e,date:t}})}]})))};e.each(l,function(r,s){var l={};e.each(t.details[s],function(t,r){e.isNull(t)||(l[r]=t),o[r]=o[r]||{date:n(r,"YYYYMMDD").format("YYYY-MM-DD")},o[r][s]=t?i(t).format("0.00"):null}),a(s,l,r)}),console.log(o)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="brief-wrapper">\n    <div class="brief">\n        <dl>\n            <dt>时间:</dt>\n            <dd>--</dd>\n            <dt>阿尔法:</dt>\n            <dd>--</dd>\n            <dt>贝塔:</dt>\n            <dd>--</dd>\n            <dt>信息比率:</dt>\n            <dd>--</dd>\n            <dt>夏普比率:</dt>\n            <dd>--</dd>\n            <dt>收益波动率:</dt>\n            <dd>--</dd>\n        </dl>\n    </div>\n</div>\n<div class="row">\n    <div class="col-md-6">\n        <div class="panel panel-default alpha">\n            <div class="panel-heading">阿尔法</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="col-md-6">\n        <div class="panel panel-default beta">\n            <div class="panel-heading">贝塔</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="row">\n    <div class="col-md-6">\n        <div class="panel panel-default info_ratio">\n            <div class="panel-heading">信息比率</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="col-md-6">\n        <div class="panel panel-default sharpe">\n            <div class="panel-heading">夏普比率</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="row">\n    <div class="col-md-6">\n        <div class="panel panel-default volatility">\n            <div class="panel-heading">收益波动率</div>\n            <div class="panel-body">\n                <div class="loading">\n                    <span class="spinner primary"></span>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="<dt>时间:</dt>\n<dd>"+(null==(__t=date||"--")?"":__t)+"</dd>\n<dt>阿尔法:</dt>\n<dd>"+(null==(__t=alpha||"--")?"":__t)+"</dd>\n<dt>贝塔:</dt>\n<dd>"+(null==(__t=beta||"--")?"":__t)+"</dd>\n<dt>信息比率:</dt>\n<dd>"+(null==(__t=info_ratio||"--")?"":__t)+"</dd>\n<dt>夏普比率:</dt>\n<dd>"+(null==(__t=sharpe||"--")?"":__t)+"</dd>\n<dt>收益波动率:</dt>\n<dd>"+(null==(__t=volatility||"--")?"":__t)+"</dd>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="empty">\n    没有数据\n</div>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(84),n(582)],r=function(e,t,n,i){return t.ItemView.extend({className:"detail-log",template:!1,initialize:function(e){this.model=e.model},onRender:function(){var t,r=this;this.model.details("log").done(function(o){t=e.map(o,function(e){return e.time=n.format(e.time),i(e)}).reverse().join(""),r.$el.append(t)})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<p class="'+(null==(__t=level)?"":__t)+'">\n    '+(null==(__t=time)?"":__t)+" ["+(null==(__t=level)?"":__t)+"] "+(null==(__t=msg)?"":__t)+"\n</p>\n";return __p}},function(e,t,n){var i,r;i=[n(45),n(49),n(162)],r=function(e,t,n){return t.ItemView.extend({className:"detail-code",template:e.template('<div class="code"></div>'),initialize:function(e){this.model=e.model},onRender:function(){var e=this.$el.find(".code"),t=n(e[0],{value:this.model.get("code"),mode:"python",readOnly:!0});setTimeout(function(){t.refresh()},1)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(464),n(84),n(444),n(585)],r=function(e,t,n,i,r){return e.ItemView.extend({className:"detail-settings",template:r,initialize:function(e){this.model=e.model},serializeData:function(){var e=this.model.toJSON();return e.capitalbase=t(e.capitalbase).format("0,0.00"),e.statusString=i.statusMap[e.status],e.contestString=i.isContestMap[e.is_contest],e.startDate=0!=e.start_time?n.format(e.start_time,"YYYY-MM-DD HH:mm:ss"):"--",e.endDate=e.end_time?n.format(e.end_time,"YYYY-MM-DD HH:mm:ss"):null,e.pms=window.getapi("pms_mom","?accountId="+e.account_id+"#!/fund/dashboard"),e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<ul class="settings">\n    <li>\n        <span class="name">策略状态:</span>\n        <span class="value">'+(null==(__t=statusString)?"":__t)+'</span>\n    </li>\n    <li>\n        <span class="name">参赛状态:</span>\n        <span class="value">'+(null==(__t=contestString)?"":__t)+'</span>\n    </li>\n    <li>\n        <span class="name">开始时间:</span>\n        <span class="value">'+(null==(__t=startDate)?"":__t)+"</span>\n    </li>\n    ",endDate&&(__p+='\n    <li>\n        <span class="name">结束时间:</span>\n        <span class="value">'+(null==(__t=endDate)?"":__t)+"</span>\n    </li>\n    "),__p+='\n    <li>\n        <span class="name">初始资金:</span>\n        <span class="value">'+(null==(__t=capitalbase)?"":__t)+'</span>\n    </li>\n    <li>\n        去<a href="'+(null==(__t=pms)?"":__t)+'">组合管理</a>查看更详细模拟交易信息\n    </li>\n</ul>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<div class="overview">\n    <div class="container">\n        <a class="back" href="trade/strategies" data-href="trade/strategies" title="返回首页">\n            <i class="fa fa-chevron-left"></i>\n        </a>\n        <div class="status">\n            ',[0,2,3,4,5,6].indexOf(status)>-1&&(__p+='\n            <span class="status-indicator '+(null==(__t=statusClassStr)?"":__t)+'">'+(null==(__t=statusStr)?"":__t)+"</span>\n            "),__p+="\n            ",[1,2].indexOf(is_contest)>-1&&(__p+='\n            <span class="is-contest '+(null==(__t=isContestClassStr)?"":__t)+'">'+(null==(__t=isContestStr)?"":__t)+"</span>\n            "),__p+='\n        </div>\n        <h3 class="title">'+__e(name)+'</h3>\n        <div class="pull-right actions"></div>\n        <ul class="summary clearfix"></ul>\n    </div>\n</div>\n<div class="container">\n    <ul class="nav nav-tabs">\n        <li>\n            <a class="tab overview" href="#strategy-'+(null==(__t=id)?"":__t)+'-overview" data-toggle="tab">策略概览</a>\n        </li>\n        <li>\n            <a class="tab risk" href="#strategy-'+(null==(__t=id)?"":__t)+'-risk" data-toggle="tab">风险指标</a>\n        </li>\n        <li>\n            <a class="tab log" href="#strategy-'+(null==(__t=id)?"":__t)+'-log" data-toggle="tab">策略日志</a>\n        </li>\n        <li>\n            <a class="tab code" href="#strategy-'+(null==(__t=id)?"":__t)+'-code" data-toggle="tab">策略代码</a>\n        </li>\n        <li>\n            <a class="tab settings" href="#strategy-'+(null==(__t=id)?"":__t)+'-settings" data-toggle="tab">策略配置</a>\n        </li>\n    </ul>\n    <div class="tab-content">\n        <div class="tab-pane overview" id="strategy-'+(null==(__t=id)?"":__t)+'-overview"></div>\n        <div class="tab-pane risk" id="strategy-'+(null==(__t=id)?"":__t)+'-risk"></div>\n        <div class="tab-pane log" id="strategy-'+(null==(__t=id)?"":__t)+'-log"></div>\n        <div class="tab-pane code" id="strategy-'+(null==(__t=id)?"":__t)+'-code"></div>\n        <div class="tab-pane settings" id="strategy-'+(null==(__t=id)?"":__t)+'-settings"></div>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<li>\n    <span class="value '+(null==(__t=fund_return_class)?"":__t)+'">'+(null==(__t=fund_return)?"":__t)+'</span>\n    <span class="name">累计收益</span>\n</li>\n<li>\n    <span class="value '+(null==(__t=daily_return_class)?"":__t)+'">'+(null==(__t=daily_return)?"":__t)+'</span>\n    <span class="name">当日收益</span>\n</li>\n<li>\n    <span class="value">'+(null==(__t=sharpe)?"":__t)+'</span>\n    <span class="name">夏普比率</span>\n</li>\n<li>\n    <span class="value">'+(null==(__t=market_value)?"":__t)+'</span>\n    <span class="name">持仓市值</span>\n</li>\n<li>\n    <span class="value">'+(null==(__t=current_cash)?"":__t)+'</span>\n    <span class="name">可用金额</span>\n</li>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";Array.prototype.join;with(obj)__p+=[2,3,5,6].indexOf(status)>-1?'\n<a class="btn btn-link delete" href="#" data-loading-text="删除中...">\n    <i class="fa fa-trash"></i> 删除策略\n</a>\n':'\n<a class="btn btn-link terminate" href="#" data-loading-text="终止中...">\n    <i class="fa fa-stop"></i> 终止策略\n</a>\n',__p+="\n";return __p}},function(e,t,n){var i,r;i=[n(443)],r=function(e){return e.extend({urlRoot:window.getapi("mercury_trade","/fundstrategy"),appUrl:function(){return"trade/fundstrategy/"+this.id}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(571),s=i(a),l=n(591),c=i(l);t["default"]=o["default"].extend({},s["default"],{settings:c["default"]}),e.exports=t["default"]},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(584),o=i(r),a=n(592),s=i(a);t["default"]=o["default"].extend({template:s["default"],serializeData:function(){var e=o["default"].prototype.serializeData.apply(this,arguments);return e.typeString="众包基金",e}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<ul class="settings">\n    <li>\n        <span class="name">策略状态:</span>\n        <span class="value">'+(null==(__t=statusString)?"":__t)+'</span>\n    </li>\n    <li>\n        <span class="name">类型:</span>\n        <span class="value">'+(null==(__t=typeString)?"":__t)+'</span>\n    </li>\n    <li>\n        <span class="name">开始时间:</span>\n        <span class="value">'+(null==(__t=startDate)?"":__t)+"</span>\n    </li>\n    ",endDate&&(__p+='\n    <li>\n        <span class="name">结束时间:</span>\n        <span class="value">'+(null==(__t=endDate)?"":__t)+"</span>\n    </li>\n    "),__p+='\n    <li>\n        <span class="name">初始资金:</span>\n        <span class="value">'+(null==(__t=capitalbase)?"":__t)+"</span>\n    </li>\n</ul>\n";return __p}},function(e,t,n){var i,r;i=[n(442),n(589)],r=function(e,t){return e.extend({model:t,url:window.getapi("mercury_trade","/fundstrategy")})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(595),n(598)],r=function(e,t){return e.extend({template:t})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(49),n(115),n(47),n(570),n(596),n(597)],r=function(e,t,n,i,r,o,a){return t.ItemView.extend({tagName:"tr",className:"strategy-item",template:o,events:{"click .btn.goFund":"clickGoFund"},initialize:function(){var e=this;this.listenTo(this.model,"change:status change:fund",function(){e.render()})},serializeData:function(){var e=this.model.toJSON();return e.statusStr=this.model.getStatus(),e.isContestStr=this.model.getContest(),e.appUrl=this.model.appUrl(),e},onRender:function(){var e=this.model.get("status"),t=1==e||4==e?"run":[2,5,6].indexOf(e)>-1?"error":0==e?"init":"term";
this.$el.addClass(t)},onDestroy:function(){this.stopListening()},clickGoFund:function(e){var t=this,r=$(e.currentTarget);r.button("loading"),n.Confirm({title:"确认领奖",positive:"确认",negtive:"取消",content:a(this.model.toJSON()),yes:function(){t.model.goFund().always(function(){r.button("reset")}).done(function(){i.tradeVent.trigger("goFundDone")})},no:function(){r.button("reset")},autoRemove:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<td><a href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'" class="detail">'+__e(name)+"</a></td>\n<td>"+(null==(__t=isContestStr)?"":__t)+'</td>\n<td>\n    <span class="status-indicator">\n        '+(null==(__t=statusStr)?"":__t)+"\n    </span>\n</td>\n<td>"+(null==(__t=_.isNull(total_return)?"-":0===total_return?"0.00%":_T.formatDigit(total_return,"~0.00%"))?"":__t)+"</td>\n<td>"+(null==(__t=start_time?_T.formatDate(start_time):"-")?"":__t)+"</td>\n<td>"+(null==(__t=end_time?_T.formatDate(end_time):"-")?"":__t)+'</td>\n<td>\n    <button class="btn btn-primary btn-xs goFund" data-loading-text="正在处理"'+(null==(__t=0===fund?"":" disabled")?"":__t)+">实盘领奖</button>\n</td>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+="恭喜您获得优矿量化大赛实盘奖励！<br>\n点击确认后您的策略将获得：<br>\n实盘金额："+(null==(__t=_T.formatDigit(contest_capital_base,"0,0.00"))?"":__t)+"<br>\n管理期间："+(null==(__t=_T.formatDate(contest_start_date))?"":__t)+" 至 "+(null==(__t=_T.formatDate(contest_end_date))?"":__t)+"<br>\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<td><a href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'" class="detail">'+__e(name)+'</a></td>\n<td>众包基金</td>\n<td>\n    <span class="status-indicator">\n        '+(null==(__t=statusStr)?"":__t)+"\n    </span>\n</td>\n<td>"+(null==(__t=_.isNull(total_return)?"-":0===total_return?"0.00%":_T.formatDigit(total_return,"~0.00%"))?"":__t)+"</td>\n<td>"+(null==(__t=start_time?_T.formatDate(start_time):"-")?"":__t)+"</td>\n<td>"+(null==(__t=end_time?_T.formatDate(end_time):"-")?"":__t)+"</td>\n";return __p}},function(e,t,n){var i,r;i=[n(600),n(594),n(603)],r=function(e,t,n){return e.extend({childView:t,emptyViewOptions:{text:'<a data-href="help/faq/#如何进行实盘交易" href="help/faq/#如何进行实盘交易">如何进行实盘交易?</a>'},template:n})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49),n(82),n(595),n(601),n(602)],r=function(e,t,n,i,r){return e.CompositeView.extend({tagName:"table",className:"strategy-list",template:r,childView:n,emptyView:i,childViewContainer:"tbody",initialize:function(){this.listenTo(this.collection,{sync:this.removeLoading,"sync:before":this.appendLoading})},appendLoading:function(){this.$el.find("tbody").hide(),this.loading=new t,this.$el.after(this.loading.render().$el)},removeLoading:function(){this.loading&&this.loading.destroy(),this.$el.find("tbody").show()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(49)],r=function(e){return e.ItemView.extend({tagName:"tr",className:"empty-share-list",template:!1,initialize:function(e){this.emptyText=e.text||"没有策略"},render:function(){e.ItemView.prototype.render.apply(this,arguments);var t=$("<td>"+this.emptyText+"</td>");return t.attr("colspan",7),this.$el.append(t),this}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<thead>\n    <tr>\n        <th class="name">名称</th>\n        <th class="contest">大赛状态</th>\n        <th class="status">状态</th>\n        <th class="profit">累计收益率</th>\n        <th class="start">开始日期</th>\n        <th class="end">停止日期</th>\n        <th class="action">操作</th>\n    </tr>\n</thead>\n<tbody></tbody>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<thead>\n    <tr>\n        <th class="name">名称</th>\n        <th class="contest">类型</th>\n        <th class="status">状态</th>\n        <th class="profit">累计收益率</th>\n        <th class="start">开始日期</th>\n        <th class="end">停止日期</th>\n    </tr>\n</thead>\n<tbody></tbody>\n';return __p}},function(e,t,n){var i,r;i=[n(49),n(47),n(116),n(270),n(442),n(600),n(593),n(599),n(605),n(607)],r=function(e,t,n,i,r,o,a,s,l,c){return e.LayoutView.extend({className:"trade-home",template:c,events:{"click .nav a":"clickNav"},regions:{strategList:".region-strategy-list",fundStrategList:".region-fundstrategy-list"},onRender:function(){var e=this;this.nav=this.$el.find(".nav"),this.strategies=new r,this.strategList.show(new o({collection:this.strategies})),this.strategies.fetch(),this.fundStrategies=new a,this.fundStrategList.show(new s({collection:this.fundStrategies})),this.fundStrategies.fetch(),this.listenTo(t.tradeVent,{goFundDone:function(){e.strategies.fetch(),e.fundStrategies.fetch()}});var n=new l({mode:"live",interval:3e4});this.$el.find(".live-monitor").append(n.render().el);var i=new l({mode:"paper",interval:3e4});this.$el.find(".paper-monitor").append(i.render().el),t.vent.trigger("title","首页")},onDestroy:function(){this.stopListening()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";var i=n(63)["default"];Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=i(r),a=n(49),s=i(a),l=n(270),c=i(l),u=n(395),d=i(u),h=n(606),p=i(h);t["default"]=s["default"].ItemView.extend({className:"monitor-dropdown",template:p["default"],ui:{cpu:".cpu",mem:".mem",disk:".disk",dropdown:".dropdown-toggle"},events:{"show.bs.dropdown .dropdown":"onDropdownShow","hide.bs.dropdown .dropdown":"onDropdownHide"},initialize:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];this.opts=o["default"].defaults(e,{mode:"live",interval:1e4})},onRender:function(){var e=this;this.renderBars(c["default"].getData()),this.listenTo(c["default"],{change:function(){e.renderBars(c["default"].getData())}})},renderBars:function(e){this.ui.cpu.find(".value").text(e.cpu_usage+"%").end().find(".bar").attr("class","bar "+d["default"](e.cpu_usage)).find("span").width(e.cpu_usage+"%"),this.ui.mem.find(".value").text(e.memory_desc).end().find(".bar").attr("class","bar "+d["default"](e.memory_usage)).find("span").width(e.memory_usage+"%"),this.ui.disk.find(".value").text(e.disk_desc).end().find(".bar").attr("class","bar "+d["default"](e.disk_usage)).find("span").width(e.disk_usage+"%"),this.$el.find("h4").text("live"===this.opts.mode?"实盘交易资源":"模拟交易资源")},onDropdownShow:function(){c["default"].setMode(this.opts.mode,this.opts.interval)},onDropdownHide:function(){c["default"].stop()}}),e.exports=t["default"]},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="dropdown dropdown-box">\n    <button class="btn btn-link dropdown-toggle" data-toggle="dropdown">\n        <i class="fa fa-tachometer"></i> 资源\n    </button>\n    <div class="dropdown-menu">\n        <h4></h4>\n        <ul class="stat-list">\n            <li class="cpu">\n                <span class="name">CPU</span>\n                <span class="used">\n                    <span class="bar">\n                        <span></span>\n                    </span>\n                    <span class="value">--</span>\n                </span>\n            </li>\n            <li class="mem">\n                <span class="name">内存</span>\n                <span class="used">\n                    <span class="bar">\n                        <span></span>\n                    </span>\n                    <span class="value">--</span>\n                </span>\n            </li>\n            <li class="disk">\n                <span class="name">硬盘</span>\n                <span class="used">\n                    <span class="bar">\n                        <span></span>\n                    </span>\n                    <span class="value">--</span>\n                </span>\n            </li>\n        </ul>\n    </div>\n</div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<h3>实盘交易<div class="monitor live-monitor"></div></h3>\n<div class="region-fundstrategy-list"></div>\n<h3>模拟交易<div class="monitor paper-monitor"></div></h3>\n<div class="region-strategy-list"></div>\n';return __p}},function(e,t,n){var i,r;i=[n(48),n(49),n(67),n(47),n(604),n(609)],r=function(e,t,n,i,r,o){return t.LayoutView.extend({className:"trade",template:o,name:"trade",regions:{main:".region-trade-main"},onRender:function(){new n({appendTo:this.el,appName:i.name,appVersion:i.version,links:!1}),i.vent.trigger("title:module","我的交易"),i.tradeVent=new e.Wreqr.EventAggregator}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<div class="region-trade-main"></div>\n';return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";with(obj)__p+='<i class="'+(null==(__t=index<=3?"icon icon-num icon-num0"+index:"")?"":__t)+'"></i>'+(null==(__t=index>3?index:"")?"":__t)+"\n";return __p}},function(e,t,n){var i,r;i=[n(608),n(604),n(570),n(569)],r=function(e,t,n,i){return{Layout:e,HomeView:t,DetailView:n,FundDetailView:i}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(45),n(48),n(49),n(613),n(46),n(378),n(156),n(47),n(116),n(614),n(567),n(615)],r=function(e,t,n,i,r,o,a,s,l,c,u,d){var h=n.LayoutView.extend({className:"wrapper",template:e.template('<div class="main"></div>'),regions:{main:".main"},initialize:function(){this.currentModuleName=""},render:function(){n.LayoutView.prototype.render.apply(this,arguments);var e=this,t=new c;return s.body.append(t.el),s.vent.on("cover:show",function(){t.show()}),s.vent.on("cover:hide",function(){t.hide()}),this.listenTo(s.vent,"menu:show",function(){e.$el.find(".region-main").removeClass("menu-hided")}),this.listenTo(s.vent,"menu:hide",function(){e.$el.find(".region-main").addClass("menu-hided")}),this.listenTo(s.vent,"title",function(t){t?o.title([t,e.currentModuleName,s.name].join(" - ")):o.title([e.currentModuleName,s.name].join(" - "))}),this.listenTo(s.vent,"title:module",function(t){e.currentModuleName=t}),s.reqres.setHandler("generateTitle",function(t){return[t,e.currentModuleName,s.name].join(" - ")}),this},addGlobalBar:function(){var e=new i({fullWidth:!0,logo:"img/logo.png",appRoot:window.getAppRoot()+"/",personalRegister:!0,navs:[{name:"contest",url:"contest/",title:"大赛"},{name:"community",url:"community/",title:"社区"},{name:"data",url:"data/",title:"数据"},{name:"labs",url:"labs/",title:"开始研究"},{name:"trade",url:"trade/",title:"我的交易"}]});this.listenTo(s.vent,"nav:focus",function(t){e.nav.activate(t)}),e.nav.$el.find("a").each(function(e,t){t=$(t),t.attr("data-href",t.attr("href"))}),this.globalBar=e,e.$el.find(".logo a").attr("href","/home"),this.addHelpNav()},addHelpNav:function(){var e=this.globalBar.nav.$el,t=$(d());e.append(t)},ensureLayout:function(e,t){return this.main.hasView()&&this.main.currentView.name===e?this.main.currentView:(t=new t,this.main.show(t),t)}});return s.addInitializer(function(){var e=new h;$(document).ajaxError(function(e,t){503!==t.status||s.initializeError||(new a({type:"warn",msg:"初始化失败, 请稍后重试",timeout:5e3}),s.initializeError=!1),507===t.status&&new a({type:"warn",msg:"操作失败，我们为您分配的免费存储空间已满。您可以删除不用的Notebook或Data文件。",timeout:5e3})});var t=l.get("profile");t||(t=new u,l.set("profile",t)),r.anonymous||t.fetch(),$("body").off("logined.mercuryLogin").on("logined.mercuryLogin",function(){t.fetch()}),o.favicon("img/favicon.ico"),e.addGlobalBar(),s.Layout=e,e.render(),$(document.body).append(e.el),s.trigger("layout:inited");var n=document.createElement("script"),i=document.createElement("script");n.src="//s11.cnzz.com/z_stat.php?id=1254798253&web_id=1254798253",i.src="//hm.baidu.com/hm.js?9a845cb3a0bc79cf531084cdf73369ad",$("head").append(n).append(i)}),h}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE_613__},function(e,t,n){var i,r;i=[n(49),n(47)],r=function(e,t){return e.ItemView.extend({className:"cover",template:!1,show:function(){var e=this;e.$el.show(),$.Velocity.animate(this.$el,{opacity:.6},{duration:200,easing:"easeOut"})},hide:function(){var e=this;$.Velocity.animate(this.$el,{opacity:0},{duration:200,easing:"easeOut",complete:function(){e.$el.hide()}})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __p="";with(obj)__p+='<li class="dropdown" data-name="help">\n    <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:void(0)">帮助<span class="caret"></span></a>\n    <ul class="dropdown-menu" role="menu">\n        <li>\n            <a href="help/faq/" data-href="help/faq/">\n                优矿帮助\n            </a>\n        </li>\n        <li>\n            <a href="help/changelog/" data-href="help/changelog/">\n                变更日志\n            </a>\n        </li>\n    </ul>\n</li>\n';return __p}},function(e,t,n){var i,r;i=[n(45),n(182),n(84),n(465),n(617),n(618),n(610)],r=function(e,t,n,i,r,o,a){var s={simpleUser:r,apiTable:o,contestGrade:a};window._T={},window._T.partial=function(e,t){return e=s[e],e?e(t):(console.error("partial %s not found.",e),"")},window._T.formatDatetime=function(e,t){return n.format(e,t)},window._T.formatDate=function(e){return n.formatDate(e)},window._T.formatDigit=function(e,n){return t.format(e,n)},window._T.updown=function(e){return i(e)}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;Array.prototype.join;with(obj)__p+='<a class="name'+(null==(__t=profile.verified?" verified-user":"")?"":__t)+'" href="'+(null==(__t=appUrl)?"":__t)+'" data-href="'+(null==(__t=appUrl)?"":__t)+'">\n    ',__p+=profile.verified?"\n    "+__e(profile.nickname)+'<i class="fa fa-check-circle" title="认证用户"></i>\n    ':"\n    "+__e(profile.nickname)+"\n    ",__p+="\n</a>\n",profile.title&&(__p+='\n<span class="signature">'+__e(profile.title)+"</span>\n"),__p+="\n";return __p}},function(module,exports){module.exports=function(obj){obj||(obj={});var __t,__p="";Array.prototype.join;with(obj)__p+='<table class="table table-bordered api-table">\n    ',head&&(__p+="\n    <thead>\n        <tr>\n            ",_.each(head,function(e,t){__p+='\n            <th class="col-'+(null==(__t=t)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</th>\n            "}),__p+="\n        </tr>\n    </thead>\n    "),__p+="\n    <tbody>\n        ",_.each(body,function(e){__p+="\n        <tr>\n            ",_.each(head,function(t,n){__p+='\n            <td class="col-'+(null==(__t=n)?"":__t)+'">'+(null==(__t=e[n])?"":__t)+"</td>\n            "}),__p+="\n        </tr>\n        "}),__p+="\n    </tbody>\n</table>\n";return __p}}])});
//# sourceMappingURL=main.4901a7b29833184454e7.js.map